diff --cc backend/src/app.js
index 165a868,830a3ba..0000000
mode 100644,100644..100755
--- a/backend/src/app.js
+++ b/backend/src/app.js
@@@ -1,74 -1,80 +1,80 @@@
--require("dotenv").config();
--const express = require("express");
--const cors = require("cors");
--const sequelize = require("./config/db");
 -const path = require('path');
--const authRoutes = require("./routes/authRoutes");
--const examRoomRoutes = require("./routes/examRoomRoutes");
--const instructorRoutes = require("./routes/instructorRoutes");
--const profileRoutes = require("./routes/profileRoutes");
--const adminRoutes = require("./routes/adminRoutes");
--const examBankRoutes = require("./routes/examBankRoutes");
- const assignBankRoutes = require("./routes/assignBankRoutes");
- const editExamRoutes = require("./routes/editExamRoutes");
 -const studentExamRoutes = require("./routes/studentExamRoutes");
--const app = express();
--// const profileRouter = require("./routes/profile");
--
- const allowedOrigins = ["http://localhost:4000", "http://127.0.0.1:4000"];
 -const allowedOrigins = [
 -  "http://localhost:4000",
 -  "http://127.0.0.1:4000",
 -];
--
--app.use(
--  cors({
--    origin: function (origin, callback) {
 -      
--      if (!origin || allowedOrigins.includes(origin)) {
--        callback(null, true);
--      } else {
--        console.warn("‚ùå Blocked CORS from:", origin);
--        callback(new Error("Not allowed by CORS"));
--      }
--    },
-     credentials: true,
 -    credentials: true, 
--  })
--);
--
--app.use(express.json());
 -
 -// Serve uploaded verification images if *_url columns are used
 -app.use('/uploads', express.static(path.join(__dirname, 'uploads')));
--
--// ‚úÖ Log debug ch·ªâ khi ch·∫°y dev
--if (process.env.NODE_ENV === "development") {
--  // console.log("üì¶ authRoutes:", typeof authRoutes);
--  // console.log("üì¶ examRoomRoutes:", typeof examRoomRoutes);
--  // console.log("üì¶ authRoutes value:", authRoutes);
--  // console.log("üì¶ examRoomRoutes value:", examRoomRoutes);
--  // console.log("üì¶ profileRoutes mounted at /api/profile");
--}
--
--// ‚úÖ Mount routes
--app.use("/api/auth", authRoutes);
--app.use("/api/exam_rooms", examRoomRoutes);
--app.use("/api/instructor", instructorRoutes);
--app.use("/api/instructor", require("./routes/instructorRoutes"));
--app.use("/api/profile", profileRoutes);
--app.use("/api/admin", adminRoutes);
--app.use("/api/exam-bank", examBankRoutes);
- app.use("/api/assign-bank", assignBankRoutes);
- app.use("/api/edit-exam", editExamRoutes);
 -app.use("/api", studentExamRoutes);
--
--// ‚úÖ Route test
--app.get("/", (req, res) => {
--  res.send("‚úÖ Backend OEM API is running...");
--});
--
--const PORT = process.env.PORT || 5000;
--
--// ‚úÖ K·∫øt n·ªëi v√† ƒë·ªìng b·ªô DB
--sequelize
--  .authenticate()
--  .then(() => {
--    console.log("‚úÖ DB connected successfully");
--    app.listen(PORT, () => {
--      console.log(`üöÄ Server running at http://localhost:${PORT}`);
--    });
--  })
--  .catch((err) => {
--    console.error("‚ùå DB connection error:", err);
--  });
--
--module.exports = app;
++require("dotenv").config();
++const express = require("express");
++const cors = require("cors");
++const sequelize = require("./config/db");
++const path = require('path');
++const authRoutes = require("./routes/authRoutes");
++const examRoomRoutes = require("./routes/examRoomRoutes");
++const instructorRoutes = require("./routes/instructorRoutes");
++const profileRoutes = require("./routes/profileRoutes");
++const adminRoutes = require("./routes/adminRoutes");
++const examBankRoutes = require("./routes/examBankRoutes");
++const assignBankRoutes = require("./routes/assignBankRoutes");
++const editExamRoutes = require("./routes/editExamRoutes");
++const studentExamRoutes = require("./routes/studentExamRoutes");
++const app = express();
++// const profileRouter = require("./routes/profile");
++
++const allowedOrigins = ["http://localhost:4000", "http://127.0.0.1:4000"];
++
++app.use(
++  cors({
++    origin: function (origin, callback) {
++      if (!origin || allowedOrigins.includes(origin)) {
++        callback(null, true);
++      } else {
++        console.warn("‚ùå Blocked CORS from:", origin);
++        callback(new Error("Not allowed by CORS"));
++      }
++    },
++    credentials: true,
++  })
++);
++
++app.use(express.json());
++
++// Serve uploaded verification images if *_url columns are used
++app.use('/uploads', express.static(path.join(__dirname, 'uploads')));
++
++// ‚úÖ Log debug ch·ªâ khi ch·∫°y dev
++if (process.env.NODE_ENV === "development") {
++  // console.log("üì¶ authRoutes:", typeof authRoutes);
++  // console.log("üì¶ examRoomRoutes:", typeof examRoomRoutes);
++  // console.log("üì¶ authRoutes value:", authRoutes);
++  // console.log("üì¶ examRoomRoutes value:", examRoomRoutes);
++  // console.log("üì¶ profileRoutes mounted at /api/profile");
++}
++
++// ‚úÖ Mount routes
++app.use("/api/auth", authRoutes);
++app.use("/api/exam_rooms", examRoomRoutes);
++app.use("/api/instructor", instructorRoutes);
++app.use("/api/instructor", require("./routes/instructorRoutes"));
++app.use("/api/profile", profileRoutes);
++app.use("/api/admin", adminRoutes);
++app.use("/api/exam-bank", examBankRoutes);
++app.use("/api/assign-bank", assignBankRoutes);
++app.use("/api/edit-exam", editExamRoutes);
++app.use("/api", studentExamRoutes);
++
++// ‚úÖ Route test
++app.get("/", (req, res) => {
++  res.send("‚úÖ Backend OEM API is running...");
++});
++
++const PORT = process.env.PORT || 5000;
++
++// ‚úÖ K·∫øt n·ªëi v√† ƒë·ªìng b·ªô DB
++sequelize
++  .authenticate()
++  .then(() => {
++    console.log("‚úÖ DB connected successfully");
++    app.listen(PORT, () => {
++      console.log(`üöÄ Server running at http://localhost:${PORT}`);
++    });
++  })
++  .catch((err) => {
++    console.error("‚ùå DB connection error:", err);
++  });
++
++module.exports = app;
diff --cc frontend/src/App.jsx
index 949f34f,ea4f925..0000000
mode 100644,100644..100755
--- a/frontend/src/App.jsx
+++ b/frontend/src/App.jsx
@@@ -1,170 -1,208 +1,211 @@@
--import React from "react";
--import {
--  BrowserRouter as Router,
--  Routes,
--  Route,
--  Navigate,
--  useLocation,
--  Outlet,
--} from "react-router-dom";
--
--import Layout from "./components/Layout.jsx";
--import LandingPage from "./pages/LandingPage.jsx";
--import AboutUs from "./pages/AboutUs.jsx";
--import Contract from "./pages/Contract.jsx";
--import Features from "./pages/Features.jsx";
--import News from "./pages/News.jsx";
--
--import LoginPage from "./authPages/LoginPage.jsx";
--import RegisterPage from "./authPages/RegisterPage.jsx";
--import RolePage from "./authPages/RolePage.jsx";
--import VerifyRoom from "./authPages/VerifyRoom.jsx";
--import ForgotPassword from "./authPages/ForgotPassword.jsx";
--import VerifyEmail from "./authPages/VerifyEmail.jsx";
--import ResetPassword from "./authPages/ResetPassword.jsx";
--
--import InstructorDashboard from "./pages/instructorPage/InstructorDashboard.jsx";
--import AssignExam from "./pages/instructorPage/AssignExam.jsx";
--import ExamBank from "./pages/instructorPage/ExamBank.jsx";
 -import OpenExam from "./pages/instructorPage/OpenExam.jsx";
 -import ExamSettings from "./pages/instructorPage/ExamSettings.jsx";
 -import ExamPreview from "./pages/instructorPage/ExamPreview.jsx";
 -import OpenRoomSuccess from "./pages/instructorPage/OpenRoomSuccess.jsx";
 -import PublishedResultsList from "./pages/instructorPage/PublishedResultsList.jsx";
--import Result from "./pages/instructorPage/Result.jsx";
--import Setting from "./pages/instructorPage/Setting.jsx";
- import EditExam from "./pages/instructorPage/EditExam.jsx";
- 
--import StudentDashboard from "./pages/studentPage/StudentDashboard.jsx";
 -import PrepareExam from "./pages/studentPage/PrepareExam.jsx";
 -import TakeExam from "./pages/studentPage/TakeExam.jsx";
 -import ResultsDashboard from "./pages/studentPage/ResultsDashboard.jsx";
--
--import InstructorSidebar from "./components/instructor/InstructorSidebar.jsx";
 -import { UiProvider } from "./context/UiContext.jsx";
--import Profile from "./pages/instructorPage/Profile.jsx";
--
--import AdminDashboard from "./pages/adminPage/AdminDashboard.jsx";
--
--function ProtectedRoute({ children, requiredRole }) {
--  const location = useLocation();
--  const role = localStorage.getItem("role");
--  const token = localStorage.getItem("token");
--
--  if (!token) {
--    return <Navigate to="/login" replace state={{ from: location }} />;
--  }
--
--  if (requiredRole && role !== requiredRole) {
--    return <Navigate to="/" replace />;
--  }
--
--  return children;
--}
--
--function InstructorLayout() {
--  return (
-     <div className="flex h-screen bg-gray-50 overflow-hidden">
-       <InstructorSidebar />
- 
-       <main className="flex-1 overflow-y-auto p-6">
-         <Outlet />
-       </main>
-     </div>
 -    <UiProvider>
 -      <div className="flex h-screen bg-gray-50 overflow-hidden">
 -        <InstructorSidebar />
 -        <main className="flex-1 overflow-y-auto p-6 bg-gray-50">
 -          <Outlet />
 -        </main>
 -      </div>
 -    </UiProvider>
--  );
--}
--
--const App = () => {
--  return (
--    <Router>
--      <Routes>
--        <Route
--          path="/"
--          element={
--            <Layout>
--              <LandingPage />
--            </Layout>
--          }
--        />
--        <Route
--          path="/ve-chung-toi"
--          element={
--            <Layout>
--              <AboutUs />
--            </Layout>
--          }
--        />
--        <Route
--          path="/tinh-nang"
--          element={
--            <Layout>
--              <Features />
--            </Layout>
--          }
--        />
--        <Route
--          path="/tin-tuc"
--          element={
--            <Layout>
--              <News />
--            </Layout>
--          }
--        />
--        <Route
--          path="/lien-he"
--          element={
--            <Layout>
--              <Contract />
--            </Layout>
--          }
--        />
--        <Route
--          path="/student-dashboard"
--          element={
--            <ProtectedRoute requiredRole="student">
--              <StudentDashboard />
--            </ProtectedRoute>
--          }
--        />
--        <Route
--          path="/admin-dashboard"
--          element={
--            <ProtectedRoute requiredRole="admin">
--              <AdminDashboard />
--            </ProtectedRoute>
--          }
--        />
--        <Route path="/role" element={<RolePage />} />
--        <Route path="/login" element={<LoginPage />} />
--        <Route path="/register" element={<RegisterPage />} />
--        <Route path="/verify-room" element={<VerifyRoom />} />
--        <Route path="/forgot-password" element={<ForgotPassword />} />
--        <Route path="/verify-email" element={<VerifyEmail />} />
--        <Route path="/reset-password" element={<ResetPassword />} />
--
--        {/* <Route
--          path="/student-dashboard"
--          element={
--            <ProtectedRoute requiredRole="student">
--              <StudentDashboard />
--            </ProtectedRoute>
--          }
--        /> */}
--
--        <Route
--          element={
--            <ProtectedRoute requiredRole="instructor">
--              <InstructorLayout />
--            </ProtectedRoute>
--          }
--        >
--          <Route
--            path="/instructor-dashboard"
--            element={<InstructorDashboard />}
--          />
--          <Route path="/exam-bank" element={<ExamBank />} />
--          <Route path="/assign-exam" element={<AssignExam />} />
-           <Route path="/instructor/exams/:id/edit" element={<EditExam />} />
 -          <Route path="/open-exam" element={<OpenExam />} />
 -          <Route path="/exam-settings/:examId" element={<ExamSettings />} />
 -          <Route path="/exams/:examId/preview" element={<ExamPreview />} />
 -          <Route path="/open-success/:examId" element={<OpenRoomSuccess />} />
 -          <Route path="/results-exams" element={<PublishedResultsList />} />
--          <Route path="/result" element={<Result />} />
--          <Route path="/setting" element={<Setting />} />
--          <Route path="/profile" element={<Profile />} />
--        </Route>
 -
 -        <Route
 -          path="/student-dashboard/results"
 -          element={
 -            <ProtectedRoute requiredRole="student">
 -              <ResultsDashboard />
 -            </ProtectedRoute>
 -          }
 -        />
 -
 -        <Route
 -          path="/exam/:examId/prepare"
 -          element={
 -            <ProtectedRoute requiredRole="student">
 -              <PrepareExam />
 -            </ProtectedRoute>
 -          }
 -        />
 -        <Route
 -          path="/exam/:examId/take"
 -          element={
 -            <ProtectedRoute requiredRole="student">
 -              <TakeExam />
 -            </ProtectedRoute>
 -          }
 -        />
--
--        <Route path="*" element={<Navigate to="/" replace />} />
--      </Routes>
--    </Router>
--  );
--};
--
--export default App;
++import React from "react";
++import {
++  BrowserRouter as Router,
++  Routes,
++  Route,
++  Navigate,
++  useLocation,
++  Outlet,
++} from "react-router-dom";
++
++import Layout from "./components/Layout.jsx";
++import LandingPage from "./pages/LandingPage.jsx";
++import AboutUs from "./pages/AboutUs.jsx";
++import Contract from "./pages/Contract.jsx";
++import Features from "./pages/Features.jsx";
++import News from "./pages/News.jsx";
++
++import LoginPage from "./authPages/LoginPage.jsx";
++import RegisterPage from "./authPages/RegisterPage.jsx";
++import RolePage from "./authPages/RolePage.jsx";
++import VerifyRoom from "./authPages/VerifyRoom.jsx";
++import ForgotPassword from "./authPages/ForgotPassword.jsx";
++import VerifyEmail from "./authPages/VerifyEmail.jsx";
++import ResetPassword from "./authPages/ResetPassword.jsx";
++
++import InstructorDashboard from "./pages/instructorPage/InstructorDashboard.jsx";
++import AssignExam from "./pages/instructorPage/AssignExam.jsx";
++import ExamBank from "./pages/instructorPage/ExamBank.jsx";
++import OpenExam from "./pages/instructorPage/OpenExam.jsx";
++import ExamSettings from "./pages/instructorPage/ExamSettings.jsx";
++import ExamPreview from "./pages/instructorPage/ExamPreview.jsx";
++import OpenRoomSuccess from "./pages/instructorPage/OpenRoomSuccess.jsx";
++import PublishedResultsList from "./pages/instructorPage/PublishedResultsList.jsx";
++import Result from "./pages/instructorPage/Result.jsx";
++import Setting from "./pages/instructorPage/Setting.jsx";
++import EditExam from "./pages/instructorPage/EditExam.jsx";
++
++import StudentDashboard from "./pages/studentPage/StudentDashboard.jsx";
++import PrepareExam from "./pages/studentPage/PrepareExam.jsx";
++import TakeExam from "./pages/studentPage/TakeExam.jsx";
++import ResultsDashboard from "./pages/studentPage/ResultsDashboard.jsx";
++
++import InstructorSidebar from "./components/instructor/InstructorSidebar.jsx";
++import { UiProvider } from "./context/UiContext.jsx";
++import Profile from "./pages/instructorPage/Profile.jsx";
++
++import AdminDashboard from "./pages/adminPage/AdminDashboard.jsx";
++
++function ProtectedRoute({ children, requiredRole }) {
++  const location = useLocation();
++  const role = localStorage.getItem("role");
++  const token = localStorage.getItem("token");
++
++  if (!token) {
++    return <Navigate to="/login" replace state={{ from: location }} />;
++  }
++
++  if (requiredRole && role !== requiredRole) {
++    return <Navigate to="/" replace />;
++  }
++
++  return children;
++}
++
++function InstructorLayout() {
++  return (
++    <UiProvider>
++      <div className="flex h-screen bg-gray-50 overflow-hidden">
++        <InstructorSidebar />
++        <main className="flex-1 overflow-y-auto p-6 bg-gray-50">
++          <Outlet />
++        </main>
++      </div>
++    </UiProvider>
++  );
++}
++
++const App = () => {
++  return (
++    <Router>
++      <Routes>
++        <Route
++          path="/"
++          element={
++            <Layout>
++              <LandingPage />
++            </Layout>
++          }
++        />
++        <Route
++          path="/ve-chung-toi"
++          element={
++            <Layout>
++              <AboutUs />
++            </Layout>
++          }
++        />
++        <Route
++          path="/tinh-nang"
++          element={
++            <Layout>
++              <Features />
++            </Layout>
++          }
++        />
++        <Route
++          path="/tin-tuc"
++          element={
++            <Layout>
++              <News />
++            </Layout>
++          }
++        />
++        <Route
++          path="/lien-he"
++          element={
++            <Layout>
++              <Contract />
++            </Layout>
++          }
++        />
++        <Route
++          path="/student-dashboard"
++          element={
++            <ProtectedRoute requiredRole="student">
++              <StudentDashboard />
++            </ProtectedRoute>
++          }
++        />
++        <Route
++          path="/admin-dashboard"
++          element={
++            <ProtectedRoute requiredRole="admin">
++              <AdminDashboard />
++            </ProtectedRoute>
++          }
++        />
++        <Route path="/role" element={<RolePage />} />
++        <Route path="/login" element={<LoginPage />} />
++        <Route path="/register" element={<RegisterPage />} />
++        <Route path="/verify-room" element={<VerifyRoom />} />
++        <Route path="/forgot-password" element={<ForgotPassword />} />
++        <Route path="/verify-email" element={<VerifyEmail />} />
++        <Route path="/reset-password" element={<ResetPassword />} />
++
++        {/* <Route
++          path="/student-dashboard"
++          element={
++            <ProtectedRoute requiredRole="student">
++              <StudentDashboard />
++            </ProtectedRoute>
++          }
++        /> */}
++
++        <Route
++          element={
++            <ProtectedRoute requiredRole="instructor">
++              <InstructorLayout />
++            </ProtectedRoute>
++          }
++        >
++          <Route
++            path="/instructor-dashboard"
++            element={<InstructorDashboard />}
++          />
++          <Route path="/exam-bank" element={<ExamBank />} />
++          <Route path="/assign-exam" element={<AssignExam />} />
++          <Route path="/open-exam" element={<OpenExam />} />
++          <Route path="/exam-settings/:examId" element={<ExamSettings />} />
++          <Route path="/exams/:examId/preview" element={<ExamPreview />} />
++          <Route path="/open-success/:examId" element={<OpenRoomSuccess />} />
++          <Route path="/results-exams" element={<PublishedResultsList />} />
++          <Route path="/result" element={<Result />} />
++          <Route path="/setting" element={<Setting />} />
++          <Route path="/profile" element={<Profile />} />
++          <Route path="/instructor/exams/:id/edit" element={<EditExam />} />
++        </Route>
++
++        <Route
++          path="/student-dashboard/results"
++          element={
++            <ProtectedRoute requiredRole="student">
++              <ResultsDashboard />
++            </ProtectedRoute>
++          }
++        />
++
++        <Route
++          path="/exam/:examId/prepare"
++          element={
++            <ProtectedRoute requiredRole="student">
++              <PrepareExam />
++            </ProtectedRoute>
++          }
++        />
++        <Route
++          path="/exam/:examId/take"
++          element={
++            <ProtectedRoute requiredRole="student">
++              <TakeExam />
++            </ProtectedRoute>
++          }
++        />
++
++        <Route path="*" element={<Navigate to="/" replace />} />
++      </Routes>
++    </Router>
++  );
++};
++
++export default App;
diff --git a/.gitignore b/.gitignore
index 741d985..15a9380 100644
--- a/.gitignore
+++ b/.gitignore
@@ -1,37 +1,37 @@
-# =========================
-# Node.js & React (Vite) Project
-# =========================
-
-# Dependencies
-node_modules/
-npm-debug.log*
-yarn-debug.log*
-yarn-error.log*
-pnpm-debug.log*
-package-lock.json
-
-# Build outputs
-dist/
-build/
-
-# Local env files
-.env
-.env.local
-.env.development.local
-.env.test.local
-.env.production.local
-
-# IDE / Editor
-.vscode/
-.idea/
-*.suo
-*.ntvs*
-*.njsproj
-*.sln
-
-# MacOS / Windows system files
-.DS_Store
-Thumbs.db
-
-# Logs
-*.log
+# =========================
+# Node.js & React (Vite) Project
+# =========================
+
+# Dependencies
+node_modules/
+npm-debug.log*
+yarn-debug.log*
+yarn-error.log*
+pnpm-debug.log*
+package-lock.json
+
+# Build outputs
+dist/
+build/
+
+# Local env files
+.env
+.env.local
+.env.development.local
+.env.test.local
+.env.production.local
+
+# IDE / Editor
+.vscode/
+.idea/
+*.suo
+*.ntvs*
+*.njsproj
+*.sln
+
+# MacOS / Windows system files
+.DS_Store
+Thumbs.db
+
+# Logs
+*.log
diff --git "a/H\306\260\341\273\233ng d\341\272\253n" "b/H\306\260\341\273\233ng d\341\272\253n"
index 1499687..b3dbbf3 100644
--- "a/H\306\260\341\273\233ng d\341\272\253n"	
+++ "b/H\306\260\341\273\233ng d\341\272\253n"	
@@ -1,26 +1,26 @@
-# C√†i dependencies cho root project
-npm install
-
-# C√†i dependencies cho frontend
-cd frontend
-npm install
-
-# C√†i dependencies cho backend  
-cd ../backend
-npm install
-
-#Ch·∫°y C·∫£ Frontend + Backend 
-# T·ª´ th∆∞ m·ª•c root
-npm start
-# Ho·∫∑c Ch·∫°y Ri√™ng T·ª´ng Ph·∫ßn
-
-##Frontend
-cd frontend
-npm run dev
-#Backend
-cd backend
-npm run dev
-#== ƒë·∫©y code l√™n github
-git add .
-git commit -m "M√¥ t·∫£ thay ƒë·ªïi, v√≠ d·ª•: Update LandingPage CSS"
-git push
+# C√†i dependencies cho root project
+npm install
+
+# C√†i dependencies cho frontend
+cd frontend
+npm install
+
+# C√†i dependencies cho backend  
+cd ../backend
+npm install
+
+#Ch·∫°y C·∫£ Frontend + Backend 
+# T·ª´ th∆∞ m·ª•c root
+npm start
+# Ho·∫∑c Ch·∫°y Ri√™ng T·ª´ng Ph·∫ßn
+
+##Frontend
+cd frontend
+npm run dev
+#Backend
+cd backend
+npm run dev
+#== ƒë·∫©y code l√™n github
+git add .
+git commit -m "M√¥ t·∫£ thay ƒë·ªïi, v√≠ d·ª•: Update LandingPage CSS"
+git push
diff --git a/README.md b/README.md
index 68d0ce0..7f9e1ed 100644
--- a/README.md
+++ b/README.md
@@ -1,53 +1,53 @@
--C√†i dependencies cho root project
-npm install
-
--C√†i dependencies cho frontend
-cd frontend
-npm install
-
--C√†i dependencies cho backend  
-cd ../backend
-npm install
-
--Ch·∫°y C·∫£ Frontend + Backend 
--T·ª´ th∆∞ m·ª•c root
-npm start
--Ho·∫∑c Ch·∫°y Ri√™ng T·ª´ng Ph·∫ßn
-
--Frontend
-cd frontend
-npm run dev
--Backend
-cd backend
-npm run dev
-
---C√°ch l·∫•y code v·ªÅ v√† ƒë·ªìng b·ªô project---
-Clone repository
-git clone https://github.com/USERNAME/OEM_Project-.git
-
-Di chuy·ªÉn v√†o th∆∞ m·ª•c project
-cd OEM_Project-
-
-Ki·ªÉm tra branch hi·ªán t·∫°i
-git branch
-
-N·∫øu mu·ªën t·∫°o branch m·ªõi ƒë·ªÉ l√†m vi·ªác, d√πng:
-git checkout -b feature-branch
-
-ƒê·ªìng b·ªô v·ªõi repository ch√≠nh
-git pull origin main
-
-ƒê·∫©y thay ƒë·ªïi l√™n GitHub n·∫øu ƒë√£ xong nh·ªØng ph·∫ßn trong ng√†y
--== ƒë·∫©y code l√™n github
-git add .
-git commit -m "M√¥ t·∫£ thay ƒë·ªïi, v√≠ d·ª•: Update LandingPage CSS"
-git push
-
-### khi b·ªã l·ªói ti·∫øng vi·ªát khi ƒëƒÉng k√Ω t√†i kho·∫£n admin, ch·∫°y l·ªánh terminal sau:
-### ‚öôÔ∏è C·∫•u h√¨nh terminal hi·ªÉn th·ªã ti·∫øng Vi·ªát
-N·∫øu ch·∫°y `npm run taoTK` m√† th·∫•y k√Ω t·ª± b·ªã l·ªói (VD: H√ü‚ïó√¨...), h√£y l√†m theo:
-```bash
-chcp 65001
-[Console]::InputEncoding  = [System.Text.Encoding]::UTF8
-[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
-
+-C√†i dependencies cho root project
+npm install
+
+-C√†i dependencies cho frontend
+cd frontend
+npm install
+
+-C√†i dependencies cho backend  
+cd ../backend
+npm install
+
+-Ch·∫°y C·∫£ Frontend + Backend 
+-T·ª´ th∆∞ m·ª•c root
+npm start
+-Ho·∫∑c Ch·∫°y Ri√™ng T·ª´ng Ph·∫ßn
+
+-Frontend
+cd frontend
+npm run dev
+-Backend
+cd backend
+npm run dev
+
+--C√°ch l·∫•y code v·ªÅ v√† ƒë·ªìng b·ªô project---
+Clone repository
+git clone https://github.com/USERNAME/OEM_Project-.git
+
+Di chuy·ªÉn v√†o th∆∞ m·ª•c project
+cd OEM_Project-
+
+Ki·ªÉm tra branch hi·ªán t·∫°i
+git branch
+
+N·∫øu mu·ªën t·∫°o branch m·ªõi ƒë·ªÉ l√†m vi·ªác, d√πng:
+git checkout -b feature-branch
+
+ƒê·ªìng b·ªô v·ªõi repository ch√≠nh
+git pull origin main
+
+ƒê·∫©y thay ƒë·ªïi l√™n GitHub n·∫øu ƒë√£ xong nh·ªØng ph·∫ßn trong ng√†y
+-== ƒë·∫©y code l√™n github
+git add .
+git commit -m "M√¥ t·∫£ thay ƒë·ªïi, v√≠ d·ª•: Update LandingPage CSS"
+git push
+
+### khi b·ªã l·ªói ti·∫øng vi·ªát khi ƒëƒÉng k√Ω t√†i kho·∫£n admin, ch·∫°y l·ªánh terminal sau:
+### ‚öôÔ∏è C·∫•u h√¨nh terminal hi·ªÉn th·ªã ti·∫øng Vi·ªát
+N·∫øu ch·∫°y `npm run taoTK` m√† th·∫•y k√Ω t·ª± b·ªã l·ªói (VD: H√ü‚ïó√¨...), h√£y l√†m theo:
+```bash
+chcp 65001
+[Console]::InputEncoding  = [System.Text.Encoding]::UTF8
+[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
+
diff --git a/backend/.gitignore b/backend/.gitignore
index a8fb13d..7865f6f 100644
--- a/backend/.gitignore
+++ b/backend/.gitignore
@@ -1,2 +1,2 @@
-# Local env files
+# Local env files
 .env
\ No newline at end of file
diff --git a/backend/old_app.js b/backend/old_app.js
index fc62a55..8dec485 100644
--- a/backend/old_app.js
+++ b/backend/old_app.js
@@ -1,29 +1,29 @@
-const express = require("express");
-const app = express();
-const sequelize = require("./src/config/db");
-const authRoutes = require("./src/routes/authRoutes");
-const examRoomRoutes = require("./src/routes/examRoomRoutes");
-// console.log("üì¶ authRoutes:", typeof authRoutes);
-// console.log("üì¶ examRoomRoutes:", typeof examRoomRoutes);
-// console.log("üì¶ authRoutes value:", authRoutes);
-// console.log("üì¶ examRoomRoutes value:", examRoomRoutes);
-
-app.use(express.json());
-
-app.use("/auth", authRoutes);
-app.use("/exam_rooms", examRoomRoutes);
-
-sequelize
-  .authenticate()
-  .then(() => {
-    console.log("‚úÖ DB connected");
-    return sequelize.sync();
-  })
-  .then(() => {
-    console.log("‚úÖ Models synchronized");
-  })
-  .catch((err) => {
-    console.error("‚ùå DB sync error:", err);
-  });
-
-module.exports = app;
+const express = require("express");
+const app = express();
+const sequelize = require("./src/config/db");
+const authRoutes = require("./src/routes/authRoutes");
+const examRoomRoutes = require("./src/routes/examRoomRoutes");
+// console.log("üì¶ authRoutes:", typeof authRoutes);
+// console.log("üì¶ examRoomRoutes:", typeof examRoomRoutes);
+// console.log("üì¶ authRoutes value:", authRoutes);
+// console.log("üì¶ examRoomRoutes value:", examRoomRoutes);
+
+app.use(express.json());
+
+app.use("/auth", authRoutes);
+app.use("/exam_rooms", examRoomRoutes);
+
+sequelize
+  .authenticate()
+  .then(() => {
+    console.log("‚úÖ DB connected");
+    return sequelize.sync();
+  })
+  .then(() => {
+    console.log("‚úÖ Models synchronized");
+  })
+  .catch((err) => {
+    console.error("‚ùå DB sync error:", err);
+  });
+
+module.exports = app;
diff --git a/backend/scripts/createAdmin.js b/backend/scripts/createAdmin.js
index b3c0d6a..3d217ed 100644
--- a/backend/scripts/createAdmin.js
+++ b/backend/scripts/createAdmin.js
@@ -1,188 +1,188 @@
-// ===============================
-// üåê OEM Mini - Tao tai khoan Quan tri (Admin) - CLI v3.0
-// ===============================
-
-// ‚öôÔ∏è Ep dau vao/ra UTF-8 de hien thi khong dau
-try {
-  if (process.stdin.setEncoding) process.stdin.setEncoding('utf8');
-  if (process.stdout.setEncoding) process.stdout.setEncoding('utf8');
-} catch {}
-
-// ===============================
-// üì¶ Import thu vien
-// ===============================
-const readlineSync = require('readline-sync');
-const bcrypt = require('bcrypt');
-const sequelize = require('../src/config/db');
-const { User } = require('../src/models/User');
-const { validateEmailDomain } = require('../src/utils/emailValidator');
-const { sendAdminOTPVerificationEmail } = require('../src/services/emailService');
-
-const SALT_ROUNDS = 10;
-const OTP_EXPIRE_MINUTES = 5;
-
-// ===============================
-// üõë Xu ly Ctrl + C (thoat an toan)
-// ===============================
-//process.on('SIGINT', () => {
-//  console.log('\n‚ùå Qua trinh nhap lieu da bi huy boi nguoi dung.');
-//  process.exit(0);
-//});
-
-// ===============================
-// üß© Ham chinh tao tai khoan admin
-// ===============================
-async function createAdmin() {
-  try {
-    console.log('üîß === OEM Mini - Tao tai khoan Quan tri (Admin) ===\n');
-
-    // 1Ô∏è‚É£ Ket noi DB
-    await sequelize.authenticate();
-    console.log('‚úÖ Ket noi co so du lieu thanh cong!\n');
-
-    // 2Ô∏è‚É£ Nhap ho ten
-    let fullName;
-    while (true) {
-      fullName = readlineSync.question('Ho va ten: ');
-      if (fullName.trim()) break;
-      console.log('‚ùå Ten khong duoc de trong. Vui long nhap lai.\n');
-    }
-
-    // 3Ô∏è‚É£ Nhap email + kiem tra ton tai + kiem tra ten mien hop le
-    let email;
-    while (true) {
-      email = readlineSync.questionEMail('Dia chi email: ');
-      if (!email) {
-        console.log('‚ùå Email khong hop le. Vui long nhap lai.\n');
-        continue;
-      }
-
-      // Kiem tra ten mien hop le bang DNS MX
-      try {
-        await validateEmailDomain(email);
-      } catch {
-        const retry = readlineSync.keyInYNStrict('Ban co muon nhap lai email khac khong? (y/n): ');
-        if (!retry) {
-          console.log('‚ùå Huy tao tai khoan quan tri.');
-          process.exit(0);
-        }
-        continue;
-      }
-
-      // Kiem tra email da ton tai trong DB
-      const existingUser = await User.findOne({ where: { email: email.toLowerCase().trim() } });
-      if (existingUser) {
-        console.log('‚ö†Ô∏è Email nay da duoc su dung trong he thong.');
-        const retry = readlineSync.keyInYNStrict('Ban co muon nhap email khac khong? (y/n): ');
-        if (!retry) {
-          console.log('‚ùå Huy tao tai khoan quan tri.');
-          process.exit(0);
-        }
-        continue;
-      }
-
-      break; // Email hop le va chua ton tai
-    }
-
-    // 4Ô∏è‚É£ Gui ma OTP xac minh
-    const otpCode = Math.floor(100000 + Math.random() * 900000);
-    console.log(`üì® Dang gui ma OTP den ${email} ...`);
-    const otpResult = await sendAdminOTPVerificationEmail(email, otpCode, fullName);
-
-    if (!otpResult.success) {
-      console.log('‚ùå Khong the gui ma OTP. Thu lai sau.');
-      process.exit(1);
-    }
-
-    console.log('‚úÖ Da gui ma OTP thanh cong. Vui long kiem tra hop thu cua ban.');
-    console.log(`‚è∞ Ma OTP co hieu luc trong ${OTP_EXPIRE_MINUTES} phut.\n`);
-
-    // 5Ô∏è‚É£ Nguoi dung nhap OTP de xac minh
-    const otpStartTime = Date.now();
-    let verified = false;
-
-    while (true) {
-      const now = Date.now();
-      const elapsedMinutes = (now - otpStartTime) / (1000 * 60);
-
-      if (elapsedMinutes > OTP_EXPIRE_MINUTES) {
-        console.log('‚åõ Ma OTP da het han. Vui long chay lai lenh tao tai khoan.');
-        process.exit(0);
-      }
-
-      const inputOTP = readlineSync.question('Nhap ma OTP duoc gui den email: ');
-      if (inputOTP.trim() === otpCode.toString()) {
-        console.log('‚úÖ Xac minh email thanh cong!\n');
-        verified = true;
-        break;
-      } else {
-        console.log('‚ùå Ma OTP khong dung. Vui long nhap lai hoac nhan Ctrl + C de thoat.\n');
-      }
-    }
-
-    if (!verified) {
-      console.log('‚ùå Email chua duoc xac minh. Huy tao tai khoan.');
-      process.exit(0);
-    }
-
-    // 6Ô∏è‚É£ Nhap mat khau
-    let password;
-    while (true) {
-      password = readlineSync.question('Mat khau: ', { hideEchoBack: true });
-      if (password.length >= 8) break;
-      console.log('‚ùå Mat khau phai co it nhat 8 ky tu.\n');
-    }
-
-    // 7Ô∏è‚É£ Xac nhan mat khau
-    let confirmPassword;
-    while (true) {
-      confirmPassword = readlineSync.question('Xac nhan mat khau: ', { hideEchoBack: true });
-      if (confirmPassword === password) break;
-      console.log('‚ùå Mat khau xac nhan khong khop.\n');
-    }
-
-    // 8Ô∏è‚É£ Hien thi thong tin truoc khi tao
-    console.log('\nüìã Thong tin tai khoan quan tri:');
-    console.log(`   Ho ten: ${fullName}`);
-    console.log(`   Email: ${email}`);
-    console.log(`   Vai tro: admin\n`);
-
-    const confirm = readlineSync.keyInYNStrict('Ban co chac muon tao tai khoan nay khong? (y/n): ');
-    if (!confirm) {
-      console.log('‚ùå Huy tao tai khoan quan tri.');
-      process.exit(0);
-    }
-
-    // 9Ô∏è‚É£ Ma hoa mat khau va luu DB
-    console.log('üîê Dang ma hoa mat khau...');
-    const hashedPassword = await bcrypt.hash(password, SALT_ROUNDS);
-
-    console.log('üíæ Dang luu vao co so du lieu...');
-    const newAdmin = await User.create({
-      full_name: fullName.trim(),
-      email: email.toLowerCase().trim(),
-      password_hash: hashedPassword,
-      role: 'admin',
-      created_at: new Date(),
-    });
-
-    // üîü Hoan tat
-    console.log('\n‚úÖ Tao tai khoan Quan tri thanh cong!');
-    console.log(`   ID: ${newAdmin.id}`);
-    console.log(`   Ho ten: ${newAdmin.full_name}`);
-    console.log(`   Email: ${newAdmin.email}`);
-    console.log(`   Vai tro: ${newAdmin.role}`);
-    console.log('\nüéâ Ban co the dang nhap bang email va mat khau vua tao.');
-
-  } catch (error) {
-    console.error('‚ùå Loi trong qua trinh tao tai khoan admin:', error.message);
-  } finally {
-    await sequelize.close();
-    process.exit(0);
-  }
-}
-
-// ===============================
-// üèÅ Chay chuong trinh
-// ===============================
-createAdmin();
+// ===============================
+// üåê OEM Mini - Tao tai khoan Quan tri (Admin) - CLI v3.0
+// ===============================
+
+// ‚öôÔ∏è Ep dau vao/ra UTF-8 de hien thi khong dau
+try {
+  if (process.stdin.setEncoding) process.stdin.setEncoding('utf8');
+  if (process.stdout.setEncoding) process.stdout.setEncoding('utf8');
+} catch {}
+
+// ===============================
+// üì¶ Import thu vien
+// ===============================
+const readlineSync = require('readline-sync');
+const bcrypt = require('bcrypt');
+const sequelize = require('../src/config/db');
+const { User } = require('../src/models/User');
+const { validateEmailDomain } = require('../src/utils/emailValidator');
+const { sendAdminOTPVerificationEmail } = require('../src/services/emailService');
+
+const SALT_ROUNDS = 10;
+const OTP_EXPIRE_MINUTES = 5;
+
+// ===============================
+// üõë Xu ly Ctrl + C (thoat an toan)
+// ===============================
+//process.on('SIGINT', () => {
+//  console.log('\n‚ùå Qua trinh nhap lieu da bi huy boi nguoi dung.');
+//  process.exit(0);
+//});
+
+// ===============================
+// üß© Ham chinh tao tai khoan admin
+// ===============================
+async function createAdmin() {
+  try {
+    console.log('üîß === OEM Mini - Tao tai khoan Quan tri (Admin) ===\n');
+
+    // 1Ô∏è‚É£ Ket noi DB
+    await sequelize.authenticate();
+    console.log('‚úÖ Ket noi co so du lieu thanh cong!\n');
+
+    // 2Ô∏è‚É£ Nhap ho ten
+    let fullName;
+    while (true) {
+      fullName = readlineSync.question('Ho va ten: ');
+      if (fullName.trim()) break;
+      console.log('‚ùå Ten khong duoc de trong. Vui long nhap lai.\n');
+    }
+
+    // 3Ô∏è‚É£ Nhap email + kiem tra ton tai + kiem tra ten mien hop le
+    let email;
+    while (true) {
+      email = readlineSync.questionEMail('Dia chi email: ');
+      if (!email) {
+        console.log('‚ùå Email khong hop le. Vui long nhap lai.\n');
+        continue;
+      }
+
+      // Kiem tra ten mien hop le bang DNS MX
+      try {
+        await validateEmailDomain(email);
+      } catch {
+        const retry = readlineSync.keyInYNStrict('Ban co muon nhap lai email khac khong? (y/n): ');
+        if (!retry) {
+          console.log('‚ùå Huy tao tai khoan quan tri.');
+          process.exit(0);
+        }
+        continue;
+      }
+
+      // Kiem tra email da ton tai trong DB
+      const existingUser = await User.findOne({ where: { email: email.toLowerCase().trim() } });
+      if (existingUser) {
+        console.log('‚ö†Ô∏è Email nay da duoc su dung trong he thong.');
+        const retry = readlineSync.keyInYNStrict('Ban co muon nhap email khac khong? (y/n): ');
+        if (!retry) {
+          console.log('‚ùå Huy tao tai khoan quan tri.');
+          process.exit(0);
+        }
+        continue;
+      }
+
+      break; // Email hop le va chua ton tai
+    }
+
+    // 4Ô∏è‚É£ Gui ma OTP xac minh
+    const otpCode = Math.floor(100000 + Math.random() * 900000);
+    console.log(`üì® Dang gui ma OTP den ${email} ...`);
+    const otpResult = await sendAdminOTPVerificationEmail(email, otpCode, fullName);
+
+    if (!otpResult.success) {
+      console.log('‚ùå Khong the gui ma OTP. Thu lai sau.');
+      process.exit(1);
+    }
+
+    console.log('‚úÖ Da gui ma OTP thanh cong. Vui long kiem tra hop thu cua ban.');
+    console.log(`‚è∞ Ma OTP co hieu luc trong ${OTP_EXPIRE_MINUTES} phut.\n`);
+
+    // 5Ô∏è‚É£ Nguoi dung nhap OTP de xac minh
+    const otpStartTime = Date.now();
+    let verified = false;
+
+    while (true) {
+      const now = Date.now();
+      const elapsedMinutes = (now - otpStartTime) / (1000 * 60);
+
+      if (elapsedMinutes > OTP_EXPIRE_MINUTES) {
+        console.log('‚åõ Ma OTP da het han. Vui long chay lai lenh tao tai khoan.');
+        process.exit(0);
+      }
+
+      const inputOTP = readlineSync.question('Nhap ma OTP duoc gui den email: ');
+      if (inputOTP.trim() === otpCode.toString()) {
+        console.log('‚úÖ Xac minh email thanh cong!\n');
+        verified = true;
+        break;
+      } else {
+        console.log('‚ùå Ma OTP khong dung. Vui long nhap lai hoac nhan Ctrl + C de thoat.\n');
+      }
+    }
+
+    if (!verified) {
+      console.log('‚ùå Email chua duoc xac minh. Huy tao tai khoan.');
+      process.exit(0);
+    }
+
+    // 6Ô∏è‚É£ Nhap mat khau
+    let password;
+    while (true) {
+      password = readlineSync.question('Mat khau: ', { hideEchoBack: true });
+      if (password.length >= 8) break;
+      console.log('‚ùå Mat khau phai co it nhat 8 ky tu.\n');
+    }
+
+    // 7Ô∏è‚É£ Xac nhan mat khau
+    let confirmPassword;
+    while (true) {
+      confirmPassword = readlineSync.question('Xac nhan mat khau: ', { hideEchoBack: true });
+      if (confirmPassword === password) break;
+      console.log('‚ùå Mat khau xac nhan khong khop.\n');
+    }
+
+    // 8Ô∏è‚É£ Hien thi thong tin truoc khi tao
+    console.log('\nüìã Thong tin tai khoan quan tri:');
+    console.log(`   Ho ten: ${fullName}`);
+    console.log(`   Email: ${email}`);
+    console.log(`   Vai tro: admin\n`);
+
+    const confirm = readlineSync.keyInYNStrict('Ban co chac muon tao tai khoan nay khong? (y/n): ');
+    if (!confirm) {
+      console.log('‚ùå Huy tao tai khoan quan tri.');
+      process.exit(0);
+    }
+
+    // 9Ô∏è‚É£ Ma hoa mat khau va luu DB
+    console.log('üîê Dang ma hoa mat khau...');
+    const hashedPassword = await bcrypt.hash(password, SALT_ROUNDS);
+
+    console.log('üíæ Dang luu vao co so du lieu...');
+    const newAdmin = await User.create({
+      full_name: fullName.trim(),
+      email: email.toLowerCase().trim(),
+      password_hash: hashedPassword,
+      role: 'admin',
+      created_at: new Date(),
+    });
+
+    // üîü Hoan tat
+    console.log('\n‚úÖ Tao tai khoan Quan tri thanh cong!');
+    console.log(`   ID: ${newAdmin.id}`);
+    console.log(`   Ho ten: ${newAdmin.full_name}`);
+    console.log(`   Email: ${newAdmin.email}`);
+    console.log(`   Vai tro: ${newAdmin.role}`);
+    console.log('\nüéâ Ban co the dang nhap bang email va mat khau vua tao.');
+
+  } catch (error) {
+    console.error('‚ùå Loi trong qua trinh tao tai khoan admin:', error.message);
+  } finally {
+    await sequelize.close();
+    process.exit(0);
+  }
+}
+
+// ===============================
+// üèÅ Chay chuong trinh
+// ===============================
+createAdmin();
diff --git a/backend/server.ts b/backend/server.ts
index 3ed8a8a..863f304 100644
--- a/backend/server.ts
+++ b/backend/server.ts
@@ -1,6 +1,6 @@
-const app = require('./app');
-const PORT = process.env.PORT || 3000;
-
-app.listen(PORT, () => {
-  console.log(`Server ch·∫°y ·ªü c·ªïng ${PORT}`);
-});
+const app = require('./app');
+const PORT = process.env.PORT || 3000;
+
+app.listen(PORT, () => {
+  console.log(`Server ch·∫°y ·ªü c·ªïng ${PORT}`);
+});
diff --git a/backend/src/config/db.js b/backend/src/config/db.js
index a7c6a4e..519f273 100644
--- a/backend/src/config/db.js
+++ b/backend/src/config/db.js
@@ -1,17 +1,17 @@
-const { Sequelize } = require("sequelize");
-require("dotenv").config();
-
-const sequelize = new Sequelize(
-  process.env.DB_NAME,
-  process.env.DB_USER,
-  process.env.DB_PASSWORD,
-  {
-    host: process.env.DB_HOST,
-    dialect: "mysql",
-    port: process.env.DB_PORT,
-    logging: false,
-    timezone: process.env.APP_TZ || "+07:00", // chu·∫©n ho√° m√∫i gi·ªù VN cho phi√™n k·∫øt n·ªëi
-  }
-);
-
-module.exports = sequelize;
+const { Sequelize } = require("sequelize");
+require("dotenv").config();
+
+const sequelize = new Sequelize(
+  process.env.DB_NAME,
+  process.env.DB_USER,
+  process.env.DB_PASSWORD,
+  {
+    host: process.env.DB_HOST,
+    dialect: "mysql",
+    port: process.env.DB_PORT,
+    logging: false,
+    timezone: process.env.APP_TZ || "+07:00", // chu·∫©n ho√° m√∫i gi·ªù VN cho phi√™n k·∫øt n·ªëi
+  }
+);
+
+module.exports = sequelize;
diff --git a/backend/src/controllers/assignBankController.js b/backend/src/controllers/assignBankController.js
index a824844..52a2961 100644
--- a/backend/src/controllers/assignBankController.js
+++ b/backend/src/controllers/assignBankController.js
@@ -1,240 +1,240 @@
-const sequelize = require("../config/db");
-const { QueryTypes } = require("sequelize");
-
-// ============================
-// 1. L·∫•y danh s√°ch ƒë·ªÅ thi (paginated + search + filter)
-// ============================
-const getExams = async (req, res) => {
-  try {
-    const instructorId = req.user.id;
-    const { page = 1, limit = 10, search = "", status } = req.query;
-    const offset = (page - 1) * limit;
-
-    let whereClause = "WHERE e.instructor_id = :instructorId";
-    const replacements = {
-      instructorId,
-      limit: parseInt(limit),
-      offset,
-      search: `%${search}%`,
-    };
-
-    if (status && status !== "T·∫•t c·∫£") {
-      whereClause += " AND e.status = :status";
-      replacements.status = status;
-    }
-
-    if (search) {
-      whereClause += " AND e.title LIKE :search";
-    }
-
-    const query = `
-      SELECT e.id, e.title, e.duration, e.status, e.exam_room_code, e.created_at, e.updated_at
-      FROM exams e
-      ${whereClause}
-      ORDER BY e.updated_at DESC
-      LIMIT :limit OFFSET :offset
-    `;
-
-    const countQuery = `
-      SELECT COUNT(*) AS total
-      FROM exams e
-      ${whereClause}
-    `;
-
-    const [exams, countResult] = await Promise.all([
-      sequelize.query(query, { replacements, type: QueryTypes.SELECT }),
-      sequelize.query(countQuery, { replacements, type: QueryTypes.SELECT }),
-    ]);
-
-    const total = countResult[0].total;
-    const totalPages = Math.ceil(total / limit);
-
-    res.json({
-      status: "success",
-      data: exams,
-      pagination: {
-        currentPage: parseInt(page),
-        totalPages,
-        total,
-        limit: parseInt(limit),
-      },
-    });
-  } catch (error) {
-    console.error("Error fetching exams:", error);
-    res.status(500).json({ status: "error", message: "Server error" });
-  }
-};
-
-// ============================
-// 2. L·∫•y chi ti·∫øt ƒë·ªÅ thi
-// ============================
-const getExamDetails = async (req, res) => {
-  try {
-    const { id } = req.params;
-    const instructorId = req.user.id;
-
-    const [exam] = await sequelize.query(
-      `SELECT * FROM exams WHERE id = :id AND instructor_id = :instructorId`,
-      { replacements: { id, instructorId }, type: QueryTypes.SELECT }
-    );
-
-    if (!exam) {
-      return res.status(404).json({
-        status: "error",
-        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi",
-      });
-    }
-
-    // L·∫§Y C√ÇU H·ªéI T·ª™ B·∫¢NG exam_questions (kh√¥ng d√πng question_bank)
-    const questions = await sequelize.query(
-      `
-      SELECT 
-        eq.id,
-        eq.question_text,
-        eq.type,
-        eq.points,
-        eq.model_answer
-      FROM exam_questions eq
-      WHERE eq.exam_id = :examId
-      ORDER BY eq.order_index, eq.id
-      `,
-      { replacements: { examId: id }, type: QueryTypes.SELECT }
-    );
-
-    // L·∫§Y ƒê√ÅP √ÅN CHO TR·∫ÆC NGHI·ªÜM
-    const questionsWithOptions = await Promise.all(
-      questions.map(async (q) => {
-        if (q.type === "MCQ") {
-          const options = await sequelize.query(
-            `SELECT id, option_text, is_correct FROM exam_options WHERE question_id = :qid`,
-            { replacements: { qid: q.id }, type: QueryTypes.SELECT }
-          );
-          return { ...q, options };
-        }
-        return q;
-      })
-    );
-
-    exam.questions = questionsWithOptions;
-
-    res.json({
-      status: "success",
-      data: exam,
-    });
-  } catch (error) {
-    console.error("Error fetching exam details:", error);
-    res.status(500).json({
-      status: "error",
-      message: "L·ªói m√°y ch·ªß",
-    });
-  }
-};
-
-const deleteExam = async (req, res) => {
-  const transaction = await sequelize.transaction();
-  try {
-    const { id } = req.params;
-    const instructorId = req.user.id;
-    const [exam] = await sequelize.query(
-      `SELECT id, title, status FROM exams WHERE id = :id AND instructor_id = :instructorId`,
-      {
-        replacements: { id, instructorId },
-        type: QueryTypes.SELECT,
-        transaction,
-      }
-    );
-    if (!exam) {
-      await transaction.rollback();
-      return res.status(404).json({
-        status: "error",
-        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi ho·∫∑c b·∫°n kh√¥ng c√≥ quy·ªÅn x√≥a.",
-      });
-    }
-    if (exam.status === "published") {
-      await transaction.rollback();
-      return res.status(400).json({
-        status: "error",
-        message: "Kh√¥ng th·ªÉ x√≥a ƒë·ªÅ thi ƒë√£ m·ªü ph√≤ng.",
-      });
-    }
-    await sequelize.query(
-      `DELETE eo FROM exam_options eo
-       INNER JOIN exam_questions eq ON eo.question_id = eq.id
-       WHERE eq.exam_id = ?`,
-      { replacements: [id], transaction }
-    );
-    await sequelize.query(`DELETE FROM exam_questions WHERE exam_id = ?`, {
-      replacements: [id],
-      transaction,
-    });
-    await sequelize.query(`DELETE FROM exams WHERE id = ?`, {
-      replacements: [id],
-      transaction,
-    });
-    await transaction.commit();
-    return res.json({
-      status: "success",
-      message: `ƒê√£ x√≥a ƒë·ªÅ thi "${exam.title}" th√†nh c√¥ng.`,
-    });
-  } catch (error) {
-    await transaction.rollback();
-    console.error("Error deleting exam:", error);
-    return res.status(500).json({
-      status: "error",
-      message: "L·ªói m√°y ch·ªß khi x√≥a ƒë·ªÅ thi. Vui l√≤ng th·ª≠ l·∫°i.",
-    });
-  }
-};
-
-// c·∫≠p nh·∫≠t
-const publishExam = async (req, res) => {
-  try {
-    const { id } = req.params;
-    const instructorId = req.user.id;
-
-    const [exam] = await sequelize.query(
-      `SELECT * FROM exams WHERE id = :id AND instructor_id = :instructorId`,
-      { replacements: { id, instructorId }, type: QueryTypes.SELECT }
-    );
-
-    if (!exam) {
-      return res.status(404).json({
-        status: "error",
-        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi ho·∫∑c b·∫°n kh√¥ng c√≥ quy·ªÅn",
-      });
-    }
-
-    if (exam.status === "published") {
-      return res.status(400).json({
-        status: "error",
-        message: "ƒê·ªÅ thi ƒë√£ ƒë∆∞·ª£c m·ªü ph√≤ng",
-      });
-    }
-
-    const examRoomCode = `EXAM${Date.now()}`;
-
-    await sequelize.query(
-      `UPDATE exams SET status = 'published', exam_room_code = ?, updated_at = NOW() WHERE id = ?`,
-      { replacements: [examRoomCode, id] }
-    );
-
-    res.json({
-      status: "success",
-      message: "M·ªü ph√≤ng thi th√†nh c√¥ng",
-      data: { exam_room_code: examRoomCode },
-    });
-  } catch (error) {
-    console.error("Error publishing exam:", error);
-    res.status(500).json({
-      status: "error",
-      message: "L·ªói m√°y ch·ªß",
-    });
-  }
-};
-
-module.exports = {
-  getExams,
-  getExamDetails,
-  deleteExam,
-  publishExam,
-};
+const sequelize = require("../config/db");
+const { QueryTypes } = require("sequelize");
+
+// ============================
+// 1. L·∫•y danh s√°ch ƒë·ªÅ thi (paginated + search + filter)
+// ============================
+const getExams = async (req, res) => {
+  try {
+    const instructorId = req.user.id;
+    const { page = 1, limit = 10, search = "", status } = req.query;
+    const offset = (page - 1) * limit;
+
+    let whereClause = "WHERE e.instructor_id = :instructorId";
+    const replacements = {
+      instructorId,
+      limit: parseInt(limit),
+      offset,
+      search: `%${search}%`,
+    };
+
+    if (status && status !== "T·∫•t c·∫£") {
+      whereClause += " AND e.status = :status";
+      replacements.status = status;
+    }
+
+    if (search) {
+      whereClause += " AND e.title LIKE :search";
+    }
+
+    const query = `
+      SELECT e.id, e.title, e.duration, e.status, e.exam_room_code, e.created_at, e.updated_at
+      FROM exams e
+      ${whereClause}
+      ORDER BY e.updated_at DESC
+      LIMIT :limit OFFSET :offset
+    `;
+
+    const countQuery = `
+      SELECT COUNT(*) AS total
+      FROM exams e
+      ${whereClause}
+    `;
+
+    const [exams, countResult] = await Promise.all([
+      sequelize.query(query, { replacements, type: QueryTypes.SELECT }),
+      sequelize.query(countQuery, { replacements, type: QueryTypes.SELECT }),
+    ]);
+
+    const total = countResult[0].total;
+    const totalPages = Math.ceil(total / limit);
+
+    res.json({
+      status: "success",
+      data: exams,
+      pagination: {
+        currentPage: parseInt(page),
+        totalPages,
+        total,
+        limit: parseInt(limit),
+      },
+    });
+  } catch (error) {
+    console.error("Error fetching exams:", error);
+    res.status(500).json({ status: "error", message: "Server error" });
+  }
+};
+
+// ============================
+// 2. L·∫•y chi ti·∫øt ƒë·ªÅ thi
+// ============================
+const getExamDetails = async (req, res) => {
+  try {
+    const { id } = req.params;
+    const instructorId = req.user.id;
+
+    const [exam] = await sequelize.query(
+      `SELECT * FROM exams WHERE id = :id AND instructor_id = :instructorId`,
+      { replacements: { id, instructorId }, type: QueryTypes.SELECT }
+    );
+
+    if (!exam) {
+      return res.status(404).json({
+        status: "error",
+        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi",
+      });
+    }
+
+    // L·∫§Y C√ÇU H·ªéI T·ª™ B·∫¢NG exam_questions (kh√¥ng d√πng question_bank)
+    const questions = await sequelize.query(
+      `
+      SELECT 
+        eq.id,
+        eq.question_text,
+        eq.type,
+        eq.points,
+        eq.model_answer
+      FROM exam_questions eq
+      WHERE eq.exam_id = :examId
+      ORDER BY eq.order_index, eq.id
+      `,
+      { replacements: { examId: id }, type: QueryTypes.SELECT }
+    );
+
+    // L·∫§Y ƒê√ÅP √ÅN CHO TR·∫ÆC NGHI·ªÜM
+    const questionsWithOptions = await Promise.all(
+      questions.map(async (q) => {
+        if (q.type === "MCQ") {
+          const options = await sequelize.query(
+            `SELECT id, option_text, is_correct FROM exam_options WHERE question_id = :qid`,
+            { replacements: { qid: q.id }, type: QueryTypes.SELECT }
+          );
+          return { ...q, options };
+        }
+        return q;
+      })
+    );
+
+    exam.questions = questionsWithOptions;
+
+    res.json({
+      status: "success",
+      data: exam,
+    });
+  } catch (error) {
+    console.error("Error fetching exam details:", error);
+    res.status(500).json({
+      status: "error",
+      message: "L·ªói m√°y ch·ªß",
+    });
+  }
+};
+
+const deleteExam = async (req, res) => {
+  const transaction = await sequelize.transaction();
+  try {
+    const { id } = req.params;
+    const instructorId = req.user.id;
+    const [exam] = await sequelize.query(
+      `SELECT id, title, status FROM exams WHERE id = :id AND instructor_id = :instructorId`,
+      {
+        replacements: { id, instructorId },
+        type: QueryTypes.SELECT,
+        transaction,
+      }
+    );
+    if (!exam) {
+      await transaction.rollback();
+      return res.status(404).json({
+        status: "error",
+        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi ho·∫∑c b·∫°n kh√¥ng c√≥ quy·ªÅn x√≥a.",
+      });
+    }
+    if (exam.status === "published") {
+      await transaction.rollback();
+      return res.status(400).json({
+        status: "error",
+        message: "Kh√¥ng th·ªÉ x√≥a ƒë·ªÅ thi ƒë√£ m·ªü ph√≤ng.",
+      });
+    }
+    await sequelize.query(
+      `DELETE eo FROM exam_options eo
+       INNER JOIN exam_questions eq ON eo.question_id = eq.id
+       WHERE eq.exam_id = ?`,
+      { replacements: [id], transaction }
+    );
+    await sequelize.query(`DELETE FROM exam_questions WHERE exam_id = ?`, {
+      replacements: [id],
+      transaction,
+    });
+    await sequelize.query(`DELETE FROM exams WHERE id = ?`, {
+      replacements: [id],
+      transaction,
+    });
+    await transaction.commit();
+    return res.json({
+      status: "success",
+      message: `ƒê√£ x√≥a ƒë·ªÅ thi "${exam.title}" th√†nh c√¥ng.`,
+    });
+  } catch (error) {
+    await transaction.rollback();
+    console.error("Error deleting exam:", error);
+    return res.status(500).json({
+      status: "error",
+      message: "L·ªói m√°y ch·ªß khi x√≥a ƒë·ªÅ thi. Vui l√≤ng th·ª≠ l·∫°i.",
+    });
+  }
+};
+
+// c·∫≠p nh·∫≠t
+const publishExam = async (req, res) => {
+  try {
+    const { id } = req.params;
+    const instructorId = req.user.id;
+
+    const [exam] = await sequelize.query(
+      `SELECT * FROM exams WHERE id = :id AND instructor_id = :instructorId`,
+      { replacements: { id, instructorId }, type: QueryTypes.SELECT }
+    );
+
+    if (!exam) {
+      return res.status(404).json({
+        status: "error",
+        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi ho·∫∑c b·∫°n kh√¥ng c√≥ quy·ªÅn",
+      });
+    }
+
+    if (exam.status === "published") {
+      return res.status(400).json({
+        status: "error",
+        message: "ƒê·ªÅ thi ƒë√£ ƒë∆∞·ª£c m·ªü ph√≤ng",
+      });
+    }
+
+    const examRoomCode = `EXAM${Date.now()}`;
+
+    await sequelize.query(
+      `UPDATE exams SET status = 'published', exam_room_code = ?, updated_at = NOW() WHERE id = ?`,
+      { replacements: [examRoomCode, id] }
+    );
+
+    res.json({
+      status: "success",
+      message: "M·ªü ph√≤ng thi th√†nh c√¥ng",
+      data: { exam_room_code: examRoomCode },
+    });
+  } catch (error) {
+    console.error("Error publishing exam:", error);
+    res.status(500).json({
+      status: "error",
+      message: "L·ªói m√°y ch·ªß",
+    });
+  }
+};
+
+module.exports = {
+  getExams,
+  getExamDetails,
+  deleteExam,
+  publishExam,
+};
diff --git a/backend/src/controllers/authController.js b/backend/src/controllers/authController.js
index 0b4f342..fac2c87 100644
--- a/backend/src/controllers/authController.js
+++ b/backend/src/controllers/authController.js
@@ -1,133 +1,133 @@
-const bcrypt = require("bcrypt");
-const User = require("../models/User");
-const ExamRoom = require("../models/ExamRoom");
-const { generateAccessToken, generateRefreshToken } = require("../utils/generateToken");
-
-const SALT_ROUNDS = 10;
-
-// ------------------- ƒêƒÉng k√Ω -------------------
-async function register(req, res) {
-  try {
-    const { fullName, email, password_hash, confirmPassword, role, roomCode } = req.body;
-
-    // ‚úÖ Ki·ªÉm tra d·ªØ li·ªáu ƒë·∫ßu v√†o
-    if (!fullName || !email || !password_hash || !confirmPassword || !role) {
-      return res.status(400).json({ message: "Thi·∫øu tr∆∞·ªùng b·∫Øt bu·ªôc" });
-    }
-
-    if (password_hash.length < 8) {
-      return res.status(400).json({ message: "M·∫≠t kh·∫©u ph·∫£i ‚â• 8 k√Ω t·ª±" });
-    }
-
-    if (password_hash !== confirmPassword) {
-      return res.status(400).json({ message: "M·∫≠t kh·∫©u v√† x√°c nh·∫≠n kh√¥ng kh·ªõp" });
-    }
-
-    const existing = await User.findOne({ where: { email } });
-    if (existing) {
-      return res.status(400).json({ message: "Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω" });
-    }
-
-    const hashed = await bcrypt.hash(password_hash, SALT_ROUNDS);
-    let newUser;
-
-    if (role === "instructor") {
-      newUser = await User.create({
-        full_name: fullName,
-        email,
-        password_hash: hashed,
-        role: "instructor",
-      });
-    } else if (role === "student") {
-      if (!roomCode) {
-        return res.status(400).json({ message: "C·∫ßn m√£ ph√≤ng thi ƒë·ªÉ ƒëƒÉng k√Ω h·ªçc vi√™n" });
-      }
-
-      const room = await ExamRoom.findOne({ where: { exam_room_code: roomCode } });
-      if (!room) {
-        return res.status(400).json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá" });
-      }
-
-      newUser = await User.create({
-        full_name: fullName,
-        email,
-        password_hash: hashed,
-        role: "student",
-      });
-
-      // üîß T√πy logic c·ªßa b·∫°n: n·∫øu c·∫ßn li√™n k·∫øt h·ªçc vi√™n v√†o ph√≤ng thi
-      // await room.addStudent(newUser);
-    } else {
-      return res.status(400).json({ message: "Role kh√¥ng h·ª£p l·ªá" });
-    }
-
-    // ‚úÖ payload ƒë·ªìng b·ªô v·ªõi middleware verifyToken
-    const payload = {
-      id: newUser.id, // ‚ö†Ô∏è d√πng id ch·ª© kh√¥ng ph·∫£i userId
-      email: newUser.email,
-      role: newUser.role,
-    };
-
-    const accessToken = generateAccessToken(payload);
-    const refreshToken = generateRefreshToken(payload);
-
-    return res.status(201).json({
-      user: {
-        id: newUser.id,
-        fullName: newUser.full_name,
-        email: newUser.email,
-        role: newUser.role,
-      },
-      accessToken,
-      refreshToken,
-    });
-  } catch (error) {
-    console.error("‚ùå Register error:", error);
-    return res.status(500).json({ message: "L·ªói server" });
-  }
-}
-
-// ------------------- ƒêƒÉng nh·∫≠p -------------------
-async function login(req, res) {
-  try {
-    const { email, password_hash } = req.body;
-    if (!email || !password_hash) {
-      return res.status(400).json({ message: "Thi·∫øu email ho·∫∑c m·∫≠t kh·∫©u" });
-    }
-
-    const user = await User.findOne({ where: { email } });
-    if (!user) {
-      return res.status(401).json({ message: "Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng" });
-    }
-
-    const match = await bcrypt.compare(password_hash, user.password_hash);
-    if (!match) {
-      return res.status(401).json({ message: "Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng" });
-    }
-
-    const payload = {
-      id: user.id, // ‚úÖ ƒë·ªìng b·ªô v·ªõi verifyToken
-      email: user.email,
-      role: user.role,
-    };
-
-    const accessToken = generateAccessToken(payload);
-    const refreshToken = generateRefreshToken(payload);
-
-    return res.status(200).json({
-      user: {
-        id: user.id,
-        fullName: user.full_name,
-        email: user.email,
-        role: user.role,
-      },
-      accessToken,
-      refreshToken,
-    });
-  } catch (error) {
-    console.error("‚ùå Login error:", error);
-    return res.status(500).json({ message: "L·ªói server" });
-  }
-}
-
-module.exports = { register, login };
+const bcrypt = require("bcrypt");
+const User = require("../models/User");
+const ExamRoom = require("../models/ExamRoom");
+const { generateAccessToken, generateRefreshToken } = require("../utils/generateToken");
+
+const SALT_ROUNDS = 10;
+
+// ------------------- ƒêƒÉng k√Ω -------------------
+async function register(req, res) {
+  try {
+    const { fullName, email, password_hash, confirmPassword, role, roomCode } = req.body;
+
+    // ‚úÖ Ki·ªÉm tra d·ªØ li·ªáu ƒë·∫ßu v√†o
+    if (!fullName || !email || !password_hash || !confirmPassword || !role) {
+      return res.status(400).json({ message: "Thi·∫øu tr∆∞·ªùng b·∫Øt bu·ªôc" });
+    }
+
+    if (password_hash.length < 8) {
+      return res.status(400).json({ message: "M·∫≠t kh·∫©u ph·∫£i ‚â• 8 k√Ω t·ª±" });
+    }
+
+    if (password_hash !== confirmPassword) {
+      return res.status(400).json({ message: "M·∫≠t kh·∫©u v√† x√°c nh·∫≠n kh√¥ng kh·ªõp" });
+    }
+
+    const existing = await User.findOne({ where: { email } });
+    if (existing) {
+      return res.status(400).json({ message: "Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω" });
+    }
+
+    const hashed = await bcrypt.hash(password_hash, SALT_ROUNDS);
+    let newUser;
+
+    if (role === "instructor") {
+      newUser = await User.create({
+        full_name: fullName,
+        email,
+        password_hash: hashed,
+        role: "instructor",
+      });
+    } else if (role === "student") {
+      if (!roomCode) {
+        return res.status(400).json({ message: "C·∫ßn m√£ ph√≤ng thi ƒë·ªÉ ƒëƒÉng k√Ω h·ªçc vi√™n" });
+      }
+
+      const room = await ExamRoom.findOne({ where: { exam_room_code: roomCode } });
+      if (!room) {
+        return res.status(400).json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá" });
+      }
+
+      newUser = await User.create({
+        full_name: fullName,
+        email,
+        password_hash: hashed,
+        role: "student",
+      });
+
+      // üîß T√πy logic c·ªßa b·∫°n: n·∫øu c·∫ßn li√™n k·∫øt h·ªçc vi√™n v√†o ph√≤ng thi
+      // await room.addStudent(newUser);
+    } else {
+      return res.status(400).json({ message: "Role kh√¥ng h·ª£p l·ªá" });
+    }
+
+    // ‚úÖ payload ƒë·ªìng b·ªô v·ªõi middleware verifyToken
+    const payload = {
+      id: newUser.id, // ‚ö†Ô∏è d√πng id ch·ª© kh√¥ng ph·∫£i userId
+      email: newUser.email,
+      role: newUser.role,
+    };
+
+    const accessToken = generateAccessToken(payload);
+    const refreshToken = generateRefreshToken(payload);
+
+    return res.status(201).json({
+      user: {
+        id: newUser.id,
+        fullName: newUser.full_name,
+        email: newUser.email,
+        role: newUser.role,
+      },
+      accessToken,
+      refreshToken,
+    });
+  } catch (error) {
+    console.error("‚ùå Register error:", error);
+    return res.status(500).json({ message: "L·ªói server" });
+  }
+}
+
+// ------------------- ƒêƒÉng nh·∫≠p -------------------
+async function login(req, res) {
+  try {
+    const { email, password_hash } = req.body;
+    if (!email || !password_hash) {
+      return res.status(400).json({ message: "Thi·∫øu email ho·∫∑c m·∫≠t kh·∫©u" });
+    }
+
+    const user = await User.findOne({ where: { email } });
+    if (!user) {
+      return res.status(401).json({ message: "Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng" });
+    }
+
+    const match = await bcrypt.compare(password_hash, user.password_hash);
+    if (!match) {
+      return res.status(401).json({ message: "Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng" });
+    }
+
+    const payload = {
+      id: user.id, // ‚úÖ ƒë·ªìng b·ªô v·ªõi verifyToken
+      email: user.email,
+      role: user.role,
+    };
+
+    const accessToken = generateAccessToken(payload);
+    const refreshToken = generateRefreshToken(payload);
+
+    return res.status(200).json({
+      user: {
+        id: user.id,
+        fullName: user.full_name,
+        email: user.email,
+        role: user.role,
+      },
+      accessToken,
+      refreshToken,
+    });
+  } catch (error) {
+    console.error("‚ùå Login error:", error);
+    return res.status(500).json({ message: "L·ªói server" });
+  }
+}
+
+module.exports = { register, login };
diff --git a/backend/src/controllers/editExamController.js b/backend/src/controllers/editExamController.js
index d2fe6ca..2f7561e 100644
--- a/backend/src/controllers/editExamController.js
+++ b/backend/src/controllers/editExamController.js
@@ -1,210 +1,210 @@
-// controllers/editExamController.js
-const sequelize = require("../config/db");
-const { QueryTypes } = require("sequelize");
-
-// ============================
-// L·∫•y chi ti·∫øt ƒë·ªÅ thi ƒë·ªÉ ch·ªânh s·ª≠a
-// ============================
-const getExamForEdit = async (req, res) => {
-  const transaction = await sequelize.transaction();
-  try {
-    const { id } = req.params;
-    const instructorId = req.user.id;
-
-    const [exam] = await sequelize.query(
-      `SELECT id, title, duration, status 
-       FROM exams 
-       WHERE id = :id AND instructor_id = :instructorId`,
-      {
-        replacements: { id, instructorId },
-        type: QueryTypes.SELECT,
-        transaction,
-      }
-    );
-
-    if (!exam) {
-      await transaction.rollback();
-      return res.status(404).json({
-        status: "error",
-        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi.",
-      });
-    }
-
-    if (exam.status === "published") {
-      await transaction.rollback();
-      return res.status(400).json({
-        status: "error",
-        message: "Kh√¥ng th·ªÉ ch·ªânh s·ª≠a ƒë·ªÅ thi ƒë√£ m·ªü ph√≤ng.",
-      });
-    }
-
-    const questions = await sequelize.query(
-      `SELECT 
-          id,
-          question_text AS content,
-          type,
-          points,
-          order_index,
-          model_answer AS modelAnswer
-       FROM exam_questions 
-       WHERE exam_id = :examId
-       ORDER BY order_index, id`,
-      { replacements: { examId: id }, type: QueryTypes.SELECT, transaction }
-    );
-
-    const questionsWithOptions = await Promise.all(
-      questions.map(async (q) => {
-        if (q.type === "MCQ") {
-          const options = await sequelize.query(
-            `SELECT id, option_text AS content, is_correct 
-             FROM exam_options 
-             WHERE question_id = :qid
-             ORDER BY id`,
-            {
-              replacements: { qid: q.id },
-              type: QueryTypes.SELECT,
-              transaction,
-            }
-          );
-          return { ...q, options };
-        }
-        return { ...q, options: [] };
-      })
-    );
-
-    await transaction.commit();
-
-    res.json({
-      id: exam.id,
-      title: exam.title,
-      duration: exam.duration,
-      questions: questionsWithOptions,
-    });
-  } catch (error) {
-    await transaction.rollback();
-    console.error("Error fetching exam for edit:", error);
-    res.status(500).json({ status: "error", message: "L·ªói m√°y ch·ªß." });
-  }
-};
-
-// ============================
-// C·∫≠p nh·∫≠t ƒë·ªÅ thi
-// ============================
-const updateExam = async (req, res) => {
-  const transaction = await sequelize.transaction();
-  try {
-    const { id } = req.params;
-    const instructorId = req.user.id;
-    const { title, duration, questions } = req.body;
-
-    if (!title?.trim()) {
-      await transaction.rollback();
-      return res
-        .status(400)
-        .json({ status: "error", message: "Ti√™u ƒë·ªÅ kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng." });
-    }
-
-    const totalPoints = questions.reduce(
-      (sum, q) => sum + (parseFloat(q.points) || 0),
-      0
-    );
-
-    if (Math.round(totalPoints * 10) / 10 !== 10) {
-      await transaction.rollback();
-      return res.status(400).json({
-        status: "error",
-        message: `T·ªïng ƒëi·ªÉm hi·ªán t·∫°i l√† ${totalPoints.toFixed(
-          1
-        )}. T·ªïng ƒëi·ªÉm t·∫•t c·∫£ c√¢u h·ªèi ph·∫£i b·∫±ng 10.`,
-      });
-    }
-
-    const exam = await sequelize.query(
-      `SELECT status 
-       FROM exams 
-       WHERE id = :id AND instructor_id = :instructorId`,
-      {
-        replacements: { id, instructorId },
-        type: QueryTypes.SELECT,
-        transaction,
-      }
-    );
-
-    if (!exam || exam.length === 0) {
-      await transaction.rollback();
-      return res
-        .status(404)
-        .json({ status: "error", message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi." });
-    }
-
-    if (exam[0].status === "published") {
-      await transaction.rollback();
-      return res.status(400).json({
-        status: "error",
-        message: "Kh√¥ng th·ªÉ s·ª≠a ƒë·ªÅ thi ƒë√£ m·ªü ph√≤ng.",
-      });
-    }
-
-    // C·∫≠p nh·∫≠t th√¥ng tin ƒë·ªÅ thi
-    await sequelize.query(
-      `UPDATE exams SET title = ?, duration = ?, updated_at = NOW() WHERE id = ?`,
-      { replacements: [title, duration, id], transaction }
-    );
-
-    // X√≥a c√¢u h·ªèi v√† option c≈©
-    await sequelize.query(
-      `DELETE eo FROM exam_options eo 
-       INNER JOIN exam_questions eq ON eo.question_id = eq.id 
-       WHERE eq.exam_id = ?`,
-      { replacements: [id], transaction }
-    );
-    await sequelize.query(`DELETE FROM exam_questions WHERE exam_id = ?`, {
-      replacements: [id],
-      transaction,
-    });
-
-    // Th√™m l·∫°i c√¢u h·ªèi m·ªõi
-    for (let i = 0; i < questions.length; i++) {
-      const q = questions[i];
-      const type = q.type?.toLowerCase() === "essay" ? "essay" : "MCQ";
-
-      const modelAnswer = type === "essay" ? q.modelAnswer || null : null;
-
-      const [questionId] = await sequelize.query(
-        `INSERT INTO exam_questions (exam_id, question_text, type, points, order_index, model_answer) 
-         VALUES (?, ?, ?, ?, ?, ?)`,
-        {
-          replacements: [id, q.content, type, q.points, i, modelAnswer],
-          type: QueryTypes.INSERT,
-          transaction,
-        }
-      );
-
-      if (type === "MCQ" && q.options?.length > 0) {
-        for (const opt of q.options) {
-          await sequelize.query(
-            `INSERT INTO exam_options (question_id, option_text, is_correct) VALUES (?, ?, ?)`,
-            {
-              replacements: [questionId, opt.content, opt.is_correct ? 1 : 0],
-              transaction,
-            }
-          );
-        }
-      }
-    }
-
-    await transaction.commit();
-    res.json({
-      status: "success",
-      message: "C·∫≠p nh·∫≠t ƒë·ªÅ thi th√†nh c√¥ng!",
-    });
-  } catch (error) {
-    await transaction.rollback();
-    console.error("Error updating exam:", error);
-    res
-      .status(500)
-      .json({ status: "error", message: "L·ªói m√°y ch·ªß khi c·∫≠p nh·∫≠t." });
-  }
-};
-
-module.exports = { getExamForEdit, updateExam };
+// controllers/editExamController.js
+const sequelize = require("../config/db");
+const { QueryTypes } = require("sequelize");
+
+// ============================
+// L·∫•y chi ti·∫øt ƒë·ªÅ thi ƒë·ªÉ ch·ªânh s·ª≠a
+// ============================
+const getExamForEdit = async (req, res) => {
+  const transaction = await sequelize.transaction();
+  try {
+    const { id } = req.params;
+    const instructorId = req.user.id;
+
+    const [exam] = await sequelize.query(
+      `SELECT id, title, duration, status 
+       FROM exams 
+       WHERE id = :id AND instructor_id = :instructorId`,
+      {
+        replacements: { id, instructorId },
+        type: QueryTypes.SELECT,
+        transaction,
+      }
+    );
+
+    if (!exam) {
+      await transaction.rollback();
+      return res.status(404).json({
+        status: "error",
+        message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi.",
+      });
+    }
+
+    if (exam.status === "published") {
+      await transaction.rollback();
+      return res.status(400).json({
+        status: "error",
+        message: "Kh√¥ng th·ªÉ ch·ªânh s·ª≠a ƒë·ªÅ thi ƒë√£ m·ªü ph√≤ng.",
+      });
+    }
+
+    const questions = await sequelize.query(
+      `SELECT 
+          id,
+          question_text AS content,
+          type,
+          points,
+          order_index,
+          model_answer AS modelAnswer
+       FROM exam_questions 
+       WHERE exam_id = :examId
+       ORDER BY order_index, id`,
+      { replacements: { examId: id }, type: QueryTypes.SELECT, transaction }
+    );
+
+    const questionsWithOptions = await Promise.all(
+      questions.map(async (q) => {
+        if (q.type === "MCQ") {
+          const options = await sequelize.query(
+            `SELECT id, option_text AS content, is_correct 
+             FROM exam_options 
+             WHERE question_id = :qid
+             ORDER BY id`,
+            {
+              replacements: { qid: q.id },
+              type: QueryTypes.SELECT,
+              transaction,
+            }
+          );
+          return { ...q, options };
+        }
+        return { ...q, options: [] };
+      })
+    );
+
+    await transaction.commit();
+
+    res.json({
+      id: exam.id,
+      title: exam.title,
+      duration: exam.duration,
+      questions: questionsWithOptions,
+    });
+  } catch (error) {
+    await transaction.rollback();
+    console.error("Error fetching exam for edit:", error);
+    res.status(500).json({ status: "error", message: "L·ªói m√°y ch·ªß." });
+  }
+};
+
+// ============================
+// C·∫≠p nh·∫≠t ƒë·ªÅ thi
+// ============================
+const updateExam = async (req, res) => {
+  const transaction = await sequelize.transaction();
+  try {
+    const { id } = req.params;
+    const instructorId = req.user.id;
+    const { title, duration, questions } = req.body;
+
+    if (!title?.trim()) {
+      await transaction.rollback();
+      return res
+        .status(400)
+        .json({ status: "error", message: "Ti√™u ƒë·ªÅ kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng." });
+    }
+
+    const totalPoints = questions.reduce(
+      (sum, q) => sum + (parseFloat(q.points) || 0),
+      0
+    );
+
+    if (Math.round(totalPoints * 10) / 10 !== 10) {
+      await transaction.rollback();
+      return res.status(400).json({
+        status: "error",
+        message: `T·ªïng ƒëi·ªÉm hi·ªán t·∫°i l√† ${totalPoints.toFixed(
+          1
+        )}. T·ªïng ƒëi·ªÉm t·∫•t c·∫£ c√¢u h·ªèi ph·∫£i b·∫±ng 10.`,
+      });
+    }
+
+    const exam = await sequelize.query(
+      `SELECT status 
+       FROM exams 
+       WHERE id = :id AND instructor_id = :instructorId`,
+      {
+        replacements: { id, instructorId },
+        type: QueryTypes.SELECT,
+        transaction,
+      }
+    );
+
+    if (!exam || exam.length === 0) {
+      await transaction.rollback();
+      return res
+        .status(404)
+        .json({ status: "error", message: "Kh√¥ng t√¨m th·∫•y ƒë·ªÅ thi." });
+    }
+
+    if (exam[0].status === "published") {
+      await transaction.rollback();
+      return res.status(400).json({
+        status: "error",
+        message: "Kh√¥ng th·ªÉ s·ª≠a ƒë·ªÅ thi ƒë√£ m·ªü ph√≤ng.",
+      });
+    }
+
+    // C·∫≠p nh·∫≠t th√¥ng tin ƒë·ªÅ thi
+    await sequelize.query(
+      `UPDATE exams SET title = ?, duration = ?, updated_at = NOW() WHERE id = ?`,
+      { replacements: [title, duration, id], transaction }
+    );
+
+    // X√≥a c√¢u h·ªèi v√† option c≈©
+    await sequelize.query(
+      `DELETE eo FROM exam_options eo 
+       INNER JOIN exam_questions eq ON eo.question_id = eq.id 
+       WHERE eq.exam_id = ?`,
+      { replacements: [id], transaction }
+    );
+    await sequelize.query(`DELETE FROM exam_questions WHERE exam_id = ?`, {
+      replacements: [id],
+      transaction,
+    });
+
+    // Th√™m l·∫°i c√¢u h·ªèi m·ªõi
+    for (let i = 0; i < questions.length; i++) {
+      const q = questions[i];
+      const type = q.type?.toLowerCase() === "essay" ? "essay" : "MCQ";
+
+      const modelAnswer = type === "essay" ? q.modelAnswer || null : null;
+
+      const [questionId] = await sequelize.query(
+        `INSERT INTO exam_questions (exam_id, question_text, type, points, order_index, model_answer) 
+         VALUES (?, ?, ?, ?, ?, ?)`,
+        {
+          replacements: [id, q.content, type, q.points, i, modelAnswer],
+          type: QueryTypes.INSERT,
+          transaction,
+        }
+      );
+
+      if (type === "MCQ" && q.options?.length > 0) {
+        for (const opt of q.options) {
+          await sequelize.query(
+            `INSERT INTO exam_options (question_id, option_text, is_correct) VALUES (?, ?, ?)`,
+            {
+              replacements: [questionId, opt.content, opt.is_correct ? 1 : 0],
+              transaction,
+            }
+          );
+        }
+      }
+    }
+
+    await transaction.commit();
+    res.json({
+      status: "success",
+      message: "C·∫≠p nh·∫≠t ƒë·ªÅ thi th√†nh c√¥ng!",
+    });
+  } catch (error) {
+    await transaction.rollback();
+    console.error("Error updating exam:", error);
+    res
+      .status(500)
+      .json({ status: "error", message: "L·ªói m√°y ch·ªß khi c·∫≠p nh·∫≠t." });
+  }
+};
+
+module.exports = { getExamForEdit, updateExam };
diff --git a/backend/src/controllers/examBankController.js b/backend/src/controllers/examBankController.js
index 210037b..cd4c30f 100644
--- a/backend/src/controllers/examBankController.js
+++ b/backend/src/controllers/examBankController.js
@@ -1,330 +1,330 @@
-const sequelize = require("../config/db");
-
-const importExamQuestions = async (req, res) => {
-  const transaction = await sequelize.transaction();
-  try {
-    const { preview, summary, exam_title, duration } = req.body;
-    console.log("üïí duration =", duration);
-
-    const instructorId = req.user.id;
-
-    if (!exam_title || exam_title.trim().length === 0) {
-      await transaction.rollback();
-      return res
-        .status(400)
-        .json({ message: "exam_title is required", status: "error" });
-    }
-
-    if (!Array.isArray(preview) || preview.length === 0) {
-      await transaction.rollback();
-      return res
-        .status(400)
-        .json({ message: "No questions to import", status: "error" });
-    }
-
-    const safeDuration = duration || 60;
-
-    const [[createdByCol], [isBankCol]] = await Promise.all([
-      sequelize.query(`SHOW COLUMNS FROM exam_questions LIKE 'created_by'`, {
-        transaction,
-      }),
-      sequelize.query(
-        `SHOW COLUMNS FROM exam_questions LIKE 'is_bank_question'`,
-        { transaction }
-      ),
-    ]);
-
-    const hasCreatedBy = Array.isArray(createdByCol) && createdByCol.length > 0;
-    const hasIsBank = Array.isArray(isBankCol) && isBankCol.length > 0;
-
-    // ‚úÖ B·∫Øt ƒë·∫ßu ki·ªÉm tra t·ªïng ƒëi·ªÉm
-    let totalMCQ = 0;
-    let totalEssay = 0;
-    let mcqCount = 0;
-    let essayCount = 0;
-    const scorePattern = /\((\d+(?:[.,]\d+)?)ƒë\)/i; // (0.5ƒë) ho·∫∑c (0,5ƒë)
-
-    // Duy·ªát ƒë·ªÉ t√≠nh t·ªïng ƒëi·ªÉm
-    for (let i = 0; i < preview.length; i++) {
-      const q = preview[i];
-      if (!q.question_text) continue;
-
-      const match = q.question_text.match(scorePattern);
-      if (!match) {
-        await transaction.rollback();
-        return res.status(400).json({
-          message: `Cannot determine the score for the question at row ${
-            q.row || i + 1
-          }. Please add the score in the format "(0.5ƒë)" or "(0,5ƒë)" within the question.`,
-          status: "error",
-        });
-      }
-
-      const point = parseFloat(match[1].replace(",", "."));
-      if (isNaN(point) || point <= 0) {
-        await transaction.rollback();
-        return res.status(400).json({
-          message: `Invalid score at row ${q.row || i + 1}.`,
-          status: "error",
-        });
-      }
-
-      if (q.type === "MCQ") {
-        totalMCQ += point;
-        mcqCount++;
-      } else if (q.type === "Essay") {
-        totalEssay += point;
-        essayCount++;
-      }
-    }
-
-    // Gi·ªõi h·∫°n s·ªë c√¢u h·ªèi
-    if (mcqCount > 50) {
-      await transaction.rollback();
-      return res.status(400).json({
-        message: `The number of multiple-choice questions exceeds the limit (maximum 50, currently ${mcqCount}).`,
-        status: "error",
-      });
-    }
-
-    if (essayCount > 10) {
-      await transaction.rollback();
-      return res.status(400).json({
-        message: `The number of essay questions exceeds the limit (maximum 10, currently ${essayCount}).`,
-        status: "error",
-      });
-    }
-
-    // ‚úÖ T·ªïng ƒëi·ªÉm ph·∫£i ƒë√∫ng 10
-    const totalPoints = preview.reduce((sum, q) => {
-      const match = q.question_text?.match(scorePattern);
-      if (!match)
-        throw new Error(`Cannot determine score for row ${q.row || "?"}`);
-      const point = parseFloat(match[1].replace(",", "."));
-      return sum + point;
-    }, 0);
-
-    console.log(
-      `‚úÖ T·ªïng ƒëi·ªÉm h·ª£p l·ªá: MCQ=${totalMCQ}, Essay=${totalEssay}, T·ªïng=${totalPoints}`
-    );
-
-    // ‚úÖ L∆∞u exam v√†o DB
-    const [insertRes] = await sequelize.query(
-      `INSERT INTO exams (title, instructor_id, duration, status, created_at)
-       VALUES (?, ?, ?, 'draft', NOW())`,
-      {
-        replacements: [exam_title.trim(), instructorId, safeDuration],
-        transaction,
-      }
-    );
-
-    let examId =
-      insertRes && typeof insertRes === "object"
-        ? insertRes.insertId
-        : insertRes;
-
-    if (!examId) {
-      const [rows] = await sequelize.query(`SELECT LAST_INSERT_ID() AS id`, {
-        transaction,
-      });
-      examId = Array.isArray(rows) ? rows[0]?.id : rows?.id;
-    }
-
-    if (!examId) throw new Error("Cannot create a new exam record.");
-
-    let importedCount = 0;
-    const errors = [];
-
-    // ‚úÖ Import t·ª´ng c√¢u h·ªèi
-    for (let i = 0; i < preview.length; i++) {
-      const q = preview[i];
-      try {
-        if (q.errors && q.errors.length > 0) {
-          errors.push(`Row ${q.row}: ${q.errors.join(", ")}`);
-          continue;
-        }
-
-        if (!q.question_text || q.question_text.trim().length === 0) {
-          errors.push(`Row ${q.row}: Missing question text`);
-          continue;
-        }
-
-        // L·∫•y ƒëi·ªÉm t·ª´ng c√¢u h·ªèi
-        const match = q.question_text.match(scorePattern);
-        const qPoints = match ? parseFloat(match[1].replace(",", ".")) : 0;
-
-        if (q.type === "MCQ") {
-          if (!q.options || q.options.length < 2) {
-            errors.push(`Row ${q.row}: MCQ must have at least 2 options`);
-            continue;
-          }
-
-          if (q.correct_option === null || q.correct_option === undefined) {
-            errors.push(`Row ${q.row}: MCQ must have correct answer marked`);
-            continue;
-          }
-
-          let insertQRes;
-          if (hasCreatedBy && hasIsBank) {
-            [insertQRes] = await sequelize.query(
-              `INSERT INTO exam_questions 
-                (exam_id, question_text, type, points, created_by, is_bank_question, created_at) 
-               VALUES (?, ?, 'MCQ', ?, ?, TRUE, NOW())`,
-              {
-                replacements: [
-                  examId,
-                  q.question_text.trim(),
-                  qPoints,
-                  instructorId,
-                ],
-                transaction,
-              }
-            );
-          } else if (hasCreatedBy) {
-            [insertQRes] = await sequelize.query(
-              `INSERT INTO exam_questions 
-                (exam_id, question_text, type, points, created_by, created_at) 
-               VALUES (?, ?, 'MCQ', ?, ?, NOW())`,
-              {
-                replacements: [
-                  examId,
-                  q.question_text.trim(),
-                  qPoints,
-                  instructorId,
-                ],
-                transaction,
-              }
-            );
-          } else {
-            [insertQRes] = await sequelize.query(
-              `INSERT INTO exam_questions 
-                (exam_id, question_text, type, points, created_at) 
-               VALUES (?, ?, 'MCQ', ?, NOW())`,
-              {
-                replacements: [examId, q.question_text.trim(), qPoints],
-                transaction,
-              }
-            );
-          }
-
-          const questionId =
-            insertQRes && insertQRes.insertId
-              ? insertQRes.insertId
-              : insertQRes;
-
-          if (!questionId) throw new Error("Failed to insert MCQ question");
-
-          for (let optIdx = 0; optIdx < q.options.length; optIdx++) {
-            const optionText = (q.options[optIdx] || "").trim();
-            if (!optionText) continue;
-
-            await sequelize.query(
-              `INSERT INTO exam_options (question_id, option_text, is_correct) VALUES (?, ?, ?)`,
-              {
-                replacements: [
-                  questionId,
-                  optionText,
-                  optIdx === q.correct_option ? 1 : 0,
-                ],
-                transaction,
-              }
-            );
-          }
-
-          importedCount++;
-        } else if (q.type === "Essay") {
-          if (!q.model_answer || q.model_answer.trim().length === 0) {
-            errors.push(`Row ${q.row}: Essay must have model answer`);
-            continue;
-          }
-
-          let insertQRes;
-          if (hasCreatedBy && hasIsBank) {
-            [insertQRes] = await sequelize.query(
-              `INSERT INTO exam_questions 
-                (exam_id, question_text, type, points, model_answer, created_by, is_bank_question, created_at) 
-               VALUES (?, ?, 'Essay', ?, ?, ?, TRUE, NOW())`,
-              {
-                replacements: [
-                  examId,
-                  q.question_text.trim(),
-                  qPoints,
-                  q.model_answer.trim(),
-                  instructorId,
-                ],
-                transaction,
-              }
-            );
-          } else if (hasCreatedBy) {
-            [insertQRes] = await sequelize.query(
-              `INSERT INTO exam_questions 
-                (exam_id, question_text, type, points, model_answer, created_by, created_at) 
-               VALUES (?, ?, 'Essay', ?, ?, ?, NOW())`,
-              {
-                replacements: [
-                  examId,
-                  q.question_text.trim(),
-                  qPoints,
-                  q.model_answer.trim(),
-                  instructorId,
-                ],
-                transaction,
-              }
-            );
-          } else {
-            [insertQRes] = await sequelize.query(
-              `INSERT INTO exam_questions 
-                (exam_id, question_text, type, points, model_answer, created_at) 
-               VALUES (?, ?, 'Essay', ?, ?, NOW())`,
-              {
-                replacements: [
-                  examId,
-                  q.question_text.trim(),
-                  qPoints,
-                  q.model_answer.trim(),
-                ],
-                transaction,
-              }
-            );
-          }
-
-          importedCount++;
-        } else {
-          errors.push(`Row ${q.row}: Unknown question type ${q.type}`);
-        }
-      } catch (err) {
-        console.error(`‚ùå Error importing row ${q.row}:`, err);
-        errors.push(`Row ${q.row}: ${err.message}`);
-      }
-    }
-
-    if (errors.length > 0) {
-      await transaction.rollback();
-      return res.status(400).json({
-        message: "Import failed, some rows invalid",
-        errors,
-        status: "error",
-      });
-    }
-
-    await transaction.commit();
-
-    return res.status(200).json({
-      message: `‚úÖ Imported ${importedCount} questions successfully.`,
-      exam_id: examId,
-      imported: importedCount,
-      total_points: totalPoints,
-      summary,
-      status: "success",
-    });
-  } catch (err) {
-    await transaction.rollback();
-    console.error("‚ùå Import error:", err);
-    return res.status(500).json({
-      message: "Server error during import: " + err.message,
-      status: "error",
-    });
-  }
-};
-
-module.exports = { importExamQuestions };
+const sequelize = require("../config/db");
+
+const importExamQuestions = async (req, res) => {
+  const transaction = await sequelize.transaction();
+  try {
+    const { preview, summary, exam_title, duration } = req.body;
+    console.log("üïí duration =", duration);
+
+    const instructorId = req.user.id;
+
+    if (!exam_title || exam_title.trim().length === 0) {
+      await transaction.rollback();
+      return res
+        .status(400)
+        .json({ message: "exam_title is required", status: "error" });
+    }
+
+    if (!Array.isArray(preview) || preview.length === 0) {
+      await transaction.rollback();
+      return res
+        .status(400)
+        .json({ message: "No questions to import", status: "error" });
+    }
+
+    const safeDuration = duration || 60;
+
+    const [[createdByCol], [isBankCol]] = await Promise.all([
+      sequelize.query(`SHOW COLUMNS FROM exam_questions LIKE 'created_by'`, {
+        transaction,
+      }),
+      sequelize.query(
+        `SHOW COLUMNS FROM exam_questions LIKE 'is_bank_question'`,
+        { transaction }
+      ),
+    ]);
+
+    const hasCreatedBy = Array.isArray(createdByCol) && createdByCol.length > 0;
+    const hasIsBank = Array.isArray(isBankCol) && isBankCol.length > 0;
+
+    // ‚úÖ B·∫Øt ƒë·∫ßu ki·ªÉm tra t·ªïng ƒëi·ªÉm
+    let totalMCQ = 0;
+    let totalEssay = 0;
+    let mcqCount = 0;
+    let essayCount = 0;
+    const scorePattern = /\((\d+(?:[.,]\d+)?)ƒë\)/i; // (0.5ƒë) ho·∫∑c (0,5ƒë)
+
+    // Duy·ªát ƒë·ªÉ t√≠nh t·ªïng ƒëi·ªÉm
+    for (let i = 0; i < preview.length; i++) {
+      const q = preview[i];
+      if (!q.question_text) continue;
+
+      const match = q.question_text.match(scorePattern);
+      if (!match) {
+        await transaction.rollback();
+        return res.status(400).json({
+          message: `Cannot determine the score for the question at row ${
+            q.row || i + 1
+          }. Please add the score in the format "(0.5ƒë)" or "(0,5ƒë)" within the question.`,
+          status: "error",
+        });
+      }
+
+      const point = parseFloat(match[1].replace(",", "."));
+      if (isNaN(point) || point <= 0) {
+        await transaction.rollback();
+        return res.status(400).json({
+          message: `Invalid score at row ${q.row || i + 1}.`,
+          status: "error",
+        });
+      }
+
+      if (q.type === "MCQ") {
+        totalMCQ += point;
+        mcqCount++;
+      } else if (q.type === "Essay") {
+        totalEssay += point;
+        essayCount++;
+      }
+    }
+
+    // Gi·ªõi h·∫°n s·ªë c√¢u h·ªèi
+    if (mcqCount > 50) {
+      await transaction.rollback();
+      return res.status(400).json({
+        message: `The number of multiple-choice questions exceeds the limit (maximum 50, currently ${mcqCount}).`,
+        status: "error",
+      });
+    }
+
+    if (essayCount > 10) {
+      await transaction.rollback();
+      return res.status(400).json({
+        message: `The number of essay questions exceeds the limit (maximum 10, currently ${essayCount}).`,
+        status: "error",
+      });
+    }
+
+    // ‚úÖ T·ªïng ƒëi·ªÉm ph·∫£i ƒë√∫ng 10
+    const totalPoints = preview.reduce((sum, q) => {
+      const match = q.question_text?.match(scorePattern);
+      if (!match)
+        throw new Error(`Cannot determine score for row ${q.row || "?"}`);
+      const point = parseFloat(match[1].replace(",", "."));
+      return sum + point;
+    }, 0);
+
+    console.log(
+      `‚úÖ T·ªïng ƒëi·ªÉm h·ª£p l·ªá: MCQ=${totalMCQ}, Essay=${totalEssay}, T·ªïng=${totalPoints}`
+    );
+
+    // ‚úÖ L∆∞u exam v√†o DB
+    const [insertRes] = await sequelize.query(
+      `INSERT INTO exams (title, instructor_id, duration, status, created_at)
+       VALUES (?, ?, ?, 'draft', NOW())`,
+      {
+        replacements: [exam_title.trim(), instructorId, safeDuration],
+        transaction,
+      }
+    );
+
+    let examId =
+      insertRes && typeof insertRes === "object"
+        ? insertRes.insertId
+        : insertRes;
+
+    if (!examId) {
+      const [rows] = await sequelize.query(`SELECT LAST_INSERT_ID() AS id`, {
+        transaction,
+      });
+      examId = Array.isArray(rows) ? rows[0]?.id : rows?.id;
+    }
+
+    if (!examId) throw new Error("Cannot create a new exam record.");
+
+    let importedCount = 0;
+    const errors = [];
+
+    // ‚úÖ Import t·ª´ng c√¢u h·ªèi
+    for (let i = 0; i < preview.length; i++) {
+      const q = preview[i];
+      try {
+        if (q.errors && q.errors.length > 0) {
+          errors.push(`Row ${q.row}: ${q.errors.join(", ")}`);
+          continue;
+        }
+
+        if (!q.question_text || q.question_text.trim().length === 0) {
+          errors.push(`Row ${q.row}: Missing question text`);
+          continue;
+        }
+
+        // L·∫•y ƒëi·ªÉm t·ª´ng c√¢u h·ªèi
+        const match = q.question_text.match(scorePattern);
+        const qPoints = match ? parseFloat(match[1].replace(",", ".")) : 0;
+
+        if (q.type === "MCQ") {
+          if (!q.options || q.options.length < 2) {
+            errors.push(`Row ${q.row}: MCQ must have at least 2 options`);
+            continue;
+          }
+
+          if (q.correct_option === null || q.correct_option === undefined) {
+            errors.push(`Row ${q.row}: MCQ must have correct answer marked`);
+            continue;
+          }
+
+          let insertQRes;
+          if (hasCreatedBy && hasIsBank) {
+            [insertQRes] = await sequelize.query(
+              `INSERT INTO exam_questions 
+                (exam_id, question_text, type, points, created_by, is_bank_question, created_at) 
+               VALUES (?, ?, 'MCQ', ?, ?, TRUE, NOW())`,
+              {
+                replacements: [
+                  examId,
+                  q.question_text.trim(),
+                  qPoints,
+                  instructorId,
+                ],
+                transaction,
+              }
+            );
+          } else if (hasCreatedBy) {
+            [insertQRes] = await sequelize.query(
+              `INSERT INTO exam_questions 
+                (exam_id, question_text, type, points, created_by, created_at) 
+               VALUES (?, ?, 'MCQ', ?, ?, NOW())`,
+              {
+                replacements: [
+                  examId,
+                  q.question_text.trim(),
+                  qPoints,
+                  instructorId,
+                ],
+                transaction,
+              }
+            );
+          } else {
+            [insertQRes] = await sequelize.query(
+              `INSERT INTO exam_questions 
+                (exam_id, question_text, type, points, created_at) 
+               VALUES (?, ?, 'MCQ', ?, NOW())`,
+              {
+                replacements: [examId, q.question_text.trim(), qPoints],
+                transaction,
+              }
+            );
+          }
+
+          const questionId =
+            insertQRes && insertQRes.insertId
+              ? insertQRes.insertId
+              : insertQRes;
+
+          if (!questionId) throw new Error("Failed to insert MCQ question");
+
+          for (let optIdx = 0; optIdx < q.options.length; optIdx++) {
+            const optionText = (q.options[optIdx] || "").trim();
+            if (!optionText) continue;
+
+            await sequelize.query(
+              `INSERT INTO exam_options (question_id, option_text, is_correct) VALUES (?, ?, ?)`,
+              {
+                replacements: [
+                  questionId,
+                  optionText,
+                  optIdx === q.correct_option ? 1 : 0,
+                ],
+                transaction,
+              }
+            );
+          }
+
+          importedCount++;
+        } else if (q.type === "Essay") {
+          if (!q.model_answer || q.model_answer.trim().length === 0) {
+            errors.push(`Row ${q.row}: Essay must have model answer`);
+            continue;
+          }
+
+          let insertQRes;
+          if (hasCreatedBy && hasIsBank) {
+            [insertQRes] = await sequelize.query(
+              `INSERT INTO exam_questions 
+                (exam_id, question_text, type, points, model_answer, created_by, is_bank_question, created_at) 
+               VALUES (?, ?, 'Essay', ?, ?, ?, TRUE, NOW())`,
+              {
+                replacements: [
+                  examId,
+                  q.question_text.trim(),
+                  qPoints,
+                  q.model_answer.trim(),
+                  instructorId,
+                ],
+                transaction,
+              }
+            );
+          } else if (hasCreatedBy) {
+            [insertQRes] = await sequelize.query(
+              `INSERT INTO exam_questions 
+                (exam_id, question_text, type, points, model_answer, created_by, created_at) 
+               VALUES (?, ?, 'Essay', ?, ?, ?, NOW())`,
+              {
+                replacements: [
+                  examId,
+                  q.question_text.trim(),
+                  qPoints,
+                  q.model_answer.trim(),
+                  instructorId,
+                ],
+                transaction,
+              }
+            );
+          } else {
+            [insertQRes] = await sequelize.query(
+              `INSERT INTO exam_questions 
+                (exam_id, question_text, type, points, model_answer, created_at) 
+               VALUES (?, ?, 'Essay', ?, ?, NOW())`,
+              {
+                replacements: [
+                  examId,
+                  q.question_text.trim(),
+                  qPoints,
+                  q.model_answer.trim(),
+                ],
+                transaction,
+              }
+            );
+          }
+
+          importedCount++;
+        } else {
+          errors.push(`Row ${q.row}: Unknown question type ${q.type}`);
+        }
+      } catch (err) {
+        console.error(`‚ùå Error importing row ${q.row}:`, err);
+        errors.push(`Row ${q.row}: ${err.message}`);
+      }
+    }
+
+    if (errors.length > 0) {
+      await transaction.rollback();
+      return res.status(400).json({
+        message: "Import failed, some rows invalid",
+        errors,
+        status: "error",
+      });
+    }
+
+    await transaction.commit();
+
+    return res.status(200).json({
+      message: `‚úÖ Imported ${importedCount} questions successfully.`,
+      exam_id: examId,
+      imported: importedCount,
+      total_points: totalPoints,
+      summary,
+      status: "success",
+    });
+  } catch (err) {
+    await transaction.rollback();
+    console.error("‚ùå Import error:", err);
+    return res.status(500).json({
+      message: "Server error during import: " + err.message,
+      status: "error",
+    });
+  }
+};
+
+module.exports = { importExamQuestions };
diff --git a/backend/src/controllers/examRoomController.js b/backend/src/controllers/examRoomController.js
index f81b813..8b6b3dc 100644
--- a/backend/src/controllers/examRoomController.js
+++ b/backend/src/controllers/examRoomController.js
@@ -1,61 +1,61 @@
-const Exam = require("../models/ExamRoom");
-const crypto = require("crypto");
-
-async function createExam(req, res) {
-  try {
-    // üîí Ch·ªâ cho ph√©p gi·∫£ng vi√™n
-    if (req.user.role !== "instructor") {
-      return res.status(403).json({ message: "Ch·ªâ gi·∫£ng vi√™n m·ªõi c√≥ th·ªÉ t·∫°o b√†i thi" });
-    }
-
-    const { courseId, title, duration } = req.body;
-    if (!courseId || !title || !duration) {
-      return res.status(400).json({ message: "Vui l√≤ng cung c·∫•p ƒë·ªß th√¥ng tin: courseId, title, duration" });
-    }
-
-    // üé≤ Sinh m√£ ph√≤ng ng·∫´u nhi√™n
-    const roomCode = crypto.randomBytes(4).toString("hex").toUpperCase();
-
-    // üß© T·∫°o exam room m·ªõi
-    const newExam = await Exam.create({
-      course_id: courseId,
-      title: title,
-      duration: duration,
-      exam_room_code: roomCode,
-    });
-
-    return res.status(201).json({
-      message: "T·∫°o b√†i thi th√†nh c√¥ng",
-      exam: newExam,
-    });
-  } catch (error) {
-    console.error("‚ùå Create exam error:", error);
-    return res.status(500).json({ message: "L·ªói server" });
-  }
-}
-
-async function verifyExamCode(req, res) {
-  try {
-    const { roomCode } = req.body;
-    if (!roomCode) {
-      return res.status(400).json({ message: "C·∫ßn m√£ ph√≤ng thi" });
-    }
-
-    const exam = await Exam.findOne({ where: { exam_room_code: roomCode } });
-    if (!exam) {
-      return res.status(400).json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá" });
-    }
-
-    return res.status(200).json({
-      valid: true,
-      examId: exam.id,
-      courseId: exam.course_id,
-      title: exam.title,
-    });
-  } catch (error) {
-    console.error("‚ùå Verify exam code error:", error);
-    return res.status(500).json({ message: "L·ªói server" });
-  }
-}
-
-module.exports = { createExam, verifyExamCode };
+const Exam = require("../models/ExamRoom");
+const crypto = require("crypto");
+
+async function createExam(req, res) {
+  try {
+    // üîí Ch·ªâ cho ph√©p gi·∫£ng vi√™n
+    if (req.user.role !== "instructor") {
+      return res.status(403).json({ message: "Ch·ªâ gi·∫£ng vi√™n m·ªõi c√≥ th·ªÉ t·∫°o b√†i thi" });
+    }
+
+    const { courseId, title, duration } = req.body;
+    if (!courseId || !title || !duration) {
+      return res.status(400).json({ message: "Vui l√≤ng cung c·∫•p ƒë·ªß th√¥ng tin: courseId, title, duration" });
+    }
+
+    // üé≤ Sinh m√£ ph√≤ng ng·∫´u nhi√™n
+    const roomCode = crypto.randomBytes(4).toString("hex").toUpperCase();
+
+    // üß© T·∫°o exam room m·ªõi
+    const newExam = await Exam.create({
+      course_id: courseId,
+      title: title,
+      duration: duration,
+      exam_room_code: roomCode,
+    });
+
+    return res.status(201).json({
+      message: "T·∫°o b√†i thi th√†nh c√¥ng",
+      exam: newExam,
+    });
+  } catch (error) {
+    console.error("‚ùå Create exam error:", error);
+    return res.status(500).json({ message: "L·ªói server" });
+  }
+}
+
+async function verifyExamCode(req, res) {
+  try {
+    const { roomCode } = req.body;
+    if (!roomCode) {
+      return res.status(400).json({ message: "C·∫ßn m√£ ph√≤ng thi" });
+    }
+
+    const exam = await Exam.findOne({ where: { exam_room_code: roomCode } });
+    if (!exam) {
+      return res.status(400).json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá" });
+    }
+
+    return res.status(200).json({
+      valid: true,
+      examId: exam.id,
+      courseId: exam.course_id,
+      title: exam.title,
+    });
+  } catch (error) {
+    console.error("‚ùå Verify exam code error:", error);
+    return res.status(500).json({ message: "L·ªói server" });
+  }
+}
+
+module.exports = { createExam, verifyExamCode };
diff --git a/backend/src/controllers/profileController.js b/backend/src/controllers/profileController.js
index 46a740f..878de5a 100644
--- a/backend/src/controllers/profileController.js
+++ b/backend/src/controllers/profileController.js
@@ -1,138 +1,138 @@
-const { User } = require("../models/User");
-
-// GET /api/profile/   - return current user's profile
-const getProfile = async (req, res) => {
-	try {
-		const userId = req.user && req.user.id;
-		if (!userId) return res.status(401).json({ message: "Unauthorized" });
-
-		const user = await User.findByPk(userId, {
-			attributes: [
-				"id",
-				"full_name",
-				"email",
-				"phone",
-				"address",
-				"avatar",
-				"gender",
-				"role",
-				"created_at",
-			],
-		});
-
-		if (!user) return res.status(404).json({ message: "User not found" });
-
-		res.json({ success: true, data: user });
-	} catch (err) {
-		console.error("[getProfile]", err);
-		res.status(500).json({ success: false, message: "Server error" });
-	}
-};
-
-// PUT /api/profile/  - update profile fields
-const updateProfile = async (req, res) => {
-	try {
-		const userId = req.user && req.user.id;
-		if (!userId) return res.status(401).json({ message: "Unauthorized" });
-
-			// Allow these fields to be updated from the frontend. Ignore email if present.
-			const { full_name, phone, address, avatar, gender } = req.body;
-
-			// Server-side validation: phone must be 10 digits if provided
-				if (typeof phone !== 'undefined' && phone !== null && phone !== '') {
-					if (!/^\d{10}$/.test(String(phone))) {
-						return res.status(400).json({ success: false, message: 'Nh·∫≠p sai ƒë·ªãnh d·∫°ng s·ªë ƒëi·ªán tho·∫°i' });
-					}
-				}
-
-			// Validate gender value if provided
-			const allowedGenders = ['male', 'female', 'other', null];
-			if (typeof gender !== 'undefined' && gender !== null && gender !== '') {
-				if (!allowedGenders.includes(gender)) {
-					return res.status(400).json({ success: false, message: 'Gi·ªõi t√≠nh kh√¥ng h·ª£p l·ªá' });
-				}
-			}
-
-		const user = await User.findByPk(userId);
-		if (!user) return res.status(404).json({ message: "User not found" });
-
-		// Update only provided fields
-		if (typeof full_name !== "undefined") user.full_name = full_name;
-		if (typeof phone !== "undefined") user.phone = phone;
-		if (typeof address !== "undefined") user.address = address;
-		if (typeof avatar !== "undefined") user.avatar = avatar;
-		if (typeof gender !== "undefined") user.gender = gender;
-
-		// Ensure email is not changed by profile update
-		// (do not assign req.body.email anywhere)
-		await user.save();
-
-		res.json({ success: true, message: "Profile updated", data: user });
-	} catch (err) {
-		console.error("[updateProfile]", err);
-		res.status(500).json({ success: false, message: "Server error" });
-	}
-};
-
-// exports are declared at the end of the file
-// Avatar upload handler
-const uploadAvatar = async (req, res) => {
-	try {
-		const userId = req.user && req.user.id;
-		if (!userId) return res.status(401).json({ message: 'Unauthorized' });
-		// debug logging: ensure upload arrived
-		console.log('[uploadAvatar] hit userId=', userId);
-
-		if (!req.file || !req.file.buffer) {
-			console.warn('[uploadAvatar] no file in request or buffer missing');
-			return res.status(400).json({ success: false, message: 'No file uploaded' });
-		}
-
-		console.log('[uploadAvatar] file info:', {
-			originalname: req.file.originalname,
-			mimetype: req.file.mimetype,
-			size: req.file.size,
-		});
-
-		const user = await User.findByPk(userId);
-		if (!user) {
-			console.warn('[uploadAvatar] user not found id=', userId);
-			return res.status(404).json({ message: 'User not found' });
-		}
-
-		// Save binary data into DB (avatar_blob) and mimetype, and set avatar URL to a GET endpoint
-		user.avatar_blob = req.file.buffer;
-		user.avatar_mimetype = req.file.mimetype || 'application/octet-stream';
-	// set avatar to an absolute endpoint the frontend can call to fetch the image
-	user.avatar = `${req.protocol}://${req.get('host')}/api/profile/avatar/${userId}`;
-		await user.save();
-
-		console.log('[uploadAvatar] saved avatar blob for user', userId);
-
-		res.json({ success: true, message: 'Avatar uploaded', data: { avatar: user.avatar } });
-	} catch (err) {
-		console.error('[uploadAvatar]', err && err.stack ? err.stack : err);
-		// Return the error message to help debugging in dev; in production consider hiding details
-		res.status(500).json({ success: false, message: err.message || 'Server error' });
-	}
-};
-
-// GET /api/profile/avatar/:id - stream avatar blob from DB
-const getAvatar = async (req, res) => {
-	try {
-		const id = req.params.id;
-		const user = await User.findByPk(id);
-		if (!user || !user.avatar_blob) return res.status(404).send('Not found');
-
-		const mime = user.avatar_mimetype || 'application/octet-stream';
-		res.set('Content-Type', mime);
-		// optional caching
-		res.set('Cache-Control', 'public, max-age=86400');
-		res.send(user.avatar_blob);
-	} catch (err) {
-		console.error('[getAvatar]', err);
-		res.status(500).send('Server error');
-	}
-};
-
-module.exports = { getProfile, updateProfile, uploadAvatar, getAvatar };
+const { User } = require("../models/User");
+
+// GET /api/profile/   - return current user's profile
+const getProfile = async (req, res) => {
+	try {
+		const userId = req.user && req.user.id;
+		if (!userId) return res.status(401).json({ message: "Unauthorized" });
+
+		const user = await User.findByPk(userId, {
+			attributes: [
+				"id",
+				"full_name",
+				"email",
+				"phone",
+				"address",
+				"avatar",
+				"gender",
+				"role",
+				"created_at",
+			],
+		});
+
+		if (!user) return res.status(404).json({ message: "User not found" });
+
+		res.json({ success: true, data: user });
+	} catch (err) {
+		console.error("[getProfile]", err);
+		res.status(500).json({ success: false, message: "Server error" });
+	}
+};
+
+// PUT /api/profile/  - update profile fields
+const updateProfile = async (req, res) => {
+	try {
+		const userId = req.user && req.user.id;
+		if (!userId) return res.status(401).json({ message: "Unauthorized" });
+
+			// Allow these fields to be updated from the frontend. Ignore email if present.
+			const { full_name, phone, address, avatar, gender } = req.body;
+
+			// Server-side validation: phone must be 10 digits if provided
+				if (typeof phone !== 'undefined' && phone !== null && phone !== '') {
+					if (!/^\d{10}$/.test(String(phone))) {
+						return res.status(400).json({ success: false, message: 'Nh·∫≠p sai ƒë·ªãnh d·∫°ng s·ªë ƒëi·ªán tho·∫°i' });
+					}
+				}
+
+			// Validate gender value if provided
+			const allowedGenders = ['male', 'female', 'other', null];
+			if (typeof gender !== 'undefined' && gender !== null && gender !== '') {
+				if (!allowedGenders.includes(gender)) {
+					return res.status(400).json({ success: false, message: 'Gi·ªõi t√≠nh kh√¥ng h·ª£p l·ªá' });
+				}
+			}
+
+		const user = await User.findByPk(userId);
+		if (!user) return res.status(404).json({ message: "User not found" });
+
+		// Update only provided fields
+		if (typeof full_name !== "undefined") user.full_name = full_name;
+		if (typeof phone !== "undefined") user.phone = phone;
+		if (typeof address !== "undefined") user.address = address;
+		if (typeof avatar !== "undefined") user.avatar = avatar;
+		if (typeof gender !== "undefined") user.gender = gender;
+
+		// Ensure email is not changed by profile update
+		// (do not assign req.body.email anywhere)
+		await user.save();
+
+		res.json({ success: true, message: "Profile updated", data: user });
+	} catch (err) {
+		console.error("[updateProfile]", err);
+		res.status(500).json({ success: false, message: "Server error" });
+	}
+};
+
+// exports are declared at the end of the file
+// Avatar upload handler
+const uploadAvatar = async (req, res) => {
+	try {
+		const userId = req.user && req.user.id;
+		if (!userId) return res.status(401).json({ message: 'Unauthorized' });
+		// debug logging: ensure upload arrived
+		console.log('[uploadAvatar] hit userId=', userId);
+
+		if (!req.file || !req.file.buffer) {
+			console.warn('[uploadAvatar] no file in request or buffer missing');
+			return res.status(400).json({ success: false, message: 'No file uploaded' });
+		}
+
+		console.log('[uploadAvatar] file info:', {
+			originalname: req.file.originalname,
+			mimetype: req.file.mimetype,
+			size: req.file.size,
+		});
+
+		const user = await User.findByPk(userId);
+		if (!user) {
+			console.warn('[uploadAvatar] user not found id=', userId);
+			return res.status(404).json({ message: 'User not found' });
+		}
+
+		// Save binary data into DB (avatar_blob) and mimetype, and set avatar URL to a GET endpoint
+		user.avatar_blob = req.file.buffer;
+		user.avatar_mimetype = req.file.mimetype || 'application/octet-stream';
+	// set avatar to an absolute endpoint the frontend can call to fetch the image
+	user.avatar = `${req.protocol}://${req.get('host')}/api/profile/avatar/${userId}`;
+		await user.save();
+
+		console.log('[uploadAvatar] saved avatar blob for user', userId);
+
+		res.json({ success: true, message: 'Avatar uploaded', data: { avatar: user.avatar } });
+	} catch (err) {
+		console.error('[uploadAvatar]', err && err.stack ? err.stack : err);
+		// Return the error message to help debugging in dev; in production consider hiding details
+		res.status(500).json({ success: false, message: err.message || 'Server error' });
+	}
+};
+
+// GET /api/profile/avatar/:id - stream avatar blob from DB
+const getAvatar = async (req, res) => {
+	try {
+		const id = req.params.id;
+		const user = await User.findByPk(id);
+		if (!user || !user.avatar_blob) return res.status(404).send('Not found');
+
+		const mime = user.avatar_mimetype || 'application/octet-stream';
+		res.set('Content-Type', mime);
+		// optional caching
+		res.set('Cache-Control', 'public, max-age=86400');
+		res.send(user.avatar_blob);
+	} catch (err) {
+		console.error('[getAvatar]', err);
+		res.status(500).send('Server error');
+	}
+};
+
+module.exports = { getProfile, updateProfile, uploadAvatar, getAvatar };
diff --git a/backend/src/middleware/authMiddleware.js b/backend/src/middleware/authMiddleware.js
index ce43b4e..ffc571b 100644
--- a/backend/src/middleware/authMiddleware.js
+++ b/backend/src/middleware/authMiddleware.js
@@ -1,52 +1,52 @@
-const jwt = require("jsonwebtoken");
-require("dotenv").config();
-
-// ‚úÖ Middleware x√°c th·ª±c token
-const verifyToken = (req, res, next) => {
-  const authHeader = req.headers.authorization;
-  // console.log("üßæ Token received:", authHeader);
-  // console.log("üßæ Token received:", req.headers.authorization);
-  if (!authHeader || !authHeader.startsWith("Bearer ")) {
-    return res.status(401).json({ message: "Kh√¥ng c√≥ token" });
-  }
-
-  const token = authHeader.split(" ")[1];
-  try {
-    const decoded = jwt.verify(token, process.env.JWT_SECRET);
-    req.user = {
-      id: decoded.id,
-      email: decoded.email,
-      role: decoded.role,
-    };
-
-    console.log("‚úÖ Decoded JWT:", req.user); // ki·ªÉm tra k·∫øt qu·∫£ th·∫≠t
-    next();
-  } catch (err) {
-    console.error("‚ùå Token verify error:", err);
-    return res.status(401).json({ message: "Token kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n" });
-  }
-};
-
-// ‚úÖ Middleware ph√¢n quy·ªÅn theo vai tr√≤
-const authorizeRole = (roles = []) => {
-  return (req, res, next) => {
-    if (!req.user) {
-      return res.status(401).json({ message: "Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p" });
-    }
-
-    const userRole = req.user.role;
-    if (Array.isArray(roles)) {
-      if (!roles.includes(userRole)) {
-        return res.status(403).json({ message: "Truy c·∫≠p b·ªã t·ª´ ch·ªëi" });
-      }
-    } else {
-      if (userRole !== roles) {
-        return res.status(403).json({ message: "Truy c·∫≠p b·ªã t·ª´ ch·ªëi" });
-      }
-    }
-
-    next();
-  };
-};
-
-module.exports = { verifyToken, authorizeRole };
+const jwt = require("jsonwebtoken");
+require("dotenv").config();
+
+// ‚úÖ Middleware x√°c th·ª±c token
+const verifyToken = (req, res, next) => {
+  const authHeader = req.headers.authorization;
+  // console.log("üßæ Token received:", authHeader);
+  // console.log("üßæ Token received:", req.headers.authorization);
+  if (!authHeader || !authHeader.startsWith("Bearer ")) {
+    return res.status(401).json({ message: "Kh√¥ng c√≥ token" });
+  }
+
+  const token = authHeader.split(" ")[1];
+  try {
+    const decoded = jwt.verify(token, process.env.JWT_SECRET);
+    req.user = {
+      id: decoded.id,
+      email: decoded.email,
+      role: decoded.role,
+    };
+
+    console.log("‚úÖ Decoded JWT:", req.user); // ki·ªÉm tra k·∫øt qu·∫£ th·∫≠t
+    next();
+  } catch (err) {
+    console.error("‚ùå Token verify error:", err);
+    return res.status(401).json({ message: "Token kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n" });
+  }
+};
+
+// ‚úÖ Middleware ph√¢n quy·ªÅn theo vai tr√≤
+const authorizeRole = (roles = []) => {
+  return (req, res, next) => {
+    if (!req.user) {
+      return res.status(401).json({ message: "Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p" });
+    }
+
+    const userRole = req.user.role;
+    if (Array.isArray(roles)) {
+      if (!roles.includes(userRole)) {
+        return res.status(403).json({ message: "Truy c·∫≠p b·ªã t·ª´ ch·ªëi" });
+      }
+    } else {
+      if (userRole !== roles) {
+        return res.status(403).json({ message: "Truy c·∫≠p b·ªã t·ª´ ch·ªëi" });
+      }
+    }
+
+    next();
+  };
+};
+
+module.exports = { verifyToken, authorizeRole };
diff --git a/backend/src/middleware/authorizeRole.js b/backend/src/middleware/authorizeRole.js
index e99762a..170ec97 100644
--- a/backend/src/middleware/authorizeRole.js
+++ b/backend/src/middleware/authorizeRole.js
@@ -1,21 +1,21 @@
-function authorizeRole(roles = []) {
-  // roles: array ho·∫∑c string
-  return (req, res, next) => {
-    if (!req.user) {
-      return res.status(401).json({ message: 'Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p' });
-    }
-    const userRole = req.user.role;
-    if (Array.isArray(roles)) {
-      if (!roles.includes(userRole)) {
-        return res.status(403).json({ message: 'Truy c·∫≠p b·ªã t·ª´ ch·ªëi' });
-      }
-    } else {
-      if (userRole !== roles) {
-        return res.status(403).json({ message: 'Truy c·∫≠p b·ªã t·ª´ ch·ªëi' });
-      }
-    }
-    next();
-  };
-}
-
-module.exports = { authorizeRole };
+function authorizeRole(roles = []) {
+  // roles: array ho·∫∑c string
+  return (req, res, next) => {
+    if (!req.user) {
+      return res.status(401).json({ message: 'Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p' });
+    }
+    const userRole = req.user.role;
+    if (Array.isArray(roles)) {
+      if (!roles.includes(userRole)) {
+        return res.status(403).json({ message: 'Truy c·∫≠p b·ªã t·ª´ ch·ªëi' });
+      }
+    } else {
+      if (userRole !== roles) {
+        return res.status(403).json({ message: 'Truy c·∫≠p b·ªã t·ª´ ch·ªëi' });
+      }
+    }
+    next();
+  };
+}
+
+module.exports = { authorizeRole };
diff --git a/backend/src/middleware/verifyRole.js b/backend/src/middleware/verifyRole.js
index 2302f00..11e5f83 100644
--- a/backend/src/middleware/verifyRole.js
+++ b/backend/src/middleware/verifyRole.js
@@ -1,29 +1,29 @@
-/**
- * Middleware x√°c th·ª±c quy·ªÅn truy c·∫≠p theo role
- * @param {string} role - Role c·∫ßn ki·ªÉm tra
- * @returns {Function} Middleware function
- */
-function verifyRole(role) {
-  return (req, res, next) => {
-    // Ki·ªÉm tra xem user ƒë√£ ƒë∆∞·ª£c x√°c th·ª±c ch∆∞a
-    if (!req.user) {
-      return res.status(401).json({ 
-        message: 'Unauthorized - No user information found' 
-      });
-    }
-
-    // Ki·ªÉm tra role
-    if (req.user.role !== role) {
-      return res.status(403).json({ 
-        message: 'Access denied - Insufficient permissions',
-        required: role,
-        current: req.user.role
-      });
-    }
-
-    // Cho ph√©p ti·∫øp t·ª•c
-    next();
-  };
-}
-
-module.exports = { verifyRole };
+/**
+ * Middleware x√°c th·ª±c quy·ªÅn truy c·∫≠p theo role
+ * @param {string} role - Role c·∫ßn ki·ªÉm tra
+ * @returns {Function} Middleware function
+ */
+function verifyRole(role) {
+  return (req, res, next) => {
+    // Ki·ªÉm tra xem user ƒë√£ ƒë∆∞·ª£c x√°c th·ª±c ch∆∞a
+    if (!req.user) {
+      return res.status(401).json({ 
+        message: 'Unauthorized - No user information found' 
+      });
+    }
+
+    // Ki·ªÉm tra role
+    if (req.user.role !== role) {
+      return res.status(403).json({ 
+        message: 'Access denied - Insufficient permissions',
+        required: role,
+        current: req.user.role
+      });
+    }
+
+    // Cho ph√©p ti·∫øp t·ª•c
+    next();
+  };
+}
+
+module.exports = { verifyRole };
diff --git a/backend/src/models/ExamRoom.js b/backend/src/models/ExamRoom.js
index 2ad6527..62837f6 100644
--- a/backend/src/models/ExamRoom.js
+++ b/backend/src/models/ExamRoom.js
@@ -1,57 +1,57 @@
-const { DataTypes } = require("sequelize");
-const sequelize = require("../config/db");
-
-// Sequelize model kh·ªõp schema m·ªõi c·ªßa b·∫£ng `exams`
-// - ƒê√É B·ªé course_id
-// - C√≥ instructor_id (m·ªôt s·ªë DB c√≥ th·ªÉ ƒë·ªÉ NULL n·∫øu d·ªØ li·ªáu c≈©)
-// - C√≥ th·ªÉ c√≥ th√™m c√°c c·ªôt c·∫•u h√¨nh (duration_minutes, time_open, time_close, max_points,
-//   require_face_check, require_student_card, monitor_screen) ‚Äî khai b√°o allowNull ƒë·ªÉ t∆∞∆°ng th√≠ch
-
-const Exam = sequelize.define(
-  "Exam",
-  {
-    id: {
-      type: DataTypes.INTEGER.UNSIGNED,
-      autoIncrement: true,
-      primaryKey: true,
-    },
-    instructor_id: {
-      type: DataTypes.INTEGER.UNSIGNED,
-      allowNull: true, // m·ªôt s·ªë DB c≈© c√≥ th·ªÉ ƒëang NULL; BE n√™n set khi t·∫°o m·ªõi
-    },
-    title: {
-      type: DataTypes.STRING(100),
-      allowNull: false,
-    },
-    duration: {
-      type: DataTypes.INTEGER,
-      allowNull: false,
-    },
-    // C√°c c·ªôt m·ªü r·ªông ‚Äì n·∫øu DB ch∆∞a c√≥ c≈©ng kh√¥ng ·∫£nh h∆∞·ªüng khi ch·ªâ ƒë·ªçc
-    duration_minutes: { type: DataTypes.INTEGER, allowNull: true },
-    time_open: { type: DataTypes.DATE, allowNull: true },
-    time_close: { type: DataTypes.DATE, allowNull: true },
-    max_points: { type: DataTypes.FLOAT, allowNull: true },
-    require_face_check: { type: DataTypes.BOOLEAN, allowNull: true },
-    require_student_card: { type: DataTypes.BOOLEAN, allowNull: true },
-    monitor_screen: { type: DataTypes.BOOLEAN, allowNull: true },
-
-    exam_room_code: {
-      type: DataTypes.STRING(64),
-      allowNull: true,
-      unique: true,
-    },
-    status: {
-      type: DataTypes.ENUM("draft", "published", "archived"),
-      allowNull: false,
-      defaultValue: "draft",
-    },
-  },
-  {
-    tableName: "exams",
-    timestamps: true, // map t·ªõi created_at/updated_at v√¨ underscored
-    underscored: true,
-  }
-);
-
-module.exports = Exam;
+const { DataTypes } = require("sequelize");
+const sequelize = require("../config/db");
+
+// Sequelize model kh·ªõp schema m·ªõi c·ªßa b·∫£ng `exams`
+// - ƒê√É B·ªé course_id
+// - C√≥ instructor_id (m·ªôt s·ªë DB c√≥ th·ªÉ ƒë·ªÉ NULL n·∫øu d·ªØ li·ªáu c≈©)
+// - C√≥ th·ªÉ c√≥ th√™m c√°c c·ªôt c·∫•u h√¨nh (duration_minutes, time_open, time_close, max_points,
+//   require_face_check, require_student_card, monitor_screen) ‚Äî khai b√°o allowNull ƒë·ªÉ t∆∞∆°ng th√≠ch
+
+const Exam = sequelize.define(
+  "Exam",
+  {
+    id: {
+      type: DataTypes.INTEGER.UNSIGNED,
+      autoIncrement: true,
+      primaryKey: true,
+    },
+    instructor_id: {
+      type: DataTypes.INTEGER.UNSIGNED,
+      allowNull: true, // m·ªôt s·ªë DB c≈© c√≥ th·ªÉ ƒëang NULL; BE n√™n set khi t·∫°o m·ªõi
+    },
+    title: {
+      type: DataTypes.STRING(100),
+      allowNull: false,
+    },
+    duration: {
+      type: DataTypes.INTEGER,
+      allowNull: false,
+    },
+    // C√°c c·ªôt m·ªü r·ªông ‚Äì n·∫øu DB ch∆∞a c√≥ c≈©ng kh√¥ng ·∫£nh h∆∞·ªüng khi ch·ªâ ƒë·ªçc
+    duration_minutes: { type: DataTypes.INTEGER, allowNull: true },
+    time_open: { type: DataTypes.DATE, allowNull: true },
+    time_close: { type: DataTypes.DATE, allowNull: true },
+    max_points: { type: DataTypes.FLOAT, allowNull: true },
+    require_face_check: { type: DataTypes.BOOLEAN, allowNull: true },
+    require_student_card: { type: DataTypes.BOOLEAN, allowNull: true },
+    monitor_screen: { type: DataTypes.BOOLEAN, allowNull: true },
+
+    exam_room_code: {
+      type: DataTypes.STRING(64),
+      allowNull: true,
+      unique: true,
+    },
+    status: {
+      type: DataTypes.ENUM("draft", "published", "archived"),
+      allowNull: false,
+      defaultValue: "draft",
+    },
+  },
+  {
+    tableName: "exams",
+    timestamps: true, // map t·ªõi created_at/updated_at v√¨ underscored
+    underscored: true,
+  }
+);
+
+module.exports = Exam;
diff --git a/backend/src/models/StudentRoom.js b/backend/src/models/StudentRoom.js
index 6182208..9b132db 100644
--- a/backend/src/models/StudentRoom.js
+++ b/backend/src/models/StudentRoom.js
@@ -1,51 +1,51 @@
-const { DataTypes } = require("sequelize");
-const sequelize = require("../config/db");
-const User = require("./User");
-const ExamRoom = require("./ExamRoom");
-
-const StudentRoom = sequelize.define(
-  "StudentRoom",
-  {
-    id: {
-      type: DataTypes.INTEGER.UNSIGNED,
-      autoIncrement: true,
-      primaryKey: true,
-    },
-    user_id: {
-      type: DataTypes.INTEGER.UNSIGNED,
-      allowNull: false,
-      references: {
-        model: User,
-        key: "id",
-      },
-      onDelete: "CASCADE",
-    },
-    room_id: {
-      type: DataTypes.INTEGER.UNSIGNED,
-      allowNull: false,
-      references: {
-        model: ExamRoom,
-        key: "id",
-      },
-      onDelete: "CASCADE",
-    },
-  },
-  {
-    tableName: "student_rooms",
-    timestamps: true,
-    indexes: [
-      {
-        unique: true,
-        fields: ["user_id", "room_id"],
-      },
-    ],
-  }
-);
-
-User.hasMany(StudentRoom, { foreignKey: "user_id" });
-StudentRoom.belongsTo(User, { foreignKey: "user_id" });
-
-ExamRoom.hasMany(StudentRoom, { foreignKey: "room_id" });
-StudentRoom.belongsTo(ExamRoom, { foreignKey: "room_id" });
-
-module.exports = StudentRoom;
+const { DataTypes } = require("sequelize");
+const sequelize = require("../config/db");
+const User = require("./User");
+const ExamRoom = require("./ExamRoom");
+
+const StudentRoom = sequelize.define(
+  "StudentRoom",
+  {
+    id: {
+      type: DataTypes.INTEGER.UNSIGNED,
+      autoIncrement: true,
+      primaryKey: true,
+    },
+    user_id: {
+      type: DataTypes.INTEGER.UNSIGNED,
+      allowNull: false,
+      references: {
+        model: User,
+        key: "id",
+      },
+      onDelete: "CASCADE",
+    },
+    room_id: {
+      type: DataTypes.INTEGER.UNSIGNED,
+      allowNull: false,
+      references: {
+        model: ExamRoom,
+        key: "id",
+      },
+      onDelete: "CASCADE",
+    },
+  },
+  {
+    tableName: "student_rooms",
+    timestamps: true,
+    indexes: [
+      {
+        unique: true,
+        fields: ["user_id", "room_id"],
+      },
+    ],
+  }
+);
+
+User.hasMany(StudentRoom, { foreignKey: "user_id" });
+StudentRoom.belongsTo(User, { foreignKey: "user_id" });
+
+ExamRoom.hasMany(StudentRoom, { foreignKey: "room_id" });
+StudentRoom.belongsTo(ExamRoom, { foreignKey: "room_id" });
+
+module.exports = StudentRoom;
diff --git a/backend/src/models/User.js b/backend/src/models/User.js
index 9fc7fc1..0b3084f 100644
--- a/backend/src/models/User.js
+++ b/backend/src/models/User.js
@@ -1,69 +1,69 @@
-const { DataTypes } = require("sequelize");
-const sequelize = require("../config/db");
-
-// --- Model User ---
-const User = sequelize.define(
-  "User",
-  {
-    id: {
-      type: DataTypes.INTEGER.UNSIGNED,
-      autoIncrement: true,
-      primaryKey: true,
-    },
-    full_name: { type: DataTypes.STRING(100), allowNull: false },
-    email: { type: DataTypes.STRING(120), allowNull: false, unique: true },
-    password_hash: { type: DataTypes.STRING(255), allowNull: false },
-    role: {
-      type: DataTypes.ENUM("admin", "instructor", "student"),
-      allowNull: false,
-    },
-    created_at: { type: DataTypes.DATE, defaultValue: DataTypes.NOW },
-    // Optional profile fields added in migrations: keep names matching controller expectations
-    avatar: { type: DataTypes.STRING(255), allowNull: true },
-    // store binary blob and mimetype for streaming avatars
-    avatar_blob: {
-      type: DataTypes.BLOB("long"),
-      allowNull: true,
-      field: "avatar_blob",
-    },
-    avatar_mimetype: {
-      type: DataTypes.STRING(100),
-      allowNull: true,
-      field: "avatar_mimetype",
-    },
-    gender: {
-      type: DataTypes.ENUM("male", "female", "other"),
-      allowNull: true,
-    },
-    address: { type: DataTypes.STRING(255), allowNull: true },
-    // DB column is phone_number in migrations; expose as `phone` on the model for controller compatibility
-    phone: {
-      type: DataTypes.STRING(20),
-      allowNull: true,
-      field: "phone_number",
-    },
-  },
-  { tableName: "users", timestamps: false }
-);
-
-// --- Model UserVerifiedRoom ---
-const UserVerifiedRoom = sequelize.define(
-  "UserVerifiedRoom",
-  {
-    id: {
-      type: DataTypes.INTEGER.UNSIGNED,
-      autoIncrement: true,
-      primaryKey: true,
-    },
-    user_id: { type: DataTypes.INTEGER.UNSIGNED, allowNull: false },
-    exam_room_code: { type: DataTypes.STRING(20), allowNull: false },
-    verified_at: { type: DataTypes.DATE, defaultValue: DataTypes.NOW },
-  },
-  {
-    tableName: "user_verified_rooms",
-    timestamps: false,
-    indexes: [{ unique: true, fields: ["user_id", "exam_room_code"] }],
-  }
-);
-
-module.exports = { User, UserVerifiedRoom };
+const { DataTypes } = require("sequelize");
+const sequelize = require("../config/db");
+
+// --- Model User ---
+const User = sequelize.define(
+  "User",
+  {
+    id: {
+      type: DataTypes.INTEGER.UNSIGNED,
+      autoIncrement: true,
+      primaryKey: true,
+    },
+    full_name: { type: DataTypes.STRING(100), allowNull: false },
+    email: { type: DataTypes.STRING(120), allowNull: false, unique: true },
+    password_hash: { type: DataTypes.STRING(255), allowNull: false },
+    role: {
+      type: DataTypes.ENUM("admin", "instructor", "student"),
+      allowNull: false,
+    },
+    created_at: { type: DataTypes.DATE, defaultValue: DataTypes.NOW },
+    // Optional profile fields added in migrations: keep names matching controller expectations
+    avatar: { type: DataTypes.STRING(255), allowNull: true },
+    // store binary blob and mimetype for streaming avatars
+    avatar_blob: {
+      type: DataTypes.BLOB("long"),
+      allowNull: true,
+      field: "avatar_blob",
+    },
+    avatar_mimetype: {
+      type: DataTypes.STRING(100),
+      allowNull: true,
+      field: "avatar_mimetype",
+    },
+    gender: {
+      type: DataTypes.ENUM("male", "female", "other"),
+      allowNull: true,
+    },
+    address: { type: DataTypes.STRING(255), allowNull: true },
+    // DB column is phone_number in migrations; expose as `phone` on the model for controller compatibility
+    phone: {
+      type: DataTypes.STRING(20),
+      allowNull: true,
+      field: "phone_number",
+    },
+  },
+  { tableName: "users", timestamps: false }
+);
+
+// --- Model UserVerifiedRoom ---
+const UserVerifiedRoom = sequelize.define(
+  "UserVerifiedRoom",
+  {
+    id: {
+      type: DataTypes.INTEGER.UNSIGNED,
+      autoIncrement: true,
+      primaryKey: true,
+    },
+    user_id: { type: DataTypes.INTEGER.UNSIGNED, allowNull: false },
+    exam_room_code: { type: DataTypes.STRING(20), allowNull: false },
+    verified_at: { type: DataTypes.DATE, defaultValue: DataTypes.NOW },
+  },
+  {
+    tableName: "user_verified_rooms",
+    timestamps: false,
+    indexes: [{ unique: true, fields: ["user_id", "exam_room_code"] }],
+  }
+);
+
+module.exports = { User, UserVerifiedRoom };
diff --git a/backend/src/models/index.js b/backend/src/models/index.js
index dc92170..1bf160e 100644
--- a/backend/src/models/index.js
+++ b/backend/src/models/index.js
@@ -1,28 +1,28 @@
-import sequelize from '../config/db.js';
-import User from './User.js';
-import ExamRoom from './ExamRoom.js';
-import StudentRoom from './StudentRoom.js';
-
-const syncDB = async () => {
-  try {
-    await sequelize.authenticate();
-    console.log('DB connected');
-
-    // T·∫°o b·∫£ng theo th·ª© t·ª± ƒë·ªÉ tr√°nh FK l·ªói:
-    await User.sync();
-    await ExamRoom.sync();
-    await StudentRoom.sync();
-
-    console.log('All models synchronized!');
-  } catch (error) {
-    console.error('DB sync error:', error);
-  }
-};
-
-export {
-  sequelize,
-  User,
-  ExamRoom,
-  StudentRoom,
-  syncDB,
-};
+import sequelize from '../config/db.js';
+import User from './User.js';
+import ExamRoom from './ExamRoom.js';
+import StudentRoom from './StudentRoom.js';
+
+const syncDB = async () => {
+  try {
+    await sequelize.authenticate();
+    console.log('DB connected');
+
+    // T·∫°o b·∫£ng theo th·ª© t·ª± ƒë·ªÉ tr√°nh FK l·ªói:
+    await User.sync();
+    await ExamRoom.sync();
+    await StudentRoom.sync();
+
+    console.log('All models synchronized!');
+  } catch (error) {
+    console.error('DB sync error:', error);
+  }
+};
+
+export {
+  sequelize,
+  User,
+  ExamRoom,
+  StudentRoom,
+  syncDB,
+};
diff --git a/backend/src/routes/assignBankRoutes.js b/backend/src/routes/assignBankRoutes.js
index 69b8492..0257dba 100644
--- a/backend/src/routes/assignBankRoutes.js
+++ b/backend/src/routes/assignBankRoutes.js
@@ -1,19 +1,19 @@
-const express = require("express");
-const router = express.Router();
-const { verifyToken } = require("../middleware/authMiddleware");
-const {
-  getExams,
-  getExamDetails,
-  deleteExam,
-  publishExam,
-} = require("../controllers/assignBankController");
-
-router.get("/exams", verifyToken, getExams);
-
-router.get("/exams/:id", verifyToken, getExamDetails);
-
-router.delete("/exams/:id", verifyToken, deleteExam);
-
-router.post("/exams/:id/publish", verifyToken, publishExam);
-
-module.exports = router;
+const express = require("express");
+const router = express.Router();
+const { verifyToken } = require("../middleware/authMiddleware");
+const {
+  getExams,
+  getExamDetails,
+  deleteExam,
+  publishExam,
+} = require("../controllers/assignBankController");
+
+router.get("/exams", verifyToken, getExams);
+
+router.get("/exams/:id", verifyToken, getExamDetails);
+
+router.delete("/exams/:id", verifyToken, deleteExam);
+
+router.post("/exams/:id/publish", verifyToken, publishExam);
+
+module.exports = router;
diff --git a/backend/src/routes/authRoutes.js b/backend/src/routes/authRoutes.js
index 519ad67..66670d2 100644
--- a/backend/src/routes/authRoutes.js
+++ b/backend/src/routes/authRoutes.js
@@ -1,699 +1,699 @@
-const express = require("express");
-const { OAuth2Client } = require("google-auth-library");
-const jwt = require("jsonwebtoken");
-const bcrypt = require("bcryptjs");
-const dotenv = require("dotenv");
-const { User, UserVerifiedRoom } = require("../models/User");
-const dns = require("dns").promises;
-const crypto = require("crypto");
-
-let OTPStore = {};
-const { sendOTPEmail, testEmailConfig } = require("../services/emailService");
-dotenv.config();
-
-const router = express.Router();
-const client = new OAuth2Client(process.env.GOOGLE_CLIENT_ID);
-
-// JWT generator
-const generateToken = (user) =>
-  jwt.sign({ id: user.id, role: user.role }, process.env.JWT_SECRET, {
-    expiresIn: "1h",
-  });
-
-// OTP storage (in production, use Redis or database)
-const otpStorage = new Map();
-
-// Generate 6-digit OTP
-const generateOTP = () => {
-  return Math.floor(100000 + Math.random() * 900000).toString();
-};
-
-// Test email configuration on startup (commented out to avoid blocking)
-// testEmailConfig();
-
-// Helper: l·∫•y exam theo id ho·∫∑c exam_room_code (truy v·∫•n SQL thu·∫ßn ƒë·ªÉ kh√¥ng l·ªá thu·ªôc model c≈©)
-const getExamByRoom = async (roomId) => {
-  const sequelize = require("../config/db");
-  if (!roomId) return null;
-  try {
-    if (/^\d+$/.test(String(roomId))) {
-      const [rows] = await sequelize.query(
-        `SELECT id, title, exam_room_code, status FROM exams WHERE id = ? LIMIT 1`,
-        { replacements: [roomId] }
-      );
-      return Array.isArray(rows) && rows.length ? rows[0] : null;
-    }
-    const [rows] = await sequelize.query(
-      `SELECT id, title, exam_room_code, status FROM exams WHERE exam_room_code = ? LIMIT 1`,
-      { replacements: [roomId] }
-    );
-    return Array.isArray(rows) && rows.length ? rows[0] : null;
-  } catch (e) {
-    console.error('[getExamByRoom] query error', e);
-    return null;
-  }
-};
-
-// --- Send OTP for email verification ---
-router.post("/send-otp", async (req, res) => {
-  try {
-    const { email } = req.body;
-    console.log("[Send OTP] Email:", email);
-
-    if (!email) {
-      return res.status(400).json({
-        message: "Email l√† b·∫Øt bu·ªôc",
-        status: "error",
-      });
-    }
-
-    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
-    if (!emailRegex.test(email)) {
-      return res.status(400).json({
-        message: "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá",
-        status: "error",
-      });
-    }
-
-    const existingUser = await User.findOne({
-      where: { email: email.toLowerCase().trim() },
-    });
-
-    if (existingUser) {
-      return res.status(400).json({
-        message: "Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω",
-        status: "error",
-      });
-    }
-
-    const otp = generateOTP();
-    const expiresAt = new Date(Date.now() + 5 * 60 * 1000); // 5 minutes
-
-    otpStorage.set(email.toLowerCase().trim(), {
-      otp,
-      expiresAt,
-      attempts: 0,
-    });
-
-    const emailResult = await sendOTPEmail(email, otp);
-
-    if (!emailResult.success) {
-      console.error(
-        `[Send OTP] ‚ùå L·ªói g·ª≠i email ƒë·∫øn ${email}:`,
-        emailResult.error
-      );
-      return res.status(500).json({
-        message: "Kh√¥ng th·ªÉ g·ª≠i email. Vui l√≤ng th·ª≠ l·∫°i sau.",
-        status: "error",
-      });
-    }
-
-    console.log(`[Send OTP] ‚úÖ OTP ƒë√£ g·ª≠i ƒë·∫øn ${email}`);
-    res.json({
-      message: "M√£ OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email c·ªßa b·∫°n",
-      status: "success",
-    });
-  } catch (err) {
-    console.error("‚ùå L·ªói g·ª≠i OTP:", err);
-    res.status(500).json({
-      message: "L·ªói server khi g·ª≠i OTP",
-      status: "error",
-    });
-  }
-});
-
-// --- Verify OTP ---
-router.post("/verify-otp", async (req, res) => {
-  try {
-    const { email, otp } = req.body;
-    console.log("[Verify OTP] Email:", email, "OTP:", otp);
-
-    if (!email || !otp) {
-      return res.status(400).json({
-        message: "Email v√† m√£ OTP l√† b·∫Øt bu·ªôc",
-        status: "error",
-      });
-    }
-
-    const emailKey = email.toLowerCase().trim();
-    const otpData = otpStorage.get(emailKey);
-
-    if (!otpData) {
-      return res.status(400).json({
-        message: "M√£ OTP kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ h·∫øt h·∫°n",
-        status: "error",
-      });
-    }
-
-    if (new Date() > otpData.expiresAt) {
-      otpStorage.delete(emailKey);
-      return res.status(400).json({
-        message: "M√£ OTP ƒë√£ h·∫øt h·∫°n",
-        status: "error",
-      });
-    }
-
-    if (otpData.attempts >= 3) {
-      otpStorage.delete(emailKey);
-      return res.status(400).json({
-        message: "ƒê√£ v∆∞·ª£t qu√° s·ªë l·∫ßn th·ª≠. Vui l√≤ng g·ª≠i l·∫°i m√£ OTP",
-        status: "error",
-      });
-    }
-
-    if (otpData.otp !== otp) {
-      otpData.attempts++;
-      otpStorage.set(emailKey, otpData);
-      return res.status(400).json({
-        message: "M√£ OTP kh√¥ng ch√≠nh x√°c",
-        status: "error",
-      });
-    }
-
-    otpData.verified = true;
-    otpStorage.set(emailKey, otpData);
-
-    console.log(`[Verify OTP] ‚úÖ Email ${email} ƒë√£ ƒë∆∞·ª£c x√°c minh`);
-    res.json({
-      message: "Email ƒë√£ ƒë∆∞·ª£c x√°c minh th√†nh c√¥ng",
-      status: "success",
-    });
-  } catch (err) {
-    console.error("‚ùå L·ªói x√°c minh OTP:", err);
-    res.status(500).json({
-      message: "L·ªói server khi x√°c minh OTP",
-      status: "error",
-    });
-  }
-});
-
-// --- Google login / create ---
-router.post("/google", async (req, res) => {
-  console.log("üü¢ [BACKEND] Google login/register API hit!");
-  // console.log("üì© Payload t·ª´ FE:", req.body);
-
-  try {
-    const { idToken, role, roomId } = req.body;
-    if (!idToken || !role)
-      return res
-        .status(400)
-        .json({ message: "Thi·∫øu idToken ho·∫∑c role", status: "error" });
-    if (role === "student" && !roomId)
-      return res
-        .status(400)
-        .json({ message: "H·ªçc vi√™n c·∫ßn m√£ ph√≤ng thi", status: "error" });
-
-    const ticket = await client.verifyIdToken({
-      idToken,
-      audience: process.env.GOOGLE_CLIENT_ID,
-    });
-    const payload = ticket.getPayload();
-    const email = payload.email?.toLowerCase().trim();
-    const full_name = payload.name;
-    console.log(
-      "[Google Login] Verified email:",
-      email,
-      "full_name:",
-      full_name
-    );
-    if (role === "student") console.log("[Google Login] Room ID:", roomId);
-    if (!email || !full_name)
-      return res
-        .status(400)
-        .json({ message: "Google token kh√¥ng h·ª£p l·ªá", status: "error" });
-
-    let user = await User.findOne({ where: { email } });
-
-    if (!user) {
-      user = await User.create({
-        full_name,
-        email,
-        password_hash: await bcrypt.hash(Date.now().toString(), 10),
-        role,
-        created_at: new Date(),
-      });
-
-      if (role === "student") {
-        const exam = await getExamByRoom(roomId);
-        if (!exam)
-          return res
-            .status(400)
-            .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
-
-        await UserVerifiedRoom.create({
-          user_id: user.id,
-          exam_room_code: exam.exam_room_code,
-        });
-      }
-    } else if (role === "student") {
-      const exam = await getExamByRoom(roomId);
-      if (!exam)
-        return res
-          .status(400)
-          .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
-
-      const verified = await UserVerifiedRoom.findOne({
-        where: { user_id: user.id, exam_room_code: exam.exam_room_code },
-      });
-
-      if (!verified) {
-        await UserVerifiedRoom.create({
-          user_id: user.id,
-          exam_room_code: exam.exam_room_code,
-        });
-        console.log("[Google Login] ‚ûï T·ª± ƒë·ªông li√™n k·∫øt user v·ªõi ph√≤ng thi.");
-      }
-    }
-
-    console.log(`[Google Login] ‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng cho ${email}`);
-    const token = generateToken(user);
-    res.json({
-      message: "ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng",
-      status: "success",
-      token,
-      user: { id: user.id, full_name: user.full_name, role: user.role },
-    });
-  } catch (err) {
-    console.error("‚ùå L·ªói Google Login:", err.stack);
-    res
-      .status(500)
-      .json({ message: "L·ªói x√°c th·ª±c Google ho·∫∑c server", status: "error" });
-  }
-});
-
-// --- Register th∆∞·ªùng ---
-router.post("/register", async (req, res) => {
-  try {
-    const { full_name, email, password, role, roomId } = req.body;
-    console.log("[Register] Payload:", req.body);
-    console.log("[Register] Creating user:", full_name, email);
-    if (role === "student") console.log("[Register] Verified Room:", roomId);
-
-    if (!full_name || !email || !password || !role) {
-      console.log("[Register] ‚ùå Thi·∫øu th√¥ng tin ƒëƒÉng k√Ω.");
-      return res
-        .status(400)
-        .json({ message: "Thi·∫øu th√¥ng tin ƒëƒÉng k√Ω", status: "error" });
-    }
-
-    if (role === "student" && !roomId) {
-      console.log("[Register] ‚ùå H·ªçc vi√™n ch∆∞a nh·∫≠p m√£ ph√≤ng thi.");
-      return res
-        .status(400)
-        .json({ message: "H·ªçc vi√™n c·∫ßn m√£ ph√≤ng thi", status: "error" });
-    }
-
-    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
-    if (!emailRegex.test(email)) {
-      console.log(`[Register] ‚ùå Email kh√¥ng h·ª£p l·ªá: ${email}`);
-      return res
-        .status(400)
-        .json({ message: "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá", status: "error" });
-    }
-
-    const domain = email.split("@")[1];
-    try {
-      const mxRecords = await dns.resolveMx(domain);
-      if (!mxRecords || mxRecords.length === 0) {
-        console.log(
-          `[Register] ‚ùå Domain "${domain}" kh√¥ng t·ªìn t·∫°i (MX tr·ªëng).`
-        );
-        return res.status(400).json({
-          message: "Email kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng th·ªÉ nh·∫≠n th∆∞.",
-          status: "error",
-        });
-      }
-      console.log(
-        `[Register] ‚úÖ Domain "${domain}" h·ª£p l·ªá (MX records found).`
-      );
-    } catch (dnsErr) {
-      console.log(
-        `[Register] ‚ùå L·ªói x√°c minh domain "${domain}":`,
-        dnsErr.message
-      );
-      return res.status(400).json({
-        message:
-          "Kh√¥ng th·ªÉ x√°c minh email n√†y. Vui l√≤ng nh·∫≠p email th·∫≠t ho·∫∑c ki·ªÉm tra l·∫°i ch√≠nh t·∫£.",
-        status: "error",
-      });
-    }
-
-    const existingUser = await User.findOne({
-      where: { email: email.toLowerCase().trim() },
-    });
-
-    if (existingUser) {
-      console.log(`[Register] ‚ùå Email ƒë√£ t·ªìn t·∫°i trong h·ªá th·ªëng: ${email}`);
-      return res
-        .status(400)
-        .json({ message: "Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω", status: "error" });
-    }
-
-    const emailKey = email.toLowerCase().trim();
-    const otpData = otpStorage.get(emailKey);
-
-    if (!otpData || !otpData.verified) {
-      console.log(`[Register] ‚ùå Email ch∆∞a ƒë∆∞·ª£c x√°c minh OTP: ${email}`);
-      return res.status(400).json({
-        message:
-          "Email ch∆∞a ƒë∆∞·ª£c x√°c minh. Vui l√≤ng x√°c minh email tr∆∞·ªõc khi ƒëƒÉng k√Ω",
-        status: "error",
-      });
-    }
-
-    const hashedPassword = await bcrypt.hash(password, 10);
-    const newUser = await User.create({
-      full_name,
-      email: email.toLowerCase().trim(),
-      password_hash: hashedPassword,
-      role,
-      created_at: new Date(),
-    });
-
-    console.log(`[Register] ‚úÖ T·∫°o user m·ªõi th√†nh c√¥ng: ${email}`);
-
-    if (role === "student") {
-      try {
-        const exam = await getExamByRoom(roomId);
-        if (!exam) {
-          console.log(`[Register] ‚ùå M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá: ${roomId}`);
-          return res
-            .status(400)
-            .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
-        }
-
-        await UserVerifiedRoom.create({
-          user_id: newUser.id,
-          exam_room_code: exam.exam_room_code,
-        });
-        console.log(
-          `[Register] ‚úÖ ƒê√£ li√™n k·∫øt h·ªçc vi√™n (ID: ${newUser.id}) v·ªõi ph√≤ng thi: ${exam.exam_room_code}`
-        );
-      } catch (examErr) {
-        console.log(
-          `[Register] ‚ö†Ô∏è L·ªói khi x·ª≠ l√Ω m√£ ph√≤ng thi:`,
-          examErr.message
-        );
-        return res
-          .status(500)
-          .json({ message: "L·ªói khi x√°c minh ph√≤ng thi", status: "error" });
-      }
-    }
-
-    otpStorage.delete(emailKey);
-    console.log(`[Register] üóëÔ∏è ƒê√£ x√≥a OTP data cho email: ${email}`);
-
-    const token = generateToken(newUser);
-    console.log(`[Register] üéâ ƒêƒÉng k√Ω th√†nh c√¥ng cho user: ${email}`);
-
-    res.status(201).json({
-      message: "ƒêƒÉng k√Ω th√†nh c√¥ng",
-      status: "success",
-      token,
-      user: {
-        id: newUser.id,
-        full_name: newUser.full_name,
-        role: newUser.role,
-      },
-    });
-  } catch (err) {
-    console.error("‚ùå L·ªói ƒëƒÉng k√Ω:", err);
-    res.status(500).json({ message: "L·ªói server", status: "error" });
-  }
-});
-
-// --- Login th∆∞·ªùng ---
-router.post("/login", async (req, res) => {
-  try {
-    const { email, password, role, roomId } = req.body;
-    console.log("[Login] Payload:", req.body);
-
-    if (!email || !password) {
-      console.log("[Login] ‚ùå Thi·∫øu email ho·∫∑c m·∫≠t kh·∫©u.");
-      return res.status(400).json({
-        message: "Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß email v√† m·∫≠t kh·∫©u",
-        status: "error",
-      });
-    }
-
-    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
-    if (!emailRegex.test(email)) {
-      console.log(`[Login] ‚ùå Email kh√¥ng h·ª£p l·ªá: ${email}`);
-      return res
-        .status(400)
-        .json({ message: "ƒê·ªãa ch·ªâ email kh√¥ng h·ª£p l·ªá", status: "error" });
-    }
-
-    const domain = email.split("@")[1];
-    try {
-      const mxRecords = await dns.resolveMx(domain);
-      if (!mxRecords || mxRecords.length === 0) {
-        console.log(`[Login] ‚ùå Domain email "${domain}" kh√¥ng t·ªìn t·∫°i.`);
-        return res.status(400).json({
-          message: "Email n√†y kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng th·ªÉ nh·∫≠n th∆∞.",
-          status: "error",
-        });
-      }
-      console.log(`[Login] ‚úÖ Domain "${domain}" h·ª£p l·ªá (MX records found).`);
-    } catch (dnsErr) {
-      console.log(
-        `[Login] ‚ùå L·ªói x√°c minh domain "${domain}":`,
-        dnsErr.message
-      );
-      return res.status(400).json({
-        message: "Kh√¥ng th·ªÉ x√°c minh t√™n mi·ªÅn email, vui l√≤ng ki·ªÉm tra l·∫°i.",
-        status: "error",
-      });
-    }
-
-    const user = await User.findOne({
-      where: { email: email.toLowerCase().trim() },
-    });
-
-    if (!user) {
-      console.log(`[Login] ‚ùå Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n v·ªõi email: ${email}`);
-      return res.status(404).json({
-        message: "Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n",
-        status: "error",
-      });
-    }
-
-    const isMatch = await bcrypt.compare(password, user.password_hash);
-    if (!isMatch) {
-      console.log(`[Login] ‚ùå Sai m·∫≠t kh·∫©u cho t√†i kho·∫£n: ${email}`);
-      return res.status(400).json({
-        message: "M·∫≠t kh·∫©u kh√¥ng ch√≠nh x√°c",
-        status: "error",
-      });
-    }
-
-    if (role === "student") {
-      if (!roomId) {
-        console.log("[Login] ‚ùå H·ªçc vi√™n ch∆∞a nh·∫≠p m√£ ph√≤ng thi.");
-        return res
-          .status(400)
-          .json({ message: "H·ªçc vi√™n c·∫ßn m√£ ph√≤ng thi", status: "error" });
-      }
-
-      const exam = await getExamByRoom(roomId);
-      if (!exam) {
-        console.log(`[Login] ‚ùå M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá: ${roomId}`);
-        return res
-          .status(400)
-          .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
-      }
-
-      const verified = await UserVerifiedRoom.findOne({
-        where: { user_id: user.id, exam_room_code: exam.exam_room_code },
-      });
-
-      if (!verified) {
-        await UserVerifiedRoom.create({
-          user_id: user.id,
-          exam_room_code: exam.exam_room_code,
-        });
-        console.log(
-          `[Login] ‚ûï ƒê√£ t·ª± ƒë·ªông li√™n k·∫øt user (ID: ${user.id}) v·ªõi ph√≤ng thi: ${exam.exam_room_code}`
-        );
-      } else {
-        console.log(
-          `[Login] ‚úÖ H·ªçc vi√™n ƒë√£ c√≥ li√™n k·∫øt ph√≤ng thi: ${exam.exam_room_code}`
-        );
-      }
-    }
-
-    const token = generateToken(user);
-    console.log(`[Login] ‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng cho user: ${email}`);
-
-    let response = {
-      message: "ƒêƒÉng nh·∫≠p th√†nh c√¥ng",
-      status: "success",
-      token,
-      user: {
-        id: user.id,
-        full_name: user.full_name,
-        email: user.email,
-        role: user.role,
-      },
-    };
-
-    if (user.role === "admin") {
-      response.redirect = "/admin/dashboard";
-    }
-
-    res.json(response);
-  } catch (err) {
-    console.error("‚ùå L·ªói ƒëƒÉng nh·∫≠p:", err);
-    return res.status(500).json({
-      message: "L·ªói server",
-      status: "error",
-    });
-  }
-});
-
-// --- Verify Room ---
-router.get("/verify-room/:code", async (req, res) => {
-  try {
-    const { code } = req.params;
-    const sequelize = require("../config/db");
-
-    // D√πng truy v·∫•n thu·∫ßn ƒë·ªÉ tr√°nh sai kh√°c model/schema
-    const [rows] = await sequelize.query(
-      `SELECT id, title, exam_room_code, status
-       FROM exams
-       WHERE exam_room_code = ?
-       LIMIT 1`,
-      { replacements: [code] }
-    );
-    const exam = Array.isArray(rows) ? rows[0] : rows;
-
-    if (!exam) {
-      return res.json({ valid: false, message: "M√£ ph√≤ng kh√¥ng h·ª£p l·ªá" });
-    }
-    if (String(exam.status) !== "published") {
-      return res.json({ valid: false, message: "Ph√≤ng thi ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t" });
-    }
-
-    return res.json({
-      valid: true,
-      roomId: exam.exam_room_code,
-      examCode: exam.exam_room_code,
-      title: exam.title,
-    });
-  } catch (err) {
-    console.error("‚ùå L·ªói verify room:", err);
-    return res.status(500).json({ valid: false, message: "L·ªói server" });
-  }
-});
-
-// --- Check email existence before sending OTP ---
-router.post("/check-email", async (req, res) => {
-  try {
-    const { email } = req.body;
-    if (!email) return res.status(400).json({ message: "Email l√† b·∫Øt bu·ªôc" });
-
-    const user = await User.findOne({
-      where: { email: email.toLowerCase().trim() },
-    });
-    res.json({ exists: !!user });
-  } catch (err) {
-    console.error("check-email error:", err);
-    res.status(500).json({ message: "L·ªói server" });
-  }
-});
-
-// --- Send OTP for forgot password ---
-router.post("/forgot-send-otp", async (req, res) => {
-  try {
-    const { email } = req.body;
-    if (!email) {
-      return res.status(400).json({ message: "Email l√† b·∫Øt bu·ªôc" });
-    }
-
-    const cleanEmail = email.toLowerCase().trim();
-    const otp = Math.floor(100000 + Math.random() * 900000)
-      .toString()
-      .padStart(6, "0");
-
-    otpStorage.set(cleanEmail, {
-      otp,
-      expiresAt: Date.now() + 5 * 60 * 1000,
-    });
-
-    const result = await sendOTPEmail(cleanEmail, otp);
-
-    if (result.success) {
-      console.log(`‚úÖ OTP ${otp} ƒë√£ g·ª≠i ƒë·∫øn ${cleanEmail}`);
-      return res.json({ success: true, message: "OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i!" });
-    }
-    return res.status(500).json({ message: "G·ª≠i email th·∫•t b·∫°i" });
-  } catch (err) {
-    console.error("‚ùå forgot-send-otp error:", err);
-    return res.status(500).json({ message: "L·ªói server khi g·ª≠i OTP" });
-  }
-});
-
-router.post("/reset-password", async (req, res) => {
-  try {
-    const { email, newPassword, otp } = req.body;
-
-    if (!email || !newPassword || !otp) {
-      return res.status(400).json({
-        message: "Thi·∫øu th√¥ng tin: email, m·∫≠t kh·∫©u m·ªõi ho·∫∑c m√£ OTP.",
-        status: "error",
-      });
-    }
-
-    const emailKey = email.toLowerCase().trim();
-    const otpData = otpStorage.get(emailKey);
-
-    if (!otpData) {
-      return res.status(400).json({
-        message: "M√£ OTP kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ h·∫øt h·∫°n.",
-        status: "error",
-      });
-    }
-
-    if (Date.now() > otpData.expiresAt) {
-      otpStorage.delete(emailKey);
-      return res.status(400).json({
-        message: "M√£ OTP ƒë√£ h·∫øt h·∫°n.",
-        status: "error",
-      });
-    }
-
-    if (otpData.otp !== otp) {
-      return res.status(400).json({
-        message: "M√£ OTP kh√¥ng ch√≠nh x√°c.",
-        status: "error",
-      });
-    }
-
-    const user = await User.findOne({ where: { email: emailKey } });
-    if (!user) {
-      return res.status(404).json({
-        message: "Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n.",
-        status: "error",
-      });
-    }
-
-    const hashedPassword = await bcrypt.hash(newPassword, 10);
-    await user.update({ password_hash: hashedPassword });
-
-    otpStorage.delete(emailKey);
-    console.log(`[Reset Password] M·∫≠t kh·∫©u ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t l·∫°i cho ${emailKey}`);
-
-    res.json({
-      message: "ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u th√†nh c√¥ng.",
-      status: "success",
-    });
-  } catch (err) {
-    console.error("L·ªói ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u:", err);
-    res.status(500).json({
-      message: "L·ªói server khi ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.",
-      status: "error",
-    });
-  }
-});
-
-module.exports = router;
+const express = require("express");
+const { OAuth2Client } = require("google-auth-library");
+const jwt = require("jsonwebtoken");
+const bcrypt = require("bcryptjs");
+const dotenv = require("dotenv");
+const { User, UserVerifiedRoom } = require("../models/User");
+const dns = require("dns").promises;
+const crypto = require("crypto");
+
+let OTPStore = {};
+const { sendOTPEmail, testEmailConfig } = require("../services/emailService");
+dotenv.config();
+
+const router = express.Router();
+const client = new OAuth2Client(process.env.GOOGLE_CLIENT_ID);
+
+// JWT generator
+const generateToken = (user) =>
+  jwt.sign({ id: user.id, role: user.role }, process.env.JWT_SECRET, {
+    expiresIn: "1h",
+  });
+
+// OTP storage (in production, use Redis or database)
+const otpStorage = new Map();
+
+// Generate 6-digit OTP
+const generateOTP = () => {
+  return Math.floor(100000 + Math.random() * 900000).toString();
+};
+
+// Test email configuration on startup (commented out to avoid blocking)
+// testEmailConfig();
+
+// Helper: l·∫•y exam theo id ho·∫∑c exam_room_code (truy v·∫•n SQL thu·∫ßn ƒë·ªÉ kh√¥ng l·ªá thu·ªôc model c≈©)
+const getExamByRoom = async (roomId) => {
+  const sequelize = require("../config/db");
+  if (!roomId) return null;
+  try {
+    if (/^\d+$/.test(String(roomId))) {
+      const [rows] = await sequelize.query(
+        `SELECT id, title, exam_room_code, status FROM exams WHERE id = ? LIMIT 1`,
+        { replacements: [roomId] }
+      );
+      return Array.isArray(rows) && rows.length ? rows[0] : null;
+    }
+    const [rows] = await sequelize.query(
+      `SELECT id, title, exam_room_code, status FROM exams WHERE exam_room_code = ? LIMIT 1`,
+      { replacements: [roomId] }
+    );
+    return Array.isArray(rows) && rows.length ? rows[0] : null;
+  } catch (e) {
+    console.error('[getExamByRoom] query error', e);
+    return null;
+  }
+};
+
+// --- Send OTP for email verification ---
+router.post("/send-otp", async (req, res) => {
+  try {
+    const { email } = req.body;
+    console.log("[Send OTP] Email:", email);
+
+    if (!email) {
+      return res.status(400).json({
+        message: "Email l√† b·∫Øt bu·ªôc",
+        status: "error",
+      });
+    }
+
+    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
+    if (!emailRegex.test(email)) {
+      return res.status(400).json({
+        message: "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá",
+        status: "error",
+      });
+    }
+
+    const existingUser = await User.findOne({
+      where: { email: email.toLowerCase().trim() },
+    });
+
+    if (existingUser) {
+      return res.status(400).json({
+        message: "Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω",
+        status: "error",
+      });
+    }
+
+    const otp = generateOTP();
+    const expiresAt = new Date(Date.now() + 5 * 60 * 1000); // 5 minutes
+
+    otpStorage.set(email.toLowerCase().trim(), {
+      otp,
+      expiresAt,
+      attempts: 0,
+    });
+
+    const emailResult = await sendOTPEmail(email, otp);
+
+    if (!emailResult.success) {
+      console.error(
+        `[Send OTP] ‚ùå L·ªói g·ª≠i email ƒë·∫øn ${email}:`,
+        emailResult.error
+      );
+      return res.status(500).json({
+        message: "Kh√¥ng th·ªÉ g·ª≠i email. Vui l√≤ng th·ª≠ l·∫°i sau.",
+        status: "error",
+      });
+    }
+
+    console.log(`[Send OTP] ‚úÖ OTP ƒë√£ g·ª≠i ƒë·∫øn ${email}`);
+    res.json({
+      message: "M√£ OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email c·ªßa b·∫°n",
+      status: "success",
+    });
+  } catch (err) {
+    console.error("‚ùå L·ªói g·ª≠i OTP:", err);
+    res.status(500).json({
+      message: "L·ªói server khi g·ª≠i OTP",
+      status: "error",
+    });
+  }
+});
+
+// --- Verify OTP ---
+router.post("/verify-otp", async (req, res) => {
+  try {
+    const { email, otp } = req.body;
+    console.log("[Verify OTP] Email:", email, "OTP:", otp);
+
+    if (!email || !otp) {
+      return res.status(400).json({
+        message: "Email v√† m√£ OTP l√† b·∫Øt bu·ªôc",
+        status: "error",
+      });
+    }
+
+    const emailKey = email.toLowerCase().trim();
+    const otpData = otpStorage.get(emailKey);
+
+    if (!otpData) {
+      return res.status(400).json({
+        message: "M√£ OTP kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ h·∫øt h·∫°n",
+        status: "error",
+      });
+    }
+
+    if (new Date() > otpData.expiresAt) {
+      otpStorage.delete(emailKey);
+      return res.status(400).json({
+        message: "M√£ OTP ƒë√£ h·∫øt h·∫°n",
+        status: "error",
+      });
+    }
+
+    if (otpData.attempts >= 3) {
+      otpStorage.delete(emailKey);
+      return res.status(400).json({
+        message: "ƒê√£ v∆∞·ª£t qu√° s·ªë l·∫ßn th·ª≠. Vui l√≤ng g·ª≠i l·∫°i m√£ OTP",
+        status: "error",
+      });
+    }
+
+    if (otpData.otp !== otp) {
+      otpData.attempts++;
+      otpStorage.set(emailKey, otpData);
+      return res.status(400).json({
+        message: "M√£ OTP kh√¥ng ch√≠nh x√°c",
+        status: "error",
+      });
+    }
+
+    otpData.verified = true;
+    otpStorage.set(emailKey, otpData);
+
+    console.log(`[Verify OTP] ‚úÖ Email ${email} ƒë√£ ƒë∆∞·ª£c x√°c minh`);
+    res.json({
+      message: "Email ƒë√£ ƒë∆∞·ª£c x√°c minh th√†nh c√¥ng",
+      status: "success",
+    });
+  } catch (err) {
+    console.error("‚ùå L·ªói x√°c minh OTP:", err);
+    res.status(500).json({
+      message: "L·ªói server khi x√°c minh OTP",
+      status: "error",
+    });
+  }
+});
+
+// --- Google login / create ---
+router.post("/google", async (req, res) => {
+  console.log("üü¢ [BACKEND] Google login/register API hit!");
+  // console.log("üì© Payload t·ª´ FE:", req.body);
+
+  try {
+    const { idToken, role, roomId } = req.body;
+    if (!idToken || !role)
+      return res
+        .status(400)
+        .json({ message: "Thi·∫øu idToken ho·∫∑c role", status: "error" });
+    if (role === "student" && !roomId)
+      return res
+        .status(400)
+        .json({ message: "H·ªçc vi√™n c·∫ßn m√£ ph√≤ng thi", status: "error" });
+
+    const ticket = await client.verifyIdToken({
+      idToken,
+      audience: process.env.GOOGLE_CLIENT_ID,
+    });
+    const payload = ticket.getPayload();
+    const email = payload.email?.toLowerCase().trim();
+    const full_name = payload.name;
+    console.log(
+      "[Google Login] Verified email:",
+      email,
+      "full_name:",
+      full_name
+    );
+    if (role === "student") console.log("[Google Login] Room ID:", roomId);
+    if (!email || !full_name)
+      return res
+        .status(400)
+        .json({ message: "Google token kh√¥ng h·ª£p l·ªá", status: "error" });
+
+    let user = await User.findOne({ where: { email } });
+
+    if (!user) {
+      user = await User.create({
+        full_name,
+        email,
+        password_hash: await bcrypt.hash(Date.now().toString(), 10),
+        role,
+        created_at: new Date(),
+      });
+
+      if (role === "student") {
+        const exam = await getExamByRoom(roomId);
+        if (!exam)
+          return res
+            .status(400)
+            .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
+
+        await UserVerifiedRoom.create({
+          user_id: user.id,
+          exam_room_code: exam.exam_room_code,
+        });
+      }
+    } else if (role === "student") {
+      const exam = await getExamByRoom(roomId);
+      if (!exam)
+        return res
+          .status(400)
+          .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
+
+      const verified = await UserVerifiedRoom.findOne({
+        where: { user_id: user.id, exam_room_code: exam.exam_room_code },
+      });
+
+      if (!verified) {
+        await UserVerifiedRoom.create({
+          user_id: user.id,
+          exam_room_code: exam.exam_room_code,
+        });
+        console.log("[Google Login] ‚ûï T·ª± ƒë·ªông li√™n k·∫øt user v·ªõi ph√≤ng thi.");
+      }
+    }
+
+    console.log(`[Google Login] ‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng cho ${email}`);
+    const token = generateToken(user);
+    res.json({
+      message: "ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng",
+      status: "success",
+      token,
+      user: { id: user.id, full_name: user.full_name, role: user.role },
+    });
+  } catch (err) {
+    console.error("‚ùå L·ªói Google Login:", err.stack);
+    res
+      .status(500)
+      .json({ message: "L·ªói x√°c th·ª±c Google ho·∫∑c server", status: "error" });
+  }
+});
+
+// --- Register th∆∞·ªùng ---
+router.post("/register", async (req, res) => {
+  try {
+    const { full_name, email, password, role, roomId } = req.body;
+    console.log("[Register] Payload:", req.body);
+    console.log("[Register] Creating user:", full_name, email);
+    if (role === "student") console.log("[Register] Verified Room:", roomId);
+
+    if (!full_name || !email || !password || !role) {
+      console.log("[Register] ‚ùå Thi·∫øu th√¥ng tin ƒëƒÉng k√Ω.");
+      return res
+        .status(400)
+        .json({ message: "Thi·∫øu th√¥ng tin ƒëƒÉng k√Ω", status: "error" });
+    }
+
+    if (role === "student" && !roomId) {
+      console.log("[Register] ‚ùå H·ªçc vi√™n ch∆∞a nh·∫≠p m√£ ph√≤ng thi.");
+      return res
+        .status(400)
+        .json({ message: "H·ªçc vi√™n c·∫ßn m√£ ph√≤ng thi", status: "error" });
+    }
+
+    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
+    if (!emailRegex.test(email)) {
+      console.log(`[Register] ‚ùå Email kh√¥ng h·ª£p l·ªá: ${email}`);
+      return res
+        .status(400)
+        .json({ message: "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá", status: "error" });
+    }
+
+    const domain = email.split("@")[1];
+    try {
+      const mxRecords = await dns.resolveMx(domain);
+      if (!mxRecords || mxRecords.length === 0) {
+        console.log(
+          `[Register] ‚ùå Domain "${domain}" kh√¥ng t·ªìn t·∫°i (MX tr·ªëng).`
+        );
+        return res.status(400).json({
+          message: "Email kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng th·ªÉ nh·∫≠n th∆∞.",
+          status: "error",
+        });
+      }
+      console.log(
+        `[Register] ‚úÖ Domain "${domain}" h·ª£p l·ªá (MX records found).`
+      );
+    } catch (dnsErr) {
+      console.log(
+        `[Register] ‚ùå L·ªói x√°c minh domain "${domain}":`,
+        dnsErr.message
+      );
+      return res.status(400).json({
+        message:
+          "Kh√¥ng th·ªÉ x√°c minh email n√†y. Vui l√≤ng nh·∫≠p email th·∫≠t ho·∫∑c ki·ªÉm tra l·∫°i ch√≠nh t·∫£.",
+        status: "error",
+      });
+    }
+
+    const existingUser = await User.findOne({
+      where: { email: email.toLowerCase().trim() },
+    });
+
+    if (existingUser) {
+      console.log(`[Register] ‚ùå Email ƒë√£ t·ªìn t·∫°i trong h·ªá th·ªëng: ${email}`);
+      return res
+        .status(400)
+        .json({ message: "Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω", status: "error" });
+    }
+
+    const emailKey = email.toLowerCase().trim();
+    const otpData = otpStorage.get(emailKey);
+
+    if (!otpData || !otpData.verified) {
+      console.log(`[Register] ‚ùå Email ch∆∞a ƒë∆∞·ª£c x√°c minh OTP: ${email}`);
+      return res.status(400).json({
+        message:
+          "Email ch∆∞a ƒë∆∞·ª£c x√°c minh. Vui l√≤ng x√°c minh email tr∆∞·ªõc khi ƒëƒÉng k√Ω",
+        status: "error",
+      });
+    }
+
+    const hashedPassword = await bcrypt.hash(password, 10);
+    const newUser = await User.create({
+      full_name,
+      email: email.toLowerCase().trim(),
+      password_hash: hashedPassword,
+      role,
+      created_at: new Date(),
+    });
+
+    console.log(`[Register] ‚úÖ T·∫°o user m·ªõi th√†nh c√¥ng: ${email}`);
+
+    if (role === "student") {
+      try {
+        const exam = await getExamByRoom(roomId);
+        if (!exam) {
+          console.log(`[Register] ‚ùå M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá: ${roomId}`);
+          return res
+            .status(400)
+            .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
+        }
+
+        await UserVerifiedRoom.create({
+          user_id: newUser.id,
+          exam_room_code: exam.exam_room_code,
+        });
+        console.log(
+          `[Register] ‚úÖ ƒê√£ li√™n k·∫øt h·ªçc vi√™n (ID: ${newUser.id}) v·ªõi ph√≤ng thi: ${exam.exam_room_code}`
+        );
+      } catch (examErr) {
+        console.log(
+          `[Register] ‚ö†Ô∏è L·ªói khi x·ª≠ l√Ω m√£ ph√≤ng thi:`,
+          examErr.message
+        );
+        return res
+          .status(500)
+          .json({ message: "L·ªói khi x√°c minh ph√≤ng thi", status: "error" });
+      }
+    }
+
+    otpStorage.delete(emailKey);
+    console.log(`[Register] üóëÔ∏è ƒê√£ x√≥a OTP data cho email: ${email}`);
+
+    const token = generateToken(newUser);
+    console.log(`[Register] üéâ ƒêƒÉng k√Ω th√†nh c√¥ng cho user: ${email}`);
+
+    res.status(201).json({
+      message: "ƒêƒÉng k√Ω th√†nh c√¥ng",
+      status: "success",
+      token,
+      user: {
+        id: newUser.id,
+        full_name: newUser.full_name,
+        role: newUser.role,
+      },
+    });
+  } catch (err) {
+    console.error("‚ùå L·ªói ƒëƒÉng k√Ω:", err);
+    res.status(500).json({ message: "L·ªói server", status: "error" });
+  }
+});
+
+// --- Login th∆∞·ªùng ---
+router.post("/login", async (req, res) => {
+  try {
+    const { email, password, role, roomId } = req.body;
+    console.log("[Login] Payload:", req.body);
+
+    if (!email || !password) {
+      console.log("[Login] ‚ùå Thi·∫øu email ho·∫∑c m·∫≠t kh·∫©u.");
+      return res.status(400).json({
+        message: "Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß email v√† m·∫≠t kh·∫©u",
+        status: "error",
+      });
+    }
+
+    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
+    if (!emailRegex.test(email)) {
+      console.log(`[Login] ‚ùå Email kh√¥ng h·ª£p l·ªá: ${email}`);
+      return res
+        .status(400)
+        .json({ message: "ƒê·ªãa ch·ªâ email kh√¥ng h·ª£p l·ªá", status: "error" });
+    }
+
+    const domain = email.split("@")[1];
+    try {
+      const mxRecords = await dns.resolveMx(domain);
+      if (!mxRecords || mxRecords.length === 0) {
+        console.log(`[Login] ‚ùå Domain email "${domain}" kh√¥ng t·ªìn t·∫°i.`);
+        return res.status(400).json({
+          message: "Email n√†y kh√¥ng t·ªìn t·∫°i ho·∫∑c kh√¥ng th·ªÉ nh·∫≠n th∆∞.",
+          status: "error",
+        });
+      }
+      console.log(`[Login] ‚úÖ Domain "${domain}" h·ª£p l·ªá (MX records found).`);
+    } catch (dnsErr) {
+      console.log(
+        `[Login] ‚ùå L·ªói x√°c minh domain "${domain}":`,
+        dnsErr.message
+      );
+      return res.status(400).json({
+        message: "Kh√¥ng th·ªÉ x√°c minh t√™n mi·ªÅn email, vui l√≤ng ki·ªÉm tra l·∫°i.",
+        status: "error",
+      });
+    }
+
+    const user = await User.findOne({
+      where: { email: email.toLowerCase().trim() },
+    });
+
+    if (!user) {
+      console.log(`[Login] ‚ùå Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n v·ªõi email: ${email}`);
+      return res.status(404).json({
+        message: "Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n",
+        status: "error",
+      });
+    }
+
+    const isMatch = await bcrypt.compare(password, user.password_hash);
+    if (!isMatch) {
+      console.log(`[Login] ‚ùå Sai m·∫≠t kh·∫©u cho t√†i kho·∫£n: ${email}`);
+      return res.status(400).json({
+        message: "M·∫≠t kh·∫©u kh√¥ng ch√≠nh x√°c",
+        status: "error",
+      });
+    }
+
+    if (role === "student") {
+      if (!roomId) {
+        console.log("[Login] ‚ùå H·ªçc vi√™n ch∆∞a nh·∫≠p m√£ ph√≤ng thi.");
+        return res
+          .status(400)
+          .json({ message: "H·ªçc vi√™n c·∫ßn m√£ ph√≤ng thi", status: "error" });
+      }
+
+      const exam = await getExamByRoom(roomId);
+      if (!exam) {
+        console.log(`[Login] ‚ùå M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá: ${roomId}`);
+        return res
+          .status(400)
+          .json({ message: "M√£ ph√≤ng thi kh√¥ng h·ª£p l·ªá", status: "error" });
+      }
+
+      const verified = await UserVerifiedRoom.findOne({
+        where: { user_id: user.id, exam_room_code: exam.exam_room_code },
+      });
+
+      if (!verified) {
+        await UserVerifiedRoom.create({
+          user_id: user.id,
+          exam_room_code: exam.exam_room_code,
+        });
+        console.log(
+          `[Login] ‚ûï ƒê√£ t·ª± ƒë·ªông li√™n k·∫øt user (ID: ${user.id}) v·ªõi ph√≤ng thi: ${exam.exam_room_code}`
+        );
+      } else {
+        console.log(
+          `[Login] ‚úÖ H·ªçc vi√™n ƒë√£ c√≥ li√™n k·∫øt ph√≤ng thi: ${exam.exam_room_code}`
+        );
+      }
+    }
+
+    const token = generateToken(user);
+    console.log(`[Login] ‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng cho user: ${email}`);
+
+    let response = {
+      message: "ƒêƒÉng nh·∫≠p th√†nh c√¥ng",
+      status: "success",
+      token,
+      user: {
+        id: user.id,
+        full_name: user.full_name,
+        email: user.email,
+        role: user.role,
+      },
+    };
+
+    if (user.role === "admin") {
+      response.redirect = "/admin/dashboard";
+    }
+
+    res.json(response);
+  } catch (err) {
+    console.error("‚ùå L·ªói ƒëƒÉng nh·∫≠p:", err);
+    return res.status(500).json({
+      message: "L·ªói server",
+      status: "error",
+    });
+  }
+});
+
+// --- Verify Room ---
+router.get("/verify-room/:code", async (req, res) => {
+  try {
+    const { code } = req.params;
+    const sequelize = require("../config/db");
+
+    // D√πng truy v·∫•n thu·∫ßn ƒë·ªÉ tr√°nh sai kh√°c model/schema
+    const [rows] = await sequelize.query(
+      `SELECT id, title, exam_room_code, status
+       FROM exams
+       WHERE exam_room_code = ?
+       LIMIT 1`,
+      { replacements: [code] }
+    );
+    const exam = Array.isArray(rows) ? rows[0] : rows;
+
+    if (!exam) {
+      return res.json({ valid: false, message: "M√£ ph√≤ng kh√¥ng h·ª£p l·ªá" });
+    }
+    if (String(exam.status) !== "published") {
+      return res.json({ valid: false, message: "Ph√≤ng thi ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t" });
+    }
+
+    return res.json({
+      valid: true,
+      roomId: exam.exam_room_code,
+      examCode: exam.exam_room_code,
+      title: exam.title,
+    });
+  } catch (err) {
+    console.error("‚ùå L·ªói verify room:", err);
+    return res.status(500).json({ valid: false, message: "L·ªói server" });
+  }
+});
+
+// --- Check email existence before sending OTP ---
+router.post("/check-email", async (req, res) => {
+  try {
+    const { email } = req.body;
+    if (!email) return res.status(400).json({ message: "Email l√† b·∫Øt bu·ªôc" });
+
+    const user = await User.findOne({
+      where: { email: email.toLowerCase().trim() },
+    });
+    res.json({ exists: !!user });
+  } catch (err) {
+    console.error("check-email error:", err);
+    res.status(500).json({ message: "L·ªói server" });
+  }
+});
+
+// --- Send OTP for forgot password ---
+router.post("/forgot-send-otp", async (req, res) => {
+  try {
+    const { email } = req.body;
+    if (!email) {
+      return res.status(400).json({ message: "Email l√† b·∫Øt bu·ªôc" });
+    }
+
+    const cleanEmail = email.toLowerCase().trim();
+    const otp = Math.floor(100000 + Math.random() * 900000)
+      .toString()
+      .padStart(6, "0");
+
+    otpStorage.set(cleanEmail, {
+      otp,
+      expiresAt: Date.now() + 5 * 60 * 1000,
+    });
+
+    const result = await sendOTPEmail(cleanEmail, otp);
+
+    if (result.success) {
+      console.log(`‚úÖ OTP ${otp} ƒë√£ g·ª≠i ƒë·∫øn ${cleanEmail}`);
+      return res.json({ success: true, message: "OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i!" });
+    }
+    return res.status(500).json({ message: "G·ª≠i email th·∫•t b·∫°i" });
+  } catch (err) {
+    console.error("‚ùå forgot-send-otp error:", err);
+    return res.status(500).json({ message: "L·ªói server khi g·ª≠i OTP" });
+  }
+});
+
+router.post("/reset-password", async (req, res) => {
+  try {
+    const { email, newPassword, otp } = req.body;
+
+    if (!email || !newPassword || !otp) {
+      return res.status(400).json({
+        message: "Thi·∫øu th√¥ng tin: email, m·∫≠t kh·∫©u m·ªõi ho·∫∑c m√£ OTP.",
+        status: "error",
+      });
+    }
+
+    const emailKey = email.toLowerCase().trim();
+    const otpData = otpStorage.get(emailKey);
+
+    if (!otpData) {
+      return res.status(400).json({
+        message: "M√£ OTP kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ h·∫øt h·∫°n.",
+        status: "error",
+      });
+    }
+
+    if (Date.now() > otpData.expiresAt) {
+      otpStorage.delete(emailKey);
+      return res.status(400).json({
+        message: "M√£ OTP ƒë√£ h·∫øt h·∫°n.",
+        status: "error",
+      });
+    }
+
+    if (otpData.otp !== otp) {
+      return res.status(400).json({
+        message: "M√£ OTP kh√¥ng ch√≠nh x√°c.",
+        status: "error",
+      });
+    }
+
+    const user = await User.findOne({ where: { email: emailKey } });
+    if (!user) {
+      return res.status(404).json({
+        message: "Kh√¥ng t√¨m th·∫•y t√†i kho·∫£n.",
+        status: "error",
+      });
+    }
+
+    const hashedPassword = await bcrypt.hash(newPassword, 10);
+    await user.update({ password_hash: hashedPassword });
+
+    otpStorage.delete(emailKey);
+    console.log(`[Reset Password] M·∫≠t kh·∫©u ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t l·∫°i cho ${emailKey}`);
+
+    res.json({
+      message: "ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u th√†nh c√¥ng.",
+      status: "success",
+    });
+  } catch (err) {
+    console.error("L·ªói ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u:", err);
+    res.status(500).json({
+      message: "L·ªói server khi ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u.",
+      status: "error",
+    });
+  }
+});
+
+module.exports = router;
diff --git a/backend/src/routes/editExamRoutes.js b/backend/src/routes/editExamRoutes.js
index 8478c8c..392864e 100644
--- a/backend/src/routes/editExamRoutes.js
+++ b/backend/src/routes/editExamRoutes.js
@@ -1,13 +1,13 @@
-// routes/editExamRoutes.js
-const express = require("express");
-const router = express.Router();
-const { verifyToken } = require("../middleware/authMiddleware");
-const {
-  getExamForEdit,
-  updateExam,
-} = require("../controllers/editExamController");
-
-router.get("/exams/:id/edit", verifyToken, getExamForEdit);
-router.put("/exams/:id", verifyToken, updateExam);
-
-module.exports = router;
+// routes/editExamRoutes.js
+const express = require("express");
+const router = express.Router();
+const { verifyToken } = require("../middleware/authMiddleware");
+const {
+  getExamForEdit,
+  updateExam,
+} = require("../controllers/editExamController");
+
+router.get("/exams/:id/edit", verifyToken, getExamForEdit);
+router.put("/exams/:id", verifyToken, updateExam);
+
+module.exports = router;
diff --git a/backend/src/routes/examBankRoutes.js b/backend/src/routes/examBankRoutes.js
index 6cab46f..37b77a4 100644
--- a/backend/src/routes/examBankRoutes.js
+++ b/backend/src/routes/examBankRoutes.js
@@ -1,14 +1,14 @@
-const express = require("express");
-const router = express.Router();
-const { importExamQuestions } = require("../controllers/examBankController");
-const { verifyToken, authorizeRole } = require("../middleware/authMiddleware");
-
-// Import exam questions from Excel preview
-router.post(
-  "/import-commit",
-  verifyToken,
-  authorizeRole(["instructor", "admin"]),
-  importExamQuestions
-);
-
-module.exports = router;
+const express = require("express");
+const router = express.Router();
+const { importExamQuestions } = require("../controllers/examBankController");
+const { verifyToken, authorizeRole } = require("../middleware/authMiddleware");
+
+// Import exam questions from Excel preview
+router.post(
+  "/import-commit",
+  verifyToken,
+  authorizeRole(["instructor", "admin"]),
+  importExamQuestions
+);
+
+module.exports = router;
diff --git a/backend/src/routes/examRoomRoutes.js b/backend/src/routes/examRoomRoutes.js
index 65d68ea..4fdcea4 100644
--- a/backend/src/routes/examRoomRoutes.js
+++ b/backend/src/routes/examRoomRoutes.js
@@ -1,12 +1,12 @@
-const express = require("express");
-const router = express.Router();
-const { createExam, verifyExamCode } = require("../controllers/examRoomController");
-const { verifyToken, authorizeRole } = require("../middleware/authMiddleware");
-
-// ‚úÖ Ki·ªÉm tra m√£ ph√≤ng thi (cho sinh vi√™n)
-router.post("/verify", verifyExamCode);
-
-// ‚úÖ T·∫°o ph√≤ng thi (ch·ªâ gi·∫£ng vi√™n)
-router.post("/create", verifyToken, authorizeRole("instructor"), createExam);
-
-module.exports = router;
+const express = require("express");
+const router = express.Router();
+const { createExam, verifyExamCode } = require("../controllers/examRoomController");
+const { verifyToken, authorizeRole } = require("../middleware/authMiddleware");
+
+// ‚úÖ Ki·ªÉm tra m√£ ph√≤ng thi (cho sinh vi√™n)
+router.post("/verify", verifyExamCode);
+
+// ‚úÖ T·∫°o ph√≤ng thi (ch·ªâ gi·∫£ng vi√™n)
+router.post("/create", verifyToken, authorizeRole("instructor"), createExam);
+
+module.exports = router;
diff --git a/backend/src/routes/instructorRoutes.js b/backend/src/routes/instructorRoutes.js
index d39a024..55afeae 100644
--- a/backend/src/routes/instructorRoutes.js
+++ b/backend/src/routes/instructorRoutes.js
@@ -1,500 +1,500 @@
-const express = require("express");
-const router = express.Router();
-const sequelize = require("../config/db");
-const { verifyToken, authorizeRole } = require("../middleware/authMiddleware");
-const crypto = require('crypto');
-
-// ==============================
-// üìä 1Ô∏è‚É£ API: L·∫•y th·ªëng k√™ t·ªïng
-// ==============================
-router.get(
-  "/dashboard",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const instructorId = req.user.id;
-
-      const [results] = await sequelize.query(
-        `
-        SELECT 
-          COUNT(DISTINCT e.id) AS total_exams_created,
-          COUNT(DISTINCT s.id) AS total_tests_submitted,
-          COUNT(DISTINCT s.user_id) AS total_students_participated,
-          AVG(s.total_score) AS avg_score
-        FROM exams e
-        LEFT JOIN submissions s ON s.exam_id = e.id
-        WHERE e.instructor_id = ?;
-        `,
-        { replacements: [instructorId], type: sequelize.QueryTypes.SELECT }
-      );
-
-      res.json(results);
-    } catch (err) {
-      console.error("‚ùå Error fetching dashboard stats:", err);
-      res.status(500).json({ message: "Internal server error" });
-    }
-  }
-);
-
-// =======================================
-// üìÖ 2Ô∏è‚É£ API: L·∫•y th·ªëng k√™ theo th√°ng (T1‚ÄìT12)
-// =======================================
-router.get(
-  "/dashboard/monthly",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const instructorId = req.user.id;
-
-      const rows = await sequelize.query(
-        `
-        SELECT 
-          MONTH(e.created_at) AS month,
-          COUNT(DISTINCT e.id) AS exams_created,
-          COUNT(DISTINCT s.user_id) AS students_participated,
-          COUNT(DISTINCT s.id) AS total_submissions,
-          AVG(s.total_score) AS avg_score
-        FROM exams e
-        LEFT JOIN submissions s ON s.exam_id = e.id
-        WHERE e.instructor_id = ?
-        GROUP BY MONTH(e.created_at)
-        ORDER BY month;
-        `,
-        { replacements: [instructorId], type: sequelize.QueryTypes.SELECT }
-      );
-
-      const fullMonths = Array.from({ length: 12 }, (_, i) => {
-        const m = i + 1;
-        return (
-          rows.find((r) => r.month === m) || {
-            month: m,
-            exams_created: 0,
-            students_participated: 0,
-            total_submissions: 0,
-            avg_score: 0,
-          }
-        );
-      });
-
-      res.json(fullMonths);
-    } catch (err) {
-      console.error("‚ùå Error fetching monthly stats:", err);
-      res.status(500).json({ message: "Internal server error" });
-    }
-  }
-);
-
-
-// ==============================
-// üìÑ 4Ô∏è‚É£ Instructor: Danh s√°ch ƒë·ªÅ thi c·ªßa t√¥i
-// ==============================
-router.get(
-  "/exams/my",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const instructorId = req.user.id;
-      const [rows] = await sequelize.query(
-        `SELECT id, title, status, duration, duration_minutes, time_open, time_close, exam_room_code,
-                require_face_check, require_student_card, monitor_screen, max_points
-         FROM exams WHERE instructor_id = ? ORDER BY id DESC`,
-        { replacements: [instructorId] }
-      );
-      return res.json(rows || []);
-    } catch (err) {
-      console.error('instructor/exams/my error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-
-// ==============================
-// üìä 7Ô∏è‚É£ Results: Helpers
-// ==============================
-async function ensureExamOwnership(examId, instructorId) {
-  const [rows] = await sequelize.query(
-    `SELECT id FROM exams WHERE id = ? AND instructor_id = ? LIMIT 1`,
-    { replacements: [examId, instructorId] }
-  );
-  return Array.isArray(rows) && rows.length > 0;
-}
-
-async function getExamRow(examId) {
-  const [rows] = await sequelize.query(
-    `SELECT id, status, instructor_id FROM exams WHERE id = ? LIMIT 1`,
-    { replacements: [examId] }
-  );
-  return Array.isArray(rows) && rows.length ? rows[0] : null;
-}
-
-// GET /api/instructor/exams/:examId/summary
-router.get(
-  "/exams/:examId/summary",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const examId = parseInt(req.params.examId, 10);
-      if (!Number.isFinite(examId)) return res.status(400).json({ message: 'examId invalid' });
-      const ok = await ensureExamOwnership(examId, req.user.id);
-      if (!ok) {
-        // allow view-only if exam is published (to reduce friction per request)
-        const er = await getExamRow(examId);
-        if (!er || String(er.status) !== 'published') {
-          return res.status(403).json({ message: 'Not owner of exam' });
-        }
-      }
-
-      // Try view v_instructor_exam_bank / v_exam_overview
-      try {
-        const [rows] = await sequelize.query(
-          `SELECT * FROM v_instructor_exam_bank WHERE exam_id = ? LIMIT 1`,
-          { replacements: [examId] }
-        );
-        if (Array.isArray(rows) && rows.length) return res.json(rows[0]);
-      } catch {}
-      try {
-        const [rows] = await sequelize.query(
-          `SELECT * FROM v_exam_overview WHERE exam_id = ? LIMIT 1`,
-          { replacements: [examId] }
-        );
-        if (Array.isArray(rows) && rows.length) return res.json(rows[0]);
-      } catch {}
-      // Fallback quick summary
-      const [[q1]] = await sequelize.query(
-        `SELECT COUNT(*) AS total_submissions, MAX(submitted_at) AS last_submission_time
-         FROM submissions WHERE exam_id = ?`, { replacements: [examId] }
-      );
-      const [[q2]] = await sequelize.query(
-        `SELECT COUNT(DISTINCT user_id) AS total_students FROM submissions WHERE exam_id = ?`,
-        { replacements: [examId] }
-      );
-      return res.json({ exam_id: examId, total_submissions: q1?.total_submissions||0, total_students: q2?.total_students||0, last_submission_time: q1?.last_submission_time || null });
-    } catch (err) {
-      console.error('exams/:examId/summary error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-
-// GET /api/instructor/exams/overview
-router.get(
-  "/exams/overview",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      try {
-        const [rows] = await sequelize.query(
-          `SELECT * FROM v_instructor_stats WHERE instructor_id = ?`,
-          { replacements: [req.user.id] }
-        );
-        if (Array.isArray(rows)) return res.json(rows);
-      } catch {}
-      // Fallback quick stats
-      const [[a]] = await sequelize.query(`SELECT COUNT(*) AS total_exams FROM exams WHERE instructor_id = ?`, { replacements: [req.user.id] });
-      const [[b]] = await sequelize.query(`SELECT COUNT(*) AS total_submissions, AVG(total_score) AS avg_score FROM submissions s JOIN exams e ON e.id=s.exam_id WHERE e.instructor_id = ?`, { replacements: [req.user.id] });
-      const [[c]] = await sequelize.query(`SELECT COUNT(DISTINCT s.user_id) AS total_students FROM submissions s JOIN exams e ON e.id=s.exam_id WHERE e.instructor_id = ?`, { replacements: [req.user.id] });
-      return res.json([{ total_exams: a?.total_exams||0, total_submissions: b?.total_submissions||0, avg_score: b?.avg_score||0, total_students: c?.total_students||0 }]);
-    } catch (err) {
-      console.error('exams/overview error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-
-// GET /api/instructor/exams/:examId/results
-router.get(
-  "/exams/:examId/results",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const examId = parseInt(req.params.examId, 10);
-      if (!Number.isFinite(examId)) return res.status(400).json({ message: 'examId invalid' });
-      const ok = await ensureExamOwnership(examId, req.user.id);
-      if (!ok) {
-        const er = await getExamRow(examId);
-        if (!er || String(er.status) !== 'published') {
-          return res.status(403).json({ message: 'Not owner of exam' });
-        }
-      }
-
-      try {
-        const [rows] = await sequelize.query(`CALL sp_get_exam_results(?, 'instructor', ?);`, { replacements: [examId, req.user.id] });
-        // mysql2/sequelize for CALL may wrap results in multiple arrays
-        let data = [];
-        if (Array.isArray(rows)) {
-          if (Array.isArray(rows[0])) data = rows[0];
-          else data = rows;
-        }
-        return res.json(data);
-      } catch (e) {
-        // Fallback: join basics
-        const [rows] = await sequelize.query(
-          `SELECT 
-              u.full_name AS student_name,
-              s.user_id AS student_id,
-              s.status,
-              s.ai_score,
-              s.total_score,
-              COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) AS mcq_score,
-              COALESCE(s.suggested_total_score, COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) + COALESCE(s.ai_score,0)) AS suggested_total_score,
-              s.started_at,
-              s.submitted_at,
-              TIMESTAMPDIFF(MINUTE, s.started_at, s.submitted_at) AS duration_minutes,
-              s.proctor_flags,
-              s.face_image_url,
-              s.student_card_url
-           FROM submissions s 
-           JOIN users u ON u.id = s.user_id
-           LEFT JOIN student_answers sa ON sa.submission_id = s.id
-           LEFT JOIN exam_questions q ON q.id = sa.question_id
-           WHERE s.exam_id = ?
-           GROUP BY s.id
-           ORDER BY u.full_name`, { replacements: [examId] }
-        );
-        return res.json(rows || []);
-      }
-    } catch (err) {
-      console.error('exams/:examId/results error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-
-// PUT /api/instructor/exams/:examId/students/:studentId/score
-router.put(
-  "/exams/:examId/students/:studentId/score",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const examId = parseInt(req.params.examId, 10);
-      const studentId = parseInt(req.params.studentId, 10);
-      const { mcq_score, ai_score, student_name } = req.body || {};
-      if (!Number.isFinite(examId) || !Number.isFinite(studentId)) return res.status(400).json({ message: 'invalid ids' });
-      const ok = await ensureExamOwnership(examId, req.user.id);
-      if (!ok) {
-        const er = await getExamRow(examId);
-        if (!er || String(er.status) !== 'published') {
-          return res.status(403).json({ message: 'Not owner of exam' });
-        }
-      }
-
-      const mcq = mcq_score != null ? Number(mcq_score) : null;
-      const ai = ai_score != null ? Number(ai_score) : null;
-      if ((mcq != null && isNaN(mcq)) || (ai != null && isNaN(ai))) return res.status(400).json({ message: 'score must be number' });
-
-      try {
-        await sequelize.query(`CALL sp_update_student_exam_record(?, ?, ?, ?, ?);`, { replacements: [examId, studentId, student_name || null, mcq, ai] });
-      } catch (e) {
-        // Fallback direct update
-        await sequelize.query(
-          `UPDATE submissions s SET total_score = ?, ai_score = ?, suggested_total_score = COALESCE(?,0) + COALESCE(?,0), instructor_confirmed = 1, status='confirmed'
-           WHERE s.exam_id = ? AND s.user_id = ?`,
-          { replacements: [mcq, ai, mcq, ai, examId, studentId] }
-        );
-        try {
-          await sequelize.query(
-            `UPDATE results r SET total_score = (SELECT total_score FROM submissions WHERE exam_id=? AND user_id=?), status='confirmed'
-             WHERE r.exam_id = ? AND r.student_id = ?`,
-            { replacements: [examId, studentId, examId, studentId] }
-          );
-        } catch {}
-      }
-      // return updated row
-      try {
-        const [rows] = await sequelize.query(`CALL sp_get_exam_results(?, 'instructor', ?);`, { replacements: [examId, req.user.id] });
-        const data = Array.isArray(rows) ? rows : [];
-        const row = data.find(r => Number(r.student_id) === Number(studentId));
-        return res.json(row || { ok: true });
-      } catch {
-        return res.json({ ok: true });
-      }
-    } catch (err) {
-      console.error('PUT score error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-
-// POST /api/instructor/exams/:examId/confirm-bulk
-router.post(
-  "/exams/:examId/confirm-bulk",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const examId = parseInt(req.params.examId, 10);
-      if (!Number.isFinite(examId)) return res.status(400).json({ message: 'examId invalid' });
-      const ok = await ensureExamOwnership(examId, req.user.id);
-      if (!ok) return res.status(403).json({ message: 'Not owner of exam' });
-      const list = Array.isArray(req.body?.items) ? req.body.items : [];
-      for (const it of list) {
-        const sid = Number(it.studentId);
-        const mcq = it.mcq != null ? Number(it.mcq) : null;
-        const ai = it.ai != null ? Number(it.ai) : null;
-        try { await sequelize.query(`CALL sp_update_student_exam_record(?, ?, ?, ?, ?);`, { replacements: [examId, sid, it.student_name || null, mcq, ai] }); } catch {}
-      }
-      return res.json({ ok: true });
-    } catch (err) {
-      console.error('confirm-bulk error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-// ==============================
-// üîç 5Ô∏è‚É£ Instructor: Xem preview c√¢u h·ªèi m·ªôt ƒë·ªÅ
-// ==============================
-router.get(
-  "/exams/:id/preview",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const examId = parseInt(req.params.id, 10);
-      const ownerCheck = await sequelize.query(
-        `SELECT id FROM exams WHERE id = ? AND instructor_id = ? LIMIT 1`,
-        { replacements: [examId, req.user.id] }
-      );
-      const ok = Array.isArray(ownerCheck[0]) && ownerCheck[0].length > 0;
-      if (!ok) return res.status(404).json({ message: 'Exam not found' });
-
-      // questions
-      const [qRows] = await sequelize.query(
-        `SELECT id AS question_id, question_text, type, points, model_answer FROM exam_questions WHERE exam_id = ? ORDER BY id ASC`,
-        { replacements: [examId] }
-      );
-      const questions = Array.isArray(qRows) ? qRows : [];
-      const ids = questions.filter(q => q.type === 'MCQ').map(q => q.question_id);
-      let optionsByQ = {};
-      if (ids.length) {
-        const [oRows] = await sequelize.query(
-          `SELECT question_id, id AS option_id, option_text, is_correct FROM exam_options WHERE question_id IN (${ids.map(()=>'?').join(',')}) ORDER BY id ASC`,
-          { replacements: ids }
-        );
-        (Array.isArray(oRows) ? oRows : []).forEach(o => {
-          optionsByQ[o.question_id] ||= [];
-          optionsByQ[o.question_id].push(o);
-        });
-      }
-      const merged = questions.map(q => q.type === 'MCQ' ? { ...q, options: optionsByQ[q.question_id] || [] } : q);
-      return res.json({ exam_id: examId, questions: merged });
-    } catch (err) {
-      console.error('instructor/exams/:id/preview error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-
-// ==============================
-// üöÄ 6Ô∏è‚É£ Instructor: M·ªü ph√≤ng thi (publish + c·∫•u h√¨nh)
-// ==============================
-router.post(
-  "/exams/:id/open",
-  verifyToken,
-  authorizeRole(["instructor"]),
-  async (req, res) => {
-    try {
-      const examId = parseInt(req.params.id, 10);
-      const {
-        duration,
-        duration_minutes,
-        time_open,
-        time_close,
-        max_points,
-        require_face_check,
-        require_student_card,
-        monitor_screen,
-      } = req.body || {};
-
-      // owner check
-      const [own] = await sequelize.query(`SELECT id FROM exams WHERE id = ? AND instructor_id = ? LIMIT 1`, { replacements: [examId, req.user.id] });
-      if (!Array.isArray(own) || own.length === 0) return res.status(404).json({ message: 'Exam not found' });
-
-      // validate time
-      const now = new Date();
-      const openAt = time_open ? new Date(time_open) : null;
-      const closeAt = time_close ? new Date(time_close) : null;
-      if (!openAt || !closeAt || isNaN(openAt) || isNaN(closeAt)) {
-        return res.status(400).json({ message: 'time_open/time_close invalid' });
-      }
-      if (openAt.getTime() < now.getTime()) {
-        return res.status(400).json({ message: 'time_open must be now or future' });
-      }
-      if (closeAt.getTime() <= openAt.getTime()) {
-        return res.status(400).json({ message: 'time_close must be after time_open' });
-      }
-
-      // generate 6-char room code (A-Z0-9)
-      const genCode = () => crypto.randomBytes(4).toString('hex').slice(0,6).toUpperCase();
-      let room = genCode();
-      try {
-        // try ensure uniqueness a few times
-        for (let i=0;i<5;i++) {
-          const [r] = await sequelize.query(`SELECT 1 FROM exams WHERE exam_room_code = ? LIMIT 1`, { replacements: [room] });
-          if (!Array.isArray(r) || r.length === 0) break;
-          room = genCode();
-        }
-      } catch {}
-
-      // build update set, mirror duration into duration_minutes when missing
-      const dur = Number(duration || duration_minutes || 0) || null;
-      const durMin = Number(duration_minutes || duration || 0) || null;
-
-      const fmt = (d)=> {
-        // accept ISO/local datetime; format to 'YYYY-MM-DD HH:MM:SS'
-        const pad = (n)=> String(n).padStart(2,'0');
-        const dt = new Date(d);
-        return `${dt.getFullYear()}-${pad(dt.getMonth()+1)}-${pad(dt.getDate())} ${pad(dt.getHours())}:${pad(dt.getMinutes())}:00`;
-      };
-
-      await sequelize.query(
-        `UPDATE exams SET 
-           duration = ?,
-           duration_minutes = ?,
-           status = 'published',
-           exam_room_code = ?,
-           time_open = ?,
-           time_close = ?,
-           max_points = ?,
-           require_face_check = ?,
-           require_student_card = ?,
-           monitor_screen = ?
-         WHERE id = ?`,
-        { replacements: [dur, durMin, room, fmt(openAt), fmt(closeAt), (max_points ?? null), (require_face_check?1:0), (require_student_card?1:0), (monitor_screen?1:0), examId] }
-      );
-
-      return res.json({ ok: true, exam_id: examId, exam_room_code: room, status: 'published' });
-    } catch (err) {
-      console.error('instructor/exams/:id/open error:', err);
-      return res.status(500).json({ message: 'Server error' });
-    }
-  }
-);
-
-
-// =======================================
-// üë§ 3Ô∏è‚É£ API: L·∫•y th√¥ng tin user theo ID
-// =======================================
-router.get("/user/info", verifyToken, async (req, res) => {
-  try {
-    const userId = req.user.id;
-    const [user] = await sequelize.query(
-      "SELECT id, full_name, email, role FROM users WHERE id = ?",
-      { replacements: [userId], type: sequelize.QueryTypes.SELECT }
-    );
-
-    if (!user) return res.status(404).json({ message: "User not found" });
-    res.json(user);
-  } catch (err) {
-    console.error("‚ùå Error fetching user info:", err);
-    res.status(500).json({ message: "Internal server error" });
-  }
-});
-
-module.exports = router;
+const express = require("express");
+const router = express.Router();
+const sequelize = require("../config/db");
+const { verifyToken, authorizeRole } = require("../middleware/authMiddleware");
+const crypto = require('crypto');
+
+// ==============================
+// üìä 1Ô∏è‚É£ API: L·∫•y th·ªëng k√™ t·ªïng
+// ==============================
+router.get(
+  "/dashboard",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const instructorId = req.user.id;
+
+      const [results] = await sequelize.query(
+        `
+        SELECT 
+          COUNT(DISTINCT e.id) AS total_exams_created,
+          COUNT(DISTINCT s.id) AS total_tests_submitted,
+          COUNT(DISTINCT s.user_id) AS total_students_participated,
+          AVG(s.total_score) AS avg_score
+        FROM exams e
+        LEFT JOIN submissions s ON s.exam_id = e.id
+        WHERE e.instructor_id = ?;
+        `,
+        { replacements: [instructorId], type: sequelize.QueryTypes.SELECT }
+      );
+
+      res.json(results);
+    } catch (err) {
+      console.error("‚ùå Error fetching dashboard stats:", err);
+      res.status(500).json({ message: "Internal server error" });
+    }
+  }
+);
+
+// =======================================
+// üìÖ 2Ô∏è‚É£ API: L·∫•y th·ªëng k√™ theo th√°ng (T1‚ÄìT12)
+// =======================================
+router.get(
+  "/dashboard/monthly",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const instructorId = req.user.id;
+
+      const rows = await sequelize.query(
+        `
+        SELECT 
+          MONTH(e.created_at) AS month,
+          COUNT(DISTINCT e.id) AS exams_created,
+          COUNT(DISTINCT s.user_id) AS students_participated,
+          COUNT(DISTINCT s.id) AS total_submissions,
+          AVG(s.total_score) AS avg_score
+        FROM exams e
+        LEFT JOIN submissions s ON s.exam_id = e.id
+        WHERE e.instructor_id = ?
+        GROUP BY MONTH(e.created_at)
+        ORDER BY month;
+        `,
+        { replacements: [instructorId], type: sequelize.QueryTypes.SELECT }
+      );
+
+      const fullMonths = Array.from({ length: 12 }, (_, i) => {
+        const m = i + 1;
+        return (
+          rows.find((r) => r.month === m) || {
+            month: m,
+            exams_created: 0,
+            students_participated: 0,
+            total_submissions: 0,
+            avg_score: 0,
+          }
+        );
+      });
+
+      res.json(fullMonths);
+    } catch (err) {
+      console.error("‚ùå Error fetching monthly stats:", err);
+      res.status(500).json({ message: "Internal server error" });
+    }
+  }
+);
+
+
+// ==============================
+// üìÑ 4Ô∏è‚É£ Instructor: Danh s√°ch ƒë·ªÅ thi c·ªßa t√¥i
+// ==============================
+router.get(
+  "/exams/my",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const instructorId = req.user.id;
+      const [rows] = await sequelize.query(
+        `SELECT id, title, status, duration, duration_minutes, time_open, time_close, exam_room_code,
+                require_face_check, require_student_card, monitor_screen, max_points
+         FROM exams WHERE instructor_id = ? ORDER BY id DESC`,
+        { replacements: [instructorId] }
+      );
+      return res.json(rows || []);
+    } catch (err) {
+      console.error('instructor/exams/my error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+
+// ==============================
+// üìä 7Ô∏è‚É£ Results: Helpers
+// ==============================
+async function ensureExamOwnership(examId, instructorId) {
+  const [rows] = await sequelize.query(
+    `SELECT id FROM exams WHERE id = ? AND instructor_id = ? LIMIT 1`,
+    { replacements: [examId, instructorId] }
+  );
+  return Array.isArray(rows) && rows.length > 0;
+}
+
+async function getExamRow(examId) {
+  const [rows] = await sequelize.query(
+    `SELECT id, status, instructor_id FROM exams WHERE id = ? LIMIT 1`,
+    { replacements: [examId] }
+  );
+  return Array.isArray(rows) && rows.length ? rows[0] : null;
+}
+
+// GET /api/instructor/exams/:examId/summary
+router.get(
+  "/exams/:examId/summary",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const examId = parseInt(req.params.examId, 10);
+      if (!Number.isFinite(examId)) return res.status(400).json({ message: 'examId invalid' });
+      const ok = await ensureExamOwnership(examId, req.user.id);
+      if (!ok) {
+        // allow view-only if exam is published (to reduce friction per request)
+        const er = await getExamRow(examId);
+        if (!er || String(er.status) !== 'published') {
+          return res.status(403).json({ message: 'Not owner of exam' });
+        }
+      }
+
+      // Try view v_instructor_exam_bank / v_exam_overview
+      try {
+        const [rows] = await sequelize.query(
+          `SELECT * FROM v_instructor_exam_bank WHERE exam_id = ? LIMIT 1`,
+          { replacements: [examId] }
+        );
+        if (Array.isArray(rows) && rows.length) return res.json(rows[0]);
+      } catch {}
+      try {
+        const [rows] = await sequelize.query(
+          `SELECT * FROM v_exam_overview WHERE exam_id = ? LIMIT 1`,
+          { replacements: [examId] }
+        );
+        if (Array.isArray(rows) && rows.length) return res.json(rows[0]);
+      } catch {}
+      // Fallback quick summary
+      const [[q1]] = await sequelize.query(
+        `SELECT COUNT(*) AS total_submissions, MAX(submitted_at) AS last_submission_time
+         FROM submissions WHERE exam_id = ?`, { replacements: [examId] }
+      );
+      const [[q2]] = await sequelize.query(
+        `SELECT COUNT(DISTINCT user_id) AS total_students FROM submissions WHERE exam_id = ?`,
+        { replacements: [examId] }
+      );
+      return res.json({ exam_id: examId, total_submissions: q1?.total_submissions||0, total_students: q2?.total_students||0, last_submission_time: q1?.last_submission_time || null });
+    } catch (err) {
+      console.error('exams/:examId/summary error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+
+// GET /api/instructor/exams/overview
+router.get(
+  "/exams/overview",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      try {
+        const [rows] = await sequelize.query(
+          `SELECT * FROM v_instructor_stats WHERE instructor_id = ?`,
+          { replacements: [req.user.id] }
+        );
+        if (Array.isArray(rows)) return res.json(rows);
+      } catch {}
+      // Fallback quick stats
+      const [[a]] = await sequelize.query(`SELECT COUNT(*) AS total_exams FROM exams WHERE instructor_id = ?`, { replacements: [req.user.id] });
+      const [[b]] = await sequelize.query(`SELECT COUNT(*) AS total_submissions, AVG(total_score) AS avg_score FROM submissions s JOIN exams e ON e.id=s.exam_id WHERE e.instructor_id = ?`, { replacements: [req.user.id] });
+      const [[c]] = await sequelize.query(`SELECT COUNT(DISTINCT s.user_id) AS total_students FROM submissions s JOIN exams e ON e.id=s.exam_id WHERE e.instructor_id = ?`, { replacements: [req.user.id] });
+      return res.json([{ total_exams: a?.total_exams||0, total_submissions: b?.total_submissions||0, avg_score: b?.avg_score||0, total_students: c?.total_students||0 }]);
+    } catch (err) {
+      console.error('exams/overview error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+
+// GET /api/instructor/exams/:examId/results
+router.get(
+  "/exams/:examId/results",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const examId = parseInt(req.params.examId, 10);
+      if (!Number.isFinite(examId)) return res.status(400).json({ message: 'examId invalid' });
+      const ok = await ensureExamOwnership(examId, req.user.id);
+      if (!ok) {
+        const er = await getExamRow(examId);
+        if (!er || String(er.status) !== 'published') {
+          return res.status(403).json({ message: 'Not owner of exam' });
+        }
+      }
+
+      try {
+        const [rows] = await sequelize.query(`CALL sp_get_exam_results(?, 'instructor', ?);`, { replacements: [examId, req.user.id] });
+        // mysql2/sequelize for CALL may wrap results in multiple arrays
+        let data = [];
+        if (Array.isArray(rows)) {
+          if (Array.isArray(rows[0])) data = rows[0];
+          else data = rows;
+        }
+        return res.json(data);
+      } catch (e) {
+        // Fallback: join basics
+        const [rows] = await sequelize.query(
+          `SELECT 
+              u.full_name AS student_name,
+              s.user_id AS student_id,
+              s.status,
+              s.ai_score,
+              s.total_score,
+              COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) AS mcq_score,
+              COALESCE(s.suggested_total_score, COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) + COALESCE(s.ai_score,0)) AS suggested_total_score,
+              s.started_at,
+              s.submitted_at,
+              TIMESTAMPDIFF(MINUTE, s.started_at, s.submitted_at) AS duration_minutes,
+              s.proctor_flags,
+              s.face_image_url,
+              s.student_card_url
+           FROM submissions s 
+           JOIN users u ON u.id = s.user_id
+           LEFT JOIN student_answers sa ON sa.submission_id = s.id
+           LEFT JOIN exam_questions q ON q.id = sa.question_id
+           WHERE s.exam_id = ?
+           GROUP BY s.id
+           ORDER BY u.full_name`, { replacements: [examId] }
+        );
+        return res.json(rows || []);
+      }
+    } catch (err) {
+      console.error('exams/:examId/results error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+
+// PUT /api/instructor/exams/:examId/students/:studentId/score
+router.put(
+  "/exams/:examId/students/:studentId/score",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const examId = parseInt(req.params.examId, 10);
+      const studentId = parseInt(req.params.studentId, 10);
+      const { mcq_score, ai_score, student_name } = req.body || {};
+      if (!Number.isFinite(examId) || !Number.isFinite(studentId)) return res.status(400).json({ message: 'invalid ids' });
+      const ok = await ensureExamOwnership(examId, req.user.id);
+      if (!ok) {
+        const er = await getExamRow(examId);
+        if (!er || String(er.status) !== 'published') {
+          return res.status(403).json({ message: 'Not owner of exam' });
+        }
+      }
+
+      const mcq = mcq_score != null ? Number(mcq_score) : null;
+      const ai = ai_score != null ? Number(ai_score) : null;
+      if ((mcq != null && isNaN(mcq)) || (ai != null && isNaN(ai))) return res.status(400).json({ message: 'score must be number' });
+
+      try {
+        await sequelize.query(`CALL sp_update_student_exam_record(?, ?, ?, ?, ?);`, { replacements: [examId, studentId, student_name || null, mcq, ai] });
+      } catch (e) {
+        // Fallback direct update
+        await sequelize.query(
+          `UPDATE submissions s SET total_score = ?, ai_score = ?, suggested_total_score = COALESCE(?,0) + COALESCE(?,0), instructor_confirmed = 1, status='confirmed'
+           WHERE s.exam_id = ? AND s.user_id = ?`,
+          { replacements: [mcq, ai, mcq, ai, examId, studentId] }
+        );
+        try {
+          await sequelize.query(
+            `UPDATE results r SET total_score = (SELECT total_score FROM submissions WHERE exam_id=? AND user_id=?), status='confirmed'
+             WHERE r.exam_id = ? AND r.student_id = ?`,
+            { replacements: [examId, studentId, examId, studentId] }
+          );
+        } catch {}
+      }
+      // return updated row
+      try {
+        const [rows] = await sequelize.query(`CALL sp_get_exam_results(?, 'instructor', ?);`, { replacements: [examId, req.user.id] });
+        const data = Array.isArray(rows) ? rows : [];
+        const row = data.find(r => Number(r.student_id) === Number(studentId));
+        return res.json(row || { ok: true });
+      } catch {
+        return res.json({ ok: true });
+      }
+    } catch (err) {
+      console.error('PUT score error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+
+// POST /api/instructor/exams/:examId/confirm-bulk
+router.post(
+  "/exams/:examId/confirm-bulk",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const examId = parseInt(req.params.examId, 10);
+      if (!Number.isFinite(examId)) return res.status(400).json({ message: 'examId invalid' });
+      const ok = await ensureExamOwnership(examId, req.user.id);
+      if (!ok) return res.status(403).json({ message: 'Not owner of exam' });
+      const list = Array.isArray(req.body?.items) ? req.body.items : [];
+      for (const it of list) {
+        const sid = Number(it.studentId);
+        const mcq = it.mcq != null ? Number(it.mcq) : null;
+        const ai = it.ai != null ? Number(it.ai) : null;
+        try { await sequelize.query(`CALL sp_update_student_exam_record(?, ?, ?, ?, ?);`, { replacements: [examId, sid, it.student_name || null, mcq, ai] }); } catch {}
+      }
+      return res.json({ ok: true });
+    } catch (err) {
+      console.error('confirm-bulk error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+// ==============================
+// üîç 5Ô∏è‚É£ Instructor: Xem preview c√¢u h·ªèi m·ªôt ƒë·ªÅ
+// ==============================
+router.get(
+  "/exams/:id/preview",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const examId = parseInt(req.params.id, 10);
+      const ownerCheck = await sequelize.query(
+        `SELECT id FROM exams WHERE id = ? AND instructor_id = ? LIMIT 1`,
+        { replacements: [examId, req.user.id] }
+      );
+      const ok = Array.isArray(ownerCheck[0]) && ownerCheck[0].length > 0;
+      if (!ok) return res.status(404).json({ message: 'Exam not found' });
+
+      // questions
+      const [qRows] = await sequelize.query(
+        `SELECT id AS question_id, question_text, type, points, model_answer FROM exam_questions WHERE exam_id = ? ORDER BY id ASC`,
+        { replacements: [examId] }
+      );
+      const questions = Array.isArray(qRows) ? qRows : [];
+      const ids = questions.filter(q => q.type === 'MCQ').map(q => q.question_id);
+      let optionsByQ = {};
+      if (ids.length) {
+        const [oRows] = await sequelize.query(
+          `SELECT question_id, id AS option_id, option_text, is_correct FROM exam_options WHERE question_id IN (${ids.map(()=>'?').join(',')}) ORDER BY id ASC`,
+          { replacements: ids }
+        );
+        (Array.isArray(oRows) ? oRows : []).forEach(o => {
+          optionsByQ[o.question_id] ||= [];
+          optionsByQ[o.question_id].push(o);
+        });
+      }
+      const merged = questions.map(q => q.type === 'MCQ' ? { ...q, options: optionsByQ[q.question_id] || [] } : q);
+      return res.json({ exam_id: examId, questions: merged });
+    } catch (err) {
+      console.error('instructor/exams/:id/preview error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+
+// ==============================
+// üöÄ 6Ô∏è‚É£ Instructor: M·ªü ph√≤ng thi (publish + c·∫•u h√¨nh)
+// ==============================
+router.post(
+  "/exams/:id/open",
+  verifyToken,
+  authorizeRole(["instructor"]),
+  async (req, res) => {
+    try {
+      const examId = parseInt(req.params.id, 10);
+      const {
+        duration,
+        duration_minutes,
+        time_open,
+        time_close,
+        max_points,
+        require_face_check,
+        require_student_card,
+        monitor_screen,
+      } = req.body || {};
+
+      // owner check
+      const [own] = await sequelize.query(`SELECT id FROM exams WHERE id = ? AND instructor_id = ? LIMIT 1`, { replacements: [examId, req.user.id] });
+      if (!Array.isArray(own) || own.length === 0) return res.status(404).json({ message: 'Exam not found' });
+
+      // validate time
+      const now = new Date();
+      const openAt = time_open ? new Date(time_open) : null;
+      const closeAt = time_close ? new Date(time_close) : null;
+      if (!openAt || !closeAt || isNaN(openAt) || isNaN(closeAt)) {
+        return res.status(400).json({ message: 'time_open/time_close invalid' });
+      }
+      if (openAt.getTime() < now.getTime()) {
+        return res.status(400).json({ message: 'time_open must be now or future' });
+      }
+      if (closeAt.getTime() <= openAt.getTime()) {
+        return res.status(400).json({ message: 'time_close must be after time_open' });
+      }
+
+      // generate 6-char room code (A-Z0-9)
+      const genCode = () => crypto.randomBytes(4).toString('hex').slice(0,6).toUpperCase();
+      let room = genCode();
+      try {
+        // try ensure uniqueness a few times
+        for (let i=0;i<5;i++) {
+          const [r] = await sequelize.query(`SELECT 1 FROM exams WHERE exam_room_code = ? LIMIT 1`, { replacements: [room] });
+          if (!Array.isArray(r) || r.length === 0) break;
+          room = genCode();
+        }
+      } catch {}
+
+      // build update set, mirror duration into duration_minutes when missing
+      const dur = Number(duration || duration_minutes || 0) || null;
+      const durMin = Number(duration_minutes || duration || 0) || null;
+
+      const fmt = (d)=> {
+        // accept ISO/local datetime; format to 'YYYY-MM-DD HH:MM:SS'
+        const pad = (n)=> String(n).padStart(2,'0');
+        const dt = new Date(d);
+        return `${dt.getFullYear()}-${pad(dt.getMonth()+1)}-${pad(dt.getDate())} ${pad(dt.getHours())}:${pad(dt.getMinutes())}:00`;
+      };
+
+      await sequelize.query(
+        `UPDATE exams SET 
+           duration = ?,
+           duration_minutes = ?,
+           status = 'published',
+           exam_room_code = ?,
+           time_open = ?,
+           time_close = ?,
+           max_points = ?,
+           require_face_check = ?,
+           require_student_card = ?,
+           monitor_screen = ?
+         WHERE id = ?`,
+        { replacements: [dur, durMin, room, fmt(openAt), fmt(closeAt), (max_points ?? null), (require_face_check?1:0), (require_student_card?1:0), (monitor_screen?1:0), examId] }
+      );
+
+      return res.json({ ok: true, exam_id: examId, exam_room_code: room, status: 'published' });
+    } catch (err) {
+      console.error('instructor/exams/:id/open error:', err);
+      return res.status(500).json({ message: 'Server error' });
+    }
+  }
+);
+
+
+// =======================================
+// üë§ 3Ô∏è‚É£ API: L·∫•y th√¥ng tin user theo ID
+// =======================================
+router.get("/user/info", verifyToken, async (req, res) => {
+  try {
+    const userId = req.user.id;
+    const [user] = await sequelize.query(
+      "SELECT id, full_name, email, role FROM users WHERE id = ?",
+      { replacements: [userId], type: sequelize.QueryTypes.SELECT }
+    );
+
+    if (!user) return res.status(404).json({ message: "User not found" });
+    res.json(user);
+  } catch (err) {
+    console.error("‚ùå Error fetching user info:", err);
+    res.status(500).json({ message: "Internal server error" });
+  }
+});
+
+module.exports = router;
diff --git a/backend/src/routes/profileroutes.js b/backend/src/routes/profileroutes.js
index edb97b8..38d506d 100644
--- a/backend/src/routes/profileroutes.js
+++ b/backend/src/routes/profileroutes.js
@@ -1,63 +1,63 @@
-const express = require("express");
-const router = express.Router();
-const { verifyToken } = require("../middleware/authMiddleware");
-const { getProfile, updateProfile, uploadAvatar, getAvatar } = require("../controllers/profileController");
-const multer = require('multer');
-const path = require('path');
-const fs = require('fs');
-
-// Use the uploads directory created by app.js
-const UPLOADS_DIR = path.resolve(__dirname, '..', '..', 'uploads');
-
-// multer storage - save files to backend/uploads
-// Use memory storage so we can optionally save image bytes directly into DB
-const storage = multer.memoryStorage();
-
-// Accept only common image types and limit file size to 5MB
-const upload = multer({
-	storage,
-	limits: { fileSize: 5 * 1024 * 1024 },
-	fileFilter: (req, file, cb) => {
-		// Log mimetype and original name for debugging
-		try {
-			console.log('[multer] incoming file:', { originalname: file.originalname, mimetype: file.mimetype, size: file.size });
-		} catch (e) {
-			console.warn('[multer] failed to log file info', e);
-		}
-
-		if (!file.mimetype || !file.mimetype.startsWith('image/')) {
-			// Reject non-image types but include mimetype in message for debugging
-			return cb(new Error(`Only image uploads are allowed; received: ${file.mimetype || 'unknown'}`));
-		}
-		cb(null, true);
-	}
-});
-
-// L·∫•y th√¥ng tin h·ªì s∆° ng∆∞·ªùi d√πng hi·ªán t·∫°i
-router.get("/", verifyToken, getProfile);
-
-// C·∫≠p nh·∫≠t h·ªì s∆°
-router.put("/", verifyToken, updateProfile);
-
-// Upload avatar (multipart/form-data) - field name: avatar
-router.post('/avatar', verifyToken, upload.single('avatar'), uploadAvatar);
-
-// Serve avatar binary from DB
-router.get('/avatar/:id', getAvatar);
-
-// --- Debug-only route: upload test without auth to verify multer/storage works ---
-// Use this to isolate upload problems (call with form field 'avatar').
-router.post('/avatar-test', upload.single('avatar'), (req, res) => {
-	try {
-		if (!req.file || !req.file.buffer) return res.status(400).json({ success: false, message: 'No file received' });
-		// return a data URL so frontend can verify server received the file (no disk write)
-		const dataUrl = `data:${req.file.mimetype};base64,${req.file.buffer.toString('base64')}`;
-		console.log('[avatar-test] received file', req.file.originalname, 'size=', req.file.size);
-		return res.json({ success: true, message: 'Test upload ok', data: { originalname: req.file.originalname, size: req.file.size, dataUrl } });
-	} catch (err) {
-		console.error('[avatar-test] error', err);
-		return res.status(500).json({ success: false, message: 'Server error' });
-	}
-});
-
-module.exports = router;
+const express = require("express");
+const router = express.Router();
+const { verifyToken } = require("../middleware/authMiddleware");
+const { getProfile, updateProfile, uploadAvatar, getAvatar } = require("../controllers/profileController");
+const multer = require('multer');
+const path = require('path');
+const fs = require('fs');
+
+// Use the uploads directory created by app.js
+const UPLOADS_DIR = path.resolve(__dirname, '..', '..', 'uploads');
+
+// multer storage - save files to backend/uploads
+// Use memory storage so we can optionally save image bytes directly into DB
+const storage = multer.memoryStorage();
+
+// Accept only common image types and limit file size to 5MB
+const upload = multer({
+	storage,
+	limits: { fileSize: 5 * 1024 * 1024 },
+	fileFilter: (req, file, cb) => {
+		// Log mimetype and original name for debugging
+		try {
+			console.log('[multer] incoming file:', { originalname: file.originalname, mimetype: file.mimetype, size: file.size });
+		} catch (e) {
+			console.warn('[multer] failed to log file info', e);
+		}
+
+		if (!file.mimetype || !file.mimetype.startsWith('image/')) {
+			// Reject non-image types but include mimetype in message for debugging
+			return cb(new Error(`Only image uploads are allowed; received: ${file.mimetype || 'unknown'}`));
+		}
+		cb(null, true);
+	}
+});
+
+// L·∫•y th√¥ng tin h·ªì s∆° ng∆∞·ªùi d√πng hi·ªán t·∫°i
+router.get("/", verifyToken, getProfile);
+
+// C·∫≠p nh·∫≠t h·ªì s∆°
+router.put("/", verifyToken, updateProfile);
+
+// Upload avatar (multipart/form-data) - field name: avatar
+router.post('/avatar', verifyToken, upload.single('avatar'), uploadAvatar);
+
+// Serve avatar binary from DB
+router.get('/avatar/:id', getAvatar);
+
+// --- Debug-only route: upload test without auth to verify multer/storage works ---
+// Use this to isolate upload problems (call with form field 'avatar').
+router.post('/avatar-test', upload.single('avatar'), (req, res) => {
+	try {
+		if (!req.file || !req.file.buffer) return res.status(400).json({ success: false, message: 'No file received' });
+		// return a data URL so frontend can verify server received the file (no disk write)
+		const dataUrl = `data:${req.file.mimetype};base64,${req.file.buffer.toString('base64')}`;
+		console.log('[avatar-test] received file', req.file.originalname, 'size=', req.file.size);
+		return res.json({ success: true, message: 'Test upload ok', data: { originalname: req.file.originalname, size: req.file.size, dataUrl } });
+	} catch (err) {
+		console.error('[avatar-test] error', err);
+		return res.status(500).json({ success: false, message: 'Server error' });
+	}
+});
+
+module.exports = router;
diff --git a/backend/src/services/emailService.js b/backend/src/services/emailService.js
index 0f15a44..0501451 100644
--- a/backend/src/services/emailService.js
+++ b/backend/src/services/emailService.js
@@ -1,155 +1,155 @@
-const nodemailer = require("nodemailer");
-
-// C·∫•u h√¨nh email transporter
-const createTransporter = () => {
-  return nodemailer.createTransport({
-    service: "gmail",
-    auth: {
-      user: process.env.EMAIL_USER || "truongkt693@gmail.com",
-      pass: process.env.EMAIL_PASS || "tqdb bzaa cqzd iuwf",
-    },
-  });
-};
-
-// G·ª≠i OTP email cho ng∆∞·ªùi d√πng th√¥ng th∆∞·ªùng
-const sendOTPEmail = async (email, otp) => {
-  try {
-    console.log(`üìß [Email Service] ƒêang g·ª≠i OTP ${otp} ƒë·∫øn ${email}`);
-    const transporter = createTransporter();
-
-    const mailOptions = {
-      from: process.env.EMAIL_USER || "truongkt693@gmail.com",
-      to: email,
-      subject: "M√£ OTP x√°c minh email - OEM Mini Examination",
-      html: `
-        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
-          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
-            <h1 style="color: white; margin: 0; font-size: 28px;">OEM System</h1>
-            <p style="color: white; margin: 10px 0 0 0; font-size: 16px;">X√°c minh email ƒëƒÉng k√Ω</p>
-          </div>
-          
-          <div style="background: #f8f9fa; padding: 30px; border-radius: 0 0 10px 10px;">
-            <h2 style="color: #333; margin-top: 0;">M√£ x√°c minh c·ªßa b·∫°n</h2>
-            <p style="color: #666; font-size: 16px; line-height: 1.6;">
-              Ch√†o b·∫°n!<br>
-              B·∫°n ƒëang ƒëƒÉng k√Ω t√†i kho·∫£n tr√™n h·ªá th·ªëng OEM. ƒê·ªÉ ho√†n t·∫•t qu√° tr√¨nh ƒëƒÉng k√Ω, 
-              vui l√≤ng s·ª≠ d·ª•ng m√£ OTP sau:
-            </p>
-            
-            <div style="background: white; border: 2px dashed #667eea; border-radius: 10px; padding: 20px; margin: 20px 0; text-align: center;">
-              <h1 style="color: #667eea; font-size: 36px; margin: 0; letter-spacing: 5px; font-family: 'Courier New', monospace;">
-                ${otp}
-              </h1>
-            </div>
-            
-            <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; padding: 15px; margin: 20px 0;">
-              <p style="color: #856404; margin: 0; font-size: 14px;">
-                <strong>‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng:</strong><br>
-                ‚Ä¢ M√£ OTP c√≥ hi·ªáu l·ª±c trong 5 ph√∫t<br>
-                ‚Ä¢ Kh√¥ng chia s·∫ª m√£ n√†y v·ªõi b·∫•t k·ª≥ ai<br>
-                ‚Ä¢ N·∫øu b·∫°n kh√¥ng y√™u c·∫ßu m√£ n√†y, vui l√≤ng b·ªè qua email
-              </p>
-            </div>
-            
-            <p style="color: #666; font-size: 14px; margin-top: 30px;">
-              Tr√¢n tr·ªçng,<br>
-              <strong>ƒê·ªôi ng≈© OEM System</strong>
-            </p>
-          </div>
-        </div>
-      `,
-    };
-
-    const result = await transporter.sendMail(mailOptions);
-    console.log(
-      `üìß [Email Service] OTP ƒë√£ g·ª≠i th√†nh c√¥ng ƒë·∫øn ${email}:`,
-      result.messageId
-    );
-    return { success: true, messageId: result.messageId };
-  } catch (error) {
-    console.error("‚ùå [Email Service] L·ªói g·ª≠i email:", error);
-    return { success: false, error: error.message };
-  }
-};
-
-// G·ª≠i OTP email cho t√†i kho·∫£n Admin
-const sendAdminOTPVerificationEmail = async (
-  adminEmail,
-  otpCode,
-  fullName = "Admin"
-) => {
-  try {
-    console.log(
-      `üìß [Admin Email Service] ƒêang g·ª≠i m√£ OTP x√°c minh ƒë·∫øn ${adminEmail}`
-    );
-    const transporter = createTransporter();
-
-    const mailOptions = {
-      from: process.env.EMAIL_USER || "truongkt693@gmail.com",
-      to: adminEmail,
-      subject: "M√£ OTP x√°c minh t√†i kho·∫£n Qu·∫£n tr·ªã - OEM System",
-      html: `
-        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
-          <div style="background: linear-gradient(135deg, #2c5364 0%, #203a43 50%, #0f2027 100%); padding: 25px; text-align: center; border-radius: 10px 10px 0 0;">
-            <h1 style="color: #ffffff; margin: 0; font-size: 24px;">OEM Mini System</h1>
-            <p style="color: #dcdcdc; font-size: 14px;">X√°c minh t√†i kho·∫£n Qu·∫£n tr·ªã</p>
-          </div>
-          <div style="background: #f8f9fa; padding: 25px; border-radius: 0 0 10px 10px;">
-            <p style="color: #333;">Xin ch√†o <strong>${fullName}</strong>,</p>
-            <p style="color: #333;">
-              B·∫°n ƒëang th·ª±c hi·ªán x√°c minh email ƒë·ªÉ t·∫°o t√†i kho·∫£n Qu·∫£n tr·ªã (Admin).<br>
-              Vui l√≤ng s·ª≠ d·ª•ng m√£ OTP d∆∞·ªõi ƒë√¢y ƒë·ªÉ ho√†n t·∫•t b∆∞·ªõc x√°c minh:
-            </p>
-            <div style="background: #fff; border: 2px dashed #203a43; border-radius: 10px; padding: 15px; margin: 20px 0; text-align: center;">
-              <h2 style="color: #203a43; font-family: 'Courier New', monospace; letter-spacing: 4px; font-size: 32px; margin: 0;">
-                ${otpCode}
-              </h2>
-            </div>
-            <p style="color: #555; font-size: 14px;">
-              ‚è∞ M√£ OTP c√≥ hi·ªáu l·ª±c trong <strong>5 ph√∫t</strong> k·ªÉ t·ª´ l√∫c ƒë∆∞·ª£c g·ª≠i.<br>
-              N·∫øu b·∫°n kh√¥ng y√™u c·∫ßu, vui l√≤ng b·ªè qua email n√†y.
-            </p>
-            <p style="color: #444; font-size: 14px; margin-top: 30px;">
-              Tr√¢n tr·ªçng,<br>
-              <strong>ƒê·ªòI NG≈® PH√ÅT TRI·ªÇN OEM SYSTEM</strong>
-            </p>
-          </div>
-        </div>
-      `,
-    };
-
-    const result = await transporter.sendMail(mailOptions);
-    console.log(
-      `‚úÖ [Admin Email Service] G·ª≠i m√£ OTP th√†nh c√¥ng ƒë·∫øn ${adminEmail} | MessageID: ${result.messageId}`
-    );
-    return { success: true, messageId: result.messageId };
-  } catch (error) {
-    console.error(
-      "‚ùå [Admin Email Service] L·ªói khi g·ª≠i m√£ OTP:",
-      error.message
-    );
-    return { success: false, error: error.message };
-  }
-};
-
-// Test email configuration
-const testEmailConfig = async () => {
-  try {
-    const transporter = createTransporter();
-    await transporter.verify();
-    console.log(
-      "‚úÖ [Email Service] C·∫•u h√¨nh email h·ª£p l·ªá - truongkt693@gmail.com"
-    );
-    return true;
-  } catch (error) {
-    console.error("‚ùå [Email Service] L·ªói c·∫•u h√¨nh email:", error.message);
-    console.log("üìñ Ki·ªÉm tra l·∫°i EMAIL_USER v√† EMAIL_PASS");
-    return false;
-  }
-};
-
-module.exports = {
-  sendOTPEmail,
-  sendAdminOTPVerificationEmail,
-  testEmailConfig,
-};
+const nodemailer = require("nodemailer");
+
+// C·∫•u h√¨nh email transporter
+const createTransporter = () => {
+  return nodemailer.createTransport({
+    service: "gmail",
+    auth: {
+      user: process.env.EMAIL_USER || "truongkt693@gmail.com",
+      pass: process.env.EMAIL_PASS || "tqdb bzaa cqzd iuwf",
+    },
+  });
+};
+
+// G·ª≠i OTP email cho ng∆∞·ªùi d√πng th√¥ng th∆∞·ªùng
+const sendOTPEmail = async (email, otp) => {
+  try {
+    console.log(`üìß [Email Service] ƒêang g·ª≠i OTP ${otp} ƒë·∫øn ${email}`);
+    const transporter = createTransporter();
+
+    const mailOptions = {
+      from: process.env.EMAIL_USER || "truongkt693@gmail.com",
+      to: email,
+      subject: "M√£ OTP x√°c minh email - OEM Mini Examination",
+      html: `
+        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
+          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; border-radius: 10px 10px 0 0;">
+            <h1 style="color: white; margin: 0; font-size: 28px;">OEM System</h1>
+            <p style="color: white; margin: 10px 0 0 0; font-size: 16px;">X√°c minh email ƒëƒÉng k√Ω</p>
+          </div>
+          
+          <div style="background: #f8f9fa; padding: 30px; border-radius: 0 0 10px 10px;">
+            <h2 style="color: #333; margin-top: 0;">M√£ x√°c minh c·ªßa b·∫°n</h2>
+            <p style="color: #666; font-size: 16px; line-height: 1.6;">
+              Ch√†o b·∫°n!<br>
+              B·∫°n ƒëang ƒëƒÉng k√Ω t√†i kho·∫£n tr√™n h·ªá th·ªëng OEM. ƒê·ªÉ ho√†n t·∫•t qu√° tr√¨nh ƒëƒÉng k√Ω, 
+              vui l√≤ng s·ª≠ d·ª•ng m√£ OTP sau:
+            </p>
+            
+            <div style="background: white; border: 2px dashed #667eea; border-radius: 10px; padding: 20px; margin: 20px 0; text-align: center;">
+              <h1 style="color: #667eea; font-size: 36px; margin: 0; letter-spacing: 5px; font-family: 'Courier New', monospace;">
+                ${otp}
+              </h1>
+            </div>
+            
+            <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; padding: 15px; margin: 20px 0;">
+              <p style="color: #856404; margin: 0; font-size: 14px;">
+                <strong>‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng:</strong><br>
+                ‚Ä¢ M√£ OTP c√≥ hi·ªáu l·ª±c trong 5 ph√∫t<br>
+                ‚Ä¢ Kh√¥ng chia s·∫ª m√£ n√†y v·ªõi b·∫•t k·ª≥ ai<br>
+                ‚Ä¢ N·∫øu b·∫°n kh√¥ng y√™u c·∫ßu m√£ n√†y, vui l√≤ng b·ªè qua email
+              </p>
+            </div>
+            
+            <p style="color: #666; font-size: 14px; margin-top: 30px;">
+              Tr√¢n tr·ªçng,<br>
+              <strong>ƒê·ªôi ng≈© OEM System</strong>
+            </p>
+          </div>
+        </div>
+      `,
+    };
+
+    const result = await transporter.sendMail(mailOptions);
+    console.log(
+      `üìß [Email Service] OTP ƒë√£ g·ª≠i th√†nh c√¥ng ƒë·∫øn ${email}:`,
+      result.messageId
+    );
+    return { success: true, messageId: result.messageId };
+  } catch (error) {
+    console.error("‚ùå [Email Service] L·ªói g·ª≠i email:", error);
+    return { success: false, error: error.message };
+  }
+};
+
+// G·ª≠i OTP email cho t√†i kho·∫£n Admin
+const sendAdminOTPVerificationEmail = async (
+  adminEmail,
+  otpCode,
+  fullName = "Admin"
+) => {
+  try {
+    console.log(
+      `üìß [Admin Email Service] ƒêang g·ª≠i m√£ OTP x√°c minh ƒë·∫øn ${adminEmail}`
+    );
+    const transporter = createTransporter();
+
+    const mailOptions = {
+      from: process.env.EMAIL_USER || "truongkt693@gmail.com",
+      to: adminEmail,
+      subject: "M√£ OTP x√°c minh t√†i kho·∫£n Qu·∫£n tr·ªã - OEM System",
+      html: `
+        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
+          <div style="background: linear-gradient(135deg, #2c5364 0%, #203a43 50%, #0f2027 100%); padding: 25px; text-align: center; border-radius: 10px 10px 0 0;">
+            <h1 style="color: #ffffff; margin: 0; font-size: 24px;">OEM Mini System</h1>
+            <p style="color: #dcdcdc; font-size: 14px;">X√°c minh t√†i kho·∫£n Qu·∫£n tr·ªã</p>
+          </div>
+          <div style="background: #f8f9fa; padding: 25px; border-radius: 0 0 10px 10px;">
+            <p style="color: #333;">Xin ch√†o <strong>${fullName}</strong>,</p>
+            <p style="color: #333;">
+              B·∫°n ƒëang th·ª±c hi·ªán x√°c minh email ƒë·ªÉ t·∫°o t√†i kho·∫£n Qu·∫£n tr·ªã (Admin).<br>
+              Vui l√≤ng s·ª≠ d·ª•ng m√£ OTP d∆∞·ªõi ƒë√¢y ƒë·ªÉ ho√†n t·∫•t b∆∞·ªõc x√°c minh:
+            </p>
+            <div style="background: #fff; border: 2px dashed #203a43; border-radius: 10px; padding: 15px; margin: 20px 0; text-align: center;">
+              <h2 style="color: #203a43; font-family: 'Courier New', monospace; letter-spacing: 4px; font-size: 32px; margin: 0;">
+                ${otpCode}
+              </h2>
+            </div>
+            <p style="color: #555; font-size: 14px;">
+              ‚è∞ M√£ OTP c√≥ hi·ªáu l·ª±c trong <strong>5 ph√∫t</strong> k·ªÉ t·ª´ l√∫c ƒë∆∞·ª£c g·ª≠i.<br>
+              N·∫øu b·∫°n kh√¥ng y√™u c·∫ßu, vui l√≤ng b·ªè qua email n√†y.
+            </p>
+            <p style="color: #444; font-size: 14px; margin-top: 30px;">
+              Tr√¢n tr·ªçng,<br>
+              <strong>ƒê·ªòI NG≈® PH√ÅT TRI·ªÇN OEM SYSTEM</strong>
+            </p>
+          </div>
+        </div>
+      `,
+    };
+
+    const result = await transporter.sendMail(mailOptions);
+    console.log(
+      `‚úÖ [Admin Email Service] G·ª≠i m√£ OTP th√†nh c√¥ng ƒë·∫øn ${adminEmail} | MessageID: ${result.messageId}`
+    );
+    return { success: true, messageId: result.messageId };
+  } catch (error) {
+    console.error(
+      "‚ùå [Admin Email Service] L·ªói khi g·ª≠i m√£ OTP:",
+      error.message
+    );
+    return { success: false, error: error.message };
+  }
+};
+
+// Test email configuration
+const testEmailConfig = async () => {
+  try {
+    const transporter = createTransporter();
+    await transporter.verify();
+    console.log(
+      "‚úÖ [Email Service] C·∫•u h√¨nh email h·ª£p l·ªá - truongkt693@gmail.com"
+    );
+    return true;
+  } catch (error) {
+    console.error("‚ùå [Email Service] L·ªói c·∫•u h√¨nh email:", error.message);
+    console.log("üìñ Ki·ªÉm tra l·∫°i EMAIL_USER v√† EMAIL_PASS");
+    return false;
+  }
+};
+
+module.exports = {
+  sendOTPEmail,
+  sendAdminOTPVerificationEmail,
+  testEmailConfig,
+};
diff --git a/backend/src/utils/emailValidator.js b/backend/src/utils/emailValidator.js
index 29b6370..d7d15d5 100644
--- a/backend/src/utils/emailValidator.js
+++ b/backend/src/utils/emailValidator.js
@@ -1,54 +1,54 @@
-// ================================
-// üß© OEM Mini - Email Validator Utils
-// ================================
-const dns = require('dns').promises;
-
-/**
- * Kiem tra ten mien email co ton tai thuc su khong (kiem tra MX record)
- * @param {string} email - Dia chi email can kiem tra
- * @returns {Promise<boolean>} - Tra ve true neu hop le, nguoc lai throw Error
- */
-async function validateEmailDomain(email) {
-  try {
-    // Kiem tra dinh dang email co hop le khong (regex don gian)
-    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
-    if (!emailRegex.test(email)) {
-      console.log('‚ùå Email khong dung dinh dang. Vui long nhap lai.');
-      throw new Error('Email khong hop le');
-    }
-
-    // Tach ten mien sau dau @
-    const domain = email.split('@')[1];
-    if (!domain) {
-      console.log('‚ùå Khong tim thay ten mien trong dia chi email.');
-      throw new Error('Email khong hop le');
-    }
-
-    console.log(`üîé Dang kiem tra ten mien: ${domain} ...`);
-
-    // Kiem tra MX record
-    const mxRecords = await dns.resolveMx(domain);
-    if (!mxRecords || mxRecords.length === 0) {
-      console.log('‚ùå Ten mien khong ton tai hoac khong co MX record.');
-      throw new Error('Ten mien email khong hop le');
-    }
-
-    console.log('‚úÖ Ten mien email hop le va co kha nang nhan thu.');
-    return true;
-
-  } catch (error) {
-    // Truong hop domain khong ton tai
-    if (error.code === 'ENOTFOUND') {
-      console.log('‚ùå Ten mien khong ton tai tren he thong DNS.');
-    } else if (error.code === 'ETIMEOUT') {
-      console.log('‚ö†Ô∏è Ket noi DNS bi tre. Thu lai sau.');
-    } else {
-      console.log(`‚ùå Loi xay ra khi kiem tra email: ${error.message}`);
-    }
-    throw error;
-  }
-}
-
-module.exports = {
-  validateEmailDomain
-};
+// ================================
+// üß© OEM Mini - Email Validator Utils
+// ================================
+const dns = require('dns').promises;
+
+/**
+ * Kiem tra ten mien email co ton tai thuc su khong (kiem tra MX record)
+ * @param {string} email - Dia chi email can kiem tra
+ * @returns {Promise<boolean>} - Tra ve true neu hop le, nguoc lai throw Error
+ */
+async function validateEmailDomain(email) {
+  try {
+    // Kiem tra dinh dang email co hop le khong (regex don gian)
+    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
+    if (!emailRegex.test(email)) {
+      console.log('‚ùå Email khong dung dinh dang. Vui long nhap lai.');
+      throw new Error('Email khong hop le');
+    }
+
+    // Tach ten mien sau dau @
+    const domain = email.split('@')[1];
+    if (!domain) {
+      console.log('‚ùå Khong tim thay ten mien trong dia chi email.');
+      throw new Error('Email khong hop le');
+    }
+
+    console.log(`üîé Dang kiem tra ten mien: ${domain} ...`);
+
+    // Kiem tra MX record
+    const mxRecords = await dns.resolveMx(domain);
+    if (!mxRecords || mxRecords.length === 0) {
+      console.log('‚ùå Ten mien khong ton tai hoac khong co MX record.');
+      throw new Error('Ten mien email khong hop le');
+    }
+
+    console.log('‚úÖ Ten mien email hop le va co kha nang nhan thu.');
+    return true;
+
+  } catch (error) {
+    // Truong hop domain khong ton tai
+    if (error.code === 'ENOTFOUND') {
+      console.log('‚ùå Ten mien khong ton tai tren he thong DNS.');
+    } else if (error.code === 'ETIMEOUT') {
+      console.log('‚ö†Ô∏è Ket noi DNS bi tre. Thu lai sau.');
+    } else {
+      console.log(`‚ùå Loi xay ra khi kiem tra email: ${error.message}`);
+    }
+    throw error;
+  }
+}
+
+module.exports = {
+  validateEmailDomain
+};
diff --git a/backend/src/utils/generateToken.js b/backend/src/utils/generateToken.js
index de48219..b7f28ef 100644
--- a/backend/src/utils/generateToken.js
+++ b/backend/src/utils/generateToken.js
@@ -1,12 +1,12 @@
-const jwt = require("jsonwebtoken");
-require("dotenv").config();
-
-function generateAccessToken(payload) {
-  return jwt.sign(payload, process.env.JWT_SECRET, { expiresIn: "15m" });
-}
-
-function generateRefreshToken(payload) {
-  return jwt.sign(payload, process.env.JWT_REFRESH_SECRET, { expiresIn: "7d" });
-}
-
-module.exports = { generateAccessToken, generateRefreshToken };
+const jwt = require("jsonwebtoken");
+require("dotenv").config();
+
+function generateAccessToken(payload) {
+  return jwt.sign(payload, process.env.JWT_SECRET, { expiresIn: "15m" });
+}
+
+function generateRefreshToken(payload) {
+  return jwt.sign(payload, process.env.JWT_REFRESH_SECRET, { expiresIn: "7d" });
+}
+
+module.exports = { generateAccessToken, generateRefreshToken };
diff --git a/backend/src/utils/timeAgo.js b/backend/src/utils/timeAgo.js
index b095014..628993b 100644
--- a/backend/src/utils/timeAgo.js
+++ b/backend/src/utils/timeAgo.js
@@ -1,11 +1,11 @@
-// utils/timeAgo.js
-export const timeAgo = (dateString) => {
-  const now = new Date();
-  const past = new Date(dateString);
-  const diff = Math.floor((now - past) / 1000);
-
-  if (diff < 60) return `${diff} gi√¢y tr∆∞·ªõc`;
-  if (diff < 3600) return `${Math.floor(diff / 60)} ph√∫t tr∆∞·ªõc`;
-  if (diff < 86400) return `${Math.floor(diff / 3600)} gi·ªù tr∆∞·ªõc`;
-  return `${Math.floor(diff / 86400)} ng√†y tr∆∞·ªõc`;
-};
+// utils/timeAgo.js
+export const timeAgo = (dateString) => {
+  const now = new Date();
+  const past = new Date(dateString);
+  const diff = Math.floor((now - past) / 1000);
+
+  if (diff < 60) return `${diff} gi√¢y tr∆∞·ªõc`;
+  if (diff < 3600) return `${Math.floor(diff / 60)} ph√∫t tr∆∞·ªõc`;
+  if (diff < 86400) return `${Math.floor(diff / 3600)} gi·ªù tr∆∞·ªõc`;
+  return `${Math.floor(diff / 86400)} ng√†y tr∆∞·ªõc`;
+};
diff --git a/backend/test.http b/backend/test.http
index dd5ef21..1cf4a5d 100644
--- a/backend/test.http
+++ b/backend/test.http
@@ -1,11 +1,11 @@
-### ƒêƒÉng k√Ω t√†i kho·∫£n instructor
-POST http://localhost:5000/api/auth/register
-Content-Type: application/json
-
-{
-  "firstName": "L·ª±c",
-  "lastName": "Tr·∫ßn",
-  "email": "luc2@gv.com",
-  "password": "123456",
-  "role": "instructor"
-}
+### ƒêƒÉng k√Ω t√†i kho·∫£n instructor
+POST http://localhost:5000/api/auth/register
+Content-Type: application/json
+
+{
+  "firstName": "L·ª±c",
+  "lastName": "Tr·∫ßn",
+  "email": "luc2@gv.com",
+  "password": "123456",
+  "role": "instructor"
+}
diff --git a/backend/test_db.js b/backend/test_db.js
index 04dc4bb..8e1aef7 100644
--- a/backend/test_db.js
+++ b/backend/test_db.js
@@ -1,20 +1,20 @@
-// test_db.js
-require("dotenv").config();
-const sequelize = require("./src/config/db");
-
-(async () => {
-  try {
-    await sequelize.authenticate();
-    console.log("‚úÖ ƒê√£ k·∫øt n·ªëi t·ªõi MySQL Database:", process.env.DB_NAME);
-
-    const [results] = await sequelize.query("SELECT NOW() AS currentTime;");
-    console.log(
-      "üïí K·∫øt n·ªëi th√†nh c√¥ng! Th·ªùi gian hi·ªán t·∫°i:",
-      results[0].currentTime
-    );
-  } catch (error) {
-    console.error("‚ùå K·∫øt n·ªëi MySQL th·∫•t b·∫°i:", error.message);
-  } finally {
-    await sequelize.close();
-  }
-})();
+// test_db.js
+require("dotenv").config();
+const sequelize = require("./src/config/db");
+
+(async () => {
+  try {
+    await sequelize.authenticate();
+    console.log("‚úÖ ƒê√£ k·∫øt n·ªëi t·ªõi MySQL Database:", process.env.DB_NAME);
+
+    const [results] = await sequelize.query("SELECT NOW() AS currentTime;");
+    console.log(
+      "üïí K·∫øt n·ªëi th√†nh c√¥ng! Th·ªùi gian hi·ªán t·∫°i:",
+      results[0].currentTime
+    );
+  } catch (error) {
+    console.error("‚ùå K·∫øt n·ªëi MySQL th·∫•t b·∫°i:", error.message);
+  } finally {
+    await sequelize.close();
+  }
+})();
diff --git a/database/README.md b/database/README.md
index 410733b..b6d36ca 100644
--- a/database/README.md
+++ b/database/README.md
@@ -1,92 +1,92 @@
-# üß© OEM Mini Database Setup Guide
-
-> D√†nh cho nh√≥m d·ª± √°n **OEM Mini (Online Examination Management System)**  
-> H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t v√† k·∫øt n·ªëi MySQL database cho to√†n b·ªô th√†nh vi√™n trong team.
-
----
-
-## ‚öôÔ∏è 1Ô∏è‚É£ Y√™u c·∫ßu m√¥i tr∆∞·ªùng
-
-Tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu, ƒë·∫£m b·∫£o m√°y c·ªßa b·∫°n ƒë√£ c√≥:
-
-- ‚úÖ **MySQL Server** (phi√™n b·∫£n 8.0.x tr·ªü l√™n)
-- ‚úÖ **MySQL Workbench** ho·∫∑c **XAMPP / Laragon** (n·∫øu b·∫°n d√πng MariaDB)
-- ‚úÖ **Node.js** (phi√™n b·∫£n 18.x ho·∫∑c 20.x)
-- ‚úÖ ƒê√£ clone repository c·ªßa d·ª± √°n v·ªÅ m√°y
-
----
-
-## üìÅ 2Ô∏è‚É£ C·∫•u tr√∫c th∆∞ m·ª•c `database/`
-
-| File | M√¥ t·∫£ |
-|------|-------|
-| `oem_migration_v5` | T·∫°o c·∫•u tr√∫c database (b·∫£ng, kh√≥a, view, v.v.) |
-| `test_oem_v5` | Th√™m d·ªØ li·ªáu m·∫´u ban ƒë·∫ßu (admin, instructor, student, v.v.) 
-|v√† Ki·ªÉm tra d·ªØ li·ªáu sau khi import |
-
----
-
-## üß± 3Ô∏è‚É£ C√°c b∆∞·ªõc import database
-
-### üîπ C√°ch 1 ‚Äî D√πng **MySQL Workbench**
-
-1. M·ªü **MySQL Workbench**
-2. K·∫øt n·ªëi ƒë·∫øn server MySQL (user: `root` ho·∫∑c user c·ªßa b·∫°n)
-3. V√†o menu **File ‚Üí Open SQL Script...**
-4. Ch·ªçn file `oem_migration_v5` ‚Üí nh·∫•n **Run (Ctrl+Shift+Enter)**
-5. Cu·ªëi c√πng, l√†m t∆∞∆°ng t·ª± v·ªõi file `test_oem_v5` v√†v√† c√≥ th·ªÉ ch·∫°y `test_oem_v5` ƒë·ªÉ ki·ªÉm tra d·ªØ li·ªáu m·∫´u
-
-> Sau khi ho√†n t·∫•t, b·∫°n s·∫Ω th·∫•y database **`oem_mini`** xu·∫•t hi·ªán trong sidebar.
-
----
-
-### üîπ C√°ch 2 ‚Äî D√πng **Command Line (CMD / PowerShell)**
-
-M·ªü terminal t·∫°i th∆∞ m·ª•c `/database` v√† ch·∫°y:
-
-```bash
-mysql -u root -p < oem_migration_v5.sql
-mysql -u root -p < test_oem_v5.sql
-```
-
----
-
-## üß™ 4Ô∏è‚É£ Test k·∫øt n·ªëi database
-
-Sau khi ƒë√£ import database th√†nh c√¥ng, b·∫°n c√≥ th·ªÉ test k·∫øt n·ªëi b·∫±ng c√°ch ch·∫°y file `test_db.js`:
-
-### üîπ C√°ch test k·∫øt n·ªëi
-
-1. M·ªü terminal t·∫°i th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n
-2. Di chuy·ªÉn v√†o th∆∞ m·ª•c `backend`:
-   ```bash
-   cd backend
-   ```
-3. Ch·∫°y l·ªánh test k·∫øt n·ªëi:
-   ```bash
-   node test_db.js
-   ```
-
-### üîπ K·∫øt qu·∫£ mong ƒë·ª£i
-
-**‚úÖ K·∫øt n·ªëi th√†nh c√¥ng:**
-```
-[dotenv@17.2.3] injecting env (5) from .env
-‚úÖ ƒê√£ k·∫øt n·ªëi t·ªõi MySQL Database: oem_mini
-üïí K·∫øt n·ªëi th√†nh c√¥ng! Th·ªùi gian hi·ªán t·∫°i: 2025-10-10T18:35:30.000Z
-```
-
-**‚ùå L·ªói k·∫øt n·ªëi:**
-```
-‚ùå L·ªói khi truy v·∫•n: Error: Unknown database 'oem_mini'
-‚ùå K·∫øt n·ªëi MySQL th·∫•t b·∫°i: Unknown database 'oem_mini'
-```
-
-### üîπ X·ª≠ l√Ω l·ªói
-
-N·∫øu g·∫∑p l·ªói "Unknown database 'oem_mini'":
-- Ki·ªÉm tra xem ƒë√£ import file `oem_migration_v5.sql` ch∆∞a
-- ƒê·∫£m b·∫£o MySQL server ƒëang ch·∫°y
-- Ki·ªÉm tra file `.env` trong th∆∞ m·ª•c `backend` c√≥ ƒë√∫ng th√¥ng tin k·∫øt n·ªëi kh√¥ng
-
+# üß© OEM Mini Database Setup Guide
+
+> D√†nh cho nh√≥m d·ª± √°n **OEM Mini (Online Examination Management System)**  
+> H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t v√† k·∫øt n·ªëi MySQL database cho to√†n b·ªô th√†nh vi√™n trong team.
+
+---
+
+## ‚öôÔ∏è 1Ô∏è‚É£ Y√™u c·∫ßu m√¥i tr∆∞·ªùng
+
+Tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu, ƒë·∫£m b·∫£o m√°y c·ªßa b·∫°n ƒë√£ c√≥:
+
+- ‚úÖ **MySQL Server** (phi√™n b·∫£n 8.0.x tr·ªü l√™n)
+- ‚úÖ **MySQL Workbench** ho·∫∑c **XAMPP / Laragon** (n·∫øu b·∫°n d√πng MariaDB)
+- ‚úÖ **Node.js** (phi√™n b·∫£n 18.x ho·∫∑c 20.x)
+- ‚úÖ ƒê√£ clone repository c·ªßa d·ª± √°n v·ªÅ m√°y
+
+---
+
+## üìÅ 2Ô∏è‚É£ C·∫•u tr√∫c th∆∞ m·ª•c `database/`
+
+| File | M√¥ t·∫£ |
+|------|-------|
+| `oem_migration_v5` | T·∫°o c·∫•u tr√∫c database (b·∫£ng, kh√≥a, view, v.v.) |
+| `test_oem_v5` | Th√™m d·ªØ li·ªáu m·∫´u ban ƒë·∫ßu (admin, instructor, student, v.v.) 
+|v√† Ki·ªÉm tra d·ªØ li·ªáu sau khi import |
+
+---
+
+## üß± 3Ô∏è‚É£ C√°c b∆∞·ªõc import database
+
+### üîπ C√°ch 1 ‚Äî D√πng **MySQL Workbench**
+
+1. M·ªü **MySQL Workbench**
+2. K·∫øt n·ªëi ƒë·∫øn server MySQL (user: `root` ho·∫∑c user c·ªßa b·∫°n)
+3. V√†o menu **File ‚Üí Open SQL Script...**
+4. Ch·ªçn file `oem_migration_v5` ‚Üí nh·∫•n **Run (Ctrl+Shift+Enter)**
+5. Cu·ªëi c√πng, l√†m t∆∞∆°ng t·ª± v·ªõi file `test_oem_v5` v√†v√† c√≥ th·ªÉ ch·∫°y `test_oem_v5` ƒë·ªÉ ki·ªÉm tra d·ªØ li·ªáu m·∫´u
+
+> Sau khi ho√†n t·∫•t, b·∫°n s·∫Ω th·∫•y database **`oem_mini`** xu·∫•t hi·ªán trong sidebar.
+
+---
+
+### üîπ C√°ch 2 ‚Äî D√πng **Command Line (CMD / PowerShell)**
+
+M·ªü terminal t·∫°i th∆∞ m·ª•c `/database` v√† ch·∫°y:
+
+```bash
+mysql -u root -p < oem_migration_v5.sql
+mysql -u root -p < test_oem_v5.sql
+```
+
+---
+
+## üß™ 4Ô∏è‚É£ Test k·∫øt n·ªëi database
+
+Sau khi ƒë√£ import database th√†nh c√¥ng, b·∫°n c√≥ th·ªÉ test k·∫øt n·ªëi b·∫±ng c√°ch ch·∫°y file `test_db.js`:
+
+### üîπ C√°ch test k·∫øt n·ªëi
+
+1. M·ªü terminal t·∫°i th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n
+2. Di chuy·ªÉn v√†o th∆∞ m·ª•c `backend`:
+   ```bash
+   cd backend
+   ```
+3. Ch·∫°y l·ªánh test k·∫øt n·ªëi:
+   ```bash
+   node test_db.js
+   ```
+
+### üîπ K·∫øt qu·∫£ mong ƒë·ª£i
+
+**‚úÖ K·∫øt n·ªëi th√†nh c√¥ng:**
+```
+[dotenv@17.2.3] injecting env (5) from .env
+‚úÖ ƒê√£ k·∫øt n·ªëi t·ªõi MySQL Database: oem_mini
+üïí K·∫øt n·ªëi th√†nh c√¥ng! Th·ªùi gian hi·ªán t·∫°i: 2025-10-10T18:35:30.000Z
+```
+
+**‚ùå L·ªói k·∫øt n·ªëi:**
+```
+‚ùå L·ªói khi truy v·∫•n: Error: Unknown database 'oem_mini'
+‚ùå K·∫øt n·ªëi MySQL th·∫•t b·∫°i: Unknown database 'oem_mini'
+```
+
+### üîπ X·ª≠ l√Ω l·ªói
+
+N·∫øu g·∫∑p l·ªói "Unknown database 'oem_mini'":
+- Ki·ªÉm tra xem ƒë√£ import file `oem_migration_v5.sql` ch∆∞a
+- ƒê·∫£m b·∫£o MySQL server ƒëang ch·∫°y
+- Ki·ªÉm tra file `.env` trong th∆∞ m·ª•c `backend` c√≥ ƒë√∫ng th√¥ng tin k·∫øt n·ªëi kh√¥ng
+
 ---
\ No newline at end of file
diff --git a/database/oem_migration_v5.sql b/database/oem_migration_v5.sql
index cc61e69..292c34a 100644
--- a/database/oem_migration_v5.sql
+++ b/database/oem_migration_v5.sql
@@ -1,1296 +1,1296 @@
--- ============================================================================
--- üß© OEM Mini Database Schema (v5 - Instructor Final Version)
--- Engine: MySQL 8.0.x
--- Charset: utf8mb4 / utf8mb4_unicode_ci
--- Author: OEM Mini Team (Capstone Project 2025 - CMU-SE)
--- ============================================================================
-
-DROP DATABASE IF EXISTS oem_mini;
-CREATE DATABASE oem_mini CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
-USE oem_mini;
-
--- ============================================================================
--- TABLES
--- ============================================================================
-
--- 1) users
-CREATE TABLE users (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    full_name VARCHAR(100) NOT NULL,
-    email VARCHAR(120) NOT NULL UNIQUE,
-    password_hash VARCHAR(255) NOT NULL,
-    avatar VARCHAR(255) NULL,
-    avatar_blob LONGBLOB NULL,
-    avatar_mimetype VARCHAR(100) NULL,
-    gender ENUM('male','female','other') NULL,
-    address VARCHAR(255) NULL,
-    phone_number VARCHAR(20) NULL,
-    role ENUM('admin','instructor','student') NOT NULL,
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    verify_room_code BOOLEAN DEFAULT FALSE,
-    INDEX idx_users_role (role)
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 2) courses
-CREATE TABLE courses (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    title VARCHAR(100) NOT NULL,
-    description TEXT NULL,
-    instructor_id INT UNSIGNED NOT NULL,
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    INDEX idx_courses_instructor (instructor_id),
-    CONSTRAINT fk_courses_instructor
-        FOREIGN KEY (instructor_id) REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE RESTRICT
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
-
--- 3) exams
-CREATE TABLE exams (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    course_id INT UNSIGNED NULL,                
-    instructor_id INT UNSIGNED NULL,            
-    title VARCHAR(100) NOT NULL,
-    duration INT NOT NULL CHECK (duration > 0),
-    exam_room_code VARCHAR(64) NULL,
-    status ENUM('draft','published','archived') DEFAULT 'draft',
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
-    UNIQUE KEY uq_exams_room_code (exam_room_code),
-    INDEX idx_exams_course (course_id),
-    INDEX idx_exams_instructor (instructor_id),
-    CONSTRAINT fk_exams_course
-        FOREIGN KEY (course_id) REFERENCES courses(id)
-        ON UPDATE CASCADE ON DELETE SET NULL,
-    CONSTRAINT fk_exams_instructor
-        FOREIGN KEY (instructor_id) REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE SET NULL
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 4) exam_questions
-CREATE TABLE exam_questions (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    exam_id INT UNSIGNED NOT NULL,
-    question_text TEXT NOT NULL,
-    type ENUM('MCQ','Essay') NOT NULL,
-    model_answer TEXT NULL,
-    points FLOAT DEFAULT 1 CHECK (points >= 0),
-    order_index INT NULL,
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    INDEX idx_exam_questions_exam (exam_id),
-    CONSTRAINT fk_exam_questions_exam
-        FOREIGN KEY (exam_id) REFERENCES exams(id)
-        ON UPDATE CASCADE ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 5) exam_options
-CREATE TABLE exam_options (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    question_id INT UNSIGNED NOT NULL,
-    option_text TEXT NOT NULL,
-    is_correct BOOLEAN DEFAULT FALSE,
-    INDEX idx_exam_options_question (question_id),
-    CONSTRAINT fk_exam_options_question
-        FOREIGN KEY (question_id) REFERENCES exam_questions(id)
-        ON UPDATE CASCADE ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 6) student_answers
-CREATE TABLE student_answers (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    student_id INT UNSIGNED NOT NULL,
-    question_id INT UNSIGNED NOT NULL,
-    answer_text TEXT NULL,
-    selected_option_id INT UNSIGNED NULL,
-    score FLOAT DEFAULT 0 CHECK (score >= 0),
-    status ENUM('pending','graded','confirmed') DEFAULT 'pending',
-    submission_id INT UNSIGNED NULL,
-    INDEX idx_student_answers_student (student_id),
-    INDEX idx_student_answers_question (question_id),
-    INDEX idx_student_answers_submission (submission_id),
-    INDEX idx_student_answers_selected_option (selected_option_id),
-    CONSTRAINT fk_student_answers_student
-        FOREIGN KEY (student_id) REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_student_answers_question
-        FOREIGN KEY (question_id) REFERENCES exam_questions(id)
-        ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_student_answers_selected_option
-        FOREIGN KEY (selected_option_id) REFERENCES exam_options(id)
-        ON UPDATE CASCADE ON DELETE SET NULL
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 7) submissions
-CREATE TABLE submissions (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    exam_id INT UNSIGNED NOT NULL,
-    user_id INT UNSIGNED NOT NULL,
-    submitted_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    total_score FLOAT DEFAULT 0 CHECK (total_score >= 0),
-    ai_score FLOAT NULL,
-    suggested_total_score FLOAT NULL,
-    instructor_confirmed BOOLEAN DEFAULT FALSE,
-    status ENUM('pending','graded','confirmed') DEFAULT 'pending',
-    INDEX idx_submissions_exam (exam_id),
-    INDEX idx_submissions_user (user_id),
-    CONSTRAINT fk_submissions_exam
-        FOREIGN KEY (exam_id) REFERENCES exams(id)
-        ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_submissions_user
-        FOREIGN KEY (user_id) REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 8) results
-CREATE TABLE results (
-    id INT AUTO_INCREMENT PRIMARY KEY,
-    exam_id INT NOT NULL,
-    student_id INT UNSIGNED NOT NULL,
-    total_score FLOAT DEFAULT 0 CHECK (total_score >= 0),
-    status ENUM('pending','graded','confirmed') DEFAULT 'pending',
-    INDEX idx_results_exam (exam_id),
-    INDEX idx_results_student (student_id),
-    CONSTRAINT fk_results_exam
-        FOREIGN KEY (exam_id) REFERENCES exams(id)
-        ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_results_student
-        FOREIGN KEY (student_id) REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 9) ai_logs
-CREATE TABLE ai_logs (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    question_id INT UNSIGNED NOT NULL,
-    student_id INT UNSIGNED NOT NULL,
-    student_answer TEXT NOT NULL,
-    model_answer TEXT NOT NULL,
-    similarity_score FLOAT NULL,
-    ai_suggested_score FLOAT NULL,
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    INDEX idx_ai_logs_question (question_id),
-    INDEX idx_ai_logs_student (student_id),
-    CONSTRAINT fk_ai_logs_question
-        FOREIGN KEY (question_id) REFERENCES exam_questions(id)
-        ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_ai_logs_student
-        FOREIGN KEY (student_id) REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- 10) user_verified_rooms 
-CREATE TABLE user_verified_rooms (
-    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
-    user_id INT UNSIGNED NOT NULL,
-    exam_room_code VARCHAR(64) NOT NULL,
-    verified_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    CONSTRAINT fk_uvr_user FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_uvr_exam FOREIGN KEY (exam_room_code) REFERENCES exams(exam_room_code) ON UPDATE CASCADE ON DELETE CASCADE,
-    UNIQUE KEY uq_user_room (user_id, exam_room_code)
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- ============================================================================
--- TRIGGER
--- ============================================================================
-DELIMITER $$
-
-CREATE TRIGGER trg_confirmed_results_update
-AFTER UPDATE ON submissions
-FOR EACH ROW
-BEGIN
-    IF NEW.instructor_confirmed = TRUE AND NEW.status = 'graded' THEN
-        UPDATE results
-        SET total_score = NEW.suggested_total_score,
-            status = 'confirmed'
-        WHERE results.exam_id = NEW.exam_id
-          AND results.student_id = NEW.user_id;
-    END IF;
-END$$
-
-DELIMITER ;
-
--- ============================================================================
--- STORED PROCEDURES
--- ============================================================================
-DELIMITER $$
-
--- 1Ô∏è‚É£ Student submit exam
-CREATE PROCEDURE sp_submit_exam(IN p_exam_id INT, IN p_student_id INT)
-BEGIN
-    IF NOT EXISTS (SELECT 1 FROM results WHERE exam_id=p_exam_id AND student_id=p_student_id) THEN
-        INSERT INTO results (exam_id, student_id, status)
-        VALUES (p_exam_id, p_student_id, 'pending');
-    END IF;
-
-    UPDATE submissions
-    SET suggested_total_score = total_score + COALESCE(ai_score,0),
-        status = 'graded'
-    WHERE exam_id = p_exam_id AND user_id = p_student_id;
-END$$
-
--- 2Ô∏è‚É£ Get results by role
-CREATE PROCEDURE sp_get_exam_results(IN examId INT, IN userRole VARCHAR(20), IN userId INT)
-BEGIN
-    IF userRole = 'student' THEN
-        SELECT r.id, e.title AS exam_title, c.title AS course_title,
-               COALESCE(r.total_score, s.suggested_total_score) AS display_score,
-               CASE 
-                   WHEN r.status='confirmed' THEN 'Final Score (Confirmed)'
-                   WHEN s.status='graded' THEN 'Suggested Score (Awaiting Instructor Approval)'
-                   ELSE 'Pending Grading'
-               END AS score_status
-        FROM results r
-        JOIN exams e ON e.id = r.exam_id
-        JOIN courses c ON c.id = e.course_id
-        JOIN submissions s ON s.exam_id=e.id AND s.user_id=r.student_id
-        WHERE r.exam_id = examId AND r.student_id = userId;
-
-    ELSEIF userRole = 'instructor' THEN
-        SELECT r.id, u.full_name AS student_name, r.total_score, r.status,
-               s.total_score AS mcq_score, s.ai_score AS ai_score,
-               s.suggested_total_score
-        FROM results r
-        JOIN users u ON u.id = r.student_id
-        JOIN submissions s ON s.exam_id = r.exam_id AND s.user_id = r.student_id
-        WHERE r.exam_id = examId;
-
-    ELSEIF userRole = 'admin' THEN
-        SELECT r.*, u.full_name AS student_name, e.title AS exam_title, c.title AS course_title
-        FROM results r
-        JOIN users u ON u.id = r.student_id
-        JOIN exams e ON e.id = r.exam_id
-        JOIN courses c ON c.id = e.course_id;
-    END IF;
-END$$
-
--- 3Ô∏è‚É£ Instructor: Update student record in an exam
-CREATE PROCEDURE sp_update_student_exam_record(
-    IN p_exam_id INT,
-    IN p_student_id INT,
-    IN p_new_name VARCHAR(100),
-    IN p_new_mcq_score FLOAT,
-    IN p_new_ai_score FLOAT
-)
-BEGIN
-    START TRANSACTION;
-
-    UPDATE users
-    SET full_name = p_new_name
-    WHERE id = p_student_id AND role = 'student';
-
-    UPDATE submissions
-    SET total_score = p_new_mcq_score,
-        ai_score = p_new_ai_score,
-        suggested_total_score = p_new_mcq_score + COALESCE(p_new_ai_score,0),
-        instructor_confirmed = TRUE,
-        status = 'confirmed'
-    WHERE exam_id = p_exam_id AND user_id = p_student_id;
-
-    UPDATE results
-    SET total_score = p_new_mcq_score + COALESCE(p_new_ai_score,0),
-        status = 'confirmed'
-    WHERE exam_id = p_exam_id AND student_id = p_student_id;
-
-    COMMIT;
-END$$
-
--- 4Ô∏è‚É£ Instructor: Delete all data of a student in an exam (hide name)
-CREATE PROCEDURE sp_delete_student_exam_record(
-    IN p_exam_id INT,
-    IN p_student_id INT
-)
-BEGIN
-    DECLARE exit HANDLER FOR SQLEXCEPTION
-    BEGIN
-        ROLLBACK;
-    END;
-
-    START TRANSACTION;
-
-    DELETE FROM ai_logs
-    WHERE student_id = p_student_id
-      AND question_id IN (
-        SELECT id FROM exam_questions WHERE exam_id = p_exam_id
-      );
-
-    DELETE FROM student_answers
-    WHERE student_id = p_student_id
-      AND question_id IN (
-        SELECT id FROM exam_questions WHERE exam_id = p_exam_id
-      );
-
-    DELETE FROM submissions
-    WHERE user_id = p_student_id AND exam_id = p_exam_id;
-
-    DELETE FROM results
-    WHERE student_id = p_student_id AND exam_id = p_exam_id;
-
-    -- ·∫®n t√™n h·ªçc vi√™n kh·ªèi danh s√°ch hi·ªÉn th·ªã c·ªßa b√†i thi
-    UPDATE users
-    SET full_name = CONCAT('(ƒê√£ x√≥a kh·ªèi b√†i thi #', p_exam_id, ')')
-    WHERE id = p_student_id AND role = 'student';
-
-    COMMIT;
-END$$
-
-DELIMITER ;
-
--- ============================================================================
--- VIEWS
--- ============================================================================
-CREATE OR REPLACE VIEW v_exam_overview AS
-SELECT e.id AS exam_id, e.title AS exam_title, e.exam_room_code, 
-       c.title AS course_title, u.full_name AS instructor
-FROM exams e
-JOIN courses c ON c.id = e.course_id
-JOIN users u ON u.id = c.instructor_id;
-
--- Instructor: Exam Bank
-CREATE OR REPLACE VIEW v_instructor_exam_bank AS
-SELECT 
-    e.id AS exam_id,
-    e.title AS exam_title,
-    e.status AS exam_status,
-    e.created_at,
-    e.updated_at,
-    c.title AS course_title,
-    u.full_name AS instructor_name,
-    COUNT(eq.id) AS total_questions
-FROM exams e
-JOIN courses c ON e.course_id = c.id
-JOIN users u ON u.id = c.instructor_id
-LEFT JOIN exam_questions eq ON eq.exam_id = e.id
-WHERE u.role = 'instructor'
-GROUP BY e.id
-ORDER BY e.updated_at DESC;
-
--- Instructor: Assigned Exams (danh s√°ch h·ªçc vi√™n ƒë√£ thi)
-CREATE OR REPLACE VIEW v_instructor_assigned_exams AS
-SELECT 
-    e.id AS exam_id,
-    e.title AS exam_title,
-    c.title AS course_title,
-    u.full_name AS instructor_name,
-    s.user_id AS student_id,
-    stu.full_name AS student_name,
-    s.total_score AS mcq_score,
-    s.ai_score AS ai_score,
-    r.total_score AS final_score,
-    s.status AS submission_status,
-    s.submitted_at AS student_submitted_at
-FROM submissions s
-JOIN exams e ON s.exam_id = e.id
-JOIN courses c ON e.course_id = c.id
-JOIN users u ON c.instructor_id = u.id
-JOIN users stu ON stu.id = s.user_id
-LEFT JOIN results r ON r.exam_id = e.id AND r.student_id = stu.id
-WHERE e.status = 'published'
-ORDER BY e.id, s.submitted_at DESC;
-
--- Student dashboard
-CREATE OR REPLACE VIEW v_student_results AS
-SELECT e.title AS exam_title,
-       c.title AS course_title,
-       COALESCE(r.total_score, s.suggested_total_score) AS display_score,
-       CASE 
-           WHEN r.status='confirmed' THEN 'Final Score (Confirmed)'
-           WHEN s.status='graded' THEN 'Suggested Score (Awaiting Instructor Approval)'
-           ELSE 'Pending Grading'
-       END AS score_status,
-       s.submitted_at,
-       e.duration
-FROM submissions s
-JOIN exams e ON e.id = s.exam_id
-JOIN courses c ON c.id = e.course_id
-LEFT JOIN results r ON r.exam_id = e.id AND r.student_id = s.user_id
-WHERE s.user_id IN (SELECT id FROM users WHERE role='student');
-
--- Admin overview
-CREATE OR REPLACE VIEW v_admin_overview AS
-SELECT u.full_name AS instructor_name,
-       c.title AS course_title,
-       e.title AS exam_title,
-       COUNT(s.id) AS total_submissions,
-       AVG(s.suggested_total_score) AS avg_score,
-       SUM(CASE WHEN s.status='confirmed' THEN 1 ELSE 0 END) AS confirmed_count
-FROM users u
-JOIN courses c ON c.instructor_id = u.id
-JOIN exams e ON e.course_id = c.id
-LEFT JOIN submissions s ON s.exam_id = e.id
-GROUP BY e.id;
-
--- Migrate existing verify_room_code data
-ALTER TABLE users DROP FOREIGN KEY fk_users_verify_room_code;
-ALTER TABLE users MODIFY COLUMN verify_room_code BOOLEAN DEFAULT FALSE;
-
-use oem_mini;
-ALTER TABLE users MODIFY COLUMN verify_room_code BOOLEAN DEFAULT FALSE;
-CREATE TABLE user_verified_rooms (
-    id INT AUTO_INCREMENT PRIMARY KEY,
-    user_id INT UNSIGNED NOT NULL,
-    exam_room_code VARCHAR(20) NOT NULL,
-    verified_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    CONSTRAINT fk_uvr_user FOREIGN KEY (user_id)
-        REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_uvr_exam FOREIGN KEY (exam_room_code)
-        REFERENCES exams(exam_room_code)
-        ON UPDATE CASCADE ON DELETE CASCADE,
-    UNIQUE KEY uq_user_room (user_id, exam_room_code)
-);
-
--- View for instructor statistics
-CREATE OR REPLACE VIEW v_instructor_stats AS
-SELECT
-  c.instructor_id,
-  COUNT(DISTINCT e.id) AS total_exams,
-  COUNT(s.id) AS total_submissions,
-  COUNT(DISTINCT s.user_id) AS total_students
-FROM courses c
-LEFT JOIN exams e ON e.course_id = c.id
-LEFT JOIN submissions s ON s.exam_id = e.id
-GROUP BY c.instructor_id;
-
--- =================================================================
--- ‚úÖ END OF SCRIPT (OEM Mini v5 - Instructor Final Version)
--- =================================================================
-
--- =================================================================
--- ‚úÖUpdate database to Sprint 2
--- =================================================================
-USE oem_mini;
-
--- =====================================================
--- 1Ô∏è‚É£ TABLES
--- =====================================================
-
--- (1) Enrollments
-CREATE TABLE IF NOT EXISTS enrollments (
-    id INT AUTO_INCREMENT PRIMARY KEY,
-    user_id INT NOT NULL,
-    course_id INT NOT NULL,
-    enrolled_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    status ENUM('active','cancelled') DEFAULT 'active',
-    UNIQUE KEY uq_enrollment_user_course (user_id, course_id),
-    INDEX idx_enrollments_user (user_id),
-    INDEX idx_enrollments_course (course_id),
-    CONSTRAINT fk_enrollments_user FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_enrollments_course FOREIGN KEY (course_id) REFERENCES courses(id) ON UPDATE CASCADE ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- (2) Import Jobs
-CREATE TABLE IF NOT EXISTS import_jobs (
-    id INT AUTO_INCREMENT PRIMARY KEY,
-    job_uuid VARCHAR(64) NOT NULL UNIQUE,
-    exam_id INT NOT NULL,
-    created_by INT NULL,
-    status ENUM('preview','processing','completed','failed') DEFAULT 'preview',
-    preview_json LONGTEXT NULL,
-    result_summary JSON NULL,
-    error_text TEXT NULL,
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
-    INDEX idx_import_jobs_exam (exam_id),
-    INDEX idx_import_jobs_user (created_by),
-    CONSTRAINT fk_import_jobs_exam FOREIGN KEY (exam_id) REFERENCES exams(id) ON UPDATE CASCADE ON DELETE CASCADE,
-    CONSTRAINT fk_import_jobs_user FOREIGN KEY (created_by) REFERENCES users(id) ON UPDATE CASCADE ON DELETE SET NULL
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- (3) Import Rows
-CREATE TABLE IF NOT EXISTS import_rows (
-    id INT AUTO_INCREMENT PRIMARY KEY,
-    job_id INT NOT NULL,
-    `row_number` INT NOT NULL,
-    row_data LONGTEXT NOT NULL,
-    errors LONGTEXT NULL,
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    INDEX idx_import_rows_job (job_id),
-    CONSTRAINT fk_import_rows_job FOREIGN KEY (job_id)
-        REFERENCES import_jobs (id)
-        ON UPDATE CASCADE
-        ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- (4) Refresh Tokens
-CREATE TABLE IF NOT EXISTS refresh_tokens (
-    id INT AUTO_INCREMENT PRIMARY KEY,
-    user_id INT NOT NULL,
-    token VARCHAR(500) NOT NULL,
-    revoked BOOLEAN DEFAULT FALSE,
-    expires_at DATETIME NULL,
-    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
-    INDEX idx_refresh_tokens_user (user_id),
-    UNIQUE KEY uq_refresh_token_token (token),
-    CONSTRAINT fk_refresh_tokens_user FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE
-) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
-
--- (5) Submissions (th√™m c·ªôt n·∫øu ch∆∞a c√≥)
-CALL add_column_if_missing('submissions', 'status', "ENUM('pending','graded','confirmed') DEFAULT 'pending'");
-CALL add_column_if_missing('submissions', 'total_score', 'FLOAT DEFAULT 0');
-CALL add_column_if_missing('submissions', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
-CALL add_column_if_missing('submissions', 'updated_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP');
-CREATE INDEX IF NOT EXISTS idx_submissions_status ON submissions (status);
-
--- (6) Student Answers
-CALL add_column_if_missing('student_answers', 'score', 'FLOAT DEFAULT 0');
-CALL add_column_if_missing('student_answers', 'graded_at', 'DATETIME NULL');
-CREATE INDEX IF NOT EXISTS idx_student_answers_graded_at ON student_answers (graded_at);
-
--- (7) Exam Questions
-ALTER TABLE exam_questions MODIFY COLUMN type ENUM('MCQ','Essay','Unknown') DEFAULT 'Unknown';
-CALL add_column_if_missing('exam_questions', 'points', 'FLOAT DEFAULT 1');
-CALL add_column_if_missing('exam_questions', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
-CALL add_column_if_missing('exam_questions', 'updated_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP');
-CREATE INDEX IF NOT EXISTS idx_exam_questions_type ON exam_questions (type);
-
--- (8) Exams
-CALL add_column_if_missing('exams', 'exam_room_code', 'VARCHAR(64) NULL');
-CALL add_column_if_missing('exams', 'status', "ENUM('draft','published','archived') DEFAULT 'draft'");
-CALL add_column_if_missing('exams', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
-CALL add_column_if_missing('exams', 'updated_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP');
-CALL add_column_if_missing('exams', 'deleted_at', 'DATETIME NULL');
-CREATE UNIQUE INDEX IF NOT EXISTS uq_exams_room_code ON exams (exam_room_code);
-
--- (9) AI Logs
-CALL add_column_if_missing('ai_logs', 'request_payload', 'LONGTEXT NULL');
-CALL add_column_if_missing('ai_logs', 'response_payload', 'LONGTEXT NULL');
-CALL add_column_if_missing('ai_logs', 'error_text', 'TEXT NULL');
-CALL add_column_if_missing('ai_logs', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
-
--- (10) Soft delete courses
-CALL add_column_if_missing('courses', 'deleted_at', 'DATETIME NULL');
-
--- =====================================================
--- 2Ô∏è‚É£ TRIGGERS
--- =====================================================
-DELIMITER $$
-
-DROP TRIGGER IF EXISTS trg_update_submission_score $$
-CREATE TRIGGER trg_update_submission_score
-AFTER UPDATE ON student_answers
-FOR EACH ROW
-BEGIN
-  DECLARE total FLOAT;
-  SELECT SUM(score) INTO total FROM student_answers WHERE submission_id = NEW.submission_id;
-  UPDATE submissions SET total_score = total WHERE id = NEW.submission_id;
-END$$
-
-DROP TRIGGER IF EXISTS trg_check_submission_status $$
-CREATE TRIGGER trg_check_submission_status
-AFTER UPDATE ON student_answers
-FOR EACH ROW
-BEGIN
-  DECLARE ungraded INT;
-  SELECT COUNT(*) INTO ungraded FROM student_answers WHERE submission_id = NEW.submission_id AND graded_at IS NULL;
-  IF ungraded = 0 THEN
-    UPDATE submissions SET status = 'graded' WHERE id = NEW.submission_id;
-  END IF;
-END$$
-
-DELIMITER ;
-
--- =====================================================
--- 3Ô∏è‚É£ PROCEDURES
--- =====================================================
-DELIMITER $$
-
--- Helper: safely add a column if missing
-DROP PROCEDURE IF EXISTS add_column_if_missing $$
-CREATE PROCEDURE add_column_if_missing(IN tbl VARCHAR(64), IN col VARCHAR(64), IN coldef TEXT)
-BEGIN
-  IF NOT EXISTS (
-    SELECT 1 FROM INFORMATION_SCHEMA.COLUMNS
-    WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = tbl AND COLUMN_NAME = col
-  ) THEN
-    SET @ddl = CONCAT('ALTER TABLE ', tbl, ' ADD COLUMN ', col, ' ', coldef);
-    PREPARE stmt FROM @ddl;
-    EXECUTE stmt;
-    DEALLOCATE PREPARE stmt;
-  END IF;
-END$$
-
--- finalize_submission
-DROP PROCEDURE IF EXISTS finalize_submission $$
-CREATE PROCEDURE finalize_submission(IN submissionId INT)
-BEGIN
-  DECLARE total FLOAT;
-  SELECT SUM(score) INTO total FROM student_answers WHERE submission_id = submissionId;
-  UPDATE submissions SET total_score = total, status = 'graded', updated_at = NOW() WHERE id = submissionId;
-END$$
-
--- import_exam_from_job
-DROP PROCEDURE IF EXISTS import_exam_from_job $$
-CREATE PROCEDURE import_exam_from_job(IN jobId INT)
-BEGIN
-  DECLARE done INT DEFAULT 0;
-  DECLARE q JSON;
-  DECLARE cur CURSOR FOR SELECT row_data FROM import_rows WHERE job_id = jobId;
-  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;
-  
-  OPEN cur;
-  read_loop: LOOP
-    FETCH cur INTO q;
-    IF done THEN LEAVE read_loop; END IF;
-    INSERT INTO exam_questions (exam_id, question_text, type, points, created_at)
-    VALUES (
-      (SELECT exam_id FROM import_jobs WHERE id = jobId),
-      JSON_UNQUOTE(JSON_EXTRACT(q, '$.question_text')),
-      JSON_UNQUOTE(JSON_EXTRACT(q, '$.type')),
-      COALESCE(JSON_UNQUOTE(JSON_EXTRACT(q, '$.points')), 1),
-      NOW()
-    );
-  END LOOP;
-  CLOSE cur;
-  UPDATE import_jobs SET status = 'completed', updated_at = NOW() WHERE id = jobId;
-END$$
-
-DELIMITER ;
-
--- =====================================================
--- 4Ô∏è‚É£ VIEWS
--- =====================================================
-CREATE OR REPLACE VIEW v_exam_overview AS
-SELECT 
-  e.id AS exam_id,
-  e.title AS exam_title,
-  e.status,
-  e.exam_room_code,
-  COUNT(s.id) AS total_submissions,
-  AVG(s.total_score) AS avg_score,
-  MAX(s.updated_at) AS last_activity
-FROM exams e
-LEFT JOIN submissions s ON e.id = s.exam_id
-GROUP BY e.id, e.title, e.status, e.exam_room_code;
-
-CREATE OR REPLACE VIEW v_student_result_overview AS
-SELECT 
-  u.id AS student_id,
-  u.full_name,
-  e.title AS exam_title,
-  s.id AS submission_id,
-  s.total_score,
-  s.status,
-  s.updated_at AS graded_at
-FROM submissions s
-JOIN users u ON s.user_id = u.id
-JOIN exams e ON s.exam_id = e.id;
-
-CREATE OR REPLACE VIEW v_ai_logs_trace AS
-SELECT 
-  id AS log_id,
-  request_payload,
-  response_payload,
-  error_text,
-  created_at
-FROM ai_logs
-ORDER BY created_at DESC;
-
-SELECT '‚úÖ OEM Mini schema successfully updated (no warnings, MySQL-safe)' AS message;
-
------ s·ª≠a b·ªï sung id_instructor
-USE oem_mini;
-ALTER TABLE exams
-    DROP FOREIGN KEY fk_exams_course,
-    DROP COLUMN course_id,
-    ADD COLUMN instructor_id INT UNSIGNED NOT NULL AFTER id,
-    ADD CONSTRAINT fk_exams_instructor
-        FOREIGN KEY (instructor_id) REFERENCES users(id)
-        ON UPDATE CASCADE ON DELETE CASCADE;
--- n·∫øu l·ªói kh√≥a ngo·∫°i th√¨ ch·∫°y l·ªánh sau tr∆∞·ªõc
-SET SQL_SAFE_UPDATES = 0;
-
-UPDATE exams SET instructor_id = 18;
-
-SET SQL_SAFE_UPDATES = 1;
--- ch·∫°y ƒë·ªÉ ki·ªÉm tra t·ªìn t·∫°i
-SELECT id, title, instructor_id FROM exams;
--- s·ª≠a b·ªï sung id_instructor kh√≥a ngo·∫°i
-ALTER TABLE exams
-ADD CONSTRAINT fk_exams_instructor
-FOREIGN KEY (instructor_id) REFERENCES users(id)
-ON UPDATE CASCADE ON DELETE CASCADE;
--- b·ªï sung id_exam v√†o b·∫£ng exam_questions
-
-USE oem_mini;
-
--- 1Ô∏è‚É£ T·∫°m t·∫Øt ki·ªÉm tra kh√≥a ngo·∫°i
-SET FOREIGN_KEY_CHECKS = 0;
-
--- 2Ô∏è‚É£ Ki·ªÉm tra xem c·ªôt exam_id ƒë√£ t·ªìn t·∫°i ch∆∞a
-SET @col_exists := (
-  SELECT COUNT(*) 
-  FROM INFORMATION_SCHEMA.COLUMNS 
-  WHERE TABLE_SCHEMA = 'oem_mini' 
-    AND TABLE_NAME = 'exam_questions' 
-    AND COLUMN_NAME = 'exam_id'
-);
-
--- 3Ô∏è‚É£ N·∫øu ch∆∞a c√≥ c·ªôt th√¨ th√™m m·ªõi
-SET @sql := IF(@col_exists = 0, 
-  'ALTER TABLE exam_questions ADD COLUMN exam_id INT NULL AFTER id;', 
-  'SELECT "Column exam_id already exists";'
-);
-PREPARE stmt FROM @sql;
-EXECUTE stmt;
-DEALLOCATE PREPARE stmt;
-
--- 4Ô∏è‚É£ C·∫≠p nh·∫≠t exam_id h·ª£p l·ªá (gi·∫£ s·ª≠ ƒë·ªÅ thi c√≥ id = 2)
-UPDATE exam_questions 
-SET exam_id = 2 
-WHERE exam_id IS NULL 
-   OR exam_id NOT IN (SELECT id FROM exams);
-
--- 5Ô∏è‚É£ X√≥a kh√≥a ngo·∫°i c≈© n·∫øu c√≥
-SET @fk_name := (
-  SELECT CONSTRAINT_NAME
-  FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
-  WHERE TABLE_SCHEMA = 'oem_mini'
-    AND TABLE_NAME = 'exam_questions'
-    AND COLUMN_NAME = 'exam_id'
-    AND REFERENCED_TABLE_NAME = 'exams'
-  LIMIT 1
-);
-SET @sql := IF(@fk_name IS NOT NULL, 
-  CONCAT('ALTER TABLE exam_questions DROP FOREIGN KEY ', @fk_name, ';'), 
-  'SELECT "No old FK found";'
-);
-PREPARE stmt FROM @sql;
-EXECUTE stmt;
-DEALLOCATE PREPARE stmt;
-
--- 6Ô∏è‚É£ T·∫°o l·∫°i kh√≥a ngo·∫°i m·ªõi ƒë√∫ng chu·∫©n
-ALTER TABLE exam_questions
-ADD CONSTRAINT fk_exam_questions_exam
-FOREIGN KEY (exam_id) REFERENCES exams(id)
-ON UPDATE CASCADE ON DELETE CASCADE;
-
--- 7Ô∏è‚É£ B·∫≠t l·∫°i ki·ªÉm tra kh√≥a ngo·∫°i
-SET FOREIGN_KEY_CHECKS = 1;
-
--- 8Ô∏è‚É£ Ki·ªÉm tra k·∫øt qu·∫£
-SELECT 
-  CONSTRAINT_NAME, TABLE_NAME, COLUMN_NAME, 
-  REFERENCED_TABLE_NAME, REFERENCED_COLUMN_NAME
-FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
-WHERE TABLE_SCHEMA = 'oem_mini' 
-  AND TABLE_NAME = 'exam_questions' 
-  AND REFERENCED_TABLE_NAME = 'exams';
---- view instructor exam bank qu·∫£n l√Ω ƒë·ªÅ thi
-CREATE OR REPLACE VIEW v_exam_questions_detail AS
-SELECT 
-  q.id AS question_id,
-  e.id AS exam_id,
-  e.title AS exam_title,
-  q.question_text,
-  q.type,
-  q.model_answer,
-  q.points,
-  q.created_by
-FROM exam_questions q
-JOIN exams e ON q.exam_id = e.id;
--- ki·ªÉm tra view
-SELECT * FROM v_exam_questions_detail WHERE created_by = ? AND exam_id = ?;
-
--- x√≥a b·∫£ng courses k c·∫ßn n·ªØa
-USE oem_mini;
-SET FOREIGN_KEY_CHECKS = 0;
-ALTER TABLE enrollments
-DROP FOREIGN KEY fk_enrollments_course;
-ALTER TABLE exams
-DROP FOREIGN KEY fk_exams_course;
-ALTER TABLE exams
-DROP COLUMN course_id;
-DROP TABLE IF EXISTS courses;
-SET FOREIGN_KEY_CHECKS = 1;
-SELECT '‚úÖ ƒê√£ x√≥a kh√≥a ngo·∫°i, c·ªôt course_id trong exams v√† c√°c b·∫£ng courses, enrollments th√†nh c√¥ng.' AS message;
-
--- update exams table + submission table cho ph√≤ng thi
-USE oem_mini;
-SET @db := DATABASE();
-
--- exam_id (INT UNSIGNED, NOT NULL)
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='exam_id';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN exam_id INT UNSIGNED NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- user_id (INT UNSIGNED, NOT NULL)
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='user_id';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN user_id INT UNSIGNED NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- attempt_no
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='attempt_no';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN attempt_no INT NOT NULL DEFAULT 1',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- started_at
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='started_at';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN started_at DATETIME NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- submitted_at
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='submitted_at';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN submitted_at DATETIME NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- status
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='status';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN status ENUM(''pending'',''in_progress'',''submitted'',''graded'',''cancelled'') NOT NULL DEFAULT ''pending''',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- face_image_blob
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_blob';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN face_image_blob LONGBLOB NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- face_image_mimetype
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_mimetype';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN face_image_mimetype VARCHAR(100) NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- face_image_url
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_url';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN face_image_url VARCHAR(500) NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- student_card_blob
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_blob';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN student_card_blob LONGBLOB NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- student_card_mimetype
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_mimetype';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN student_card_mimetype VARCHAR(100) NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- student_card_url
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_url';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN student_card_url VARCHAR(500) NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- proctor_flags (JSON)
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='proctor_flags';
-SET @sql := IF(@c=0,
-  'ALTER TABLE submissions ADD COLUMN proctor_flags JSON NULL',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-/* ---------- Backfill nh·ªè ---------- */
-UPDATE submissions SET attempt_no = 1 WHERE attempt_no IS NULL;
-
-/* ---------- ƒê·∫£m b·∫£o ki·ªÉu c·ªôt ƒë√∫ng ƒë·ªÉ g·∫Øn FK ---------- */
--- (N·∫øu tr∆∞·ªõc ƒë√≥ l·ª° t·∫°o BIGINT th√¨ ƒë·ªïi v·ªÅ INT UNSIGNED)
-ALTER TABLE submissions
-  MODIFY COLUMN exam_id INT UNSIGNED NULL,
-  MODIFY COLUMN user_id INT UNSIGNED NULL;
-
-/* ---------- Foreign Keys (th√™m n·∫øu ch∆∞a c√≥) ---------- */
--- Xo√° tr∆∞·ªõc n·∫øu ƒë√£ t·ªìn t·∫°i ƒë·ªÉ tr√°nh va
-SET FOREIGN_KEY_CHECKS = 0;
-SELECT COUNT(*) INTO @fk_exists
-FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
-WHERE CONSTRAINT_SCHEMA=@db AND CONSTRAINT_NAME='fk_submissions__exams';
-SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__exams','SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-SELECT COUNT(*) INTO @fk_exists
-FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
-WHERE CONSTRAINT_SCHEMA=@db AND CONSTRAINT_NAME='fk_submissions__users';
-SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__users','SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-SET FOREIGN_KEY_CHECKS = 1;
-
--- Th√™m l·∫°i FK
-ALTER TABLE submissions
-  ADD CONSTRAINT fk_submissions__exams
-    FOREIGN KEY (exam_id) REFERENCES exams(id)
-    ON DELETE CASCADE ON UPDATE CASCADE,
-  ADD CONSTRAINT fk_submissions__users
-    FOREIGN KEY (user_id) REFERENCES users(id)
-    ON DELETE CASCADE ON UPDATE CASCADE;
-
-/* ---------- Indexes (t·∫°o n·∫øu thi·∫øu) ---------- */
--- Unique (exam_id, user_id, attempt_no)
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='uq_submissions_exam_user_attempt';
-SET @sql := IF(@idx_exists=0,
-  'CREATE UNIQUE INDEX uq_submissions_exam_user_attempt ON submissions (exam_id, user_id, attempt_no)',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- Index (exam_id, user_id)
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_exam_user';
-SET @sql := IF(@idx_exists=0,
-  'CREATE INDEX idx_submissions_exam_user ON submissions (exam_id, user_id)',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- Index (status)
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_status';
-SET @sql := IF(@idx_exists=0,
-  'CREATE INDEX idx_submissions_status ON submissions (status)',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- Index (user_id)
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_user';
-SET @sql := IF(@idx_exists=0,
-  'CREATE INDEX idx_submissions_user ON submissions (user_id)',
-  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-
---
-ALTER TABLE exams
-  MODIFY COLUMN duration_minutes INT NOT NULL DEFAULT 60,
-  MODIFY COLUMN max_points DECIMAL(10,2) NULL,
-  MODIFY COLUMN require_face_check TINYINT(1) NOT NULL DEFAULT 0,
-  MODIFY COLUMN require_student_card TINYINT(1) NOT NULL DEFAULT 0,
-  MODIFY COLUMN monitor_screen TINYINT(1) NOT NULL DEFAULT 0;
-
-
-USE oem_mini;
-
-/* Drop target columns if exist */
--- duration_minutes
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='duration_minutes';
-SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN duration_minutes', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- time_open
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='time_open';
-SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN time_open', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- time_close
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='time_close';
-SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN time_close', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- max_points
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='max_points';
-SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN max_points', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- require_face_check
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='require_face_check';
-SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN require_face_check', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- require_student_card
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='require_student_card';
-SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN require_student_card', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- monitor_screen
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='monitor_screen';
-SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN monitor_screen', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-/* Add fresh columns */
-ALTER TABLE exams
-  ADD COLUMN duration_minutes INT NOT NULL DEFAULT 60,
-  ADD COLUMN time_open DATETIME NULL,
-  ADD COLUMN time_close DATETIME NULL,
-  ADD COLUMN max_points DECIMAL(10,2) NULL,
-  ADD COLUMN require_face_check TINYINT(1) NOT NULL DEFAULT 0,
-  ADD COLUMN require_student_card TINYINT(1) NOT NULL DEFAULT 0,
-  ADD COLUMN monitor_screen TINYINT(1) NOT NULL DEFAULT 0;
-
-/* Recreate indexes for EXAMS */
--- idx_exams_status_room
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND INDEX_NAME='idx_exams_status_room';
-SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_exams_status_room ON exams', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-CREATE INDEX idx_exams_status_room ON exams (status, exam_room_code);
-
--- idx_exams_time_open
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND INDEX_NAME='idx_exams_time_open';
-SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_exams_time_open ON exams', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-CREATE INDEX idx_exams_time_open ON exams (time_open);
-
-/* Ensure submissions table exists (id only) */
-CREATE TABLE IF NOT EXISTS submissions (
-  id BIGINT PRIMARY KEY AUTO_INCREMENT
-);
-
-/* Drop FKs first to allow dropping columns safely */
-SET FOREIGN_KEY_CHECKS = 0;
-
--- drop FK exams
-SELECT COUNT(*) INTO @fk_exists
-FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
-WHERE CONSTRAINT_SCHEMA=DATABASE() AND CONSTRAINT_NAME='fk_submissions__exams';
-SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__exams', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- drop FK users
-SELECT COUNT(*) INTO @fk_exists
-FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
-WHERE CONSTRAINT_SCHEMA=DATABASE() AND CONSTRAINT_NAME='fk_submissions__users';
-SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__users', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-SET FOREIGN_KEY_CHECKS = 1;
-
-/* Drop indexes so we can rebuild clean */
--- unique attempt index
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='uq_submissions_exam_user_attempt';
-SET @sql := IF(@idx_exists>0, 'DROP INDEX uq_submissions_exam_user_attempt ON submissions', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
--- other indexes
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_exam_user';
-SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_submissions_exam_user ON submissions', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_status';
-SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_submissions_status ON submissions', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-SELECT COUNT(*) INTO @idx_exists
-FROM INFORMATION_SCHEMA.STATISTICS
-WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_user';
-SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_submissions_user ON submissions', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-
-/* Drop target columns (if exist) and add fresh ones */
--- exam_id
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='exam_id';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN exam_id', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN exam_id BIGINT NULL;
-
--- user_id
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='user_id';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN user_id', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN user_id BIGINT NULL;
-
--- attempt_no
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='attempt_no';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN attempt_no', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN attempt_no INT NOT NULL DEFAULT 1;
-
--- started_at
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='started_at';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN started_at', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN started_at DATETIME NULL;
-
--- submitted_at
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='submitted_at';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN submitted_at', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN submitted_at DATETIME NULL;
-
--- status
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='status';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN status', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions
-  ADD COLUMN status ENUM('pending','in_progress','submitted','graded','cancelled')
-  NOT NULL DEFAULT 'pending';
-
--- face_image_blob
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_blob';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN face_image_blob', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN face_image_blob LONGBLOB NULL;
-
--- face_image_mimetype
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_mimetype';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN face_image_mimetype', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN face_image_mimetype VARCHAR(100) NULL;
-
--- face_image_url
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_url';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN face_image_url', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN face_image_url VARCHAR(500) NULL;
-
--- student_card_blob
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_blob';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN student_card_blob', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN student_card_blob LONGBLOB NULL;
-
--- student_card_mimetype
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_mimetype';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN student_card_mimetype', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN student_card_mimetype VARCHAR(100) NULL;
-
--- student_card_url
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_url';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN student_card_url', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN student_card_url VARCHAR(500) NULL;
-
--- proctor_flags
-SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
- WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='proctor_flags';
-SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN proctor_flags', 'SELECT 1');
-PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
-ALTER TABLE submissions ADD COLUMN proctor_flags JSON NULL;
-
-/* Recreate FKs */
-SET FOREIGN_KEY_CHECKS = 1;
-ALTER TABLE submissions
-  ADD CONSTRAINT fk_submissions__exams
-    FOREIGN KEY (exam_id) REFERENCES exams(id)
-    ON DELETE CASCADE ON UPDATE CASCADE;
-
-ALTER TABLE submissions
-  ADD CONSTRAINT fk_submissions__users
-    FOREIGN KEY (user_id) REFERENCES users(id)
-    ON DELETE CASCADE ON UPDATE CASCADE;
-/* NOTE: n·∫øu b·∫£ng user c·ªßa b·∫°n KH√îNG ph·∫£i 'users', h√£y ƒë·ªïi t√™n ·ªü d√≤ng tr√™n. */
-
-/* Recreate Indexes */
-CREATE UNIQUE INDEX uq_submissions_exam_user_attempt
-  ON submissions (exam_id, user_id, attempt_no);
-
-CREATE INDEX idx_submissions_exam_user
-  ON submissions (exam_id, user_id);
-
-CREATE INDEX idx_submissions_status
-  ON submissions (status);
-
-CREATE INDEX idx_submissions_user
-  ON submissions (user_id);
----
-DELIMITER $$
-
-DROP PROCEDURE IF EXISTS sp_get_exam_results $$
-CREATE PROCEDURE sp_get_exam_results(IN p_exam_id INT, IN p_role VARCHAR(20), IN p_instructor_id INT)
-BEGIN
-    SELECT u.full_name AS student_name, s.user_id AS student_id, s.status,
-           COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) AS mcq_score,
-           s.ai_score,
-           COALESCE(s.suggested_total_score,
-                    COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) + COALESCE(s.ai_score,0)) AS suggested_total_score,
-           s.total_score, s.started_at, s.submitted_at,
-           TIMESTAMPDIFF(MINUTE, s.started_at, s.submitted_at) AS duration_minutes,
-           s.proctor_flags, s.face_image_url, s.student_card_url
-    FROM submissions s
-    JOIN users u ON u.id = s.user_id
-    LEFT JOIN student_answers sa ON sa.submission_id = s.id
-    LEFT JOIN exam_questions q ON q.id = sa.question_id
-    WHERE s.exam_id = p_exam_id
-    GROUP BY s.id
-    ORDER BY u.full_name;
-END $$
-DELIMITER ;
---
-DELIMITER $$
-
-DROP PROCEDURE IF EXISTS sp_update_student_exam_record $$
-CREATE PROCEDURE sp_update_student_exam_record(
-    IN p_exam_id INT,
-    IN p_student_id INT,
-    IN p_student_name VARCHAR(255),
-    IN p_mcq_score DECIMAL(10,2),
-    IN p_ai_score DECIMAL(10,2)
-)
-BEGIN
-    -- (tu·ª≥ ch·ªçn) g√≥i trong transaction
-    START TRANSACTION;
-
-    -- 1) C·∫≠p nh·∫≠t submissions
-    UPDATE submissions
-    SET
-        total_score = COALESCE(p_mcq_score, 0),
-        ai_score = COALESCE(p_ai_score, 0),
-        suggested_total_score = COALESCE(p_mcq_score, 0) + COALESCE(p_ai_score, 0),
-        instructor_confirmed = TRUE,
-        status = 'confirmed'
-    WHERE exam_id = p_exam_id
-      AND user_id = p_student_id;
-
-    -- 2) C·∫≠p nh·∫≠t results b·∫±ng JOIN ƒë·ªÉ tr√°nh subquery tr·∫£ nhi·ªÅu d√≤ng
-    UPDATE results r
-    JOIN submissions s
-      ON s.exam_id = r.exam_id
-     AND s.user_id  = r.student_id
-    SET
-        r.total_score = s.total_score,
-        r.status = 'confirmed'
-    WHERE r.exam_id = p_exam_id
-      AND r.student_id = p_student_id;
-
-    -- 3) C·∫≠p nh·∫≠t t√™n sinh vi√™n n·∫øu c√≥
-    IF p_student_name IS NOT NULL AND LENGTH(TRIM(p_student_name)) > 0 THEN
-        UPDATE users
-        SET full_name = p_student_name
-        WHERE id = p_student_id;
-    END IF;
-
-    COMMIT;
-END $$
-DELIMITER ;
-
-
-
-
--- =================================================================
--- ‚úÖ END OF SCRIPT (OEM Mini v5.1 - Sprint 2 Update)
+-- ============================================================================
+-- üß© OEM Mini Database Schema (v5 - Instructor Final Version)
+-- Engine: MySQL 8.0.x
+-- Charset: utf8mb4 / utf8mb4_unicode_ci
+-- Author: OEM Mini Team (Capstone Project 2025 - CMU-SE)
+-- ============================================================================
+
+DROP DATABASE IF EXISTS oem_mini;
+CREATE DATABASE oem_mini CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
+USE oem_mini;
+
+-- ============================================================================
+-- TABLES
+-- ============================================================================
+
+-- 1) users
+CREATE TABLE users (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    full_name VARCHAR(100) NOT NULL,
+    email VARCHAR(120) NOT NULL UNIQUE,
+    password_hash VARCHAR(255) NOT NULL,
+    avatar VARCHAR(255) NULL,
+    avatar_blob LONGBLOB NULL,
+    avatar_mimetype VARCHAR(100) NULL,
+    gender ENUM('male','female','other') NULL,
+    address VARCHAR(255) NULL,
+    phone_number VARCHAR(20) NULL,
+    role ENUM('admin','instructor','student') NOT NULL,
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    verify_room_code BOOLEAN DEFAULT FALSE,
+    INDEX idx_users_role (role)
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 2) courses
+CREATE TABLE courses (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    title VARCHAR(100) NOT NULL,
+    description TEXT NULL,
+    instructor_id INT UNSIGNED NOT NULL,
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    INDEX idx_courses_instructor (instructor_id),
+    CONSTRAINT fk_courses_instructor
+        FOREIGN KEY (instructor_id) REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE RESTRICT
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+
+-- 3) exams
+CREATE TABLE exams (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    course_id INT UNSIGNED NULL,                
+    instructor_id INT UNSIGNED NULL,            
+    title VARCHAR(100) NOT NULL,
+    duration INT NOT NULL CHECK (duration > 0),
+    exam_room_code VARCHAR(64) NULL,
+    status ENUM('draft','published','archived') DEFAULT 'draft',
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
+    UNIQUE KEY uq_exams_room_code (exam_room_code),
+    INDEX idx_exams_course (course_id),
+    INDEX idx_exams_instructor (instructor_id),
+    CONSTRAINT fk_exams_course
+        FOREIGN KEY (course_id) REFERENCES courses(id)
+        ON UPDATE CASCADE ON DELETE SET NULL,
+    CONSTRAINT fk_exams_instructor
+        FOREIGN KEY (instructor_id) REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE SET NULL
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 4) exam_questions
+CREATE TABLE exam_questions (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    exam_id INT UNSIGNED NOT NULL,
+    question_text TEXT NOT NULL,
+    type ENUM('MCQ','Essay') NOT NULL,
+    model_answer TEXT NULL,
+    points FLOAT DEFAULT 1 CHECK (points >= 0),
+    order_index INT NULL,
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    INDEX idx_exam_questions_exam (exam_id),
+    CONSTRAINT fk_exam_questions_exam
+        FOREIGN KEY (exam_id) REFERENCES exams(id)
+        ON UPDATE CASCADE ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 5) exam_options
+CREATE TABLE exam_options (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    question_id INT UNSIGNED NOT NULL,
+    option_text TEXT NOT NULL,
+    is_correct BOOLEAN DEFAULT FALSE,
+    INDEX idx_exam_options_question (question_id),
+    CONSTRAINT fk_exam_options_question
+        FOREIGN KEY (question_id) REFERENCES exam_questions(id)
+        ON UPDATE CASCADE ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 6) student_answers
+CREATE TABLE student_answers (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    student_id INT UNSIGNED NOT NULL,
+    question_id INT UNSIGNED NOT NULL,
+    answer_text TEXT NULL,
+    selected_option_id INT UNSIGNED NULL,
+    score FLOAT DEFAULT 0 CHECK (score >= 0),
+    status ENUM('pending','graded','confirmed') DEFAULT 'pending',
+    submission_id INT UNSIGNED NULL,
+    INDEX idx_student_answers_student (student_id),
+    INDEX idx_student_answers_question (question_id),
+    INDEX idx_student_answers_submission (submission_id),
+    INDEX idx_student_answers_selected_option (selected_option_id),
+    CONSTRAINT fk_student_answers_student
+        FOREIGN KEY (student_id) REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_student_answers_question
+        FOREIGN KEY (question_id) REFERENCES exam_questions(id)
+        ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_student_answers_selected_option
+        FOREIGN KEY (selected_option_id) REFERENCES exam_options(id)
+        ON UPDATE CASCADE ON DELETE SET NULL
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 7) submissions
+CREATE TABLE submissions (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    exam_id INT UNSIGNED NOT NULL,
+    user_id INT UNSIGNED NOT NULL,
+    submitted_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    total_score FLOAT DEFAULT 0 CHECK (total_score >= 0),
+    ai_score FLOAT NULL,
+    suggested_total_score FLOAT NULL,
+    instructor_confirmed BOOLEAN DEFAULT FALSE,
+    status ENUM('pending','graded','confirmed') DEFAULT 'pending',
+    INDEX idx_submissions_exam (exam_id),
+    INDEX idx_submissions_user (user_id),
+    CONSTRAINT fk_submissions_exam
+        FOREIGN KEY (exam_id) REFERENCES exams(id)
+        ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_submissions_user
+        FOREIGN KEY (user_id) REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 8) results
+CREATE TABLE results (
+    id INT AUTO_INCREMENT PRIMARY KEY,
+    exam_id INT NOT NULL,
+    student_id INT UNSIGNED NOT NULL,
+    total_score FLOAT DEFAULT 0 CHECK (total_score >= 0),
+    status ENUM('pending','graded','confirmed') DEFAULT 'pending',
+    INDEX idx_results_exam (exam_id),
+    INDEX idx_results_student (student_id),
+    CONSTRAINT fk_results_exam
+        FOREIGN KEY (exam_id) REFERENCES exams(id)
+        ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_results_student
+        FOREIGN KEY (student_id) REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 9) ai_logs
+CREATE TABLE ai_logs (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    question_id INT UNSIGNED NOT NULL,
+    student_id INT UNSIGNED NOT NULL,
+    student_answer TEXT NOT NULL,
+    model_answer TEXT NOT NULL,
+    similarity_score FLOAT NULL,
+    ai_suggested_score FLOAT NULL,
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    INDEX idx_ai_logs_question (question_id),
+    INDEX idx_ai_logs_student (student_id),
+    CONSTRAINT fk_ai_logs_question
+        FOREIGN KEY (question_id) REFERENCES exam_questions(id)
+        ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_ai_logs_student
+        FOREIGN KEY (student_id) REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- 10) user_verified_rooms 
+CREATE TABLE user_verified_rooms (
+    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
+    user_id INT UNSIGNED NOT NULL,
+    exam_room_code VARCHAR(64) NOT NULL,
+    verified_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    CONSTRAINT fk_uvr_user FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_uvr_exam FOREIGN KEY (exam_room_code) REFERENCES exams(exam_room_code) ON UPDATE CASCADE ON DELETE CASCADE,
+    UNIQUE KEY uq_user_room (user_id, exam_room_code)
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- ============================================================================
+-- TRIGGER
+-- ============================================================================
+DELIMITER $$
+
+CREATE TRIGGER trg_confirmed_results_update
+AFTER UPDATE ON submissions
+FOR EACH ROW
+BEGIN
+    IF NEW.instructor_confirmed = TRUE AND NEW.status = 'graded' THEN
+        UPDATE results
+        SET total_score = NEW.suggested_total_score,
+            status = 'confirmed'
+        WHERE results.exam_id = NEW.exam_id
+          AND results.student_id = NEW.user_id;
+    END IF;
+END$$
+
+DELIMITER ;
+
+-- ============================================================================
+-- STORED PROCEDURES
+-- ============================================================================
+DELIMITER $$
+
+-- 1Ô∏è‚É£ Student submit exam
+CREATE PROCEDURE sp_submit_exam(IN p_exam_id INT, IN p_student_id INT)
+BEGIN
+    IF NOT EXISTS (SELECT 1 FROM results WHERE exam_id=p_exam_id AND student_id=p_student_id) THEN
+        INSERT INTO results (exam_id, student_id, status)
+        VALUES (p_exam_id, p_student_id, 'pending');
+    END IF;
+
+    UPDATE submissions
+    SET suggested_total_score = total_score + COALESCE(ai_score,0),
+        status = 'graded'
+    WHERE exam_id = p_exam_id AND user_id = p_student_id;
+END$$
+
+-- 2Ô∏è‚É£ Get results by role
+CREATE PROCEDURE sp_get_exam_results(IN examId INT, IN userRole VARCHAR(20), IN userId INT)
+BEGIN
+    IF userRole = 'student' THEN
+        SELECT r.id, e.title AS exam_title, c.title AS course_title,
+               COALESCE(r.total_score, s.suggested_total_score) AS display_score,
+               CASE 
+                   WHEN r.status='confirmed' THEN 'Final Score (Confirmed)'
+                   WHEN s.status='graded' THEN 'Suggested Score (Awaiting Instructor Approval)'
+                   ELSE 'Pending Grading'
+               END AS score_status
+        FROM results r
+        JOIN exams e ON e.id = r.exam_id
+        JOIN courses c ON c.id = e.course_id
+        JOIN submissions s ON s.exam_id=e.id AND s.user_id=r.student_id
+        WHERE r.exam_id = examId AND r.student_id = userId;
+
+    ELSEIF userRole = 'instructor' THEN
+        SELECT r.id, u.full_name AS student_name, r.total_score, r.status,
+               s.total_score AS mcq_score, s.ai_score AS ai_score,
+               s.suggested_total_score
+        FROM results r
+        JOIN users u ON u.id = r.student_id
+        JOIN submissions s ON s.exam_id = r.exam_id AND s.user_id = r.student_id
+        WHERE r.exam_id = examId;
+
+    ELSEIF userRole = 'admin' THEN
+        SELECT r.*, u.full_name AS student_name, e.title AS exam_title, c.title AS course_title
+        FROM results r
+        JOIN users u ON u.id = r.student_id
+        JOIN exams e ON e.id = r.exam_id
+        JOIN courses c ON c.id = e.course_id;
+    END IF;
+END$$
+
+-- 3Ô∏è‚É£ Instructor: Update student record in an exam
+CREATE PROCEDURE sp_update_student_exam_record(
+    IN p_exam_id INT,
+    IN p_student_id INT,
+    IN p_new_name VARCHAR(100),
+    IN p_new_mcq_score FLOAT,
+    IN p_new_ai_score FLOAT
+)
+BEGIN
+    START TRANSACTION;
+
+    UPDATE users
+    SET full_name = p_new_name
+    WHERE id = p_student_id AND role = 'student';
+
+    UPDATE submissions
+    SET total_score = p_new_mcq_score,
+        ai_score = p_new_ai_score,
+        suggested_total_score = p_new_mcq_score + COALESCE(p_new_ai_score,0),
+        instructor_confirmed = TRUE,
+        status = 'confirmed'
+    WHERE exam_id = p_exam_id AND user_id = p_student_id;
+
+    UPDATE results
+    SET total_score = p_new_mcq_score + COALESCE(p_new_ai_score,0),
+        status = 'confirmed'
+    WHERE exam_id = p_exam_id AND student_id = p_student_id;
+
+    COMMIT;
+END$$
+
+-- 4Ô∏è‚É£ Instructor: Delete all data of a student in an exam (hide name)
+CREATE PROCEDURE sp_delete_student_exam_record(
+    IN p_exam_id INT,
+    IN p_student_id INT
+)
+BEGIN
+    DECLARE exit HANDLER FOR SQLEXCEPTION
+    BEGIN
+        ROLLBACK;
+    END;
+
+    START TRANSACTION;
+
+    DELETE FROM ai_logs
+    WHERE student_id = p_student_id
+      AND question_id IN (
+        SELECT id FROM exam_questions WHERE exam_id = p_exam_id
+      );
+
+    DELETE FROM student_answers
+    WHERE student_id = p_student_id
+      AND question_id IN (
+        SELECT id FROM exam_questions WHERE exam_id = p_exam_id
+      );
+
+    DELETE FROM submissions
+    WHERE user_id = p_student_id AND exam_id = p_exam_id;
+
+    DELETE FROM results
+    WHERE student_id = p_student_id AND exam_id = p_exam_id;
+
+    -- ·∫®n t√™n h·ªçc vi√™n kh·ªèi danh s√°ch hi·ªÉn th·ªã c·ªßa b√†i thi
+    UPDATE users
+    SET full_name = CONCAT('(ƒê√£ x√≥a kh·ªèi b√†i thi #', p_exam_id, ')')
+    WHERE id = p_student_id AND role = 'student';
+
+    COMMIT;
+END$$
+
+DELIMITER ;
+
+-- ============================================================================
+-- VIEWS
+-- ============================================================================
+CREATE OR REPLACE VIEW v_exam_overview AS
+SELECT e.id AS exam_id, e.title AS exam_title, e.exam_room_code, 
+       c.title AS course_title, u.full_name AS instructor
+FROM exams e
+JOIN courses c ON c.id = e.course_id
+JOIN users u ON u.id = c.instructor_id;
+
+-- Instructor: Exam Bank
+CREATE OR REPLACE VIEW v_instructor_exam_bank AS
+SELECT 
+    e.id AS exam_id,
+    e.title AS exam_title,
+    e.status AS exam_status,
+    e.created_at,
+    e.updated_at,
+    c.title AS course_title,
+    u.full_name AS instructor_name,
+    COUNT(eq.id) AS total_questions
+FROM exams e
+JOIN courses c ON e.course_id = c.id
+JOIN users u ON u.id = c.instructor_id
+LEFT JOIN exam_questions eq ON eq.exam_id = e.id
+WHERE u.role = 'instructor'
+GROUP BY e.id
+ORDER BY e.updated_at DESC;
+
+-- Instructor: Assigned Exams (danh s√°ch h·ªçc vi√™n ƒë√£ thi)
+CREATE OR REPLACE VIEW v_instructor_assigned_exams AS
+SELECT 
+    e.id AS exam_id,
+    e.title AS exam_title,
+    c.title AS course_title,
+    u.full_name AS instructor_name,
+    s.user_id AS student_id,
+    stu.full_name AS student_name,
+    s.total_score AS mcq_score,
+    s.ai_score AS ai_score,
+    r.total_score AS final_score,
+    s.status AS submission_status,
+    s.submitted_at AS student_submitted_at
+FROM submissions s
+JOIN exams e ON s.exam_id = e.id
+JOIN courses c ON e.course_id = c.id
+JOIN users u ON c.instructor_id = u.id
+JOIN users stu ON stu.id = s.user_id
+LEFT JOIN results r ON r.exam_id = e.id AND r.student_id = stu.id
+WHERE e.status = 'published'
+ORDER BY e.id, s.submitted_at DESC;
+
+-- Student dashboard
+CREATE OR REPLACE VIEW v_student_results AS
+SELECT e.title AS exam_title,
+       c.title AS course_title,
+       COALESCE(r.total_score, s.suggested_total_score) AS display_score,
+       CASE 
+           WHEN r.status='confirmed' THEN 'Final Score (Confirmed)'
+           WHEN s.status='graded' THEN 'Suggested Score (Awaiting Instructor Approval)'
+           ELSE 'Pending Grading'
+       END AS score_status,
+       s.submitted_at,
+       e.duration
+FROM submissions s
+JOIN exams e ON e.id = s.exam_id
+JOIN courses c ON c.id = e.course_id
+LEFT JOIN results r ON r.exam_id = e.id AND r.student_id = s.user_id
+WHERE s.user_id IN (SELECT id FROM users WHERE role='student');
+
+-- Admin overview
+CREATE OR REPLACE VIEW v_admin_overview AS
+SELECT u.full_name AS instructor_name,
+       c.title AS course_title,
+       e.title AS exam_title,
+       COUNT(s.id) AS total_submissions,
+       AVG(s.suggested_total_score) AS avg_score,
+       SUM(CASE WHEN s.status='confirmed' THEN 1 ELSE 0 END) AS confirmed_count
+FROM users u
+JOIN courses c ON c.instructor_id = u.id
+JOIN exams e ON e.course_id = c.id
+LEFT JOIN submissions s ON s.exam_id = e.id
+GROUP BY e.id;
+
+-- Migrate existing verify_room_code data
+ALTER TABLE users DROP FOREIGN KEY fk_users_verify_room_code;
+ALTER TABLE users MODIFY COLUMN verify_room_code BOOLEAN DEFAULT FALSE;
+
+use oem_mini;
+ALTER TABLE users MODIFY COLUMN verify_room_code BOOLEAN DEFAULT FALSE;
+CREATE TABLE user_verified_rooms (
+    id INT AUTO_INCREMENT PRIMARY KEY,
+    user_id INT UNSIGNED NOT NULL,
+    exam_room_code VARCHAR(20) NOT NULL,
+    verified_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    CONSTRAINT fk_uvr_user FOREIGN KEY (user_id)
+        REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_uvr_exam FOREIGN KEY (exam_room_code)
+        REFERENCES exams(exam_room_code)
+        ON UPDATE CASCADE ON DELETE CASCADE,
+    UNIQUE KEY uq_user_room (user_id, exam_room_code)
+);
+
+-- View for instructor statistics
+CREATE OR REPLACE VIEW v_instructor_stats AS
+SELECT
+  c.instructor_id,
+  COUNT(DISTINCT e.id) AS total_exams,
+  COUNT(s.id) AS total_submissions,
+  COUNT(DISTINCT s.user_id) AS total_students
+FROM courses c
+LEFT JOIN exams e ON e.course_id = c.id
+LEFT JOIN submissions s ON s.exam_id = e.id
+GROUP BY c.instructor_id;
+
+-- =================================================================
+-- ‚úÖ END OF SCRIPT (OEM Mini v5 - Instructor Final Version)
+-- =================================================================
+
+-- =================================================================
+-- ‚úÖUpdate database to Sprint 2
+-- =================================================================
+USE oem_mini;
+
+-- =====================================================
+-- 1Ô∏è‚É£ TABLES
+-- =====================================================
+
+-- (1) Enrollments
+CREATE TABLE IF NOT EXISTS enrollments (
+    id INT AUTO_INCREMENT PRIMARY KEY,
+    user_id INT NOT NULL,
+    course_id INT NOT NULL,
+    enrolled_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    status ENUM('active','cancelled') DEFAULT 'active',
+    UNIQUE KEY uq_enrollment_user_course (user_id, course_id),
+    INDEX idx_enrollments_user (user_id),
+    INDEX idx_enrollments_course (course_id),
+    CONSTRAINT fk_enrollments_user FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_enrollments_course FOREIGN KEY (course_id) REFERENCES courses(id) ON UPDATE CASCADE ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- (2) Import Jobs
+CREATE TABLE IF NOT EXISTS import_jobs (
+    id INT AUTO_INCREMENT PRIMARY KEY,
+    job_uuid VARCHAR(64) NOT NULL UNIQUE,
+    exam_id INT NOT NULL,
+    created_by INT NULL,
+    status ENUM('preview','processing','completed','failed') DEFAULT 'preview',
+    preview_json LONGTEXT NULL,
+    result_summary JSON NULL,
+    error_text TEXT NULL,
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
+    INDEX idx_import_jobs_exam (exam_id),
+    INDEX idx_import_jobs_user (created_by),
+    CONSTRAINT fk_import_jobs_exam FOREIGN KEY (exam_id) REFERENCES exams(id) ON UPDATE CASCADE ON DELETE CASCADE,
+    CONSTRAINT fk_import_jobs_user FOREIGN KEY (created_by) REFERENCES users(id) ON UPDATE CASCADE ON DELETE SET NULL
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- (3) Import Rows
+CREATE TABLE IF NOT EXISTS import_rows (
+    id INT AUTO_INCREMENT PRIMARY KEY,
+    job_id INT NOT NULL,
+    `row_number` INT NOT NULL,
+    row_data LONGTEXT NOT NULL,
+    errors LONGTEXT NULL,
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    INDEX idx_import_rows_job (job_id),
+    CONSTRAINT fk_import_rows_job FOREIGN KEY (job_id)
+        REFERENCES import_jobs (id)
+        ON UPDATE CASCADE
+        ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- (4) Refresh Tokens
+CREATE TABLE IF NOT EXISTS refresh_tokens (
+    id INT AUTO_INCREMENT PRIMARY KEY,
+    user_id INT NOT NULL,
+    token VARCHAR(500) NOT NULL,
+    revoked BOOLEAN DEFAULT FALSE,
+    expires_at DATETIME NULL,
+    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
+    INDEX idx_refresh_tokens_user (user_id),
+    UNIQUE KEY uq_refresh_token_token (token),
+    CONSTRAINT fk_refresh_tokens_user FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE
+) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
+
+-- (5) Submissions (th√™m c·ªôt n·∫øu ch∆∞a c√≥)
+CALL add_column_if_missing('submissions', 'status', "ENUM('pending','graded','confirmed') DEFAULT 'pending'");
+CALL add_column_if_missing('submissions', 'total_score', 'FLOAT DEFAULT 0');
+CALL add_column_if_missing('submissions', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
+CALL add_column_if_missing('submissions', 'updated_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP');
+CREATE INDEX IF NOT EXISTS idx_submissions_status ON submissions (status);
+
+-- (6) Student Answers
+CALL add_column_if_missing('student_answers', 'score', 'FLOAT DEFAULT 0');
+CALL add_column_if_missing('student_answers', 'graded_at', 'DATETIME NULL');
+CREATE INDEX IF NOT EXISTS idx_student_answers_graded_at ON student_answers (graded_at);
+
+-- (7) Exam Questions
+ALTER TABLE exam_questions MODIFY COLUMN type ENUM('MCQ','Essay','Unknown') DEFAULT 'Unknown';
+CALL add_column_if_missing('exam_questions', 'points', 'FLOAT DEFAULT 1');
+CALL add_column_if_missing('exam_questions', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
+CALL add_column_if_missing('exam_questions', 'updated_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP');
+CREATE INDEX IF NOT EXISTS idx_exam_questions_type ON exam_questions (type);
+
+-- (8) Exams
+CALL add_column_if_missing('exams', 'exam_room_code', 'VARCHAR(64) NULL');
+CALL add_column_if_missing('exams', 'status', "ENUM('draft','published','archived') DEFAULT 'draft'");
+CALL add_column_if_missing('exams', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
+CALL add_column_if_missing('exams', 'updated_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP');
+CALL add_column_if_missing('exams', 'deleted_at', 'DATETIME NULL');
+CREATE UNIQUE INDEX IF NOT EXISTS uq_exams_room_code ON exams (exam_room_code);
+
+-- (9) AI Logs
+CALL add_column_if_missing('ai_logs', 'request_payload', 'LONGTEXT NULL');
+CALL add_column_if_missing('ai_logs', 'response_payload', 'LONGTEXT NULL');
+CALL add_column_if_missing('ai_logs', 'error_text', 'TEXT NULL');
+CALL add_column_if_missing('ai_logs', 'created_at', 'DATETIME DEFAULT CURRENT_TIMESTAMP');
+
+-- (10) Soft delete courses
+CALL add_column_if_missing('courses', 'deleted_at', 'DATETIME NULL');
+
+-- =====================================================
+-- 2Ô∏è‚É£ TRIGGERS
+-- =====================================================
+DELIMITER $$
+
+DROP TRIGGER IF EXISTS trg_update_submission_score $$
+CREATE TRIGGER trg_update_submission_score
+AFTER UPDATE ON student_answers
+FOR EACH ROW
+BEGIN
+  DECLARE total FLOAT;
+  SELECT SUM(score) INTO total FROM student_answers WHERE submission_id = NEW.submission_id;
+  UPDATE submissions SET total_score = total WHERE id = NEW.submission_id;
+END$$
+
+DROP TRIGGER IF EXISTS trg_check_submission_status $$
+CREATE TRIGGER trg_check_submission_status
+AFTER UPDATE ON student_answers
+FOR EACH ROW
+BEGIN
+  DECLARE ungraded INT;
+  SELECT COUNT(*) INTO ungraded FROM student_answers WHERE submission_id = NEW.submission_id AND graded_at IS NULL;
+  IF ungraded = 0 THEN
+    UPDATE submissions SET status = 'graded' WHERE id = NEW.submission_id;
+  END IF;
+END$$
+
+DELIMITER ;
+
+-- =====================================================
+-- 3Ô∏è‚É£ PROCEDURES
+-- =====================================================
+DELIMITER $$
+
+-- Helper: safely add a column if missing
+DROP PROCEDURE IF EXISTS add_column_if_missing $$
+CREATE PROCEDURE add_column_if_missing(IN tbl VARCHAR(64), IN col VARCHAR(64), IN coldef TEXT)
+BEGIN
+  IF NOT EXISTS (
+    SELECT 1 FROM INFORMATION_SCHEMA.COLUMNS
+    WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = tbl AND COLUMN_NAME = col
+  ) THEN
+    SET @ddl = CONCAT('ALTER TABLE ', tbl, ' ADD COLUMN ', col, ' ', coldef);
+    PREPARE stmt FROM @ddl;
+    EXECUTE stmt;
+    DEALLOCATE PREPARE stmt;
+  END IF;
+END$$
+
+-- finalize_submission
+DROP PROCEDURE IF EXISTS finalize_submission $$
+CREATE PROCEDURE finalize_submission(IN submissionId INT)
+BEGIN
+  DECLARE total FLOAT;
+  SELECT SUM(score) INTO total FROM student_answers WHERE submission_id = submissionId;
+  UPDATE submissions SET total_score = total, status = 'graded', updated_at = NOW() WHERE id = submissionId;
+END$$
+
+-- import_exam_from_job
+DROP PROCEDURE IF EXISTS import_exam_from_job $$
+CREATE PROCEDURE import_exam_from_job(IN jobId INT)
+BEGIN
+  DECLARE done INT DEFAULT 0;
+  DECLARE q JSON;
+  DECLARE cur CURSOR FOR SELECT row_data FROM import_rows WHERE job_id = jobId;
+  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;
+  
+  OPEN cur;
+  read_loop: LOOP
+    FETCH cur INTO q;
+    IF done THEN LEAVE read_loop; END IF;
+    INSERT INTO exam_questions (exam_id, question_text, type, points, created_at)
+    VALUES (
+      (SELECT exam_id FROM import_jobs WHERE id = jobId),
+      JSON_UNQUOTE(JSON_EXTRACT(q, '$.question_text')),
+      JSON_UNQUOTE(JSON_EXTRACT(q, '$.type')),
+      COALESCE(JSON_UNQUOTE(JSON_EXTRACT(q, '$.points')), 1),
+      NOW()
+    );
+  END LOOP;
+  CLOSE cur;
+  UPDATE import_jobs SET status = 'completed', updated_at = NOW() WHERE id = jobId;
+END$$
+
+DELIMITER ;
+
+-- =====================================================
+-- 4Ô∏è‚É£ VIEWS
+-- =====================================================
+CREATE OR REPLACE VIEW v_exam_overview AS
+SELECT 
+  e.id AS exam_id,
+  e.title AS exam_title,
+  e.status,
+  e.exam_room_code,
+  COUNT(s.id) AS total_submissions,
+  AVG(s.total_score) AS avg_score,
+  MAX(s.updated_at) AS last_activity
+FROM exams e
+LEFT JOIN submissions s ON e.id = s.exam_id
+GROUP BY e.id, e.title, e.status, e.exam_room_code;
+
+CREATE OR REPLACE VIEW v_student_result_overview AS
+SELECT 
+  u.id AS student_id,
+  u.full_name,
+  e.title AS exam_title,
+  s.id AS submission_id,
+  s.total_score,
+  s.status,
+  s.updated_at AS graded_at
+FROM submissions s
+JOIN users u ON s.user_id = u.id
+JOIN exams e ON s.exam_id = e.id;
+
+CREATE OR REPLACE VIEW v_ai_logs_trace AS
+SELECT 
+  id AS log_id,
+  request_payload,
+  response_payload,
+  error_text,
+  created_at
+FROM ai_logs
+ORDER BY created_at DESC;
+
+SELECT '‚úÖ OEM Mini schema successfully updated (no warnings, MySQL-safe)' AS message;
+
+----- s·ª≠a b·ªï sung id_instructor
+USE oem_mini;
+ALTER TABLE exams
+    DROP FOREIGN KEY fk_exams_course,
+    DROP COLUMN course_id,
+    ADD COLUMN instructor_id INT UNSIGNED NOT NULL AFTER id,
+    ADD CONSTRAINT fk_exams_instructor
+        FOREIGN KEY (instructor_id) REFERENCES users(id)
+        ON UPDATE CASCADE ON DELETE CASCADE;
+-- n·∫øu l·ªói kh√≥a ngo·∫°i th√¨ ch·∫°y l·ªánh sau tr∆∞·ªõc
+SET SQL_SAFE_UPDATES = 0;
+
+UPDATE exams SET instructor_id = 18;
+
+SET SQL_SAFE_UPDATES = 1;
+-- ch·∫°y ƒë·ªÉ ki·ªÉm tra t·ªìn t·∫°i
+SELECT id, title, instructor_id FROM exams;
+-- s·ª≠a b·ªï sung id_instructor kh√≥a ngo·∫°i
+ALTER TABLE exams
+ADD CONSTRAINT fk_exams_instructor
+FOREIGN KEY (instructor_id) REFERENCES users(id)
+ON UPDATE CASCADE ON DELETE CASCADE;
+-- b·ªï sung id_exam v√†o b·∫£ng exam_questions
+
+USE oem_mini;
+
+-- 1Ô∏è‚É£ T·∫°m t·∫Øt ki·ªÉm tra kh√≥a ngo·∫°i
+SET FOREIGN_KEY_CHECKS = 0;
+
+-- 2Ô∏è‚É£ Ki·ªÉm tra xem c·ªôt exam_id ƒë√£ t·ªìn t·∫°i ch∆∞a
+SET @col_exists := (
+  SELECT COUNT(*) 
+  FROM INFORMATION_SCHEMA.COLUMNS 
+  WHERE TABLE_SCHEMA = 'oem_mini' 
+    AND TABLE_NAME = 'exam_questions' 
+    AND COLUMN_NAME = 'exam_id'
+);
+
+-- 3Ô∏è‚É£ N·∫øu ch∆∞a c√≥ c·ªôt th√¨ th√™m m·ªõi
+SET @sql := IF(@col_exists = 0, 
+  'ALTER TABLE exam_questions ADD COLUMN exam_id INT NULL AFTER id;', 
+  'SELECT "Column exam_id already exists";'
+);
+PREPARE stmt FROM @sql;
+EXECUTE stmt;
+DEALLOCATE PREPARE stmt;
+
+-- 4Ô∏è‚É£ C·∫≠p nh·∫≠t exam_id h·ª£p l·ªá (gi·∫£ s·ª≠ ƒë·ªÅ thi c√≥ id = 2)
+UPDATE exam_questions 
+SET exam_id = 2 
+WHERE exam_id IS NULL 
+   OR exam_id NOT IN (SELECT id FROM exams);
+
+-- 5Ô∏è‚É£ X√≥a kh√≥a ngo·∫°i c≈© n·∫øu c√≥
+SET @fk_name := (
+  SELECT CONSTRAINT_NAME
+  FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
+  WHERE TABLE_SCHEMA = 'oem_mini'
+    AND TABLE_NAME = 'exam_questions'
+    AND COLUMN_NAME = 'exam_id'
+    AND REFERENCED_TABLE_NAME = 'exams'
+  LIMIT 1
+);
+SET @sql := IF(@fk_name IS NOT NULL, 
+  CONCAT('ALTER TABLE exam_questions DROP FOREIGN KEY ', @fk_name, ';'), 
+  'SELECT "No old FK found";'
+);
+PREPARE stmt FROM @sql;
+EXECUTE stmt;
+DEALLOCATE PREPARE stmt;
+
+-- 6Ô∏è‚É£ T·∫°o l·∫°i kh√≥a ngo·∫°i m·ªõi ƒë√∫ng chu·∫©n
+ALTER TABLE exam_questions
+ADD CONSTRAINT fk_exam_questions_exam
+FOREIGN KEY (exam_id) REFERENCES exams(id)
+ON UPDATE CASCADE ON DELETE CASCADE;
+
+-- 7Ô∏è‚É£ B·∫≠t l·∫°i ki·ªÉm tra kh√≥a ngo·∫°i
+SET FOREIGN_KEY_CHECKS = 1;
+
+-- 8Ô∏è‚É£ Ki·ªÉm tra k·∫øt qu·∫£
+SELECT 
+  CONSTRAINT_NAME, TABLE_NAME, COLUMN_NAME, 
+  REFERENCED_TABLE_NAME, REFERENCED_COLUMN_NAME
+FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
+WHERE TABLE_SCHEMA = 'oem_mini' 
+  AND TABLE_NAME = 'exam_questions' 
+  AND REFERENCED_TABLE_NAME = 'exams';
+--- view instructor exam bank qu·∫£n l√Ω ƒë·ªÅ thi
+CREATE OR REPLACE VIEW v_exam_questions_detail AS
+SELECT 
+  q.id AS question_id,
+  e.id AS exam_id,
+  e.title AS exam_title,
+  q.question_text,
+  q.type,
+  q.model_answer,
+  q.points,
+  q.created_by
+FROM exam_questions q
+JOIN exams e ON q.exam_id = e.id;
+-- ki·ªÉm tra view
+SELECT * FROM v_exam_questions_detail WHERE created_by = ? AND exam_id = ?;
+
+-- x√≥a b·∫£ng courses k c·∫ßn n·ªØa
+USE oem_mini;
+SET FOREIGN_KEY_CHECKS = 0;
+ALTER TABLE enrollments
+DROP FOREIGN KEY fk_enrollments_course;
+ALTER TABLE exams
+DROP FOREIGN KEY fk_exams_course;
+ALTER TABLE exams
+DROP COLUMN course_id;
+DROP TABLE IF EXISTS courses;
+SET FOREIGN_KEY_CHECKS = 1;
+SELECT '‚úÖ ƒê√£ x√≥a kh√≥a ngo·∫°i, c·ªôt course_id trong exams v√† c√°c b·∫£ng courses, enrollments th√†nh c√¥ng.' AS message;
+
+-- update exams table + submission table cho ph√≤ng thi
+USE oem_mini;
+SET @db := DATABASE();
+
+-- exam_id (INT UNSIGNED, NOT NULL)
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='exam_id';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN exam_id INT UNSIGNED NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- user_id (INT UNSIGNED, NOT NULL)
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='user_id';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN user_id INT UNSIGNED NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- attempt_no
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='attempt_no';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN attempt_no INT NOT NULL DEFAULT 1',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- started_at
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='started_at';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN started_at DATETIME NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- submitted_at
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='submitted_at';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN submitted_at DATETIME NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- status
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='status';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN status ENUM(''pending'',''in_progress'',''submitted'',''graded'',''cancelled'') NOT NULL DEFAULT ''pending''',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- face_image_blob
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_blob';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN face_image_blob LONGBLOB NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- face_image_mimetype
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_mimetype';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN face_image_mimetype VARCHAR(100) NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- face_image_url
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_url';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN face_image_url VARCHAR(500) NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- student_card_blob
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_blob';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN student_card_blob LONGBLOB NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- student_card_mimetype
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_mimetype';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN student_card_mimetype VARCHAR(100) NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- student_card_url
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_url';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN student_card_url VARCHAR(500) NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- proctor_flags (JSON)
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND COLUMN_NAME='proctor_flags';
+SET @sql := IF(@c=0,
+  'ALTER TABLE submissions ADD COLUMN proctor_flags JSON NULL',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+/* ---------- Backfill nh·ªè ---------- */
+UPDATE submissions SET attempt_no = 1 WHERE attempt_no IS NULL;
+
+/* ---------- ƒê·∫£m b·∫£o ki·ªÉu c·ªôt ƒë√∫ng ƒë·ªÉ g·∫Øn FK ---------- */
+-- (N·∫øu tr∆∞·ªõc ƒë√≥ l·ª° t·∫°o BIGINT th√¨ ƒë·ªïi v·ªÅ INT UNSIGNED)
+ALTER TABLE submissions
+  MODIFY COLUMN exam_id INT UNSIGNED NULL,
+  MODIFY COLUMN user_id INT UNSIGNED NULL;
+
+/* ---------- Foreign Keys (th√™m n·∫øu ch∆∞a c√≥) ---------- */
+-- Xo√° tr∆∞·ªõc n·∫øu ƒë√£ t·ªìn t·∫°i ƒë·ªÉ tr√°nh va
+SET FOREIGN_KEY_CHECKS = 0;
+SELECT COUNT(*) INTO @fk_exists
+FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
+WHERE CONSTRAINT_SCHEMA=@db AND CONSTRAINT_NAME='fk_submissions__exams';
+SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__exams','SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+SELECT COUNT(*) INTO @fk_exists
+FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
+WHERE CONSTRAINT_SCHEMA=@db AND CONSTRAINT_NAME='fk_submissions__users';
+SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__users','SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+SET FOREIGN_KEY_CHECKS = 1;
+
+-- Th√™m l·∫°i FK
+ALTER TABLE submissions
+  ADD CONSTRAINT fk_submissions__exams
+    FOREIGN KEY (exam_id) REFERENCES exams(id)
+    ON DELETE CASCADE ON UPDATE CASCADE,
+  ADD CONSTRAINT fk_submissions__users
+    FOREIGN KEY (user_id) REFERENCES users(id)
+    ON DELETE CASCADE ON UPDATE CASCADE;
+
+/* ---------- Indexes (t·∫°o n·∫øu thi·∫øu) ---------- */
+-- Unique (exam_id, user_id, attempt_no)
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='uq_submissions_exam_user_attempt';
+SET @sql := IF(@idx_exists=0,
+  'CREATE UNIQUE INDEX uq_submissions_exam_user_attempt ON submissions (exam_id, user_id, attempt_no)',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- Index (exam_id, user_id)
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_exam_user';
+SET @sql := IF(@idx_exists=0,
+  'CREATE INDEX idx_submissions_exam_user ON submissions (exam_id, user_id)',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- Index (status)
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_status';
+SET @sql := IF(@idx_exists=0,
+  'CREATE INDEX idx_submissions_status ON submissions (status)',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- Index (user_id)
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=@db AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_user';
+SET @sql := IF(@idx_exists=0,
+  'CREATE INDEX idx_submissions_user ON submissions (user_id)',
+  'SELECT 1'); PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+
+--
+ALTER TABLE exams
+  MODIFY COLUMN duration_minutes INT NOT NULL DEFAULT 60,
+  MODIFY COLUMN max_points DECIMAL(10,2) NULL,
+  MODIFY COLUMN require_face_check TINYINT(1) NOT NULL DEFAULT 0,
+  MODIFY COLUMN require_student_card TINYINT(1) NOT NULL DEFAULT 0,
+  MODIFY COLUMN monitor_screen TINYINT(1) NOT NULL DEFAULT 0;
+
+
+USE oem_mini;
+
+/* Drop target columns if exist */
+-- duration_minutes
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='duration_minutes';
+SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN duration_minutes', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- time_open
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='time_open';
+SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN time_open', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- time_close
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='time_close';
+SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN time_close', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- max_points
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='max_points';
+SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN max_points', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- require_face_check
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='require_face_check';
+SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN require_face_check', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- require_student_card
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='require_student_card';
+SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN require_student_card', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- monitor_screen
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND COLUMN_NAME='monitor_screen';
+SET @sql := IF(@c=1, 'ALTER TABLE exams DROP COLUMN monitor_screen', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+/* Add fresh columns */
+ALTER TABLE exams
+  ADD COLUMN duration_minutes INT NOT NULL DEFAULT 60,
+  ADD COLUMN time_open DATETIME NULL,
+  ADD COLUMN time_close DATETIME NULL,
+  ADD COLUMN max_points DECIMAL(10,2) NULL,
+  ADD COLUMN require_face_check TINYINT(1) NOT NULL DEFAULT 0,
+  ADD COLUMN require_student_card TINYINT(1) NOT NULL DEFAULT 0,
+  ADD COLUMN monitor_screen TINYINT(1) NOT NULL DEFAULT 0;
+
+/* Recreate indexes for EXAMS */
+-- idx_exams_status_room
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND INDEX_NAME='idx_exams_status_room';
+SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_exams_status_room ON exams', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+CREATE INDEX idx_exams_status_room ON exams (status, exam_room_code);
+
+-- idx_exams_time_open
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='exams' AND INDEX_NAME='idx_exams_time_open';
+SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_exams_time_open ON exams', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+CREATE INDEX idx_exams_time_open ON exams (time_open);
+
+/* Ensure submissions table exists (id only) */
+CREATE TABLE IF NOT EXISTS submissions (
+  id BIGINT PRIMARY KEY AUTO_INCREMENT
+);
+
+/* Drop FKs first to allow dropping columns safely */
+SET FOREIGN_KEY_CHECKS = 0;
+
+-- drop FK exams
+SELECT COUNT(*) INTO @fk_exists
+FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
+WHERE CONSTRAINT_SCHEMA=DATABASE() AND CONSTRAINT_NAME='fk_submissions__exams';
+SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__exams', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- drop FK users
+SELECT COUNT(*) INTO @fk_exists
+FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
+WHERE CONSTRAINT_SCHEMA=DATABASE() AND CONSTRAINT_NAME='fk_submissions__users';
+SET @sql := IF(@fk_exists>0, 'ALTER TABLE submissions DROP FOREIGN KEY fk_submissions__users', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+SET FOREIGN_KEY_CHECKS = 1;
+
+/* Drop indexes so we can rebuild clean */
+-- unique attempt index
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='uq_submissions_exam_user_attempt';
+SET @sql := IF(@idx_exists>0, 'DROP INDEX uq_submissions_exam_user_attempt ON submissions', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+-- other indexes
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_exam_user';
+SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_submissions_exam_user ON submissions', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_status';
+SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_submissions_status ON submissions', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+SELECT COUNT(*) INTO @idx_exists
+FROM INFORMATION_SCHEMA.STATISTICS
+WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND INDEX_NAME='idx_submissions_user';
+SET @sql := IF(@idx_exists>0, 'DROP INDEX idx_submissions_user ON submissions', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+
+/* Drop target columns (if exist) and add fresh ones */
+-- exam_id
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='exam_id';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN exam_id', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN exam_id BIGINT NULL;
+
+-- user_id
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='user_id';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN user_id', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN user_id BIGINT NULL;
+
+-- attempt_no
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='attempt_no';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN attempt_no', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN attempt_no INT NOT NULL DEFAULT 1;
+
+-- started_at
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='started_at';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN started_at', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN started_at DATETIME NULL;
+
+-- submitted_at
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='submitted_at';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN submitted_at', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN submitted_at DATETIME NULL;
+
+-- status
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='status';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN status', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions
+  ADD COLUMN status ENUM('pending','in_progress','submitted','graded','cancelled')
+  NOT NULL DEFAULT 'pending';
+
+-- face_image_blob
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_blob';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN face_image_blob', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN face_image_blob LONGBLOB NULL;
+
+-- face_image_mimetype
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_mimetype';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN face_image_mimetype', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN face_image_mimetype VARCHAR(100) NULL;
+
+-- face_image_url
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='face_image_url';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN face_image_url', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN face_image_url VARCHAR(500) NULL;
+
+-- student_card_blob
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_blob';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN student_card_blob', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN student_card_blob LONGBLOB NULL;
+
+-- student_card_mimetype
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_mimetype';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN student_card_mimetype', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN student_card_mimetype VARCHAR(100) NULL;
+
+-- student_card_url
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='student_card_url';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN student_card_url', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN student_card_url VARCHAR(500) NULL;
+
+-- proctor_flags
+SELECT COUNT(*) INTO @c FROM INFORMATION_SCHEMA.COLUMNS
+ WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='submissions' AND COLUMN_NAME='proctor_flags';
+SET @sql := IF(@c=1, 'ALTER TABLE submissions DROP COLUMN proctor_flags', 'SELECT 1');
+PREPARE s FROM @sql; EXECUTE s; DEALLOCATE PREPARE s;
+ALTER TABLE submissions ADD COLUMN proctor_flags JSON NULL;
+
+/* Recreate FKs */
+SET FOREIGN_KEY_CHECKS = 1;
+ALTER TABLE submissions
+  ADD CONSTRAINT fk_submissions__exams
+    FOREIGN KEY (exam_id) REFERENCES exams(id)
+    ON DELETE CASCADE ON UPDATE CASCADE;
+
+ALTER TABLE submissions
+  ADD CONSTRAINT fk_submissions__users
+    FOREIGN KEY (user_id) REFERENCES users(id)
+    ON DELETE CASCADE ON UPDATE CASCADE;
+/* NOTE: n·∫øu b·∫£ng user c·ªßa b·∫°n KH√îNG ph·∫£i 'users', h√£y ƒë·ªïi t√™n ·ªü d√≤ng tr√™n. */
+
+/* Recreate Indexes */
+CREATE UNIQUE INDEX uq_submissions_exam_user_attempt
+  ON submissions (exam_id, user_id, attempt_no);
+
+CREATE INDEX idx_submissions_exam_user
+  ON submissions (exam_id, user_id);
+
+CREATE INDEX idx_submissions_status
+  ON submissions (status);
+
+CREATE INDEX idx_submissions_user
+  ON submissions (user_id);
+---
+DELIMITER $$
+
+DROP PROCEDURE IF EXISTS sp_get_exam_results $$
+CREATE PROCEDURE sp_get_exam_results(IN p_exam_id INT, IN p_role VARCHAR(20), IN p_instructor_id INT)
+BEGIN
+    SELECT u.full_name AS student_name, s.user_id AS student_id, s.status,
+           COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) AS mcq_score,
+           s.ai_score,
+           COALESCE(s.suggested_total_score,
+                    COALESCE(SUM(CASE WHEN q.type='MCQ' THEN COALESCE(sa.score,0) ELSE 0 END),0) + COALESCE(s.ai_score,0)) AS suggested_total_score,
+           s.total_score, s.started_at, s.submitted_at,
+           TIMESTAMPDIFF(MINUTE, s.started_at, s.submitted_at) AS duration_minutes,
+           s.proctor_flags, s.face_image_url, s.student_card_url
+    FROM submissions s
+    JOIN users u ON u.id = s.user_id
+    LEFT JOIN student_answers sa ON sa.submission_id = s.id
+    LEFT JOIN exam_questions q ON q.id = sa.question_id
+    WHERE s.exam_id = p_exam_id
+    GROUP BY s.id
+    ORDER BY u.full_name;
+END $$
+DELIMITER ;
+--
+DELIMITER $$
+
+DROP PROCEDURE IF EXISTS sp_update_student_exam_record $$
+CREATE PROCEDURE sp_update_student_exam_record(
+    IN p_exam_id INT,
+    IN p_student_id INT,
+    IN p_student_name VARCHAR(255),
+    IN p_mcq_score DECIMAL(10,2),
+    IN p_ai_score DECIMAL(10,2)
+)
+BEGIN
+    -- (tu·ª≥ ch·ªçn) g√≥i trong transaction
+    START TRANSACTION;
+
+    -- 1) C·∫≠p nh·∫≠t submissions
+    UPDATE submissions
+    SET
+        total_score = COALESCE(p_mcq_score, 0),
+        ai_score = COALESCE(p_ai_score, 0),
+        suggested_total_score = COALESCE(p_mcq_score, 0) + COALESCE(p_ai_score, 0),
+        instructor_confirmed = TRUE,
+        status = 'confirmed'
+    WHERE exam_id = p_exam_id
+      AND user_id = p_student_id;
+
+    -- 2) C·∫≠p nh·∫≠t results b·∫±ng JOIN ƒë·ªÉ tr√°nh subquery tr·∫£ nhi·ªÅu d√≤ng
+    UPDATE results r
+    JOIN submissions s
+      ON s.exam_id = r.exam_id
+     AND s.user_id  = r.student_id
+    SET
+        r.total_score = s.total_score,
+        r.status = 'confirmed'
+    WHERE r.exam_id = p_exam_id
+      AND r.student_id = p_student_id;
+
+    -- 3) C·∫≠p nh·∫≠t t√™n sinh vi√™n n·∫øu c√≥
+    IF p_student_name IS NOT NULL AND LENGTH(TRIM(p_student_name)) > 0 THEN
+        UPDATE users
+        SET full_name = p_student_name
+        WHERE id = p_student_id;
+    END IF;
+
+    COMMIT;
+END $$
+DELIMITER ;
+
+
+
+
+-- =================================================================
+-- ‚úÖ END OF SCRIPT (OEM Mini v5.1 - Sprint 2 Update)
diff --git a/database/test_oem_v5.sql b/database/test_oem_v5.sql
index 8fe5d31..060e014 100644
--- a/database/test_oem_v5.sql
+++ b/database/test_oem_v5.sql
@@ -1,218 +1,218 @@
--- ============================================================================
--- üßπ RESET DATA (OEM Mini v5 ‚Äì Synced with Migration)
--- ============================================================================
-USE oem_mini;
-SET SQL_SAFE_UPDATES = 0;
-SET FOREIGN_KEY_CHECKS = 0;
-
-DELETE FROM ai_logs;
-DELETE FROM student_answers;
-DELETE FROM submissions;
-DELETE FROM results;
-DELETE FROM exam_options;
-DELETE FROM exam_questions;
-DELETE FROM exams;
-DELETE FROM courses;
-DELETE FROM users;
-ALTER TABLE users AUTO_INCREMENT = 1;
-
-SET FOREIGN_KEY_CHECKS = 1;
-SET SQL_SAFE_UPDATES = 1;
-
--- ============================================================================
--- üë• 1Ô∏è‚É£ USERS
--- ============================================================================
-INSERT INTO users (full_name, email, password_hash, role)
-VALUES 
-('Admin User', 'admin@oem.com', 'hash_admin', 'admin'),
-('Dr. Smith', 'smith@uni.edu', 'hash_instructor', 'instructor'),
-('Alice Nguyen', 'alice@student.com', 'hash_123', 'student'),
-('Bob Tran', 'bob@student.com', 'hash_456', 'student'),
-('Carol Pham', 'carol@student.com', 'hash_789', 'student');
-
--- ============================================================================
--- üìö 2Ô∏è‚É£ COURSES
--- ============================================================================
-INSERT INTO courses (title, description, instructor_id)
-VALUES
-('Database Systems', 'Learn SQL, ERD, normalization.', 2),
-('Web Development', 'Intro to HTML, CSS, JS.', 2);
-
--- ============================================================================
--- üßæ 3Ô∏è‚É£ EXAMS
--- ============================================================================
-INSERT INTO exams (course_id, title, duration, exam_room_code, status)
-VALUES
-(1, 'DB Midterm', 60, 'ROOM123', 'published'),
-(1, 'DB Final', 90, 'ROOM456', 'draft'),
-(2, 'Web Quiz', 30, 'ROOM789', 'published');
-
--- ============================================================================
--- ‚ùì 4Ô∏è‚É£ QUESTIONS + OPTIONS
--- ============================================================================
-INSERT INTO exam_questions (exam_id, question_text, type, model_answer, points)
-VALUES
-(1, 'What is SQL?', 'Essay', 'Structured Query Language', 2),
-(1, 'Which are SQL commands?', 'MCQ', 'SELECT', 1);
-
-INSERT INTO exam_options (question_id, option_text, is_correct)
-VALUES
-(2, 'SELECT', TRUE),
-(2, 'WHERE', TRUE),
-(2, 'HTML', FALSE),
-(2, 'JOIN', TRUE);
-
--- ============================================================================
--- üßÆ 5Ô∏è‚É£ RESULTS
--- ============================================================================
-INSERT INTO results (exam_id, student_id, total_score, status)
-VALUES
-(1, 3, 0, 'pending'),
-(1, 4, 0, 'pending'),
-(1, 5, 0, 'pending');
-
--- ============================================================================
--- üìù 6Ô∏è‚É£ SUBMISSIONS
--- ============================================================================
-INSERT INTO submissions (exam_id, user_id, total_score, ai_score, suggested_total_score, instructor_confirmed, status)
-VALUES
-(1, 3, 7, 1, 8, FALSE, 'graded'),
-(1, 4, 6, 2, 8, FALSE, 'graded'),
-(1, 5, 9, 0, 9, FALSE, 'graded');
-
--- ============================================================================
--- ‚ö° 7Ô∏è‚É£ TRIGGER TEST
--- ============================================================================
-UPDATE submissions
-SET instructor_confirmed = TRUE, status = 'graded'
-WHERE exam_id = 1 AND user_id = 3;
-
-SELECT * FROM results WHERE exam_id = 1;
-
--- ============================================================================
--- ‚úèÔ∏è 8Ô∏è‚É£ PROCEDURE TEST ‚Äì Update
--- ============================================================================
-CALL sp_update_student_exam_record(1, 3, 'Alice Updated', 9.5, 1.5);
-
-SELECT * FROM submissions WHERE exam_id = 1 AND user_id = 3;
-SELECT * FROM results WHERE exam_id = 1 AND student_id = 3;
-SELECT * FROM users WHERE id = 3;
-
--- ============================================================================
--- üóëÔ∏è 9Ô∏è‚É£ PROCEDURE TEST ‚Äì Delete
--- ============================================================================
-CALL sp_delete_student_exam_record(1, 4);
-
-SELECT * FROM submissions WHERE exam_id = 1 AND user_id = 4;
-SELECT * FROM results WHERE exam_id = 1 AND student_id = 4;
-SELECT * FROM users WHERE id = 4;
-
--- ============================================================================
--- üëÄ üîü VIEWS TEST
--- ============================================================================
-SELECT * FROM v_instructor_exam_bank;
-SELECT * FROM v_instructor_assigned_exams;
-SELECT * FROM v_student_results;
-SELECT * FROM v_admin_overview;
-
--- ============================================================================
--- üß† 1Ô∏è‚É£1Ô∏è‚É£ CASCADE TEST
--- ============================================================================
-DELETE FROM exams WHERE id = 1;
-SELECT COUNT(*) AS remaining_questions FROM exam_questions WHERE exam_id = 1;
-SELECT COUNT(*) AS remaining_submissions FROM submissions WHERE exam_id = 1;
-SELECT COUNT(*) AS remaining_results FROM results WHERE exam_id = 1;
----- x√≥a c√°c view li√™n quan ƒë·∫øn b·∫£ng recourse trc ƒë√≥
-USE oem_mini;
-
-DROP VIEW IF EXISTS 
-v_exam_overview,
-v_instructor_assigned_exams,
-v_instructor_exam_bank,
-v_instructor_stats,
-v_student_results;
--- update l·∫°i c√°c view
-
-USE oem_mini;
-CREATE OR REPLACE VIEW v_exam_overview AS
-SELECT 
-    e.id AS exam_id,
-    e.title AS exam_title,
-    e.status AS exam_status,
-    e.instructor_id AS instructor_id,
-    u.full_name AS instructor_name,
-    COUNT(DISTINCT q.id) AS total_questions,
-    COUNT(DISTINCT sub.user_id) AS total_students,
-    COUNT(DISTINCT sub.id) AS total_submissions,
-    MAX(sub.submitted_at) AS last_submission_time
-FROM exams e
-LEFT JOIN users u ON u.id = e.instructor_id
-LEFT JOIN exam_questions q ON q.exam_id = e.id
-LEFT JOIN submissions sub ON sub.exam_id = e.id
-GROUP BY e.id, e.title, e.status, e.instructor_id, u.full_name;
-
-USE oem_mini;
-
-CREATE OR REPLACE VIEW v_instructor_exam_bank AS
-SELECT 
-    e.id AS exam_id,
-    e.title AS exam_title,
-    e.status AS exam_status,
-    e.instructor_id,
-    u.full_name AS instructor_name,
-    COUNT(DISTINCT q.id) AS total_questions,
-    COUNT(DISTINCT sub.user_id) AS total_students,
-    MAX(sub.submitted_at) AS last_submission_time
-FROM exams e
-LEFT JOIN users u ON u.id = e.instructor_id
-LEFT JOIN exam_questions q ON q.exam_id = e.id
-LEFT JOIN submissions sub ON sub.exam_id = e.id
-GROUP BY e.id, e.title, e.status, e.instructor_id, u.full_name;
-
-CREATE OR REPLACE VIEW v_instructor_assigned_exams AS
-SELECT 
-    e.id AS exam_id,
-    e.title AS exam_title,
-    e.status AS exam_status,
-    e.instructor_id,
-    u.full_name AS instructor_name,
-    COUNT(DISTINCT sub.user_id) AS total_students,
-    COUNT(DISTINCT sub.id) AS total_submissions,
-    MAX(sub.submitted_at) AS last_submission_time
-FROM exams e
-LEFT JOIN users u ON u.id = e.instructor_id
-LEFT JOIN submissions sub ON sub.exam_id = e.id
-WHERE e.status IN ('active', 'open', 'ongoing')
-GROUP BY e.id, e.title, e.status, e.instructor_id, u.full_name;
-
-CREATE OR REPLACE VIEW v_instructor_stats AS
-SELECT 
-    u.id AS instructor_id,
-    u.full_name AS instructor_name,
-    COUNT(DISTINCT e.id) AS total_exams,
-    COUNT(DISTINCT sub.user_id) AS total_students,
-    COUNT(DISTINCT sub.id) AS total_submissions,
-    AVG(sub.total_score) AS avg_score
-FROM users u
-LEFT JOIN exams e ON e.instructor_id = u.id
-LEFT JOIN submissions sub ON sub.exam_id = e.id
-WHERE u.role = 'instructor'
-GROUP BY u.id, u.full_name;
-
-CREATE OR REPLACE VIEW v_student_results AS
-SELECT 
-    s.id AS submission_id,
-    s.exam_id,
-    e.title AS exam_title,
-    s.user_id AS student_id,
-    u.full_name AS student_name,
-    s.total_score,
-    s.ai_score,
-    s.suggested_total_score,
-    s.instructor_confirmed,
-    s.status,
-    s.submitted_at
-FROM submissions s
-JOIN exams e ON e.id = s.exam_id
-JOIN users u ON u.id = s.user_id
-ORDER BY s.submitted_at DESC;
+-- ============================================================================
+-- üßπ RESET DATA (OEM Mini v5 ‚Äì Synced with Migration)
+-- ============================================================================
+USE oem_mini;
+SET SQL_SAFE_UPDATES = 0;
+SET FOREIGN_KEY_CHECKS = 0;
+
+DELETE FROM ai_logs;
+DELETE FROM student_answers;
+DELETE FROM submissions;
+DELETE FROM results;
+DELETE FROM exam_options;
+DELETE FROM exam_questions;
+DELETE FROM exams;
+DELETE FROM courses;
+DELETE FROM users;
+ALTER TABLE users AUTO_INCREMENT = 1;
+
+SET FOREIGN_KEY_CHECKS = 1;
+SET SQL_SAFE_UPDATES = 1;
+
+-- ============================================================================
+-- üë• 1Ô∏è‚É£ USERS
+-- ============================================================================
+INSERT INTO users (full_name, email, password_hash, role)
+VALUES 
+('Admin User', 'admin@oem.com', 'hash_admin', 'admin'),
+('Dr. Smith', 'smith@uni.edu', 'hash_instructor', 'instructor'),
+('Alice Nguyen', 'alice@student.com', 'hash_123', 'student'),
+('Bob Tran', 'bob@student.com', 'hash_456', 'student'),
+('Carol Pham', 'carol@student.com', 'hash_789', 'student');
+
+-- ============================================================================
+-- üìö 2Ô∏è‚É£ COURSES
+-- ============================================================================
+INSERT INTO courses (title, description, instructor_id)
+VALUES
+('Database Systems', 'Learn SQL, ERD, normalization.', 2),
+('Web Development', 'Intro to HTML, CSS, JS.', 2);
+
+-- ============================================================================
+-- üßæ 3Ô∏è‚É£ EXAMS
+-- ============================================================================
+INSERT INTO exams (course_id, title, duration, exam_room_code, status)
+VALUES
+(1, 'DB Midterm', 60, 'ROOM123', 'published'),
+(1, 'DB Final', 90, 'ROOM456', 'draft'),
+(2, 'Web Quiz', 30, 'ROOM789', 'published');
+
+-- ============================================================================
+-- ‚ùì 4Ô∏è‚É£ QUESTIONS + OPTIONS
+-- ============================================================================
+INSERT INTO exam_questions (exam_id, question_text, type, model_answer, points)
+VALUES
+(1, 'What is SQL?', 'Essay', 'Structured Query Language', 2),
+(1, 'Which are SQL commands?', 'MCQ', 'SELECT', 1);
+
+INSERT INTO exam_options (question_id, option_text, is_correct)
+VALUES
+(2, 'SELECT', TRUE),
+(2, 'WHERE', TRUE),
+(2, 'HTML', FALSE),
+(2, 'JOIN', TRUE);
+
+-- ============================================================================
+-- üßÆ 5Ô∏è‚É£ RESULTS
+-- ============================================================================
+INSERT INTO results (exam_id, student_id, total_score, status)
+VALUES
+(1, 3, 0, 'pending'),
+(1, 4, 0, 'pending'),
+(1, 5, 0, 'pending');
+
+-- ============================================================================
+-- üìù 6Ô∏è‚É£ SUBMISSIONS
+-- ============================================================================
+INSERT INTO submissions (exam_id, user_id, total_score, ai_score, suggested_total_score, instructor_confirmed, status)
+VALUES
+(1, 3, 7, 1, 8, FALSE, 'graded'),
+(1, 4, 6, 2, 8, FALSE, 'graded'),
+(1, 5, 9, 0, 9, FALSE, 'graded');
+
+-- ============================================================================
+-- ‚ö° 7Ô∏è‚É£ TRIGGER TEST
+-- ============================================================================
+UPDATE submissions
+SET instructor_confirmed = TRUE, status = 'graded'
+WHERE exam_id = 1 AND user_id = 3;
+
+SELECT * FROM results WHERE exam_id = 1;
+
+-- ============================================================================
+-- ‚úèÔ∏è 8Ô∏è‚É£ PROCEDURE TEST ‚Äì Update
+-- ============================================================================
+CALL sp_update_student_exam_record(1, 3, 'Alice Updated', 9.5, 1.5);
+
+SELECT * FROM submissions WHERE exam_id = 1 AND user_id = 3;
+SELECT * FROM results WHERE exam_id = 1 AND student_id = 3;
+SELECT * FROM users WHERE id = 3;
+
+-- ============================================================================
+-- üóëÔ∏è 9Ô∏è‚É£ PROCEDURE TEST ‚Äì Delete
+-- ============================================================================
+CALL sp_delete_student_exam_record(1, 4);
+
+SELECT * FROM submissions WHERE exam_id = 1 AND user_id = 4;
+SELECT * FROM results WHERE exam_id = 1 AND student_id = 4;
+SELECT * FROM users WHERE id = 4;
+
+-- ============================================================================
+-- üëÄ üîü VIEWS TEST
+-- ============================================================================
+SELECT * FROM v_instructor_exam_bank;
+SELECT * FROM v_instructor_assigned_exams;
+SELECT * FROM v_student_results;
+SELECT * FROM v_admin_overview;
+
+-- ============================================================================
+-- üß† 1Ô∏è‚É£1Ô∏è‚É£ CASCADE TEST
+-- ============================================================================
+DELETE FROM exams WHERE id = 1;
+SELECT COUNT(*) AS remaining_questions FROM exam_questions WHERE exam_id = 1;
+SELECT COUNT(*) AS remaining_submissions FROM submissions WHERE exam_id = 1;
+SELECT COUNT(*) AS remaining_results FROM results WHERE exam_id = 1;
+---- x√≥a c√°c view li√™n quan ƒë·∫øn b·∫£ng recourse trc ƒë√≥
+USE oem_mini;
+
+DROP VIEW IF EXISTS 
+v_exam_overview,
+v_instructor_assigned_exams,
+v_instructor_exam_bank,
+v_instructor_stats,
+v_student_results;
+-- update l·∫°i c√°c view
+
+USE oem_mini;
+CREATE OR REPLACE VIEW v_exam_overview AS
+SELECT 
+    e.id AS exam_id,
+    e.title AS exam_title,
+    e.status AS exam_status,
+    e.instructor_id AS instructor_id,
+    u.full_name AS instructor_name,
+    COUNT(DISTINCT q.id) AS total_questions,
+    COUNT(DISTINCT sub.user_id) AS total_students,
+    COUNT(DISTINCT sub.id) AS total_submissions,
+    MAX(sub.submitted_at) AS last_submission_time
+FROM exams e
+LEFT JOIN users u ON u.id = e.instructor_id
+LEFT JOIN exam_questions q ON q.exam_id = e.id
+LEFT JOIN submissions sub ON sub.exam_id = e.id
+GROUP BY e.id, e.title, e.status, e.instructor_id, u.full_name;
+
+USE oem_mini;
+
+CREATE OR REPLACE VIEW v_instructor_exam_bank AS
+SELECT 
+    e.id AS exam_id,
+    e.title AS exam_title,
+    e.status AS exam_status,
+    e.instructor_id,
+    u.full_name AS instructor_name,
+    COUNT(DISTINCT q.id) AS total_questions,
+    COUNT(DISTINCT sub.user_id) AS total_students,
+    MAX(sub.submitted_at) AS last_submission_time
+FROM exams e
+LEFT JOIN users u ON u.id = e.instructor_id
+LEFT JOIN exam_questions q ON q.exam_id = e.id
+LEFT JOIN submissions sub ON sub.exam_id = e.id
+GROUP BY e.id, e.title, e.status, e.instructor_id, u.full_name;
+
+CREATE OR REPLACE VIEW v_instructor_assigned_exams AS
+SELECT 
+    e.id AS exam_id,
+    e.title AS exam_title,
+    e.status AS exam_status,
+    e.instructor_id,
+    u.full_name AS instructor_name,
+    COUNT(DISTINCT sub.user_id) AS total_students,
+    COUNT(DISTINCT sub.id) AS total_submissions,
+    MAX(sub.submitted_at) AS last_submission_time
+FROM exams e
+LEFT JOIN users u ON u.id = e.instructor_id
+LEFT JOIN submissions sub ON sub.exam_id = e.id
+WHERE e.status IN ('active', 'open', 'ongoing')
+GROUP BY e.id, e.title, e.status, e.instructor_id, u.full_name;
+
+CREATE OR REPLACE VIEW v_instructor_stats AS
+SELECT 
+    u.id AS instructor_id,
+    u.full_name AS instructor_name,
+    COUNT(DISTINCT e.id) AS total_exams,
+    COUNT(DISTINCT sub.user_id) AS total_students,
+    COUNT(DISTINCT sub.id) AS total_submissions,
+    AVG(sub.total_score) AS avg_score
+FROM users u
+LEFT JOIN exams e ON e.instructor_id = u.id
+LEFT JOIN submissions sub ON sub.exam_id = e.id
+WHERE u.role = 'instructor'
+GROUP BY u.id, u.full_name;
+
+CREATE OR REPLACE VIEW v_student_results AS
+SELECT 
+    s.id AS submission_id,
+    s.exam_id,
+    e.title AS exam_title,
+    s.user_id AS student_id,
+    u.full_name AS student_name,
+    s.total_score,
+    s.ai_score,
+    s.suggested_total_score,
+    s.instructor_confirmed,
+    s.status,
+    s.submitted_at
+FROM submissions s
+JOIN exams e ON e.id = s.exam_id
+JOIN users u ON u.id = s.user_id
+ORDER BY s.submitted_at DESC;
diff --git a/frontend/index.html b/frontend/index.html
index f422bd6..395249b 100644
--- a/frontend/index.html
+++ b/frontend/index.html
@@ -1,20 +1,20 @@
-<!doctype html>
-<html lang="en">
-
-<head>
-  <meta charset="UTF-8" />
-  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
-  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
-  <meta name="referrer" content="origin" />
-  <meta name="referrer" content="strict-origin-when-cross-origin" />
-  <meta name="referrer" content="no-referrer" />
-  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
-  <title>OEM Exam Mini</title>
-</head>
-
-<body>
-  <div id="root"></div>
-  <script type="module" src="/src/main.jsx"></script>
-</body>
-
+<!doctype html>
+<html lang="en">
+
+<head>
+  <meta charset="UTF-8" />
+  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
+  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
+  <meta name="referrer" content="origin" />
+  <meta name="referrer" content="strict-origin-when-cross-origin" />
+  <meta name="referrer" content="no-referrer" />
+  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
+  <title>OEM Exam Mini</title>
+</head>
+
+<body>
+  <div id="root"></div>
+  <script type="module" src="/src/main.jsx"></script>
+</body>
+
 </html>
\ No newline at end of file
diff --git a/frontend/src/api/axiosClient.js b/frontend/src/api/axiosClient.js
index 8c9e02f..1986f52 100644
--- a/frontend/src/api/axiosClient.js
+++ b/frontend/src/api/axiosClient.js
@@ -1,15 +1,15 @@
-import axios from "axios";
-
-const axiosClient = axios.create({
-  baseURL: "http://localhost:5000/api",
-});
-
-axiosClient.interceptors.request.use((config) => {
-  const token = localStorage.getItem("token");
-  if (token) {
-    config.headers.Authorization = `Bearer ${token}`;
-  }
-  return config;
-});
-
-export default axiosClient;
+import axios from "axios";
+
+const axiosClient = axios.create({
+  baseURL: "http://localhost:5000/api",
+});
+
+axiosClient.interceptors.request.use((config) => {
+  const token = localStorage.getItem("token");
+  if (token) {
+    config.headers.Authorization = `Bearer ${token}`;
+  }
+  return config;
+});
+
+export default axiosClient;
diff --git a/frontend/src/authPages/ForgotPassword.jsx b/frontend/src/authPages/ForgotPassword.jsx
index bd1c6a4..1af5cd6 100644
--- a/frontend/src/authPages/ForgotPassword.jsx
+++ b/frontend/src/authPages/ForgotPassword.jsx
@@ -1,137 +1,137 @@
-import React, { useState } from "react";
-import { useNavigate } from "react-router-dom";
-
-const ForgotPassword = () => {
-  const [email, setEmail] = useState("");
-  const [error, setError] = useState("");
-  const [loading, setLoading] = useState(false);
-  const navigate = useNavigate();
-
-  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
-
-  const handleSubmit = async (e) => {
-    e.preventDefault();
-    setError("");
-
-    const trimmed = email.toLowerCase().trim();
-
-    // 1. Client-side validate format
-    if (!emailRegex.test(trimmed)) {
-      setError("ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá.");
-      return;
-    }
-
-    setLoading(true);
-    try {
-      const res = await fetch("/api/auth/check-email", {
-        method: "POST",
-        headers: { "Content-Type": "application/json" },
-        body: JSON.stringify({ email: trimmed }),
-      });
-
-      const data = await res.json();
-
-      if (!res.ok) {
-        setError(data.message || "L·ªói server khi ki·ªÉm tra email.");
-        setLoading(false);
-        return;
-      }
-
-      if (!data.exists) {
-        setError("Email n√†y ch∆∞a ƒë∆∞·ª£c ƒëƒÉng k√Ω trong h·ªá th·ªëng.");
-        setLoading(false);
-        return;
-      }
-
-      if (data.exists) {
-        const otpRes = await fetch("/api/auth/forgot-send-otp", {
-          method: "POST",
-          headers: { "Content-Type": "application/json" },
-          body: JSON.stringify({ email: trimmed }),
-        });
-
-        const otpData = await otpRes.json();
-        if (!otpRes.ok) {
-          setError(otpData.message || "Kh√¥ng th·ªÉ g·ª≠i m√£ x√°c th·ª±c.");
-          setLoading(false);
-          return;
-        }
-        navigate("/verify-email", {
-          state: { email: trimmed, action: "forgot" },
-        });
-      }
-    } catch (err) {
-      console.error("Error checking email:", err);
-      setError("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.");
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  return (
-    <div className="min-h-screen flex flex-col bg-gray-100">
-      <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 md:px-4 md:py-3 gap-2 md:gap-3">
-        <img
-          src="/Logo.png"
-          alt="OEM Logo"
-          className="h-14 md:h-20 w-auto cursor-pointer"
-          onClick={() => navigate("/")}
-        />
-      </header>
-
-      <div className="flex flex-col md:flex-row w-full max-w-6xl mx-auto my-10 shadow-lg rounded-2xl overflow-hidden bg-white min-h-[80vh]">
-        <div className="flex flex-1 items-center justify-center px-8 md:px-16 lg:px-24">
-          <div className="w-full max-w-lg flex flex-col justify-center min-h-[520px]">
-            <h3 className="text-3xl font-bold text-gray-800 text-center mb-4 uppercase tracking-wide">
-              ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u
-            </h3>
-            <p className="text-gray-500 text-center mb-4 text-base">
-              Nh·∫≠p email ƒë√£ ƒëƒÉng k√Ω ƒë·ªÉ nh·∫≠n m√£ x√°c th·ª±c.
-            </p>
-
-            <form onSubmit={handleSubmit} className="space-y-6">
-              <input
-                type="email"
-                placeholder="Email ƒë√£ ƒëƒÉng k√Ω"
-                value={email}
-                onChange={(e) => setEmail(e.target.value)}
-                className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:outline-none text-base"
-                required
-                disabled={loading}
-              />
-
-              {error && <div className="text-sm text-red-500">{error}</div>}
-
-              <button
-                type="submit"
-                className="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 rounded-lg transition duration-200 text-base disabled:opacity-60"
-                disabled={loading}
-              >
-                {loading ? "ƒêang ki·ªÉm tra..." : "G·ª≠i m√£ x√°c th·ª±c"}
-              </button>
-            </form>
-
-            <p
-              onClick={() => navigate("/login")}
-              className="text-center text-blue-500 text-sm mt-8 cursor-pointer hover:underline"
-            >
-              Quay l·∫°i ƒêƒÉng Nh·∫≠p
-            </p>
-          </div>
-        </div>
-
-        <div className="hidden md:flex w-1/2 items-center justify-center relative">
-          <div className="w-100 h-100 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-inner">
-            <img
-              src="/icons/UI Image/item login,rgs.png"
-              alt="Illustration"
-              className="w-70 h-auto drop-shadow-lg transition-transform duration-500 hover:scale-105"
-            />
-          </div>
-        </div>
-      </div>
-    </div>
-  );
-};
-
-export default ForgotPassword;
+import React, { useState } from "react";
+import { useNavigate } from "react-router-dom";
+
+const ForgotPassword = () => {
+  const [email, setEmail] = useState("");
+  const [error, setError] = useState("");
+  const [loading, setLoading] = useState(false);
+  const navigate = useNavigate();
+
+  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError("");
+
+    const trimmed = email.toLowerCase().trim();
+
+    // 1. Client-side validate format
+    if (!emailRegex.test(trimmed)) {
+      setError("ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá.");
+      return;
+    }
+
+    setLoading(true);
+    try {
+      const res = await fetch("/api/auth/check-email", {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({ email: trimmed }),
+      });
+
+      const data = await res.json();
+
+      if (!res.ok) {
+        setError(data.message || "L·ªói server khi ki·ªÉm tra email.");
+        setLoading(false);
+        return;
+      }
+
+      if (!data.exists) {
+        setError("Email n√†y ch∆∞a ƒë∆∞·ª£c ƒëƒÉng k√Ω trong h·ªá th·ªëng.");
+        setLoading(false);
+        return;
+      }
+
+      if (data.exists) {
+        const otpRes = await fetch("/api/auth/forgot-send-otp", {
+          method: "POST",
+          headers: { "Content-Type": "application/json" },
+          body: JSON.stringify({ email: trimmed }),
+        });
+
+        const otpData = await otpRes.json();
+        if (!otpRes.ok) {
+          setError(otpData.message || "Kh√¥ng th·ªÉ g·ª≠i m√£ x√°c th·ª±c.");
+          setLoading(false);
+          return;
+        }
+        navigate("/verify-email", {
+          state: { email: trimmed, action: "forgot" },
+        });
+      }
+    } catch (err) {
+      console.error("Error checking email:", err);
+      setError("L·ªói k·∫øt n·ªëi. Vui l√≤ng th·ª≠ l·∫°i.");
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="min-h-screen flex flex-col bg-gray-100">
+      <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 md:px-4 md:py-3 gap-2 md:gap-3">
+        <img
+          src="/Logo.png"
+          alt="OEM Logo"
+          className="h-14 md:h-20 w-auto cursor-pointer"
+          onClick={() => navigate("/")}
+        />
+      </header>
+
+      <div className="flex flex-col md:flex-row w-full max-w-6xl mx-auto my-10 shadow-lg rounded-2xl overflow-hidden bg-white min-h-[80vh]">
+        <div className="flex flex-1 items-center justify-center px-8 md:px-16 lg:px-24">
+          <div className="w-full max-w-lg flex flex-col justify-center min-h-[520px]">
+            <h3 className="text-3xl font-bold text-gray-800 text-center mb-4 uppercase tracking-wide">
+              ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u
+            </h3>
+            <p className="text-gray-500 text-center mb-4 text-base">
+              Nh·∫≠p email ƒë√£ ƒëƒÉng k√Ω ƒë·ªÉ nh·∫≠n m√£ x√°c th·ª±c.
+            </p>
+
+            <form onSubmit={handleSubmit} className="space-y-6">
+              <input
+                type="email"
+                placeholder="Email ƒë√£ ƒëƒÉng k√Ω"
+                value={email}
+                onChange={(e) => setEmail(e.target.value)}
+                className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:outline-none text-base"
+                required
+                disabled={loading}
+              />
+
+              {error && <div className="text-sm text-red-500">{error}</div>}
+
+              <button
+                type="submit"
+                className="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 rounded-lg transition duration-200 text-base disabled:opacity-60"
+                disabled={loading}
+              >
+                {loading ? "ƒêang ki·ªÉm tra..." : "G·ª≠i m√£ x√°c th·ª±c"}
+              </button>
+            </form>
+
+            <p
+              onClick={() => navigate("/login")}
+              className="text-center text-blue-500 text-sm mt-8 cursor-pointer hover:underline"
+            >
+              Quay l·∫°i ƒêƒÉng Nh·∫≠p
+            </p>
+          </div>
+        </div>
+
+        <div className="hidden md:flex w-1/2 items-center justify-center relative">
+          <div className="w-100 h-100 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-inner">
+            <img
+              src="/icons/UI Image/item login,rgs.png"
+              alt="Illustration"
+              className="w-70 h-auto drop-shadow-lg transition-transform duration-500 hover:scale-105"
+            />
+          </div>
+        </div>
+      </div>
+    </div>
+  );
+};
+
+export default ForgotPassword;
diff --git a/frontend/src/authPages/LoginPage.jsx b/frontend/src/authPages/LoginPage.jsx
index f0aa478..2f391f4 100644
--- a/frontend/src/authPages/LoginPage.jsx
+++ b/frontend/src/authPages/LoginPage.jsx
@@ -1,380 +1,380 @@
-import React, { useState, useEffect } from "react";
-import { useNavigate, useLocation } from "react-router-dom";
-import { GoogleLogin } from "@react-oauth/google";
-import axiosClient from "../api/axiosClient";
-import LoadingSpinner from "../components/LoadingSpinner";
-
-const LoginPage = () => {
-  const navigate = useNavigate();
-  const location = useLocation();
-  const [form, setForm] = useState({ email: "", password: "" });
-  const [errors, setErrors] = useState({});
-  const [success, setSuccess] = useState("");
-  const [loading, setLoading] = useState(false);
-  const role = localStorage.getItem("selectedRole") || "";
-
-  useEffect(() => {
-    const fromRoleSelection = location.state?.fromRoleSelection;
-
-    // N·∫øu ƒë√£ ƒëƒÉng nh·∫≠p th√¨ chuy·ªÉn th·∫≥ng v√†o dashboard
-    if (!fromRoleSelection) {
-      const token = localStorage.getItem("token");
-      const userRole = localStorage.getItem("role");
-      if (token && userRole) {
-        const dashboardPath = userRole === "student" 
-          ? "/student-dashboard" 
-          : userRole === "admin" 
-          ? "/admin-dashboard" 
-          : "/instructor-dashboard";
-        navigate(dashboardPath);
-        return;
-      }
-    }
-
-    if (!role) {
-      navigate("/role");
-    } else if (role === "student") {
-      const verifiedRoomId = localStorage.getItem("verifiedRoomId");
-      if (!verifiedRoomId) navigate("/verify-room");
-    }
-  }, [role, navigate, location.state]);
-
-  const handleChange = (e) => {
-    const { name, value } = e.target;
-    setForm({ ...form, [name]: value });
-  };
-
-  const validate = () => {
-    const newErrors = {};
-    if (!form.email.trim()) newErrors.email = "Vui l√≤ng nh·∫≠p email";
-    else if (!/\S+@\S+\.\S+/.test(form.email))
-      newErrors.email = "Email kh√¥ng h·ª£p l·ªá";
-    if (!form.password.trim()) newErrors.password = "Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u";
-    return newErrors;
-  };
-
-  // --- Login th∆∞·ªùng ---
-  const handleLogin = async (e) => {
-    e.preventDefault();
-
-    const newErrors = validate();
-    if (Object.keys(newErrors).length > 0) {
-      setErrors(newErrors);
-      setSuccess("");
-      return;
-    }
-
-    setLoading(true);
-    setErrors({});
-    setSuccess("");
-
-    try {
-      const payload = {
-        email: form.email,
-        password: form.password,
-        role,
-      };
-
-      if (role === "student") {
-        const roomId = localStorage.getItem("verifiedRoomId");
-        if (!roomId) {
-          setErrors({
-            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
-          });
-          setLoading(false);
-          return;
-        }
-        payload.roomId = roomId;
-      }
-
-      console.log("[DEV] üöÄ G·ª≠i request ƒëƒÉng nh·∫≠p v·ªõi payload:", payload);
-
-      const res = await axiosClient.post("/auth/login", payload);
-
-      console.log("[DEV] ‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng:", res.data);
-
-      setSuccess("üéâ ƒêƒÉng nh·∫≠p th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
-
-      setTimeout(() => {
-        localStorage.setItem("token", res.data.token);
-        localStorage.setItem("role", res.data.user.role);
-        localStorage.setItem(
-          "fullname",
-          res.data.user.full_name || "Ng∆∞·ªùi d√πng"
-        );
-        localStorage.setItem(
-          "avatar",
-          res.data.user.avatar || "/icons/UI Image/default-avatar.png"
-        );
-
-        const userRole = res.data.user.role;
-        // If student came from /join with room_token, auto-join and go to prepare
-        if (userRole === 'student') {
-          const roomToken = sessionStorage.getItem('room_token');
-          const pendingExam = sessionStorage.getItem('pending_exam_id');
-          if (roomToken && pendingExam) {
-            (async ()=>{
-              try {
-                const j = await axiosClient.post('/exams/join', { room_token: roomToken });
-                const sid = j.data?.submission_id;
-                if (sid) {
-                  try { sessionStorage.setItem('exam_flags', JSON.stringify(j.data?.flags || {})); } catch(e){}
-                  navigate(`/exam/${j.data.exam_id}/prepare?submission_id=${sid}`);
-                  return;
-                }
-              } catch (e) {}
-              navigate('/student-dashboard');
-            })();
-            return;
-          }
-        }
-        const dashboardPath = userRole === "admin" 
-          ? "/admin-dashboard" 
-          : userRole === "instructor" 
-          ? "/instructor-dashboard" 
-          : "/student-dashboard";
-        navigate(dashboardPath);
-      }, 1500);
-    } catch (error) {
-      console.error("‚ùå [Login Error] Chi ti·∫øt l·ªói ƒë·∫ßy ƒë·ªß:", error);
-
-      // Log chi ti·∫øt h∆°n t·ª´ng ph·∫ßn ƒë·ªÉ bi·∫øt nguy√™n nh√¢n
-      if (error.response) {
-        console.error("üì© [Server Response]:", error.response.data);
-        console.error("üî¢ [Status Code]:", error.response.status);
-        console.error("üì° [Headers]:", error.response.headers);
-      } else if (error.request) {
-        console.error("üì≠ [No Response t·ª´ Server]:", error.request);
-      } else {
-        console.error("‚ö†Ô∏è [Error Message]:", error.message);
-      }
-
-      setErrors({
-        general:
-          error.response?.data?.message ||
-          "ƒêƒÉng nh·∫≠p th·∫•t b·∫°i, vui l√≤ng th·ª≠ l·∫°i.",
-      });
-      setSuccess("");
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  // --- Google login ---
-  const handleGoogleLoginSuccess = async (credentialResponse) => {
-    if (!credentialResponse?.credential) {
-      setErrors({ general: "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c Google credential" });
-      return;
-    }
-
-    setLoading(true);
-    setErrors({});
-    setSuccess("");
-
-    try {
-      const payload = {
-        idToken: credentialResponse.credential,
-        role,
-      };
-
-      if (role === "student") {
-        const roomId = localStorage.getItem("verifiedRoomId");
-        if (!roomId) {
-          setErrors({
-            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
-          });
-          setLoading(false);
-          return;
-        }
-        payload.roomId = roomId;
-      }
-
-      console.log("[DEV] Google login payload g·ª≠i backend:", payload);
-      const res = await axiosClient.post("/auth/google", payload);
-      console.log("[DEV] ‚úÖ Google login th√†nh c√¥ng:", res.data);
-
-      setSuccess("üéâ ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
-
-      setTimeout(() => {
-        localStorage.setItem("token", res.data.token);
-        localStorage.setItem("role", res.data.user.role);
-        localStorage.setItem(
-          "fullname",
-          res.data.user.full_name || "Ng∆∞·ªùi d√πng"
-        );
-        localStorage.setItem(
-          "avatar",
-          res.data.user.avatar || "/icons/UI Image/default-avatar.png"
-        );
-
-        const userRole = res.data.user.role;
-        if (userRole === 'student') {
-          // N·∫øu ƒë·∫øn t·ª´ /verify-room v√† ƒë√£ c√≥ room_token ‚Üí auto join v√† chuy·ªÉn th·∫≥ng v√†o prepare
-          const roomToken = sessionStorage.getItem('room_token');
-          const pendingExam = sessionStorage.getItem('pending_exam_id');
-          if (roomToken && pendingExam) {
-            (async ()=>{
-              try {
-                const j = await axiosClient.post('/exams/join', { room_token: roomToken });
-                const sid = j.data?.submission_id;
-                if (sid) {
-                  try { sessionStorage.setItem('exam_flags', JSON.stringify(j.data?.flags || {})); } catch(e){}
-                  navigate(`/exam/${j.data.exam_id}/prepare?submission_id=${sid}`);
-                  return;
-                }
-              } catch (e) { /* fallthrough */ }
-              navigate('/student-dashboard');
-            })();
-            return;
-          }
-        }
-
-        const dashboardPath = userRole === "admin" 
-          ? "/admin-dashboard" 
-          : userRole === "instructor" 
-          ? "/instructor-dashboard" 
-          : "/student-dashboard";
-        navigate(dashboardPath);
-      }, 800);
-    } catch (error) {
-      console.error("‚ùå L·ªói Google login:", error?.response?.data || error);
-      setErrors({
-        general: error.response?.data?.message || "ƒêƒÉng nh·∫≠p Google th·∫•t b·∫°i",
-      });
-      setSuccess("");
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  const handleGoogleLoginError = () => {
-    console.error("‚ö†Ô∏è L·ªói x√°c th·ª±c Google");
-    setErrors({ general: "L·ªói x√°c th·ª±c Google" });
-  };
-
-  return (
-    <div className="min-h-screen bg-gray-100 flex flex-col">
-      <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 md:px-4 md:py-3 gap-2 md:gap-3">
-        <img
-          src="/Logo.png"
-          alt="OEM Logo"
-          className="h-14 md:h-20 w-auto cursor-pointer"
-          onClick={() => navigate("/")}
-        />
-      </header>
-
-      <div className="flex flex-col md:flex-row w-full max-w-6xl mx-auto my-10 shadow-lg rounded-2xl overflow-hidden bg-white">
-        <div className="w-full md:w-1/2 p-6 md:p-10">
-          <div className="overflow-hidden flex mb-6 rounded-full border border-[#a2b9ff]">
-            <button
-              onClick={() => navigate("/register")}
-              className="flex-1 py-2 text-center bg-[#e2f6ff] font-medium text-gray-900"
-            >
-              ƒêƒÉng k√Ω
-            </button>
-            <button
-              onClick={() => navigate("/login")}
-              className="flex-1 py-2 text-center bg-[#51b9ff] font-semibold text-gray-900"
-            >
-              ƒêƒÉng nh·∫≠p
-            </button>
-          </div>
-
-          <h3 className="text-2xl md:text-3xl font-bold text-red-600 mb-6 text-center uppercase">
-            ƒêƒÉng nh·∫≠p
-          </h3>
-
-          <form className="space-y-4" onSubmit={handleLogin}>
-            <div>
-              <input
-                type="email"
-                name="email"
-                value={form.email}
-                onChange={handleChange}
-                placeholder="Email"
-                disabled={loading}
-                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none text-gray-800 placeholder-gray-400"
-              />
-              {errors.email && (
-                <p className="text-red-500 text-sm mt-1">{errors.email}</p>
-              )}
-            </div>
-
-            <div>
-              <input
-                type="password"
-                name="password"
-                value={form.password}
-                onChange={handleChange}
-                placeholder="M·∫≠t kh·∫©u"
-                disabled={loading}
-                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none text-gray-800 placeholder-gray-400"
-              />
-              {errors.password && (
-                <p className="text-red-500 text-sm mt-1">{errors.password}</p>
-              )}
-              <div className="text-right mt-1">
-                <span
-                  className="text-blue-500 text-xs cursor-pointer hover:underline"
-                  onClick={() => navigate("/forgot-password")}
-                >
-                  Qu√™n m·∫≠t kh·∫©u?
-                </span>
-              </div>
-            </div>
-
-            <button
-              type="submit"
-              disabled={loading}
-              className={`w-full py-3 rounded-lg text-white font-semibold mt-2 active:scale-95 transition-all flex items-center justify-center gap-2 ${
-                loading
-                  ? "bg-gray-400 cursor-not-allowed"
-                  : "bg-blue-600 hover:bg-blue-700"
-              }`}
-            >
-              {loading ? (
-                <LoadingSpinner size="sm" text="ƒêang ƒëƒÉng nh·∫≠p..." />
-              ) : (
-                "ƒêƒÉng nh·∫≠p"
-              )}
-            </button>
-
-            <span className="block text-center text-gray-500 text-sm mt-3">
-              Ho·∫∑c ƒëƒÉng nh·∫≠p b·∫±ng
-            </span>
-            <div className="flex justify-center mt-3">
-              <GoogleLogin
-                onSuccess={handleGoogleLoginSuccess}
-                onError={handleGoogleLoginError}
-              />
-            </div>
-          </form>
-
-          {errors.general && (
-            <p className="text-red-500 text-sm mt-2 text-center">
-              {errors.general}
-            </p>
-          )}
-
-          {success && (
-            <p className="text-green-600 text-sm mt-2 text-center font-medium">
-              {success}
-            </p>
-          )}
-        </div>
-
-        <div className="hidden md:flex w-1/2 items-center justify-center relative">
-          <div className="w-100 h-100 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-inner">
-            <img
-              src="/icons/UI Image/item login,rgs.png"
-              alt="Illustration"
-              className="w-70 h-auto drop-shadow-lg transition-transform duration-500 hover:scale-105"
-            />
-          </div>
-        </div>
-      </div>
-    </div>
-  );
-};
-
-export default LoginPage;
+import React, { useState, useEffect } from "react";
+import { useNavigate, useLocation } from "react-router-dom";
+import { GoogleLogin } from "@react-oauth/google";
+import axiosClient from "../api/axiosClient";
+import LoadingSpinner from "../components/LoadingSpinner";
+
+const LoginPage = () => {
+  const navigate = useNavigate();
+  const location = useLocation();
+  const [form, setForm] = useState({ email: "", password: "" });
+  const [errors, setErrors] = useState({});
+  const [success, setSuccess] = useState("");
+  const [loading, setLoading] = useState(false);
+  const role = localStorage.getItem("selectedRole") || "";
+
+  useEffect(() => {
+    const fromRoleSelection = location.state?.fromRoleSelection;
+
+    // N·∫øu ƒë√£ ƒëƒÉng nh·∫≠p th√¨ chuy·ªÉn th·∫≥ng v√†o dashboard
+    if (!fromRoleSelection) {
+      const token = localStorage.getItem("token");
+      const userRole = localStorage.getItem("role");
+      if (token && userRole) {
+        const dashboardPath = userRole === "student" 
+          ? "/student-dashboard" 
+          : userRole === "admin" 
+          ? "/admin-dashboard" 
+          : "/instructor-dashboard";
+        navigate(dashboardPath);
+        return;
+      }
+    }
+
+    if (!role) {
+      navigate("/role");
+    } else if (role === "student") {
+      const verifiedRoomId = localStorage.getItem("verifiedRoomId");
+      if (!verifiedRoomId) navigate("/verify-room");
+    }
+  }, [role, navigate, location.state]);
+
+  const handleChange = (e) => {
+    const { name, value } = e.target;
+    setForm({ ...form, [name]: value });
+  };
+
+  const validate = () => {
+    const newErrors = {};
+    if (!form.email.trim()) newErrors.email = "Vui l√≤ng nh·∫≠p email";
+    else if (!/\S+@\S+\.\S+/.test(form.email))
+      newErrors.email = "Email kh√¥ng h·ª£p l·ªá";
+    if (!form.password.trim()) newErrors.password = "Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u";
+    return newErrors;
+  };
+
+  // --- Login th∆∞·ªùng ---
+  const handleLogin = async (e) => {
+    e.preventDefault();
+
+    const newErrors = validate();
+    if (Object.keys(newErrors).length > 0) {
+      setErrors(newErrors);
+      setSuccess("");
+      return;
+    }
+
+    setLoading(true);
+    setErrors({});
+    setSuccess("");
+
+    try {
+      const payload = {
+        email: form.email,
+        password: form.password,
+        role,
+      };
+
+      if (role === "student") {
+        const roomId = localStorage.getItem("verifiedRoomId");
+        if (!roomId) {
+          setErrors({
+            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
+          });
+          setLoading(false);
+          return;
+        }
+        payload.roomId = roomId;
+      }
+
+      console.log("[DEV] üöÄ G·ª≠i request ƒëƒÉng nh·∫≠p v·ªõi payload:", payload);
+
+      const res = await axiosClient.post("/auth/login", payload);
+
+      console.log("[DEV] ‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng:", res.data);
+
+      setSuccess("üéâ ƒêƒÉng nh·∫≠p th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
+
+      setTimeout(() => {
+        localStorage.setItem("token", res.data.token);
+        localStorage.setItem("role", res.data.user.role);
+        localStorage.setItem(
+          "fullname",
+          res.data.user.full_name || "Ng∆∞·ªùi d√πng"
+        );
+        localStorage.setItem(
+          "avatar",
+          res.data.user.avatar || "/icons/UI Image/default-avatar.png"
+        );
+
+        const userRole = res.data.user.role;
+        // If student came from /join with room_token, auto-join and go to prepare
+        if (userRole === 'student') {
+          const roomToken = sessionStorage.getItem('room_token');
+          const pendingExam = sessionStorage.getItem('pending_exam_id');
+          if (roomToken && pendingExam) {
+            (async ()=>{
+              try {
+                const j = await axiosClient.post('/exams/join', { room_token: roomToken });
+                const sid = j.data?.submission_id;
+                if (sid) {
+                  try { sessionStorage.setItem('exam_flags', JSON.stringify(j.data?.flags || {})); } catch(e){}
+                  navigate(`/exam/${j.data.exam_id}/prepare?submission_id=${sid}`);
+                  return;
+                }
+              } catch (e) {}
+              navigate('/student-dashboard');
+            })();
+            return;
+          }
+        }
+        const dashboardPath = userRole === "admin" 
+          ? "/admin-dashboard" 
+          : userRole === "instructor" 
+          ? "/instructor-dashboard" 
+          : "/student-dashboard";
+        navigate(dashboardPath);
+      }, 1500);
+    } catch (error) {
+      console.error("‚ùå [Login Error] Chi ti·∫øt l·ªói ƒë·∫ßy ƒë·ªß:", error);
+
+      // Log chi ti·∫øt h∆°n t·ª´ng ph·∫ßn ƒë·ªÉ bi·∫øt nguy√™n nh√¢n
+      if (error.response) {
+        console.error("üì© [Server Response]:", error.response.data);
+        console.error("üî¢ [Status Code]:", error.response.status);
+        console.error("üì° [Headers]:", error.response.headers);
+      } else if (error.request) {
+        console.error("üì≠ [No Response t·ª´ Server]:", error.request);
+      } else {
+        console.error("‚ö†Ô∏è [Error Message]:", error.message);
+      }
+
+      setErrors({
+        general:
+          error.response?.data?.message ||
+          "ƒêƒÉng nh·∫≠p th·∫•t b·∫°i, vui l√≤ng th·ª≠ l·∫°i.",
+      });
+      setSuccess("");
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  // --- Google login ---
+  const handleGoogleLoginSuccess = async (credentialResponse) => {
+    if (!credentialResponse?.credential) {
+      setErrors({ general: "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c Google credential" });
+      return;
+    }
+
+    setLoading(true);
+    setErrors({});
+    setSuccess("");
+
+    try {
+      const payload = {
+        idToken: credentialResponse.credential,
+        role,
+      };
+
+      if (role === "student") {
+        const roomId = localStorage.getItem("verifiedRoomId");
+        if (!roomId) {
+          setErrors({
+            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
+          });
+          setLoading(false);
+          return;
+        }
+        payload.roomId = roomId;
+      }
+
+      console.log("[DEV] Google login payload g·ª≠i backend:", payload);
+      const res = await axiosClient.post("/auth/google", payload);
+      console.log("[DEV] ‚úÖ Google login th√†nh c√¥ng:", res.data);
+
+      setSuccess("üéâ ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
+
+      setTimeout(() => {
+        localStorage.setItem("token", res.data.token);
+        localStorage.setItem("role", res.data.user.role);
+        localStorage.setItem(
+          "fullname",
+          res.data.user.full_name || "Ng∆∞·ªùi d√πng"
+        );
+        localStorage.setItem(
+          "avatar",
+          res.data.user.avatar || "/icons/UI Image/default-avatar.png"
+        );
+
+        const userRole = res.data.user.role;
+        if (userRole === 'student') {
+          // N·∫øu ƒë·∫øn t·ª´ /verify-room v√† ƒë√£ c√≥ room_token ‚Üí auto join v√† chuy·ªÉn th·∫≥ng v√†o prepare
+          const roomToken = sessionStorage.getItem('room_token');
+          const pendingExam = sessionStorage.getItem('pending_exam_id');
+          if (roomToken && pendingExam) {
+            (async ()=>{
+              try {
+                const j = await axiosClient.post('/exams/join', { room_token: roomToken });
+                const sid = j.data?.submission_id;
+                if (sid) {
+                  try { sessionStorage.setItem('exam_flags', JSON.stringify(j.data?.flags || {})); } catch(e){}
+                  navigate(`/exam/${j.data.exam_id}/prepare?submission_id=${sid}`);
+                  return;
+                }
+              } catch (e) { /* fallthrough */ }
+              navigate('/student-dashboard');
+            })();
+            return;
+          }
+        }
+
+        const dashboardPath = userRole === "admin" 
+          ? "/admin-dashboard" 
+          : userRole === "instructor" 
+          ? "/instructor-dashboard" 
+          : "/student-dashboard";
+        navigate(dashboardPath);
+      }, 800);
+    } catch (error) {
+      console.error("‚ùå L·ªói Google login:", error?.response?.data || error);
+      setErrors({
+        general: error.response?.data?.message || "ƒêƒÉng nh·∫≠p Google th·∫•t b·∫°i",
+      });
+      setSuccess("");
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleGoogleLoginError = () => {
+    console.error("‚ö†Ô∏è L·ªói x√°c th·ª±c Google");
+    setErrors({ general: "L·ªói x√°c th·ª±c Google" });
+  };
+
+  return (
+    <div className="min-h-screen bg-gray-100 flex flex-col">
+      <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 md:px-4 md:py-3 gap-2 md:gap-3">
+        <img
+          src="/Logo.png"
+          alt="OEM Logo"
+          className="h-14 md:h-20 w-auto cursor-pointer"
+          onClick={() => navigate("/")}
+        />
+      </header>
+
+      <div className="flex flex-col md:flex-row w-full max-w-6xl mx-auto my-10 shadow-lg rounded-2xl overflow-hidden bg-white">
+        <div className="w-full md:w-1/2 p-6 md:p-10">
+          <div className="overflow-hidden flex mb-6 rounded-full border border-[#a2b9ff]">
+            <button
+              onClick={() => navigate("/register")}
+              className="flex-1 py-2 text-center bg-[#e2f6ff] font-medium text-gray-900"
+            >
+              ƒêƒÉng k√Ω
+            </button>
+            <button
+              onClick={() => navigate("/login")}
+              className="flex-1 py-2 text-center bg-[#51b9ff] font-semibold text-gray-900"
+            >
+              ƒêƒÉng nh·∫≠p
+            </button>
+          </div>
+
+          <h3 className="text-2xl md:text-3xl font-bold text-red-600 mb-6 text-center uppercase">
+            ƒêƒÉng nh·∫≠p
+          </h3>
+
+          <form className="space-y-4" onSubmit={handleLogin}>
+            <div>
+              <input
+                type="email"
+                name="email"
+                value={form.email}
+                onChange={handleChange}
+                placeholder="Email"
+                disabled={loading}
+                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none text-gray-800 placeholder-gray-400"
+              />
+              {errors.email && (
+                <p className="text-red-500 text-sm mt-1">{errors.email}</p>
+              )}
+            </div>
+
+            <div>
+              <input
+                type="password"
+                name="password"
+                value={form.password}
+                onChange={handleChange}
+                placeholder="M·∫≠t kh·∫©u"
+                disabled={loading}
+                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none text-gray-800 placeholder-gray-400"
+              />
+              {errors.password && (
+                <p className="text-red-500 text-sm mt-1">{errors.password}</p>
+              )}
+              <div className="text-right mt-1">
+                <span
+                  className="text-blue-500 text-xs cursor-pointer hover:underline"
+                  onClick={() => navigate("/forgot-password")}
+                >
+                  Qu√™n m·∫≠t kh·∫©u?
+                </span>
+              </div>
+            </div>
+
+            <button
+              type="submit"
+              disabled={loading}
+              className={`w-full py-3 rounded-lg text-white font-semibold mt-2 active:scale-95 transition-all flex items-center justify-center gap-2 ${
+                loading
+                  ? "bg-gray-400 cursor-not-allowed"
+                  : "bg-blue-600 hover:bg-blue-700"
+              }`}
+            >
+              {loading ? (
+                <LoadingSpinner size="sm" text="ƒêang ƒëƒÉng nh·∫≠p..." />
+              ) : (
+                "ƒêƒÉng nh·∫≠p"
+              )}
+            </button>
+
+            <span className="block text-center text-gray-500 text-sm mt-3">
+              Ho·∫∑c ƒëƒÉng nh·∫≠p b·∫±ng
+            </span>
+            <div className="flex justify-center mt-3">
+              <GoogleLogin
+                onSuccess={handleGoogleLoginSuccess}
+                onError={handleGoogleLoginError}
+              />
+            </div>
+          </form>
+
+          {errors.general && (
+            <p className="text-red-500 text-sm mt-2 text-center">
+              {errors.general}
+            </p>
+          )}
+
+          {success && (
+            <p className="text-green-600 text-sm mt-2 text-center font-medium">
+              {success}
+            </p>
+          )}
+        </div>
+
+        <div className="hidden md:flex w-1/2 items-center justify-center relative">
+          <div className="w-100 h-100 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-inner">
+            <img
+              src="/icons/UI Image/item login,rgs.png"
+              alt="Illustration"
+              className="w-70 h-auto drop-shadow-lg transition-transform duration-500 hover:scale-105"
+            />
+          </div>
+        </div>
+      </div>
+    </div>
+  );
+};
+
+export default LoginPage;
diff --git a/frontend/src/authPages/RegisterPage.jsx b/frontend/src/authPages/RegisterPage.jsx
index cb14149..299155e 100644
--- a/frontend/src/authPages/RegisterPage.jsx
+++ b/frontend/src/authPages/RegisterPage.jsx
@@ -1,537 +1,537 @@
-import React, { useState, useEffect } from "react";
-import { useNavigate } from "react-router-dom";
-import { GoogleLogin } from "@react-oauth/google";
-import axiosClient from "../api/axiosClient";
-import LoadingSpinner from "../components/LoadingSpinner";
-
-const RegisterPage = () => {
-  const navigate = useNavigate();
-  const [form, setForm] = useState({
-    lastName: "",
-    firstName: "",
-    email: "",
-    password: "",
-    confirmPassword: "",
-  });
-  const [errors, setErrors] = useState({});
-  const [success, setSuccess] = useState("");
-  const [loading, setLoading] = useState(false);
-  const [otpStep, setOtpStep] = useState(false); // true when showing OTP verification
-  const [otpCode, setOtpCode] = useState("");
-  const [otpLoading, setOtpLoading] = useState(false);
-  const [emailVerified, setEmailVerified] = useState(false);
-  const role = localStorage.getItem("selectedRole") || "";
-
-  // --- Ki·ªÉm tra role + roomId ---
-  useEffect(() => {
-    if (!role) navigate("/role");
-    else if (role === "student") {
-      const verifiedRoomId = localStorage.getItem("verifiedRoomId");
-      if (!verifiedRoomId) navigate("/verify-room");
-    }
-  }, [role, navigate]);
-
-  const handleChange = (e) => {
-    const { name, value } = e.target;
-    setForm({ ...form, [name]: value });
-    
-    // Clear error when user starts typing
-    if (errors[name]) {
-      setErrors({ ...errors, [name]: "" });
-    }
-    
-    // Real-time validation for lastName and firstName
-    if (name === 'lastName' || name === 'firstName') {
-      const trimmedValue = value.trim();
-      if (trimmedValue && !/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(trimmedValue)) {
-        setErrors({ 
-          ...errors, 
-          [name]: `${name === 'lastName' ? 'H·ªç' : 'T√™n'} ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát` 
-        });
-      }
-    }
-  };
-
-  // --- Send OTP ---
-  const handleSendOTP = async () => {
-    // Ki·ªÉm tra validation cho H·ªç v√† T√™n tr∆∞·ªõc khi g·ª≠i OTP
-    const newErrors = {};
-    
-    // Validation cho H·ªç
-    if (!form.lastName.trim()) {
-      newErrors.lastName = "Vui l√≤ng nh·∫≠p h·ªç";
-    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.lastName.trim())) {
-      newErrors.lastName = "H·ªç ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
-    }
-    
-    // Validation cho T√™n
-    if (!form.firstName.trim()) {
-      newErrors.firstName = "Vui l√≤ng nh·∫≠p t√™n";
-    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.firstName.trim())) {
-      newErrors.firstName = "T√™n ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
-    }
-    
-    // Validation cho Email
-    if (!form.email.trim()) {
-      newErrors.email = "Vui l√≤ng nh·∫≠p email";
-    } else {
-      const emailRegex = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i;
-      if (!emailRegex.test(form.email)) {
-        newErrors.email = "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá";
-      }
-    }
-    
-    // N·∫øu c√≥ l·ªói validation, hi·ªÉn th·ªã l·ªói v√† kh√¥ng g·ª≠i OTP
-    if (Object.keys(newErrors).length > 0) {
-      setErrors(newErrors);
-      setSuccess("");
-      return;
-    }
-
-    setOtpLoading(true);
-    setErrors({});
-
-    try {
-      const res = await axiosClient.post("/auth/send-otp", {
-        email: form.email
-      });
-
-      console.log("[Send OTP] Response:", res.data);
-      setSuccess("M√£ OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email c·ªßa b·∫°n");
-      setOtpStep(true);
-    } catch (error) {
-      console.error("‚ùå Send OTP Error:", error);
-      setErrors({
-        general: error.response?.data?.message || "L·ªói khi g·ª≠i m√£ OTP"
-      });
-    } finally {
-      setOtpLoading(false);
-    }
-  };
-
-  // --- Verify OTP ---
-  const handleVerifyOTP = async () => {
-    if (!otpCode.trim()) {
-      setErrors({ otp: "Vui l√≤ng nh·∫≠p m√£ OTP" });
-      return;
-    }
-
-    if (otpCode.length !== 6) {
-      setErrors({ otp: "M√£ OTP ph·∫£i c√≥ 6 ch·ªØ s·ªë" });
-      return;
-    }
-
-    setOtpLoading(true);
-    setErrors({});
-
-    try {
-      const res = await axiosClient.post("/auth/verify-otp", {
-        email: form.email,
-        otp: otpCode
-      });
-
-      console.log("[Verify OTP] Response:", res.data);
-      setSuccess("Email ƒë√£ ƒë∆∞·ª£c x√°c minh th√†nh c√¥ng!");
-      setEmailVerified(true);
-      setOtpStep(false);
-    } catch (error) {
-      console.error("‚ùå Verify OTP Error:", error);
-      setErrors({
-        otp: error.response?.data?.message || "M√£ OTP kh√¥ng ch√≠nh x√°c"
-      });
-    } finally {
-      setOtpLoading(false);
-    }
-  };
-
-  const validate = () => {
-    const newErrors = {};
-    
-    // Validation cho H·ªç - ch·ªâ cho ph√©p ch·ªØ c√°i v√† kho·∫£ng tr·∫Øng
-    if (!form.lastName.trim()) {
-      newErrors.lastName = "Vui l√≤ng nh·∫≠p h·ªç";
-    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.lastName.trim())) {
-      newErrors.lastName = "H·ªç ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
-    }
-    
-    // Validation cho T√™n - ch·ªâ cho ph√©p ch·ªØ c√°i v√† kho·∫£ng tr·∫Øng
-    if (!form.firstName.trim()) {
-      newErrors.firstName = "Vui l√≤ng nh·∫≠p t√™n";
-    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.firstName.trim())) {
-      newErrors.firstName = "T√™n ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
-    }
-    
-    if (!form.email.trim()) newErrors.email = "Vui l√≤ng nh·∫≠p email";
-    else if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(form.email))
-      newErrors.email = "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá";
-    else if (!emailVerified) 
-      newErrors.email = "Email ch∆∞a ƒë∆∞·ª£c x√°c minh";
-    if (!form.password.trim()) newErrors.password = "Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u";
-    else if (form.password.length < 6)
-      newErrors.password = "M·∫≠t kh·∫©u ph·∫£i √≠t nh·∫•t 6 k√Ω t·ª±";
-    if (form.confirmPassword !== form.password)
-      newErrors.confirmPassword = "M·∫≠t kh·∫©u nh·∫≠p l·∫°i kh√¥ng kh·ªõp";
-    return newErrors;
-  };
-
-  // --- ƒêƒÉng k√Ω th∆∞·ªùng ---
-  const handleRegister = async (e) => {
-    e.preventDefault();
-    const newErrors = validate();
-    if (Object.keys(newErrors).length > 0) {
-      setErrors(newErrors);
-      setSuccess("");
-      return;
-    }
-
-    setLoading(true);
-    setErrors({});
-    setSuccess("");
-
-    try {
-      const payload = {
-        full_name: `${form.lastName} ${form.firstName}`.trim(),
-        email: form.email,
-        password: form.password,
-        role,
-      };
-
-      if (role === "student") {
-        const roomId = localStorage.getItem("verifiedRoomId");
-        if (!roomId) {
-          setErrors({
-            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
-          });
-          setLoading(false);
-          return;
-        }
-        payload.roomId = roomId;
-        console.log("[DEV] Register payload:", payload);
-      }
-
-      console.log("[DEV] üöÄ G·ª≠i request ƒëƒÉng k√Ω v·ªõi payload:", payload);
-
-      const res = await axiosClient.post("/auth/register", payload);
-
-      console.log("[DEV] ‚úÖ ƒêƒÉng k√Ω th√†nh c√¥ng:", res.data);
-
-      setSuccess("üéâ ƒêƒÉng k√Ω th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
-
-      setTimeout(() => {
-        localStorage.setItem("token", res.data.token);
-        localStorage.setItem("role", res.data.user.role);
-        navigate(`/${role === "student" ? "student" : "instructor"}-dashboard`);
-      }, 1500);
-    } catch (error) {
-      console.error("‚ùå [Register Error] Chi ti·∫øt l·ªói ƒë·∫ßy ƒë·ªß:", error);
-
-      if (error.response) {
-        const message = error.response.data?.message || "";
-
-        console.error("üì© [Server Response]:", error.response.data);
-        console.error("üî¢ [Status Code]:", error.response.status);
-        console.error("üì° [Headers]:", error.response.headers);
-
-        // üü† B·ªï sung log ri√™ng cho email ho·∫∑c domain kh√¥ng t·ªìn t·∫°i
-        if (
-          message.includes("T√™n mi·ªÅn email kh√¥ng t·ªìn t·∫°i") ||
-          message.includes("kh√¥ng h·ª£p l·ªá") ||
-          message.includes("kh√¥ng th·ªÉ x√°c minh") ||
-          message.includes("Email ƒëƒÉng k√Ω kh√¥ng t·ªìn t·∫°i")
-        ) {
-          console.warn(
-            `[Register] ‚ö†Ô∏è Email ho·∫∑c domain kh√¥ng t·ªìn t·∫°i: ${payload.email}`
-          );
-        } else if (message.includes("Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω")) {
-          console.warn(`[Register] ‚ö†Ô∏è Email ƒë√£ t·ªìn t·∫°i: ${payload.email}`);
-        }
-      } else if (error.request) {
-        console.error("üì≠ [No Response t·ª´ Server]:", error.request);
-      } else {
-        console.error("‚ö†Ô∏è [Error Message]:", error.message);
-      }
-
-      setErrors({
-        general:
-          error.response?.data?.message ||
-          "ƒêƒÉng k√Ω th·∫•t b·∫°i, vui l√≤ng th·ª≠ l·∫°i.",
-      });
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  // --- Google Register ---
-  const handleGoogleSuccess = async (credentialResponse) => {
-    if (!credentialResponse?.credential) {
-      setErrors({ general: "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c Google credential" });
-      return;
-    }
-
-    setLoading(true);
-    setErrors({});
-    setSuccess("");
-
-    try {
-      const payload = { idToken: credentialResponse.credential, role };
-      if (role === "student") {
-        const roomId = localStorage.getItem("verifiedRoomId");
-        if (!roomId) {
-          setErrors({
-            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
-          });
-          setLoading(false);
-          return;
-        }
-        payload.roomId = roomId;
-      }
-
-      console.log("[DEV] Google register payload:", payload);
-      const res = await axiosClient.post("/auth/google", payload);
-      console.log("[DEV] Google register response:", res.data);
-      setSuccess("üéâ ƒêƒÉng k√Ω Google th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
-
-      setTimeout(() => {
-        localStorage.setItem("token", res.data.token);
-        localStorage.setItem("role", res.data.user.role);
-        navigate(`/${role === "student" ? "student" : "instructor"}-dashboard`);
-      }, 1500);
-    } catch (error) {
-      console.error("‚ùå Google register error:", error);
-      setErrors({
-        general: error.response?.data?.message || "ƒêƒÉng k√Ω Google th·∫•t b·∫°i",
-      });
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  const handleGoogleError = () => {
-    setErrors({ general: "L·ªói x√°c th·ª±c Google" });
-  };
-
-  return (
-    <div className="min-h-screen bg-gray-100 flex flex-col">
-      <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 gap-2 md:gap-3">
-        <img
-          src="/Logo.png"
-          alt="OEM Logo"
-          className="h-14 md:h-20 w-auto cursor-pointer"
-          onClick={() => navigate("/")}
-        />
-      </header>
-
-      <div className="flex flex-col md:flex-row w-full max-w-6xl mx-auto my-10 shadow-lg rounded-2xl overflow-hidden bg-white">
-        <div className="w-full md:w-1/2 p-6 md:p-10">
-          <div className="overflow-hidden flex mb-6 rounded-full border border-[#a2b9ff]">
-            <button
-              onClick={() => navigate("/register")}
-              className="flex-1 py-2 text-center bg-[#51b9ff] font-semibold text-gray-900"
-            >
-              ƒêƒÉng k√Ω
-            </button>
-            <button
-              onClick={() => navigate("/login")}
-              className="flex-1 py-2 text-center bg-[#e2f6ff] font-medium text-gray-900"
-            >
-              ƒêƒÉng nh·∫≠p
-            </button>
-          </div>
-
-          <h3 className="text-2xl md:text-3xl font-bold text-red-600 mb-6 text-center uppercase">
-            ƒêƒÉng k√Ω ngay
-          </h3>
-
-          <form className="space-y-4" onSubmit={handleRegister}>
-            <div className="flex flex-col sm:flex-row gap-3">
-              <div className="flex-1">
-                <input
-                  className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 ${
-                    errors.lastName ? 'border-red-500' : ''
-                  }`}
-                  name="lastName"
-                  placeholder="H·ªç"
-                  value={form.lastName}
-                  onChange={handleChange}
-                  disabled={loading || otpStep}
-                />
-                {errors.lastName && (
-                  <p className="text-red-500 text-sm mt-1">{errors.lastName}</p>
-                )}
-              </div>
-              <div className="flex-1">
-                <input
-                  className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 ${
-                    errors.firstName ? 'border-red-500' : ''
-                  }`}
-                  name="firstName"
-                  placeholder="T√™n"
-                  value={form.firstName}
-                  onChange={handleChange}
-                  disabled={loading || otpStep}
-                />
-                {errors.firstName && (
-                  <p className="text-red-500 text-sm mt-1">{errors.firstName}</p>
-                )}
-              </div>
-            </div>
-            
-            {/* Email field with OTP verification */}
-            <div className="space-y-2">
-              <div className="flex gap-2">
-                <input
-                  type="email"
-                  name="email"
-                  placeholder="Nh·∫≠p email ƒë·ªÉ ƒëƒÉng k√Ω"
-                  value={form.email}
-                  onChange={handleChange}
-                  disabled={loading || emailVerified}
-                  className={`flex-1 p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 ${
-                    emailVerified ? 'bg-green-50 border-green-300' : ''
-                  }`}
-                />
-                {!emailVerified && !otpStep && form.email.trim() && form.lastName.trim() && form.firstName.trim() && (
-                  <button
-                    type="button"
-                    onClick={handleSendOTP}
-                    disabled={otpLoading}
-                    className="px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold disabled:bg-gray-400"
-                  >
-                    {otpLoading ? (
-                      <LoadingSpinner size="sm" text="G·ª≠i..." />
-                    ) : (
-                      "G·ª≠i OTP"
-                    )}
-                  </button>
-                )}
-                {emailVerified && (
-                  <div className="px-4 py-3 bg-green-100 text-green-800 rounded-lg font-semibold flex items-center">
-                    ‚úì ƒê√£ x√°c minh
-                  </div>
-                )}
-              </div>
-              {errors.email && (
-                <p className="text-red-500 text-sm">{errors.email}</p>
-              )}
-              {!emailVerified && !otpStep && (
-                <p className="text-sm text-gray-400">
-                </p>
-              )}
-            </div>
-
-            {/* OTP Verification Step */}
-            {otpStep && (
-              <div className="space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200">
-                <h4 className="font-semibold text-blue-800">X√°c minh email</h4>
-                <p className="text-sm text-blue-700">
-                  Ch√∫ng t√¥i ƒë√£ g·ª≠i m√£ OTP 6 ch·ªØ s·ªë ƒë·∫øn email <strong>{form.email}</strong>
-                </p>
-                <div className="flex gap-2">
-                  <input
-                    type="text"
-                    placeholder="Nh·∫≠p m√£ OTP"
-                    value={otpCode}
-                    onChange={(e) => setOtpCode(e.target.value.replace(/\D/g, '').slice(0, 6))}
-                    disabled={otpLoading}
-                    className="flex-1 p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 text-center text-lg font-mono"
-                    maxLength={6}
-                  />
-                  <button
-                    type="button"
-                    onClick={handleVerifyOTP}
-                    disabled={otpLoading || otpCode.length !== 6}
-                    className="px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold disabled:bg-gray-400"
-                  >
-                    {otpLoading ? (
-                      <LoadingSpinner size="sm" text="X√°c minh..." />
-                    ) : (
-                      "X√°c minh"
-                    )}
-                  </button>
-                </div>
-                {errors.otp && (
-                  <p className="text-red-500 text-sm">{errors.otp}</p>
-                )}
-                <button
-                  type="button"
-                  onClick={() => {
-                    setOtpStep(false);
-                    setOtpCode("");
-                    setErrors({});
-                  }}
-                  className="text-sm text-blue-600 hover:text-blue-800 underline"
-                >
-                  Quay l·∫°i nh·∫≠p email
-                </button>
-              </div>
-            )}
-
-            <input
-              type="password"
-              name="password"
-              placeholder="M·∫≠t kh·∫©u"
-              value={form.password}
-              onChange={handleChange}
-              disabled={loading || otpStep}
-              className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400"
-            />
-            <input
-              type="password"
-              name="confirmPassword"
-              placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
-              value={form.confirmPassword}
-              onChange={handleChange}
-              disabled={loading || otpStep}
-              className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400"
-            />
-
-            <button
-              type="submit"
-              disabled={loading || !emailVerified}
-              className="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold flex items-center justify-center disabled:bg-gray-400"
-            >
-              {loading ? (
-                <LoadingSpinner size="sm" text="ƒêang x·ª≠ l√Ω..." />
-              ) : (
-                "ƒêƒÉng k√Ω"
-              )}
-            </button>
-
-            <span className="block text-center text-gray-500 text-sm mt-3">
-              Ho·∫∑c ƒëƒÉng k√Ω nhanh b·∫±ng
-            </span>
-            <div className="flex justify-center mt-3">
-              <GoogleLogin
-                onSuccess={handleGoogleSuccess}
-                onError={handleGoogleError}
-              />
-            </div>
-
-            {errors.general && (
-              <p className="text-red-500 text-sm mt-2 text-center">
-                {errors.general}
-              </p>
-            )}
-            {success && (
-              <p className="text-green-600 text-sm mt-2 text-center font-medium">
-                {success}
-              </p>
-            )}
-          </form>
-        </div>
-
-        <div className="hidden md:flex w-1/2 items-center justify-center relative">
-          <div className="w-100 h-100 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-inner">
-            <img
-              src="/icons/UI Image/item login,rgs.png"
-              alt="Illustration"
-              className="w-70 h-auto drop-shadow-lg transition-transform duration-500 hover:scale-105"
-            />
-          </div>
-        </div>
-      </div>
-    </div>
-  );
-};
-
-export default RegisterPage;
+import React, { useState, useEffect } from "react";
+import { useNavigate } from "react-router-dom";
+import { GoogleLogin } from "@react-oauth/google";
+import axiosClient from "../api/axiosClient";
+import LoadingSpinner from "../components/LoadingSpinner";
+
+const RegisterPage = () => {
+  const navigate = useNavigate();
+  const [form, setForm] = useState({
+    lastName: "",
+    firstName: "",
+    email: "",
+    password: "",
+    confirmPassword: "",
+  });
+  const [errors, setErrors] = useState({});
+  const [success, setSuccess] = useState("");
+  const [loading, setLoading] = useState(false);
+  const [otpStep, setOtpStep] = useState(false); // true when showing OTP verification
+  const [otpCode, setOtpCode] = useState("");
+  const [otpLoading, setOtpLoading] = useState(false);
+  const [emailVerified, setEmailVerified] = useState(false);
+  const role = localStorage.getItem("selectedRole") || "";
+
+  // --- Ki·ªÉm tra role + roomId ---
+  useEffect(() => {
+    if (!role) navigate("/role");
+    else if (role === "student") {
+      const verifiedRoomId = localStorage.getItem("verifiedRoomId");
+      if (!verifiedRoomId) navigate("/verify-room");
+    }
+  }, [role, navigate]);
+
+  const handleChange = (e) => {
+    const { name, value } = e.target;
+    setForm({ ...form, [name]: value });
+    
+    // Clear error when user starts typing
+    if (errors[name]) {
+      setErrors({ ...errors, [name]: "" });
+    }
+    
+    // Real-time validation for lastName and firstName
+    if (name === 'lastName' || name === 'firstName') {
+      const trimmedValue = value.trim();
+      if (trimmedValue && !/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(trimmedValue)) {
+        setErrors({ 
+          ...errors, 
+          [name]: `${name === 'lastName' ? 'H·ªç' : 'T√™n'} ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát` 
+        });
+      }
+    }
+  };
+
+  // --- Send OTP ---
+  const handleSendOTP = async () => {
+    // Ki·ªÉm tra validation cho H·ªç v√† T√™n tr∆∞·ªõc khi g·ª≠i OTP
+    const newErrors = {};
+    
+    // Validation cho H·ªç
+    if (!form.lastName.trim()) {
+      newErrors.lastName = "Vui l√≤ng nh·∫≠p h·ªç";
+    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.lastName.trim())) {
+      newErrors.lastName = "H·ªç ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
+    }
+    
+    // Validation cho T√™n
+    if (!form.firstName.trim()) {
+      newErrors.firstName = "Vui l√≤ng nh·∫≠p t√™n";
+    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.firstName.trim())) {
+      newErrors.firstName = "T√™n ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
+    }
+    
+    // Validation cho Email
+    if (!form.email.trim()) {
+      newErrors.email = "Vui l√≤ng nh·∫≠p email";
+    } else {
+      const emailRegex = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i;
+      if (!emailRegex.test(form.email)) {
+        newErrors.email = "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá";
+      }
+    }
+    
+    // N·∫øu c√≥ l·ªói validation, hi·ªÉn th·ªã l·ªói v√† kh√¥ng g·ª≠i OTP
+    if (Object.keys(newErrors).length > 0) {
+      setErrors(newErrors);
+      setSuccess("");
+      return;
+    }
+
+    setOtpLoading(true);
+    setErrors({});
+
+    try {
+      const res = await axiosClient.post("/auth/send-otp", {
+        email: form.email
+      });
+
+      console.log("[Send OTP] Response:", res.data);
+      setSuccess("M√£ OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email c·ªßa b·∫°n");
+      setOtpStep(true);
+    } catch (error) {
+      console.error("‚ùå Send OTP Error:", error);
+      setErrors({
+        general: error.response?.data?.message || "L·ªói khi g·ª≠i m√£ OTP"
+      });
+    } finally {
+      setOtpLoading(false);
+    }
+  };
+
+  // --- Verify OTP ---
+  const handleVerifyOTP = async () => {
+    if (!otpCode.trim()) {
+      setErrors({ otp: "Vui l√≤ng nh·∫≠p m√£ OTP" });
+      return;
+    }
+
+    if (otpCode.length !== 6) {
+      setErrors({ otp: "M√£ OTP ph·∫£i c√≥ 6 ch·ªØ s·ªë" });
+      return;
+    }
+
+    setOtpLoading(true);
+    setErrors({});
+
+    try {
+      const res = await axiosClient.post("/auth/verify-otp", {
+        email: form.email,
+        otp: otpCode
+      });
+
+      console.log("[Verify OTP] Response:", res.data);
+      setSuccess("Email ƒë√£ ƒë∆∞·ª£c x√°c minh th√†nh c√¥ng!");
+      setEmailVerified(true);
+      setOtpStep(false);
+    } catch (error) {
+      console.error("‚ùå Verify OTP Error:", error);
+      setErrors({
+        otp: error.response?.data?.message || "M√£ OTP kh√¥ng ch√≠nh x√°c"
+      });
+    } finally {
+      setOtpLoading(false);
+    }
+  };
+
+  const validate = () => {
+    const newErrors = {};
+    
+    // Validation cho H·ªç - ch·ªâ cho ph√©p ch·ªØ c√°i v√† kho·∫£ng tr·∫Øng
+    if (!form.lastName.trim()) {
+      newErrors.lastName = "Vui l√≤ng nh·∫≠p h·ªç";
+    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.lastName.trim())) {
+      newErrors.lastName = "H·ªç ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
+    }
+    
+    // Validation cho T√™n - ch·ªâ cho ph√©p ch·ªØ c√°i v√† kho·∫£ng tr·∫Øng
+    if (!form.firstName.trim()) {
+      newErrors.firstName = "Vui l√≤ng nh·∫≠p t√™n";
+    } else if (!/^[a-zA-Z√Ä√Å√Ç√É√à√â√ä√å√ç√í√ì√î√ï√ô√öƒÇƒêƒ®≈®∆†√†√°√¢√£√®√©√™√¨√≠√≤√≥√¥√µ√π√∫ƒÉƒëƒ©≈©∆°∆ØƒÇ√Ç√ä√î∆∞ƒÉ√¢√™√¥\s]+$/.test(form.firstName.trim())) {
+      newErrors.firstName = "T√™n ch·ªâ ƒë∆∞·ª£c ch·ª©a ch·ªØ c√°i, kh√¥ng ƒë∆∞·ª£c c√≥ s·ªë ho·∫∑c k√Ω t·ª± ƒë·∫∑c bi·ªát";
+    }
+    
+    if (!form.email.trim()) newErrors.email = "Vui l√≤ng nh·∫≠p email";
+    else if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(form.email))
+      newErrors.email = "ƒê·ªãnh d·∫°ng email kh√¥ng h·ª£p l·ªá";
+    else if (!emailVerified) 
+      newErrors.email = "Email ch∆∞a ƒë∆∞·ª£c x√°c minh";
+    if (!form.password.trim()) newErrors.password = "Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u";
+    else if (form.password.length < 6)
+      newErrors.password = "M·∫≠t kh·∫©u ph·∫£i √≠t nh·∫•t 6 k√Ω t·ª±";
+    if (form.confirmPassword !== form.password)
+      newErrors.confirmPassword = "M·∫≠t kh·∫©u nh·∫≠p l·∫°i kh√¥ng kh·ªõp";
+    return newErrors;
+  };
+
+  // --- ƒêƒÉng k√Ω th∆∞·ªùng ---
+  const handleRegister = async (e) => {
+    e.preventDefault();
+    const newErrors = validate();
+    if (Object.keys(newErrors).length > 0) {
+      setErrors(newErrors);
+      setSuccess("");
+      return;
+    }
+
+    setLoading(true);
+    setErrors({});
+    setSuccess("");
+
+    try {
+      const payload = {
+        full_name: `${form.lastName} ${form.firstName}`.trim(),
+        email: form.email,
+        password: form.password,
+        role,
+      };
+
+      if (role === "student") {
+        const roomId = localStorage.getItem("verifiedRoomId");
+        if (!roomId) {
+          setErrors({
+            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
+          });
+          setLoading(false);
+          return;
+        }
+        payload.roomId = roomId;
+        console.log("[DEV] Register payload:", payload);
+      }
+
+      console.log("[DEV] üöÄ G·ª≠i request ƒëƒÉng k√Ω v·ªõi payload:", payload);
+
+      const res = await axiosClient.post("/auth/register", payload);
+
+      console.log("[DEV] ‚úÖ ƒêƒÉng k√Ω th√†nh c√¥ng:", res.data);
+
+      setSuccess("üéâ ƒêƒÉng k√Ω th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
+
+      setTimeout(() => {
+        localStorage.setItem("token", res.data.token);
+        localStorage.setItem("role", res.data.user.role);
+        navigate(`/${role === "student" ? "student" : "instructor"}-dashboard`);
+      }, 1500);
+    } catch (error) {
+      console.error("‚ùå [Register Error] Chi ti·∫øt l·ªói ƒë·∫ßy ƒë·ªß:", error);
+
+      if (error.response) {
+        const message = error.response.data?.message || "";
+
+        console.error("üì© [Server Response]:", error.response.data);
+        console.error("üî¢ [Status Code]:", error.response.status);
+        console.error("üì° [Headers]:", error.response.headers);
+
+        // üü† B·ªï sung log ri√™ng cho email ho·∫∑c domain kh√¥ng t·ªìn t·∫°i
+        if (
+          message.includes("T√™n mi·ªÅn email kh√¥ng t·ªìn t·∫°i") ||
+          message.includes("kh√¥ng h·ª£p l·ªá") ||
+          message.includes("kh√¥ng th·ªÉ x√°c minh") ||
+          message.includes("Email ƒëƒÉng k√Ω kh√¥ng t·ªìn t·∫°i")
+        ) {
+          console.warn(
+            `[Register] ‚ö†Ô∏è Email ho·∫∑c domain kh√¥ng t·ªìn t·∫°i: ${payload.email}`
+          );
+        } else if (message.includes("Email ƒë√£ ƒë∆∞·ª£c ƒëƒÉng k√Ω")) {
+          console.warn(`[Register] ‚ö†Ô∏è Email ƒë√£ t·ªìn t·∫°i: ${payload.email}`);
+        }
+      } else if (error.request) {
+        console.error("üì≠ [No Response t·ª´ Server]:", error.request);
+      } else {
+        console.error("‚ö†Ô∏è [Error Message]:", error.message);
+      }
+
+      setErrors({
+        general:
+          error.response?.data?.message ||
+          "ƒêƒÉng k√Ω th·∫•t b·∫°i, vui l√≤ng th·ª≠ l·∫°i.",
+      });
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  // --- Google Register ---
+  const handleGoogleSuccess = async (credentialResponse) => {
+    if (!credentialResponse?.credential) {
+      setErrors({ general: "Kh√¥ng nh·∫≠n ƒë∆∞·ª£c Google credential" });
+      return;
+    }
+
+    setLoading(true);
+    setErrors({});
+    setSuccess("");
+
+    try {
+      const payload = { idToken: credentialResponse.credential, role };
+      if (role === "student") {
+        const roomId = localStorage.getItem("verifiedRoomId");
+        if (!roomId) {
+          setErrors({
+            general: "Kh√¥ng t√¨m th·∫•y m√£ ph√≤ng thi. Vui l√≤ng x√°c th·ª±c l·∫°i.",
+          });
+          setLoading(false);
+          return;
+        }
+        payload.roomId = roomId;
+      }
+
+      console.log("[DEV] Google register payload:", payload);
+      const res = await axiosClient.post("/auth/google", payload);
+      console.log("[DEV] Google register response:", res.data);
+      setSuccess("üéâ ƒêƒÉng k√Ω Google th√†nh c√¥ng! ƒêang chuy·ªÉn h∆∞·ªõng...");
+
+      setTimeout(() => {
+        localStorage.setItem("token", res.data.token);
+        localStorage.setItem("role", res.data.user.role);
+        navigate(`/${role === "student" ? "student" : "instructor"}-dashboard`);
+      }, 1500);
+    } catch (error) {
+      console.error("‚ùå Google register error:", error);
+      setErrors({
+        general: error.response?.data?.message || "ƒêƒÉng k√Ω Google th·∫•t b·∫°i",
+      });
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  const handleGoogleError = () => {
+    setErrors({ general: "L·ªói x√°c th·ª±c Google" });
+  };
+
+  return (
+    <div className="min-h-screen bg-gray-100 flex flex-col">
+      <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 gap-2 md:gap-3">
+        <img
+          src="/Logo.png"
+          alt="OEM Logo"
+          className="h-14 md:h-20 w-auto cursor-pointer"
+          onClick={() => navigate("/")}
+        />
+      </header>
+
+      <div className="flex flex-col md:flex-row w-full max-w-6xl mx-auto my-10 shadow-lg rounded-2xl overflow-hidden bg-white">
+        <div className="w-full md:w-1/2 p-6 md:p-10">
+          <div className="overflow-hidden flex mb-6 rounded-full border border-[#a2b9ff]">
+            <button
+              onClick={() => navigate("/register")}
+              className="flex-1 py-2 text-center bg-[#51b9ff] font-semibold text-gray-900"
+            >
+              ƒêƒÉng k√Ω
+            </button>
+            <button
+              onClick={() => navigate("/login")}
+              className="flex-1 py-2 text-center bg-[#e2f6ff] font-medium text-gray-900"
+            >
+              ƒêƒÉng nh·∫≠p
+            </button>
+          </div>
+
+          <h3 className="text-2xl md:text-3xl font-bold text-red-600 mb-6 text-center uppercase">
+            ƒêƒÉng k√Ω ngay
+          </h3>
+
+          <form className="space-y-4" onSubmit={handleRegister}>
+            <div className="flex flex-col sm:flex-row gap-3">
+              <div className="flex-1">
+                <input
+                  className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 ${
+                    errors.lastName ? 'border-red-500' : ''
+                  }`}
+                  name="lastName"
+                  placeholder="H·ªç"
+                  value={form.lastName}
+                  onChange={handleChange}
+                  disabled={loading || otpStep}
+                />
+                {errors.lastName && (
+                  <p className="text-red-500 text-sm mt-1">{errors.lastName}</p>
+                )}
+              </div>
+              <div className="flex-1">
+                <input
+                  className={`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 ${
+                    errors.firstName ? 'border-red-500' : ''
+                  }`}
+                  name="firstName"
+                  placeholder="T√™n"
+                  value={form.firstName}
+                  onChange={handleChange}
+                  disabled={loading || otpStep}
+                />
+                {errors.firstName && (
+                  <p className="text-red-500 text-sm mt-1">{errors.firstName}</p>
+                )}
+              </div>
+            </div>
+            
+            {/* Email field with OTP verification */}
+            <div className="space-y-2">
+              <div className="flex gap-2">
+                <input
+                  type="email"
+                  name="email"
+                  placeholder="Nh·∫≠p email ƒë·ªÉ ƒëƒÉng k√Ω"
+                  value={form.email}
+                  onChange={handleChange}
+                  disabled={loading || emailVerified}
+                  className={`flex-1 p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 ${
+                    emailVerified ? 'bg-green-50 border-green-300' : ''
+                  }`}
+                />
+                {!emailVerified && !otpStep && form.email.trim() && form.lastName.trim() && form.firstName.trim() && (
+                  <button
+                    type="button"
+                    onClick={handleSendOTP}
+                    disabled={otpLoading}
+                    className="px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold disabled:bg-gray-400"
+                  >
+                    {otpLoading ? (
+                      <LoadingSpinner size="sm" text="G·ª≠i..." />
+                    ) : (
+                      "G·ª≠i OTP"
+                    )}
+                  </button>
+                )}
+                {emailVerified && (
+                  <div className="px-4 py-3 bg-green-100 text-green-800 rounded-lg font-semibold flex items-center">
+                    ‚úì ƒê√£ x√°c minh
+                  </div>
+                )}
+              </div>
+              {errors.email && (
+                <p className="text-red-500 text-sm">{errors.email}</p>
+              )}
+              {!emailVerified && !otpStep && (
+                <p className="text-sm text-gray-400">
+                </p>
+              )}
+            </div>
+
+            {/* OTP Verification Step */}
+            {otpStep && (
+              <div className="space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200">
+                <h4 className="font-semibold text-blue-800">X√°c minh email</h4>
+                <p className="text-sm text-blue-700">
+                  Ch√∫ng t√¥i ƒë√£ g·ª≠i m√£ OTP 6 ch·ªØ s·ªë ƒë·∫øn email <strong>{form.email}</strong>
+                </p>
+                <div className="flex gap-2">
+                  <input
+                    type="text"
+                    placeholder="Nh·∫≠p m√£ OTP"
+                    value={otpCode}
+                    onChange={(e) => setOtpCode(e.target.value.replace(/\D/g, '').slice(0, 6))}
+                    disabled={otpLoading}
+                    className="flex-1 p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 text-center text-lg font-mono"
+                    maxLength={6}
+                  />
+                  <button
+                    type="button"
+                    onClick={handleVerifyOTP}
+                    disabled={otpLoading || otpCode.length !== 6}
+                    className="px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold disabled:bg-gray-400"
+                  >
+                    {otpLoading ? (
+                      <LoadingSpinner size="sm" text="X√°c minh..." />
+                    ) : (
+                      "X√°c minh"
+                    )}
+                  </button>
+                </div>
+                {errors.otp && (
+                  <p className="text-red-500 text-sm">{errors.otp}</p>
+                )}
+                <button
+                  type="button"
+                  onClick={() => {
+                    setOtpStep(false);
+                    setOtpCode("");
+                    setErrors({});
+                  }}
+                  className="text-sm text-blue-600 hover:text-blue-800 underline"
+                >
+                  Quay l·∫°i nh·∫≠p email
+                </button>
+              </div>
+            )}
+
+            <input
+              type="password"
+              name="password"
+              placeholder="M·∫≠t kh·∫©u"
+              value={form.password}
+              onChange={handleChange}
+              disabled={loading || otpStep}
+              className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400"
+            />
+            <input
+              type="password"
+              name="confirmPassword"
+              placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
+              value={form.confirmPassword}
+              onChange={handleChange}
+              disabled={loading || otpStep}
+              className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400"
+            />
+
+            <button
+              type="submit"
+              disabled={loading || !emailVerified}
+              className="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold flex items-center justify-center disabled:bg-gray-400"
+            >
+              {loading ? (
+                <LoadingSpinner size="sm" text="ƒêang x·ª≠ l√Ω..." />
+              ) : (
+                "ƒêƒÉng k√Ω"
+              )}
+            </button>
+
+            <span className="block text-center text-gray-500 text-sm mt-3">
+              Ho·∫∑c ƒëƒÉng k√Ω nhanh b·∫±ng
+            </span>
+            <div className="flex justify-center mt-3">
+              <GoogleLogin
+                onSuccess={handleGoogleSuccess}
+                onError={handleGoogleError}
+              />
+            </div>
+
+            {errors.general && (
+              <p className="text-red-500 text-sm mt-2 text-center">
+                {errors.general}
+              </p>
+            )}
+            {success && (
+              <p className="text-green-600 text-sm mt-2 text-center font-medium">
+                {success}
+              </p>
+            )}
+          </form>
+        </div>
+
+        <div className="hidden md:flex w-1/2 items-center justify-center relative">
+          <div className="w-100 h-100 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-inner">
+            <img
+              src="/icons/UI Image/item login,rgs.png"
+              alt="Illustration"
+              className="w-70 h-auto drop-shadow-lg transition-transform duration-500 hover:scale-105"
+            />
+          </div>
+        </div>
+      </div>
+    </div>
+  );
+};
+
+export default RegisterPage;
diff --git a/frontend/src/authPages/ResetPassword.jsx b/frontend/src/authPages/ResetPassword.jsx
index 3b42844..b686b07 100644
--- a/frontend/src/authPages/ResetPassword.jsx
+++ b/frontend/src/authPages/ResetPassword.jsx
@@ -1,124 +1,124 @@
-import React, { useState } from "react";
-import { useNavigate, useLocation } from "react-router-dom";
-import axios from "axios";
-import { FaEye, FaEyeSlash } from "react-icons/fa";
-
-const ResetPassword = () => {
-  const navigate = useNavigate();
-  const location = useLocation();
-  const email = location.state?.email || "";
-  const otp = location.state?.otp || "";
-
-  const [password, setPassword] = useState("");
-  const [confirmPassword, setConfirmPassword] = useState("");
-  const [error, setError] = useState("");
-  const [success, setSuccess] = useState("");
-  const [loading, setLoading] = useState(false);
-  const [showPassword, setShowPassword] = useState(false);
-  const [showConfirmPassword, setShowConfirmPassword] = useState(false);
-
-  const handleSubmit = async (e) => {
-    e.preventDefault();
-    setError("");
-    setSuccess("");
-
-    if (password !== confirmPassword) {
-      setError("M·∫≠t kh·∫©u v√† x√°c nh·∫≠n m·∫≠t kh·∫©u kh√¥ng kh·ªõp.");
-      return;
-    }
-
-    if (password.length < 6) {
-      setError("M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±.");
-      return;
-    }
-
-    try {
-      setLoading(true);
-      const res = await axios.post(
-        "http://localhost:5000/api/auth/reset-password",
-        { email, newPassword: password, otp }
-      );
-
-      if (res.status === 200 || res.data.status === "success") {
-        setSuccess(
-          "‚úÖ ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng! B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn ƒë·∫øn trang ƒëƒÉng nh·∫≠p..."
-        );
-        setTimeout(() => navigate("/login"), 2000);
-      } else {
-        setError(res.data.message || "C√≥ l·ªói x·∫£y ra khi c·∫≠p nh·∫≠t m·∫≠t kh·∫©u.");
-      }
-    } catch (err) {
-      setError(
-        err.response?.data?.message || "K·∫øt n·ªëi th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i."
-      );
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  return (
-    <div className="flex items-center justify-center min-h-screen bg-gray-100">
-      <div className="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
-        <h2 className="text-2xl font-bold text-center mb-4">
-          T·∫°o m·∫≠t kh·∫©u m·ªõi
-        </h2>
-        <p className="text-center text-gray-600 mb-6">
-          Nh·∫≠p m·∫≠t kh·∫©u m·ªõi c·ªßa b·∫°n n·∫øu b·∫°n ƒë√£ qu√™n m·∫≠t kh·∫©u c≈©.
-        </p>
-
-        <form onSubmit={handleSubmit}>
-          <div className="mb-4 relative">
-            <input
-              type={showPassword ? "text" : "password"}
-              value={password}
-              onChange={(e) => setPassword(e.target.value)}
-              placeholder="M·∫≠t kh·∫©u m·ªõi"
-              className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
-              required
-            />
-            <button
-              type="button"
-              onClick={() => setShowPassword(!showPassword)}
-              className="absolute right-3 top-2.5 text-gray-500"
-            >
-              {showPassword ? <FaEyeSlash /> : <FaEye />}
-            </button>
-          </div>
-
-          <div className="mb-4 relative">
-            <input
-              type={showConfirmPassword ? "text" : "password"}
-              value={confirmPassword}
-              onChange={(e) => setConfirmPassword(e.target.value)}
-              placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u"
-              className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
-              required
-            />
-            <button
-              type="button"
-              onClick={() => setShowConfirmPassword(!showConfirmPassword)}
-              className="absolute right-3 top-2.5 text-gray-500"
-            >
-              {showConfirmPassword ? <FaEyeSlash /> : <FaEye />}
-            </button>
-          </div>
-
-          {error && <p className="text-red-500 text-center mb-4">{error}</p>}
-          {success && (
-            <p className="text-green-600 text-center mb-4">{success}</p>
-          )}
-
-          <button
-            type="submit"
-            disabled={loading}
-            className="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600 transition disabled:opacity-50"
-          >
-            {loading ? "ƒêang x·ª≠ l√Ω..." : "X√°c nh·∫≠n"}
-          </button>
-        </form>
-      </div>
-    </div>
-  );
-};
-
-export default ResetPassword;
+import React, { useState } from "react";
+import { useNavigate, useLocation } from "react-router-dom";
+import axios from "axios";
+import { FaEye, FaEyeSlash } from "react-icons/fa";
+
+const ResetPassword = () => {
+  const navigate = useNavigate();
+  const location = useLocation();
+  const email = location.state?.email || "";
+  const otp = location.state?.otp || "";
+
+  const [password, setPassword] = useState("");
+  const [confirmPassword, setConfirmPassword] = useState("");
+  const [error, setError] = useState("");
+  const [success, setSuccess] = useState("");
+  const [loading, setLoading] = useState(false);
+  const [showPassword, setShowPassword] = useState(false);
+  const [showConfirmPassword, setShowConfirmPassword] = useState(false);
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    setError("");
+    setSuccess("");
+
+    if (password !== confirmPassword) {
+      setError("M·∫≠t kh·∫©u v√† x√°c nh·∫≠n m·∫≠t kh·∫©u kh√¥ng kh·ªõp.");
+      return;
+    }
+
+    if (password.length < 6) {
+      setError("M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±.");
+      return;
+    }
+
+    try {
+      setLoading(true);
+      const res = await axios.post(
+        "http://localhost:5000/api/auth/reset-password",
+        { email, newPassword: password, otp }
+      );
+
+      if (res.status === 200 || res.data.status === "success") {
+        setSuccess(
+          "‚úÖ ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng! B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn ƒë·∫øn trang ƒëƒÉng nh·∫≠p..."
+        );
+        setTimeout(() => navigate("/login"), 2000);
+      } else {
+        setError(res.data.message || "C√≥ l·ªói x·∫£y ra khi c·∫≠p nh·∫≠t m·∫≠t kh·∫©u.");
+      }
+    } catch (err) {
+      setError(
+        err.response?.data?.message || "K·∫øt n·ªëi th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i."
+      );
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  return (
+    <div className="flex items-center justify-center min-h-screen bg-gray-100">
+      <div className="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
+        <h2 className="text-2xl font-bold text-center mb-4">
+          T·∫°o m·∫≠t kh·∫©u m·ªõi
+        </h2>
+        <p className="text-center text-gray-600 mb-6">
+          Nh·∫≠p m·∫≠t kh·∫©u m·ªõi c·ªßa b·∫°n n·∫øu b·∫°n ƒë√£ qu√™n m·∫≠t kh·∫©u c≈©.
+        </p>
+
+        <form onSubmit={handleSubmit}>
+          <div className="mb-4 relative">
+            <input
+              type={showPassword ? "text" : "password"}
+              value={password}
+              onChange={(e) => setPassword(e.target.value)}
+              placeholder="M·∫≠t kh·∫©u m·ªõi"
+              className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
+              required
+            />
+            <button
+              type="button"
+              onClick={() => setShowPassword(!showPassword)}
+              className="absolute right-3 top-2.5 text-gray-500"
+            >
+              {showPassword ? <FaEyeSlash /> : <FaEye />}
+            </button>
+          </div>
+
+          <div className="mb-4 relative">
+            <input
+              type={showConfirmPassword ? "text" : "password"}
+              value={confirmPassword}
+              onChange={(e) => setConfirmPassword(e.target.value)}
+              placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u"
+              className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
+              required
+            />
+            <button
+              type="button"
+              onClick={() => setShowConfirmPassword(!showConfirmPassword)}
+              className="absolute right-3 top-2.5 text-gray-500"
+            >
+              {showConfirmPassword ? <FaEyeSlash /> : <FaEye />}
+            </button>
+          </div>
+
+          {error && <p className="text-red-500 text-center mb-4">{error}</p>}
+          {success && (
+            <p className="text-green-600 text-center mb-4">{success}</p>
+          )}
+
+          <button
+            type="submit"
+            disabled={loading}
+            className="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600 transition disabled:opacity-50"
+          >
+            {loading ? "ƒêang x·ª≠ l√Ω..." : "X√°c nh·∫≠n"}
+          </button>
+        </form>
+      </div>
+    </div>
+  );
+};
+
+export default ResetPassword;
diff --git a/frontend/src/authPages/RolePage.jsx b/frontend/src/authPages/RolePage.jsx
index c5bb610..db876a8 100644
--- a/frontend/src/authPages/RolePage.jsx
+++ b/frontend/src/authPages/RolePage.jsx
@@ -1,103 +1,103 @@
-import React, { useState, useEffect } from "react";
-import { useNavigate, useLocation } from "react-router-dom";
-
-export default function RolePage() {
-  const navigate = useNavigate();
-  const location = useLocation();
-  const isLogin = location.state?.mode === "login";
-  const [loading, setLoading] = useState(false);
-
-  useEffect(() => {
-    // Kh√¥ng t·ª± ƒë·ªông redirect, ƒë·ªÉ user c√≥ th·ªÉ ch·ªçn role m·ªõi
-    // Ch·ªâ x√≥a selectedRole n·∫øu ƒë√£ ƒëƒÉng nh·∫≠p
-    const token = localStorage.getItem("token");
-    if (token) {
-      localStorage.removeItem("selectedRole");
-    }
-  }, []);
-
-  const handleSelectRole = async (role) => {
-  setLoading(true);
-  const selectedRole = role;
-
-  try {
-    // X√≥a t·∫•t c·∫£ d·ªØ li·ªáu c≈© khi ch·ªçn role m·ªõi
-    localStorage.removeItem("token");
-    localStorage.removeItem("role");
-    localStorage.removeItem("verifiedRoomId");
-    localStorage.removeItem("verifiedRoomCode");
-
-    localStorage.setItem("selectedRole", selectedRole);
-
-    if (selectedRole === "instructor") {
-      navigate("/login", {
-        state: { role: selectedRole, fromRoleSelection: true },
-      });
-    } else {
-      navigate("/verify-room", {
-        state: { role: selectedRole, fromRoleSelection: true },
-      });
-    }
-  } catch (error) {
-    console.error("L·ªói ch·ªçn role:", error);
-  } finally {
-    setLoading(false);
-  }
-};
-
-  return (
-    <div className="min-h-screen bg-gray-100 flex flex-col">
-      <header className="mx-auto flex items-center justify-start px-6 py-4 w-full max-w-6xl">
-        <div
-          className="flex items-center gap-3 cursor-pointer"
-          onClick={() => navigate("/")}
-        >
-          <img
-            src="/Logo.png"
-            alt="OEM Logo"
-            className="h-16 sm:h-20 md:h-24 w-auto"
-          />
-        </div>
-      </header>
-
-      <main className="flex flex-1 flex-col items-center px-4 py-10 sm:py-20">
-        <div className="bg-white w-full max-w-[450px] p-8 md:p-10 rounded-2xl shadow-md flex flex-col items-center justify-center text-center border border-gray-200 transition-all hover:shadow-lg">
-          <div className="flex items-center justify-start w-full mb-6 gap-3 pl-2">
-            <img
-              src="/icons/UI Image/user.png"
-              alt="User Icon"
-              className="h-10 sm:h-12 w-auto"
-            />
-            <span className="text-lg sm:text-xl md:text-2xl font-semibold text-gray-700">
-              B·∫°n l√† ai?
-            </span>
-          </div>
-
-          <div className="flex w-full gap-4">
-            <button
-              onClick={() => handleSelectRole("instructor")}
-              disabled={loading}
-              className="flex-1 px-8 py-3 border !border-blue-500 !text-blue-600 rounded-lg !bg-white 
-             !hover:bg-blue-50 !text-lg !sm:text-xl !font-semibold transition-all active:scale-95 
-             active:!border-blue-700 focus:!border-blue-700  focus:!ring-blue-300 
-             focus:!outline-none active:!outline-none"
-            >
-              {loading ? "ƒêang x·ª≠ l√Ω..." : "Instructor"}
-            </button>
-
-            <button
-              onClick={() => handleSelectRole("student")}
-              disabled={loading}
-              className="flex-1 px-8 py-3 border !border-blue-500 !text-blue-600 rounded-lg !bg-white 
-             !hover:bg-blue-50 !text-lg !sm:text-xl !font-semibold transition-all active:scale-95 
-             active:!border-blue-700 focus:!border-blue-700  focus:!ring-blue-300 
-             focus:!outline-none active:!outline-none"
-            >
-              {loading ? "ƒêang x·ª≠ l√Ω..." : "Student"}
-            </button>
-          </div>
-        </div>
-      </main>
-    </div>
-  );
-}
+import React, { useState, useEffect } from "react";
+import { useNavigate, useLocation } from "react-router-dom";
+
+export default function RolePage() {
+  const navigate = useNavigate();
+  const location = useLocation();
+  const isLogin = location.state?.mode === "login";
+  const [loading, setLoading] = useState(false);
+
+  useEffect(() => {
+    // Kh√¥ng t·ª± ƒë·ªông redirect, ƒë·ªÉ user c√≥ th·ªÉ ch·ªçn role m·ªõi
+    // Ch·ªâ x√≥a selectedRole n·∫øu ƒë√£ ƒëƒÉng nh·∫≠p
+    const token = localStorage.getItem("token");
+    if (token) {
+      localStorage.removeItem("selectedRole");
+    }
+  }, []);
+
+  const handleSelectRole = async (role) => {
+  setLoading(true);
+  const selectedRole = role;
+
+  try {
+    // X√≥a t·∫•t c·∫£ d·ªØ li·ªáu c≈© khi ch·ªçn role m·ªõi
+    localStorage.removeItem("token");
+    localStorage.removeItem("role");
+    localStorage.removeItem("verifiedRoomId");
+    localStorage.removeItem("verifiedRoomCode");
+
+    localStorage.setItem("selectedRole", selectedRole);
+
+    if (selectedRole === "instructor") {
+      navigate("/login", {
+        state: { role: selectedRole, fromRoleSelection: true },
+      });
+    } else {
+      navigate("/verify-room", {
+        state: { role: selectedRole, fromRoleSelection: true },
+      });
+    }
+  } catch (error) {
+    console.error("L·ªói ch·ªçn role:", error);
+  } finally {
+    setLoading(false);
+  }
+};
+
+  return (
+    <div className="min-h-screen bg-gray-100 flex flex-col">
+      <header className="mx-auto flex items-center justify-start px-6 py-4 w-full max-w-6xl">
+        <div
+          className="flex items-center gap-3 cursor-pointer"
+          onClick={() => navigate("/")}
+        >
+          <img
+            src="/Logo.png"
+            alt="OEM Logo"
+            className="h-16 sm:h-20 md:h-24 w-auto"
+          />
+        </div>
+      </header>
+
+      <main className="flex flex-1 flex-col items-center px-4 py-10 sm:py-20">
+        <div className="bg-white w-full max-w-[450px] p-8 md:p-10 rounded-2xl shadow-md flex flex-col items-center justify-center text-center border border-gray-200 transition-all hover:shadow-lg">
+          <div className="flex items-center justify-start w-full mb-6 gap-3 pl-2">
+            <img
+              src="/icons/UI Image/user.png"
+              alt="User Icon"
+              className="h-10 sm:h-12 w-auto"
+            />
+            <span className="text-lg sm:text-xl md:text-2xl font-semibold text-gray-700">
+              B·∫°n l√† ai?
+            </span>
+          </div>
+
+          <div className="flex w-full gap-4">
+            <button
+              onClick={() => handleSelectRole("instructor")}
+              disabled={loading}
+              className="flex-1 px-8 py-3 border !border-blue-500 !text-blue-600 rounded-lg !bg-white 
+             !hover:bg-blue-50 !text-lg !sm:text-xl !font-semibold transition-all active:scale-95 
+             active:!border-blue-700 focus:!border-blue-700  focus:!ring-blue-300 
+             focus:!outline-none active:!outline-none"
+            >
+              {loading ? "ƒêang x·ª≠ l√Ω..." : "Instructor"}
+            </button>
+
+            <button
+              onClick={() => handleSelectRole("student")}
+              disabled={loading}
+              className="flex-1 px-8 py-3 border !border-blue-500 !text-blue-600 rounded-lg !bg-white 
+             !hover:bg-blue-50 !text-lg !sm:text-xl !font-semibold transition-all active:scale-95 
+             active:!border-blue-700 focus:!border-blue-700  focus:!ring-blue-300 
+             focus:!outline-none active:!outline-none"
+            >
+              {loading ? "ƒêang x·ª≠ l√Ω..." : "Student"}
+            </button>
+          </div>
+        </div>
+      </main>
+    </div>
+  );
+}
diff --git a/frontend/src/authPages/VerifyEmail.jsx b/frontend/src/authPages/VerifyEmail.jsx
index c9cd7c3..37ca677 100644
--- a/frontend/src/authPages/VerifyEmail.jsx
+++ b/frontend/src/authPages/VerifyEmail.jsx
@@ -1,154 +1,154 @@
-import React, { useState, useEffect, useRef } from "react";
-import { useLocation, useNavigate } from "react-router-dom";
-import axios from "axios";
-
-const VerifyEmail = () => {
-  const location = useLocation();
-  const navigate = useNavigate();
-  const email = location.state?.email || "";
-  const [otp, setOtp] = useState(["", "", "", "", "", ""]); // ‚úÖ 6 k√Ω t·ª±
-  const [timer, setTimer] = useState(60);
-  const [message, setMessage] = useState("");
-  const inputsRef = useRef([]);
-
-  // ƒê·∫øm ng∆∞·ª£c 60s
-  useEffect(() => {
-    if (timer > 0) {
-      const countdown = setTimeout(() => setTimer((prev) => prev - 1), 1000);
-      return () => clearTimeout(countdown);
-    }
-  }, [timer]);
-
-  const handleChange = (e, index) => {
-    const value = e.target.value.replace(/\D/g, "").slice(0, 1);
-    const newOtp = [...otp];
-    newOtp[index] = value;
-    setOtp(newOtp);
-
-    if (value && index < otp.length - 1) {
-      setTimeout(() => {
-        inputsRef.current[index + 1]?.focus();
-      }, 0);
-    }
-  };
-
-  const handleKeyDown = (e, index) => {
-    if (e.key === "Backspace") {
-      e.preventDefault();
-      const newOtp = [...otp];
-
-      if (otp[index]) {
-        newOtp[index] = "";
-        setOtp(newOtp);
-      } else if (index > 0) {
-        inputsRef.current[index - 1].focus();
-        newOtp[index - 1] = "";
-        setOtp(newOtp);
-      }
-    }
-  };
-
-  const handleVerify = async (e) => {
-    e.preventDefault();
-    const code = otp.join("");
-    if (code.length < 6) {
-      setMessage("Vui l√≤ng nh·∫≠p ƒë·ªß 6 s·ªë OTP");
-      return;
-    }
-
-    try {
-      const res = await axios.post(
-        "http://localhost:5000/api/auth/verify-otp",
-        { email, otp: code }
-      );
-
-      if (res.data.status === "success") {
-        setMessage("‚úÖ X√°c minh th√†nh c√¥ng!");
-        setTimeout(
-          () => navigate("/reset-password", { state: { email, otp: code } }),
-          1000
-        );
-      } else {
-        setMessage("‚ùå M√£ OTP kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n");
-      }
-    } catch (err) {
-      setMessage("‚ö†Ô∏è L·ªói x√°c minh OTP");
-      console.error(err);
-    }
-  };
-
-  // ‚úÖ G·ª≠i l·∫°i OTP
-  const handleResend = async () => {
-    if (timer > 0) return;
-    try {
-      await axios.post("http://localhost:5000/api/auth/forgot-send-otp", {
-        email,
-      });
-      setTimer(60);
-      setMessage("‚úÖ M√£ OTP m·ªõi ƒë√£ ƒë∆∞·ª£c g·ª≠i l·∫°i!");
-      setOtp(["", "", "", "", "", ""]);
-      inputsRef.current[0].focus();
-    } catch (err) {
-      console.error(err);
-      setMessage("‚ùå G·ª≠i l·∫°i OTP th·∫•t b·∫°i");
-    }
-  };
-
-  return (
-    <div className="min-h-screen flex items-center justify-center bg-gray-100">
-      <div className="bg-white shadow-lg rounded-2xl p-8 w-full max-w-md text-center">
-        <h2 className="text-3xl font-bold text-gray-800 mb-2">
-          Ki·ªÉm tra Email c·ªßa b·∫°n
-        </h2>
-        <p className="text-gray-500 mb-6">
-          M√£ x√°c th·ª±c OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email
-          <br /> Vui l√≤ng nh·∫≠p m√£ b√™n d∆∞·ªõi ƒë·ªÉ ti·∫øp t·ª•c.
-        </p>
-
-        <div className="flex justify-center gap-3 mb-6">
-          {otp.map((digit, index) => (
-            <input
-              key={index}
-              ref={(el) => (inputsRef.current[index] = el)}
-              type="text"
-              maxLength="1"
-              value={digit}
-              onChange={(e) => handleChange(e, index)}
-              onKeyDown={(e) => handleKeyDown(e, index)}
-              className="w-12 h-12 text-center text-xl font-semibold border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
-            />
-          ))}
-        </div>
-
-        <p
-          onClick={handleResend}
-          className={`text-sm ${
-            timer > 0
-              ? "text-gray-400"
-              : "text-indigo-600 cursor-pointer hover:underline"
-          } mb-4`}
-        >
-          {timer > 0 ? `You can resend code in ${timer}s` : "Resend code"}
-        </p>
-
-        <button
-          onClick={handleVerify}
-          className="w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition-colors"
-        >
-          X√°c nh·∫≠n
-        </button>
-
-        {message && <p className="text-sm text-gray-700 mt-4">{message}</p>}
-
-        <button
-          onClick={() => navigate("/login")}
-          className="text-indigo-600 text-sm mt-4 hover:underline"
-        >
-          Quay l·∫°i ƒêƒÉng Nh·∫≠p
-        </button>
-      </div>
-    </div>
-  );
-};
-
-export default VerifyEmail;
+import React, { useState, useEffect, useRef } from "react";
+import { useLocation, useNavigate } from "react-router-dom";
+import axios from "axios";
+
+const VerifyEmail = () => {
+  const location = useLocation();
+  const navigate = useNavigate();
+  const email = location.state?.email || "";
+  const [otp, setOtp] = useState(["", "", "", "", "", ""]); // ‚úÖ 6 k√Ω t·ª±
+  const [timer, setTimer] = useState(60);
+  const [message, setMessage] = useState("");
+  const inputsRef = useRef([]);
+
+  // ƒê·∫øm ng∆∞·ª£c 60s
+  useEffect(() => {
+    if (timer > 0) {
+      const countdown = setTimeout(() => setTimer((prev) => prev - 1), 1000);
+      return () => clearTimeout(countdown);
+    }
+  }, [timer]);
+
+  const handleChange = (e, index) => {
+    const value = e.target.value.replace(/\D/g, "").slice(0, 1);
+    const newOtp = [...otp];
+    newOtp[index] = value;
+    setOtp(newOtp);
+
+    if (value && index < otp.length - 1) {
+      setTimeout(() => {
+        inputsRef.current[index + 1]?.focus();
+      }, 0);
+    }
+  };
+
+  const handleKeyDown = (e, index) => {
+    if (e.key === "Backspace") {
+      e.preventDefault();
+      const newOtp = [...otp];
+
+      if (otp[index]) {
+        newOtp[index] = "";
+        setOtp(newOtp);
+      } else if (index > 0) {
+        inputsRef.current[index - 1].focus();
+        newOtp[index - 1] = "";
+        setOtp(newOtp);
+      }
+    }
+  };
+
+  const handleVerify = async (e) => {
+    e.preventDefault();
+    const code = otp.join("");
+    if (code.length < 6) {
+      setMessage("Vui l√≤ng nh·∫≠p ƒë·ªß 6 s·ªë OTP");
+      return;
+    }
+
+    try {
+      const res = await axios.post(
+        "http://localhost:5000/api/auth/verify-otp",
+        { email, otp: code }
+      );
+
+      if (res.data.status === "success") {
+        setMessage("‚úÖ X√°c minh th√†nh c√¥ng!");
+        setTimeout(
+          () => navigate("/reset-password", { state: { email, otp: code } }),
+          1000
+        );
+      } else {
+        setMessage("‚ùå M√£ OTP kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n");
+      }
+    } catch (err) {
+      setMessage("‚ö†Ô∏è L·ªói x√°c minh OTP");
+      console.error(err);
+    }
+  };
+
+  // ‚úÖ G·ª≠i l·∫°i OTP
+  const handleResend = async () => {
+    if (timer > 0) return;
+    try {
+      await axios.post("http://localhost:5000/api/auth/forgot-send-otp", {
+        email,
+      });
+      setTimer(60);
+      setMessage("‚úÖ M√£ OTP m·ªõi ƒë√£ ƒë∆∞·ª£c g·ª≠i l·∫°i!");
+      setOtp(["", "", "", "", "", ""]);
+      inputsRef.current[0].focus();
+    } catch (err) {
+      console.error(err);
+      setMessage("‚ùå G·ª≠i l·∫°i OTP th·∫•t b·∫°i");
+    }
+  };
+
+  return (
+    <div className="min-h-screen flex items-center justify-center bg-gray-100">
+      <div className="bg-white shadow-lg rounded-2xl p-8 w-full max-w-md text-center">
+        <h2 className="text-3xl font-bold text-gray-800 mb-2">
+          Ki·ªÉm tra Email c·ªßa b·∫°n
+        </h2>
+        <p className="text-gray-500 mb-6">
+          M√£ x√°c th·ª±c OTP ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email
+          <br /> Vui l√≤ng nh·∫≠p m√£ b√™n d∆∞·ªõi ƒë·ªÉ ti·∫øp t·ª•c.
+        </p>
+
+        <div className="flex justify-center gap-3 mb-6">
+          {otp.map((digit, index) => (
+            <input
+              key={index}
+              ref={(el) => (inputsRef.current[index] = el)}
+              type="text"
+              maxLength="1"
+              value={digit}
+              onChange={(e) => handleChange(e, index)}
+              onKeyDown={(e) => handleKeyDown(e, index)}
+              className="w-12 h-12 text-center text-xl font-semibold border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
+            />
+          ))}
+        </div>
+
+        <p
+          onClick={handleResend}
+          className={`text-sm ${
+            timer > 0
+              ? "text-gray-400"
+              : "text-indigo-600 cursor-pointer hover:underline"
+          } mb-4`}
+        >
+          {timer > 0 ? `You can resend code in ${timer}s` : "Resend code"}
+        </p>
+
+        <button
+          onClick={handleVerify}
+          className="w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition-colors"
+        >
+          X√°c nh·∫≠n
+        </button>
+
+        {message && <p className="text-sm text-gray-700 mt-4">{message}</p>}
+
+        <button
+          onClick={() => navigate("/login")}
+          className="text-indigo-600 text-sm mt-4 hover:underline"
+        >
+          Quay l·∫°i ƒêƒÉng Nh·∫≠p
+        </button>
+      </div>
+    </div>
+  );
+};
+
+export default VerifyEmail;
diff --git a/frontend/src/authPages/VerifyRoom.jsx b/frontend/src/authPages/VerifyRoom.jsx
index 6387611..d5c14fe 100644
--- a/frontend/src/authPages/VerifyRoom.jsx
+++ b/frontend/src/authPages/VerifyRoom.jsx
@@ -1,194 +1,194 @@
-// ‚úÖ B·∫£n chu·∫©n c·ªßa VerifyRoom.jsx (kh√¥ng ƒë·ªïi UI, ch·ªâ ƒë·ªïi logic)
-import React, { useState, useEffect } from "react";
-import { useNavigate, useLocation } from "react-router-dom";
-import axiosClient from "../api/axiosClient";
-import LoadingSpinner from "../components/LoadingSpinner";
-
-export default function VerifyRoom() {
-  const navigate = useNavigate();
-  const location = useLocation();
-  const [roomCode, setRoomCode] = useState("");
-  const [error, setError] = useState("");
-  const [success, setSuccess] = useState("");
-  const [loading, setLoading] = useState(false);
-  const role = localStorage.getItem("selectedRole");
-
-  useEffect(() => {
-    const fromRoleSelection = location.state?.fromRoleSelection;
-
-    if (!fromRoleSelection) {
-      const token = localStorage.getItem("token");
-      const userRole = localStorage.getItem("role");
-      if (token && userRole) {
-        navigate(
-          `/${userRole === "student" ? "student" : "instructor"}-dashboard`
-        );
-        return;
-      }
-    }
-
-    if (!role || role !== "student") {
-      navigate("/");
-    }
-  }, [role, navigate, location.state]);
-
-  const handleVerify = async () => {
-    if (!roomCode.trim()) {
-      setError("Vui l√≤ng nh·∫≠p m√£ ph√≤ng");
-      setSuccess("");
-      return;
-    }
-
-    setLoading(true);
-    setError("");
-    setSuccess("");
-    try {
-      // ∆Øu ti√™n g·ªçi endpoint m·ªõi ƒë·ªÉ l·∫•y room_token
-      const resNew = await axiosClient.post('/exams/verify-room', { room_code: roomCode.trim() });
-      console.log('[DEV] Verify room (new) response:', resNew.data);
-      const { exam_id, duration_minutes, room_token, require_face_check, require_student_card, monitor_screen, time_open, time_close } = resNew.data || {};
-      if (room_token && exam_id) {
-        // L∆∞u token ph√≤ng ·ªü sessionStorage (ng·∫Øn h·∫°n)
-        sessionStorage.setItem('room_token', room_token);
-        sessionStorage.setItem('pending_exam_id', String(exam_id));
-        if (duration_minutes) sessionStorage.setItem('pending_exam_duration', String(duration_minutes));
-        try {
-          sessionStorage.setItem('exam_flags', JSON.stringify({ face: !!require_face_check, card: !!require_student_card, monitor: !!monitor_screen }));
-        } catch(e) {}
-        if (time_open) sessionStorage.setItem('exam_time_open', String(time_open));
-        if (time_close) sessionStorage.setItem('exam_time_close', String(time_close));
-        // L∆∞u code c≈© ƒë·ªÉ t∆∞∆°ng th√≠ch c√°c flow t·ªìn t·∫°i
-        localStorage.setItem('verifiedRoomId', roomCode.trim());
-        localStorage.setItem('verifiedRoomCode', roomCode.trim());
-
-        setSuccess('‚úÖ M√£ ph√≤ng thi h·ª£p l·ªá! ƒêang chuy·ªÉn h∆∞·ªõng...');
-        setTimeout(() => {
-          navigate('/login', { state: { role, fromVerifyRoom: true } });
-        }, 800);
-        return;
-      }
-
-      // Fallback sang API c≈© n·∫øu kh√¥ng c√≥ room_token
-      const res = await axiosClient.get(`/auth/verify-room/${roomCode}`);
-      console.log("[DEV] Verify room (legacy) response:", res.data);
-      if (res.data.valid) {
-        setSuccess("‚úÖ M√£ ph√≤ng thi h·ª£p l·ªá! ƒêang chuy·ªÉn h∆∞·ªõng...");
-        localStorage.setItem("verifiedRoomId", res.data.examCode);
-        localStorage.setItem("verifiedRoomCode", res.data.examCode);
-        setTimeout(() => navigate('/login', { state: { role, fromVerifyRoom: true } }), 800);
-      } else {
-        setError(res.data.message || "M√£ ph√≤ng kh√¥ng h·ª£p l·ªá");
-        setSuccess("");
-      }
-    } catch (error) {
-      // N·∫øu 403 do h·∫øt gi·ªù/ch∆∞a m·ªü ‚Üí hi·ªÉn th·ªã v√† kh√¥ng fallback
-      const m = error?.response?.data?.message || error?.message;
-      if (error?.response?.status === 403) {
-        setError(m || 'Kh√¥ng th·ªÉ v√†o ph√≤ng thi (th·ªùi gian)');
-        setSuccess('');
-        return;
-      }
-      console.warn('[VerifyRoom] new verify failed, try legacy route‚Ä¶', error?.response?.data || error?.message || error);
-      try {
-        const res = await axiosClient.get(`/auth/verify-room/${roomCode}`);
-        if (res.data?.valid) {
-          localStorage.setItem("verifiedRoomId", res.data.examCode);
-          localStorage.setItem("verifiedRoomCode", res.data.examCode);
-          setSuccess("‚úÖ M√£ ph√≤ng thi h·ª£p l·ªá! ƒêang chuy·ªÉn h∆∞·ªõng...");
-          setTimeout(() => navigate('/login', { state: { role, fromVerifyRoom: true } }), 800);
-        } else {
-          setError(res.data?.message || "M√£ ph√≤ng kh√¥ng h·ª£p l·ªá");
-        }
-      } catch (e2) {
-        setError(e2?.response?.data?.message || 'C√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i');
-      }
-    }
-    setLoading(false);
-  };
-
-  return (
-    <div className="min-h-screen bg-gray-100 flex flex-col">
-      <header className="mx-auto flex items-center justify-start px-6 py-4 w-full max-w-6xl">
-        <div
-          className="flex items-center gap-3 cursor-pointer"
-          onClick={() => navigate("/")}
-        >
-          <img
-            src="/Logo.png"
-            alt="OEM Logo"
-            className="h-16 sm:h-20 md:h-24 w-auto"
-          />
-        </div>
-      </header>
-
-      <div className="bg-gray-100 mt-8 flex flex-col items-center justify-center">
-        <div className="bg-white w-full max-w-[400px] p-6 rounded-lg shadow-md border border-gray-300">
-          <div className="mb-6 flex items-center justify-center gap-4">
-            <div className="!w-14 !h-14 sm:w-20 sm:h-20 rounded-full bg-[#C0D9EB] flex items-center justify-center shadow-md border border-blue-200">
-              <img
-                src="/icons/UI Image/lock.png"
-                alt="Lock Icon"
-                className="h-8 sm:h-10 w-auto object-contain"
-              />
-            </div>
-            <h2 className="text-lg sm:text-xl md:text-2xl font-semibold text-gray-700">
-              Truy c·∫≠p ph·∫ßn thi
-            </h2>
-          </div>
-
-          <div className="mb-4 p-4 bg-[#C0D9EB] rounded-lg border border-blue-200">
-            <span className="block text-sm font-medium text-gray-600 mb-2">
-              M√£ truy c·∫≠p v√†o ph·∫ßn thi
-            </span>
-            <input
-              id="roomCode"
-              type="text"
-              value={roomCode}
-              onChange={(e) => setRoomCode(e.target.value.toUpperCase())}
-              onKeyDown={(e) => {
-                if (e.key === "Enter") handleVerify();
-              }}
-              maxLength={12}
-              className="w-full p-2 border rounded-md !text-gray-700 focus:outline-none !bg-white focus:!ring-blue-400 border-gray-400"
-              placeholder="Nh·∫≠p m√£ truy c·∫≠p"
-              disabled={loading}
-            />
-          </div>
-
-          {error && (
-            <p className="text-red-500 text-sm text-center mb-4">{error}</p>
-          )}
-
-          {success && (
-            <p className="text-green-600 text-sm text-center mb-4 font-medium">
-              {success}
-            </p>
-          )}
-
-          <button
-            onClick={handleVerify}
-            disabled={loading || !roomCode.trim()}
-            className={`w-full py-2 rounded-md !text-white font-medium flex items-center justify-center gap-2 transition-all ${
-              loading || !roomCode.trim()
-                ? "!bg-blue-300 cursor-not-allowed"
-                : "!bg-blue-500 !hover:bg-blue-600 active:scale-95"
-            }`}
-          >
-            {loading ? (
-              <LoadingSpinner size="sm" text="ƒêang x√°c nh·∫≠n..." />
-            ) : (
-              <>
-                <img
-                  src="/icons/UI Image/tick.png"
-                  alt="Tick Icon"
-                  className="!h-4 sm:h-7 w-auto"
-                />
-                X√°c nh·∫≠n
-              </>
-            )}
-          </button>
-        </div>
-      </div>
-    </div>
-  );
-}
+// ‚úÖ B·∫£n chu·∫©n c·ªßa VerifyRoom.jsx (kh√¥ng ƒë·ªïi UI, ch·ªâ ƒë·ªïi logic)
+import React, { useState, useEffect } from "react";
+import { useNavigate, useLocation } from "react-router-dom";
+import axiosClient from "../api/axiosClient";
+import LoadingSpinner from "../components/LoadingSpinner";
+
+export default function VerifyRoom() {
+  const navigate = useNavigate();
+  const location = useLocation();
+  const [roomCode, setRoomCode] = useState("");
+  const [error, setError] = useState("");
+  const [success, setSuccess] = useState("");
+  const [loading, setLoading] = useState(false);
+  const role = localStorage.getItem("selectedRole");
+
+  useEffect(() => {
+    const fromRoleSelection = location.state?.fromRoleSelection;
+
+    if (!fromRoleSelection) {
+      const token = localStorage.getItem("token");
+      const userRole = localStorage.getItem("role");
+      if (token && userRole) {
+        navigate(
+          `/${userRole === "student" ? "student" : "instructor"}-dashboard`
+        );
+        return;
+      }
+    }
+
+    if (!role || role !== "student") {
+      navigate("/");
+    }
+  }, [role, navigate, location.state]);
+
+  const handleVerify = async () => {
+    if (!roomCode.trim()) {
+      setError("Vui l√≤ng nh·∫≠p m√£ ph√≤ng");
+      setSuccess("");
+      return;
+    }
+
+    setLoading(true);
+    setError("");
+    setSuccess("");
+    try {
+      // ∆Øu ti√™n g·ªçi endpoint m·ªõi ƒë·ªÉ l·∫•y room_token
+      const resNew = await axiosClient.post('/exams/verify-room', { room_code: roomCode.trim() });
+      console.log('[DEV] Verify room (new) response:', resNew.data);
+      const { exam_id, duration_minutes, room_token, require_face_check, require_student_card, monitor_screen, time_open, time_close } = resNew.data || {};
+      if (room_token && exam_id) {
+        // L∆∞u token ph√≤ng ·ªü sessionStorage (ng·∫Øn h·∫°n)
+        sessionStorage.setItem('room_token', room_token);
+        sessionStorage.setItem('pending_exam_id', String(exam_id));
+        if (duration_minutes) sessionStorage.setItem('pending_exam_duration', String(duration_minutes));
+        try {
+          sessionStorage.setItem('exam_flags', JSON.stringify({ face: !!require_face_check, card: !!require_student_card, monitor: !!monitor_screen }));
+        } catch(e) {}
+        if (time_open) sessionStorage.setItem('exam_time_open', String(time_open));
+        if (time_close) sessionStorage.setItem('exam_time_close', String(time_close));
+        // L∆∞u code c≈© ƒë·ªÉ t∆∞∆°ng th√≠ch c√°c flow t·ªìn t·∫°i
+        localStorage.setItem('verifiedRoomId', roomCode.trim());
+        localStorage.setItem('verifiedRoomCode', roomCode.trim());
+
+        setSuccess('‚úÖ M√£ ph√≤ng thi h·ª£p l·ªá! ƒêang chuy·ªÉn h∆∞·ªõng...');
+        setTimeout(() => {
+          navigate('/login', { state: { role, fromVerifyRoom: true } });
+        }, 800);
+        return;
+      }
+
+      // Fallback sang API c≈© n·∫øu kh√¥ng c√≥ room_token
+      const res = await axiosClient.get(`/auth/verify-room/${roomCode}`);
+      console.log("[DEV] Verify room (legacy) response:", res.data);
+      if (res.data.valid) {
+        setSuccess("‚úÖ M√£ ph√≤ng thi h·ª£p l·ªá! ƒêang chuy·ªÉn h∆∞·ªõng...");
+        localStorage.setItem("verifiedRoomId", res.data.examCode);
+        localStorage.setItem("verifiedRoomCode", res.data.examCode);
+        setTimeout(() => navigate('/login', { state: { role, fromVerifyRoom: true } }), 800);
+      } else {
+        setError(res.data.message || "M√£ ph√≤ng kh√¥ng h·ª£p l·ªá");
+        setSuccess("");
+      }
+    } catch (error) {
+      // N·∫øu 403 do h·∫øt gi·ªù/ch∆∞a m·ªü ‚Üí hi·ªÉn th·ªã v√† kh√¥ng fallback
+      const m = error?.response?.data?.message || error?.message;
+      if (error?.response?.status === 403) {
+        setError(m || 'Kh√¥ng th·ªÉ v√†o ph√≤ng thi (th·ªùi gian)');
+        setSuccess('');
+        return;
+      }
+      console.warn('[VerifyRoom] new verify failed, try legacy route‚Ä¶', error?.response?.data || error?.message || error);
+      try {
+        const res = await axiosClient.get(`/auth/verify-room/${roomCode}`);
+        if (res.data?.valid) {
+          localStorage.setItem("verifiedRoomId", res.data.examCode);
+          localStorage.setItem("verifiedRoomCode", res.data.examCode);
+          setSuccess("‚úÖ M√£ ph√≤ng thi h·ª£p l·ªá! ƒêang chuy·ªÉn h∆∞·ªõng...");
+          setTimeout(() => navigate('/login', { state: { role, fromVerifyRoom: true } }), 800);
+        } else {
+          setError(res.data?.message || "M√£ ph√≤ng kh√¥ng h·ª£p l·ªá");
+        }
+      } catch (e2) {
+        setError(e2?.response?.data?.message || 'C√≥ l·ªói x·∫£y ra, vui l√≤ng th·ª≠ l·∫°i');
+      }
+    }
+    setLoading(false);
+  };
+
+  return (
+    <div className="min-h-screen bg-gray-100 flex flex-col">
+      <header className="mx-auto flex items-center justify-start px-6 py-4 w-full max-w-6xl">
+        <div
+          className="flex items-center gap-3 cursor-pointer"
+          onClick={() => navigate("/")}
+        >
+          <img
+            src="/Logo.png"
+            alt="OEM Logo"
+            className="h-16 sm:h-20 md:h-24 w-auto"
+          />
+        </div>
+      </header>
+
+      <div className="bg-gray-100 mt-8 flex flex-col items-center justify-center">
+        <div className="bg-white w-full max-w-[400px] p-6 rounded-lg shadow-md border border-gray-300">
+          <div className="mb-6 flex items-center justify-center gap-4">
+            <div className="!w-14 !h-14 sm:w-20 sm:h-20 rounded-full bg-[#C0D9EB] flex items-center justify-center shadow-md border border-blue-200">
+              <img
+                src="/icons/UI Image/lock.png"
+                alt="Lock Icon"
+                className="h-8 sm:h-10 w-auto object-contain"
+              />
+            </div>
+            <h2 className="text-lg sm:text-xl md:text-2xl font-semibold text-gray-700">
+              Truy c·∫≠p ph·∫ßn thi
+            </h2>
+          </div>
+
+          <div className="mb-4 p-4 bg-[#C0D9EB] rounded-lg border border-blue-200">
+            <span className="block text-sm font-medium text-gray-600 mb-2">
+              M√£ truy c·∫≠p v√†o ph·∫ßn thi
+            </span>
+            <input
+              id="roomCode"
+              type="text"
+              value={roomCode}
+              onChange={(e) => setRoomCode(e.target.value.toUpperCase())}
+              onKeyDown={(e) => {
+                if (e.key === "Enter") handleVerify();
+              }}
+              maxLength={12}
+              className="w-full p-2 border rounded-md !text-gray-700 focus:outline-none !bg-white focus:!ring-blue-400 border-gray-400"
+              placeholder="Nh·∫≠p m√£ truy c·∫≠p"
+              disabled={loading}
+            />
+          </div>
+
+          {error && (
+            <p className="text-red-500 text-sm text-center mb-4">{error}</p>
+          )}
+
+          {success && (
+            <p className="text-green-600 text-sm text-center mb-4 font-medium">
+              {success}
+            </p>
+          )}
+
+          <button
+            onClick={handleVerify}
+            disabled={loading || !roomCode.trim()}
+            className={`w-full py-2 rounded-md !text-white font-medium flex items-center justify-center gap-2 transition-all ${
+              loading || !roomCode.trim()
+                ? "!bg-blue-300 cursor-not-allowed"
+                : "!bg-blue-500 !hover:bg-blue-600 active:scale-95"
+            }`}
+          >
+            {loading ? (
+              <LoadingSpinner size="sm" text="ƒêang x√°c nh·∫≠n..." />
+            ) : (
+              <>
+                <img
+                  src="/icons/UI Image/tick.png"
+                  alt="Tick Icon"
+                  className="!h-4 sm:h-7 w-auto"
+                />
+                X√°c nh·∫≠n
+              </>
+            )}
+          </button>
+        </div>
+      </div>
+    </div>
+  );
+}
diff --git a/frontend/src/components/Footer.jsx b/frontend/src/components/Footer.jsx
index 1c1193d..a6babca 100644
--- a/frontend/src/components/Footer.jsx
+++ b/frontend/src/components/Footer.jsx
@@ -1,116 +1,116 @@
-import React, { useState } from "react";
-
-export default function Footer() {
-  const [activeContent, setActiveContent] = useState(null);
-
-  const servicePolicy = (
-    <div className="p-4 text-left">
-      <h3 className="font-bold text-lg mb-2">Ch√≠nh s√°ch d·ªãch v·ª•</h3>
-      <ol className="list-decimal ml-6 space-y-1">
-        <li>
-          <strong>M·ª•c ƒë√≠ch d·ªãch v·ª•:</strong> <br></br>
-          OEM Mini cung c·∫•p n·ªÅn t·∫£ng qu·∫£n l√Ω k·ª≥ thi tr·ª±c tuy·∫øn, cho ph√©p gi·∫£ng
-          vi√™n t·∫°o kh√≥a h·ªçc, t·∫£i l√™n ƒë·ªÅ thi, v√† ch·∫•m ƒëi·ªÉm t·ª± ƒë·ªông; h·ªçc sinh c√≥
-          th·ªÉ ƒëƒÉng k√Ω kh√≥a h·ªçc, tham gia k·ª≥ thi v√† tra c·ª©u k·∫øt qu·∫£.
-        </li>
-        <li>
-          <strong>Tr√°ch nhi·ªám c·ªßa ng∆∞·ªùi d√πng:</strong>
-          <br></br>
-          H·ªçc sinh v√† gi·∫£ng vi√™n ph·∫£i s·ª≠ d·ª•ng t√†i kho·∫£n c√° nh√¢n ƒë·ªÉ truy c·∫≠p h·ªá
-          th·ªëng.<br></br>
-          Ng∆∞·ªùi d√πng kh√¥ng ƒë∆∞·ª£c chia s·∫ª th√¥ng tin ƒëƒÉng nh·∫≠p v·ªõi ng∆∞·ªùi kh√°c.
-          <br></br>
-          Gi·∫£ng vi√™n ch·ªãu tr√°ch nhi·ªám ƒë·∫£m b·∫£o ch·∫•t l∆∞·ª£ng n·ªôi dung v√† c√¢u h·ªèi t·∫£i
-          l√™n h·ªá th·ªëng.<br></br>
-        </li>
-        <li>
-          <strong>Gi·ªõi h·∫°n d·ªãch v·ª•:</strong>
-          <br></br>
-          M·ªói k·ª≥ thi h·ªó tr·ª£ t·ªëi ƒëa 50 c√¢u h·ªèi tr·∫Øc nghi·ªám.<br></br>
-          D·ªãch v·ª• ch·∫•m t·ª± lu·∫≠ns·ª≠ d·ª•ng g·ª£i √Ω t·ª´ AI, nh∆∞ng ƒëi·ªÉm ch√≠nh th·ª©c ph·∫£i
-          ƒë∆∞·ª£c gi·∫£ng vi√™n x√°c nh·∫≠n. <br></br>
-          H·ªá th·ªëng kh√¥ng bao g·ªìm h·ªôi th·∫£o tr·ª±c tuy·∫øn, video b√†i gi·∫£ng hay c√°c
-          t√≠nh nƒÉng AI n√¢ng cao ngo√†i ch·∫•m ƒëi·ªÉm t·ª± lu·∫≠n.<br></br>
-        </li>
-        <li>
-          <strong>H·ªó tr·ª£ & b·∫£o tr√¨:</strong>
-          <br></br>
-          Qu·∫£n tr·ªã vi√™n th·ª±c hi·ªán sao l∆∞u d·ªØ li·ªáu ƒë·ªãnh k·ª≥ v√† gi√°m s√°t ho·∫°t ƒë·ªông
-          h·ªá th·ªëng.<br></br>
-          Ng∆∞·ªùi d√πng c√≥ th·ªÉ li√™n h·ªá ƒë·ªôi ng≈© h·ªó tr·ª£ ƒë·ªÉ b√°o c√°o s·ª± c·ªë, l·ªói truy
-          c·∫≠p ho·∫∑c c√°c v·∫•n ƒë·ªÅ li√™n quan ƒë·∫øn k·ª≥ thi.<br></br>
-        </li>
-      </ol>
-    </div>
-  );
-
-  const infoTerms = (
-    <div className="p-4 text-left">
-      <h3 className="font-bold text-lg mb-2">ƒêi·ªÅu kho·∫£n th√¥ng tin</h3>
-      <ol className="list-decimal ml-6 space-y-1">
-        <li>
-          <strong>Thu th·∫≠p d·ªØ li·ªáu:</strong> <br></br>H·ªá th·ªëng l∆∞u tr·ªØ th√¥ng tin
-          c√° nh√¢n c·ªßa ng∆∞·ªùi d√πng, bao g·ªìm t√™n, email, vai tr√≤
-          (Student/Instructor/Admin), m√£ ph√≤ng thi (n·∫øu l√† h·ªçc sinh) v√† k·∫øt qu·∫£
-          thi. <br></br>D·ªØ li·ªáu c√¢u h·ªèi, ƒë√°p √°n v√† ƒëi·ªÉm s·ªë c≈©ng ƒë∆∞·ª£c l∆∞u trong
-          c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ ph·ª•c v·ª• qu·∫£n l√Ω v√† ƒë√°nh gi√°.
-        </li>
-        <li>
-          <strong>B·∫£o m·∫≠t th√¥ng tin:</strong> <br></br>M·∫≠t kh·∫©u ƒë∆∞·ª£c m√£ h√≥a b·∫±ng
-          bcrypt; x√°c th·ª±c v√† ph√¢n quy·ªÅn d·ª±a tr√™n JWT.<br></br>T·∫•t c·∫£ c√°c truy
-          v·∫•n v√† ƒë·∫ßu v√†o ƒë·ªÅu ƒë∆∞·ª£c ki·ªÉm tra ƒë·ªÉ ph√≤ng ch·ªëng SQL Injection, XSS v√†
-          c√°c h√†nh vi tr√°i ph√©p.
-        </li>
-        <li>
-          <strong>Quy·ªÅn truy c·∫≠p d·ªØ li·ªáu:</strong> <br></br>H·ªçc sinh ch·ªâ xem
-          ƒë∆∞·ª£c k·∫øt qu·∫£ v√† ƒë·ªÅ thi c·ªßa b·∫£n th√¢n. <br></br>Gi·∫£ng vi√™n xem ƒë∆∞·ª£c k·∫øt
-          qu·∫£ c·ªßa h·ªçc sinh trong kh√≥a h·ªçc m√¨nh qu·∫£n l√Ω. <br></br>Qu·∫£n tr·ªã vi√™n
-          c√≥ quy·ªÅn qu·∫£n l√Ω to√†n b·ªô h·ªá th·ªëng nh∆∞ng v·∫´n tu√¢n th·ªß c√°c nguy√™n t·∫Øc
-          b·∫£o m·∫≠t d·ªØ li·ªáu.
-        </li>
-        <li>
-          <strong>Chia s·∫ª th√¥ng tin:</strong> <br></br>D·ªØ li·ªáu ng∆∞·ªùi d√πng v√† k·∫øt
-          qu·∫£ thi kh√¥ng ƒë∆∞·ª£c chia s·∫ª cho b√™n th·ª© ba m√† kh√¥ng c√≥ s·ª± ƒë·ªìng √Ω.{" "}
-          <br></br>T·∫•t c·∫£ th√¥ng tin ph·ª•c v·ª• m·ª•c ƒë√≠ch gi√°o d·ª•c v√† qu·∫£n l√Ω n·ªôi b·ªô
-          c·ªßa t·ªï ch·ª©c.
-        </li>
-      </ol>
-    </div>
-  );
-
-  return (
-    <footer className="w-full py-6 px-4 text-gray-600 text-sm text-center">
-      <div className="flex flex-wrap items-center justify-center gap-3">
-        <button
-          className="font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors"
-          onClick={() => setActiveContent("policy")}
-        >
-          Ch√≠nh s√°ch d·ªãch v·ª•
-        </button>
-        <span>|</span>
-        <button
-          className="font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors"
-          onClick={() => setActiveContent("info")}
-        >
-          ƒêi·ªÅu kho·∫£n th√¥ng tin
-        </button>
-      </div>
-
-      {/* Modal */}
-      {activeContent && (
-        <div className="fixed inset-0 z-50 flex items-center justify-center">
-          <div className="bg-white/90 backdrop-blur-sm rounded-lg shadow-lg max-w-2xl w-11/12 p-6 relative border border-white/20">
-            <button
-              className="absolute top-2 right-2 text-gray-700 hover:text-gray-900 font-bold text-xl"
-              onClick={() => setActiveContent(null)}
-            >
-              &times;
-            </button>
-            {activeContent === "policy" && servicePolicy}
-            {activeContent === "info" && infoTerms}
-          </div>
-        </div>
-      )}
-    </footer>
-  );
-}
+import React, { useState } from "react";
+
+export default function Footer() {
+  const [activeContent, setActiveContent] = useState(null);
+
+  const servicePolicy = (
+    <div className="p-4 text-left">
+      <h3 className="font-bold text-lg mb-2">Ch√≠nh s√°ch d·ªãch v·ª•</h3>
+      <ol className="list-decimal ml-6 space-y-1">
+        <li>
+          <strong>M·ª•c ƒë√≠ch d·ªãch v·ª•:</strong> <br></br>
+          OEM Mini cung c·∫•p n·ªÅn t·∫£ng qu·∫£n l√Ω k·ª≥ thi tr·ª±c tuy·∫øn, cho ph√©p gi·∫£ng
+          vi√™n t·∫°o kh√≥a h·ªçc, t·∫£i l√™n ƒë·ªÅ thi, v√† ch·∫•m ƒëi·ªÉm t·ª± ƒë·ªông; h·ªçc sinh c√≥
+          th·ªÉ ƒëƒÉng k√Ω kh√≥a h·ªçc, tham gia k·ª≥ thi v√† tra c·ª©u k·∫øt qu·∫£.
+        </li>
+        <li>
+          <strong>Tr√°ch nhi·ªám c·ªßa ng∆∞·ªùi d√πng:</strong>
+          <br></br>
+          H·ªçc sinh v√† gi·∫£ng vi√™n ph·∫£i s·ª≠ d·ª•ng t√†i kho·∫£n c√° nh√¢n ƒë·ªÉ truy c·∫≠p h·ªá
+          th·ªëng.<br></br>
+          Ng∆∞·ªùi d√πng kh√¥ng ƒë∆∞·ª£c chia s·∫ª th√¥ng tin ƒëƒÉng nh·∫≠p v·ªõi ng∆∞·ªùi kh√°c.
+          <br></br>
+          Gi·∫£ng vi√™n ch·ªãu tr√°ch nhi·ªám ƒë·∫£m b·∫£o ch·∫•t l∆∞·ª£ng n·ªôi dung v√† c√¢u h·ªèi t·∫£i
+          l√™n h·ªá th·ªëng.<br></br>
+        </li>
+        <li>
+          <strong>Gi·ªõi h·∫°n d·ªãch v·ª•:</strong>
+          <br></br>
+          M·ªói k·ª≥ thi h·ªó tr·ª£ t·ªëi ƒëa 50 c√¢u h·ªèi tr·∫Øc nghi·ªám.<br></br>
+          D·ªãch v·ª• ch·∫•m t·ª± lu·∫≠ns·ª≠ d·ª•ng g·ª£i √Ω t·ª´ AI, nh∆∞ng ƒëi·ªÉm ch√≠nh th·ª©c ph·∫£i
+          ƒë∆∞·ª£c gi·∫£ng vi√™n x√°c nh·∫≠n. <br></br>
+          H·ªá th·ªëng kh√¥ng bao g·ªìm h·ªôi th·∫£o tr·ª±c tuy·∫øn, video b√†i gi·∫£ng hay c√°c
+          t√≠nh nƒÉng AI n√¢ng cao ngo√†i ch·∫•m ƒëi·ªÉm t·ª± lu·∫≠n.<br></br>
+        </li>
+        <li>
+          <strong>H·ªó tr·ª£ & b·∫£o tr√¨:</strong>
+          <br></br>
+          Qu·∫£n tr·ªã vi√™n th·ª±c hi·ªán sao l∆∞u d·ªØ li·ªáu ƒë·ªãnh k·ª≥ v√† gi√°m s√°t ho·∫°t ƒë·ªông
+          h·ªá th·ªëng.<br></br>
+          Ng∆∞·ªùi d√πng c√≥ th·ªÉ li√™n h·ªá ƒë·ªôi ng≈© h·ªó tr·ª£ ƒë·ªÉ b√°o c√°o s·ª± c·ªë, l·ªói truy
+          c·∫≠p ho·∫∑c c√°c v·∫•n ƒë·ªÅ li√™n quan ƒë·∫øn k·ª≥ thi.<br></br>
+        </li>
+      </ol>
+    </div>
+  );
+
+  const infoTerms = (
+    <div className="p-4 text-left">
+      <h3 className="font-bold text-lg mb-2">ƒêi·ªÅu kho·∫£n th√¥ng tin</h3>
+      <ol className="list-decimal ml-6 space-y-1">
+        <li>
+          <strong>Thu th·∫≠p d·ªØ li·ªáu:</strong> <br></br>H·ªá th·ªëng l∆∞u tr·ªØ th√¥ng tin
+          c√° nh√¢n c·ªßa ng∆∞·ªùi d√πng, bao g·ªìm t√™n, email, vai tr√≤
+          (Student/Instructor/Admin), m√£ ph√≤ng thi (n·∫øu l√† h·ªçc sinh) v√† k·∫øt qu·∫£
+          thi. <br></br>D·ªØ li·ªáu c√¢u h·ªèi, ƒë√°p √°n v√† ƒëi·ªÉm s·ªë c≈©ng ƒë∆∞·ª£c l∆∞u trong
+          c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ ph·ª•c v·ª• qu·∫£n l√Ω v√† ƒë√°nh gi√°.
+        </li>
+        <li>
+          <strong>B·∫£o m·∫≠t th√¥ng tin:</strong> <br></br>M·∫≠t kh·∫©u ƒë∆∞·ª£c m√£ h√≥a b·∫±ng
+          bcrypt; x√°c th·ª±c v√† ph√¢n quy·ªÅn d·ª±a tr√™n JWT.<br></br>T·∫•t c·∫£ c√°c truy
+          v·∫•n v√† ƒë·∫ßu v√†o ƒë·ªÅu ƒë∆∞·ª£c ki·ªÉm tra ƒë·ªÉ ph√≤ng ch·ªëng SQL Injection, XSS v√†
+          c√°c h√†nh vi tr√°i ph√©p.
+        </li>
+        <li>
+          <strong>Quy·ªÅn truy c·∫≠p d·ªØ li·ªáu:</strong> <br></br>H·ªçc sinh ch·ªâ xem
+          ƒë∆∞·ª£c k·∫øt qu·∫£ v√† ƒë·ªÅ thi c·ªßa b·∫£n th√¢n. <br></br>Gi·∫£ng vi√™n xem ƒë∆∞·ª£c k·∫øt
+          qu·∫£ c·ªßa h·ªçc sinh trong kh√≥a h·ªçc m√¨nh qu·∫£n l√Ω. <br></br>Qu·∫£n tr·ªã vi√™n
+          c√≥ quy·ªÅn qu·∫£n l√Ω to√†n b·ªô h·ªá th·ªëng nh∆∞ng v·∫´n tu√¢n th·ªß c√°c nguy√™n t·∫Øc
+          b·∫£o m·∫≠t d·ªØ li·ªáu.
+        </li>
+        <li>
+          <strong>Chia s·∫ª th√¥ng tin:</strong> <br></br>D·ªØ li·ªáu ng∆∞·ªùi d√πng v√† k·∫øt
+          qu·∫£ thi kh√¥ng ƒë∆∞·ª£c chia s·∫ª cho b√™n th·ª© ba m√† kh√¥ng c√≥ s·ª± ƒë·ªìng √Ω.{" "}
+          <br></br>T·∫•t c·∫£ th√¥ng tin ph·ª•c v·ª• m·ª•c ƒë√≠ch gi√°o d·ª•c v√† qu·∫£n l√Ω n·ªôi b·ªô
+          c·ªßa t·ªï ch·ª©c.
+        </li>
+      </ol>
+    </div>
+  );
+
+  return (
+    <footer className="w-full py-6 px-4 text-gray-600 text-sm text-center">
+      <div className="flex flex-wrap items-center justify-center gap-3">
+        <button
+          className="font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors"
+          onClick={() => setActiveContent("policy")}
+        >
+          Ch√≠nh s√°ch d·ªãch v·ª•
+        </button>
+        <span>|</span>
+        <button
+          className="font-medium text-blue-600 hover:text-blue-800 hover:underline transition-colors"
+          onClick={() => setActiveContent("info")}
+        >
+          ƒêi·ªÅu kho·∫£n th√¥ng tin
+        </button>
+      </div>
+
+      {/* Modal */}
+      {activeContent && (
+        <div className="fixed inset-0 z-50 flex items-center justify-center">
+          <div className="bg-white/90 backdrop-blur-sm rounded-lg shadow-lg max-w-2xl w-11/12 p-6 relative border border-white/20">
+            <button
+              className="absolute top-2 right-2 text-gray-700 hover:text-gray-900 font-bold text-xl"
+              onClick={() => setActiveContent(null)}
+            >
+              &times;
+            </button>
+            {activeContent === "policy" && servicePolicy}
+            {activeContent === "info" && infoTerms}
+          </div>
+        </div>
+      )}
+    </footer>
+  );
+}
diff --git a/frontend/src/components/Layout.jsx b/frontend/src/components/Layout.jsx
index 6928b93..eb33063 100644
--- a/frontend/src/components/Layout.jsx
+++ b/frontend/src/components/Layout.jsx
@@ -1,18 +1,18 @@
-// src/components/Layout.jsx
-import React from "react";
-import Navbar from "./Navbar.jsx";
-import Footer from "./Footer.jsx";
-import { Outlet } from "react-router-dom";
-
-const Layout = ({ children }) => {
-  return (
-    <div className="flex flex-col min-h-screen bg-gradient-to-r from-[#e7f7ff] to-[#fff0fb] shadow-lg font-sans">
-      <Navbar />
-      <Outlet />
-      <main className="flex-1 p-4">{children}</main>
-      <Footer />
-    </div>
-  );
-};
-
-export default Layout;
+// src/components/Layout.jsx
+import React from "react";
+import Navbar from "./Navbar.jsx";
+import Footer from "./Footer.jsx";
+import { Outlet } from "react-router-dom";
+
+const Layout = ({ children }) => {
+  return (
+    <div className="flex flex-col min-h-screen bg-gradient-to-r from-[#e7f7ff] to-[#fff0fb] shadow-lg font-sans">
+      <Navbar />
+      <Outlet />
+      <main className="flex-1 p-4">{children}</main>
+      <Footer />
+    </div>
+  );
+};
+
+export default Layout;
diff --git a/frontend/src/components/LoadingSpinner.jsx b/frontend/src/components/LoadingSpinner.jsx
index 6ac09d5..ed44425 100644
--- a/frontend/src/components/LoadingSpinner.jsx
+++ b/frontend/src/components/LoadingSpinner.jsx
@@ -1,29 +1,29 @@
-import React from "react";
-
-const LoadingSpinner = ({ size = "md", text = "ƒêang x·ª≠ l√Ω..." }) => {
-  const getSizeClasses = () => {
-    switch (size) {
-      case "sm":
-        return "w-4 h-4";
-      case "md":
-        return "w-6 h-6";
-      case "lg":
-        return "w-8 h-8";
-      case "xl":
-        return "w-12 h-12";
-      default:
-        return "w-6 h-6";
-    }
-  };
-
-  return (
-    <div className="flex items-center justify-center gap-3">
-      <div
-        className={`${getSizeClasses()} border-2 border-white border-t-transparent rounded-full animate-spin`}
-      ></div>
-      {text && <span className="text-sm font-medium">{text}</span>}
-    </div>
-  );
-};
-
-export default LoadingSpinner;
+import React from "react";
+
+const LoadingSpinner = ({ size = "md", text = "ƒêang x·ª≠ l√Ω..." }) => {
+  const getSizeClasses = () => {
+    switch (size) {
+      case "sm":
+        return "w-4 h-4";
+      case "md":
+        return "w-6 h-6";
+      case "lg":
+        return "w-8 h-8";
+      case "xl":
+        return "w-12 h-12";
+      default:
+        return "w-6 h-6";
+    }
+  };
+
+  return (
+    <div className="flex items-center justify-center gap-3">
+      <div
+        className={`${getSizeClasses()} border-2 border-white border-t-transparent rounded-full animate-spin`}
+      ></div>
+      {text && <span className="text-sm font-medium">{text}</span>}
+    </div>
+  );
+};
+
+export default LoadingSpinner;
diff --git a/frontend/src/components/Navbar.jsx b/frontend/src/components/Navbar.jsx
index d8e9f75..f6e387d 100644
--- a/frontend/src/components/Navbar.jsx
+++ b/frontend/src/components/Navbar.jsx
@@ -1,55 +1,55 @@
-import React from "react";
-import { useNavigate } from "react-router-dom";
-
-const Navbar = () => {
-  const navigate = useNavigate();
-
-  const menuItems = [
-    { text: "V·ªÅ ch√∫ng t√¥i", path: "/ve-chung-toi" },
-    { text: "T√≠nh nƒÉng", path: "/tinh-nang" },
-    { text: "Tin t·ª©c", path: "/tin-tuc" },
-    { text: "Li√™n h·ªá", path: "/lien-he" },
-  ];
-
-  return (
-    <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 md:px-4 md:py-3 gap-2 md:gap-3">
-      <div
-        className="flex items-center gap-3 cursor-pointer"
-        onClick={() => navigate("/")}
-      >
-        <img
-          src="/Logo.png"
-          alt="OEM Logo"
-          className="h-16 sm:h-20 md:h-24 w-auto"
-        />
-      </div>
-      <nav className="flex gap-5 sm:gap-8 md:gap-12 flex-1 justify-center items-center text-[#023e8a] font-extrabold">
-        {menuItems.map(({ text, path }, idx) => (
-          <span
-            key={idx}
-            onClick={() => navigate(path)}
-            className="text-sm sm:text-base md:text-lg xl:text-xl pb-1 border-b-0 hover:border-b-4 hover:border-blue-500 hover:text-[#007bf6] transition-all cursor-pointer"
-          >
-            {text}
-          </span>
-        ))}
-      </nav>
-      <div className="flex gap-2 sm:gap-3 items-center mt-2 md:mt-0 text-sm sm:text-base md:text-lg font-bold">
-        <button
-          onClick={() => navigate("/role", { state: { mode: "register" } })}
-          className="bg-[#0077b6] cursor-pointer text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 ease-in-out active:scale-95"
-        >
-          ƒêƒÉng K√Ω Ngay
-        </button>
-        <button
-          onClick={() => navigate("/role", { state: { mode: "login" } })}
-          className="border cursor-pointer border-[#0077b6] !bg-transparent text-[#0077b6] px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 ease-in-out hover:bg-[#0077b6]/10 active:scale-95"
-        >
-          ƒêƒÉng Nh·∫≠p
-        </button>
-      </div>
-    </header>
-  );
-};
-
-export default Navbar;
+import React from "react";
+import { useNavigate } from "react-router-dom";
+
+const Navbar = () => {
+  const navigate = useNavigate();
+
+  const menuItems = [
+    { text: "V·ªÅ ch√∫ng t√¥i", path: "/ve-chung-toi" },
+    { text: "T√≠nh nƒÉng", path: "/tinh-nang" },
+    { text: "Tin t·ª©c", path: "/tin-tuc" },
+    { text: "Li√™n h·ªá", path: "/lien-he" },
+  ];
+
+  return (
+    <header className="flex flex-col md:flex-row items-center justify-between mx-auto w-full max-w-7xl px-3 py-2 md:px-4 md:py-3 gap-2 md:gap-3">
+      <div
+        className="flex items-center gap-3 cursor-pointer"
+        onClick={() => navigate("/")}
+      >
+        <img
+          src="/Logo.png"
+          alt="OEM Logo"
+          className="h-16 sm:h-20 md:h-24 w-auto"
+        />
+      </div>
+      <nav className="flex gap-5 sm:gap-8 md:gap-12 flex-1 justify-center items-center text-[#023e8a] font-extrabold">
+        {menuItems.map(({ text, path }, idx) => (
+          <span
+            key={idx}
+            onClick={() => navigate(path)}
+            className="text-sm sm:text-base md:text-lg xl:text-xl pb-1 border-b-0 hover:border-b-4 hover:border-blue-500 hover:text-[#007bf6] transition-all cursor-pointer"
+          >
+            {text}
+          </span>
+        ))}
+      </nav>
+      <div className="flex gap-2 sm:gap-3 items-center mt-2 md:mt-0 text-sm sm:text-base md:text-lg font-bold">
+        <button
+          onClick={() => navigate("/role", { state: { mode: "register" } })}
+          className="bg-[#0077b6] cursor-pointer text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 ease-in-out active:scale-95"
+        >
+          ƒêƒÉng K√Ω Ngay
+        </button>
+        <button
+          onClick={() => navigate("/role", { state: { mode: "login" } })}
+          className="border cursor-pointer border-[#0077b6] !bg-transparent text-[#0077b6] px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 ease-in-out hover:bg-[#0077b6]/10 active:scale-95"
+        >
+          ƒêƒÉng Nh·∫≠p
+        </button>
+      </div>
+    </header>
+  );
+};
+
+export default Navbar;
diff --git a/frontend/src/components/instructor/InstructorSidebar.jsx b/frontend/src/components/instructor/InstructorSidebar.jsx
index d033441..b1c74de 100644
--- a/frontend/src/components/instructor/InstructorSidebar.jsx
+++ b/frontend/src/components/instructor/InstructorSidebar.jsx
@@ -1,158 +1,158 @@
-import React, { useState, useRef } from "react";
-import { useNavigate, useLocation } from "react-router-dom";
-import {
-  FiHome,
-  FiFolder,
-  FiFileText,
-  FiEdit3,
-  FiClipboard,
-  FiSettings,
-  FiChevronDown,
-} from "react-icons/fi";
-import { useUi } from "../../context/UiContext.jsx";
-
-const InstructorSidebar = () => {
-  const navigate = useNavigate();
-  const location = useLocation();
-  const [openDropdown, setOpenDropdown] = useState(false);
-
-  const { t } = useUi();
-  const menu = [
-    { icon: FiHome, label: t('dashboard','B·∫£ng ƒëi·ªÅu khi·ªÉn','Dashboard'), path: "/instructor-dashboard" },
-    { icon: FiFolder, label: t('resources','T√†i nguy√™n','Resources'), path: "/resources", hasDropdown: true },
-    { icon: FiFileText, label: t('exam_bank','Ng√¢n h√†ng ƒë·ªÅ','Exam Bank'), path: "/exam-bank" },
-    { icon: FiEdit3, label: t('assign_exam','Assign Exam','Assign Exam'), path: "/assign-exam" },
-    { icon: FiClipboard, label: t('result','K·∫øt qu·∫£','Result'), path: "/result" },
-  ];
-
-  const setting = { icon: FiSettings, label: t('setting','C√†i ƒë·∫∑t','Setting'), path: "/setting" };
-
-  const dropdownRef = useRef(null);
-  const resourcesRef = useRef(null);
-
-  const handleMouseEnter = (item) => {
-    if (item.hasDropdown) setOpenDropdown(true);
-  };
-
-  const handleMouseLeave = (e, item) => {
-    if (item.hasDropdown) {
-      const related = e.relatedTarget;
-      if (
-        dropdownRef.current &&
-        !dropdownRef.current.contains(related) &&
-        resourcesRef.current &&
-        !resourcesRef.current.contains(related)
-      ) {
-        setOpenDropdown(false);
-      }
-    }
-  };
-
-  return (
-    <aside className="w-64 h-screen bg-gradient-to-b from-[#E8F5FF] to-[#CAEAFF] rounded-tr-3xl rounded-br-3xl p-5 shadow-md flex flex-col justify-between relative text-slate-800">
-      <div>
-        <div
-          className="flex items-center justify-center mb-8 cursor-pointer"
-          onClick={() => navigate("/")}
-        >
-          <img
-            src="/Logo.png"
-            alt="OEM Logo"
-            className="h-20 w-auto drop-shadow-md"
-          />
-        </div>
-
-        <nav className="flex flex-col gap-2 relative">
-          {menu.map((item, idx) => {
-            const isActive = location.pathname === item.path;
-            const Icon = item.icon;
-
-            return (
-              <div key={idx} className="relative">
-                <button
-                  ref={item.hasDropdown ? resourcesRef : null}
-                  onClick={() => {
-                    if (item.hasDropdown) {
-                      setOpenDropdown((prev) => !prev);
-                    } else {
-                      navigate(item.path);
-                    }
-                  }}
-                  onMouseEnter={() => handleMouseEnter(item)}
-                  onMouseLeave={(e) => handleMouseLeave(e, item)}
-                  className={`group flex items-center justify-between text-lg font-medium px-4 py-3 rounded-xl transition-all duration-200 w-full ${
-                    isActive
-                      ? "bg-[#0080FF]/10 border-l-4 border-[#0080FF] text-[#0080FF] shadow-sm"
-                      : "text-gray-700 hover:bg-[#A0D4FF]/60 hover:text-[#0080FF]"
-                  }`}
-                >
-                  <div className="flex items-center gap-4">
-                    <Icon
-                      className={`w-6 h-6 transition-colors duration-200 ${
-                        isActive
-                          ? "text-[#0080FF]"
-                          : "text-gray-600 group-hover:text-[#0080FF]"
-                      }`}
-                    />
-                    <span>{item.label}</span>
-                  </div>
-
-                  {/* Chevron (kh√¥ng xoay) */}
-                  {item.hasDropdown && (
-                    <FiChevronDown className="w-5 h-5 text-gray-600 group-hover:text-[#0080FF]" />
-                  )}
-                </button>
-
-                {item.hasDropdown && openDropdown && (
-                  <div
-                    ref={dropdownRef}
-                    onMouseLeave={(e) => handleMouseLeave(e, item)}
-                    onMouseEnter={() => setOpenDropdown(true)}
-                    className="absolute left-full top-0 ml-[1px] bg-white shadow-lg rounded-xl border border-gray-200 py-2 w-44 z-20"
-                  >
-                    <button
-                      onClick={() => navigate("/exam-bank")}
-                      className="flex items-center gap-3 px-4 py-2 hover:bg-[#E8F5FF] text-gray-700 hover:text-[#0080FF] w-full text-left"
-                    >
-                      <FiFileText className="w-5 h-5" />
-                      {t('exam_bank','Ng√¢n h√†ng ƒë·ªÅ','Exam Bank')}
-                    </button>
-                    <button
-                      onClick={() => navigate("/open-exam")}
-                      className="flex items-center gap-3 px-4 py-2 hover:bg-[#E8F5FF] text-gray-700 hover:text-[#0080FF] w-full text-left"
-                    >
-                      <FiEdit3 className="w-5 h-5" />
-                      {t('open_room','M·ªü ph√≤ng thi','Open Room')}
-                    </button>
-                  </div>
-                )}
-              </div>
-            );
-          })}
-        </nav>
-      </div>
-
-      <div className="border-t border-blue-100 pt-3 mt-3">
-        <button
-          onClick={() => navigate(setting.path)}
-          className={`group flex items-center gap-3 text-lg font-medium px-4 py-3 rounded-xl transition-all duration-200 w-full ${
-            location.pathname === setting.path
-              ? "bg-[#0080FF]/10 border-l-4 border-[#0080FF] text-[#0080FF] shadow-sm"
-              : "text-gray-700 hover:bg-[#A0D4FF]/60 hover:text-[#0080FF]"
-          }`}
-        >
-          <setting.icon
-            className={`w-6 h-6 transition-colors duration-200 ${
-              location.pathname === setting.path
-                ? "text-[#0080FF]"
-                : "text-gray-600 group-hover:text-[#0080FF]"
-            }`}
-          />
-          <span>{setting.label}</span>
-        </button>
-      </div>
-    </aside>
-  );
-};
-
-export default InstructorSidebar;
+import React, { useState, useRef } from "react";
+import { useNavigate, useLocation } from "react-router-dom";
+import {
+  FiHome,
+  FiFolder,
+  FiFileText,
+  FiEdit3,
+  FiClipboard,
+  FiSettings,
+  FiChevronDown,
+} from "react-icons/fi";
+import { useUi } from "../../context/UiContext.jsx";
+
+const InstructorSidebar = () => {
+  const navigate = useNavigate();
+  const location = useLocation();
+  const [openDropdown, setOpenDropdown] = useState(false);
+
+  const { t } = useUi();
+  const menu = [
+    { icon: FiHome, label: t('dashboard','B·∫£ng ƒëi·ªÅu khi·ªÉn','Dashboard'), path: "/instructor-dashboard" },
+    { icon: FiFolder, label: t('resources','T√†i nguy√™n','Resources'), path: "/resources", hasDropdown: true },
+    { icon: FiFileText, label: t('exam_bank','Ng√¢n h√†ng ƒë·ªÅ','Exam Bank'), path: "/exam-bank" },
+    { icon: FiEdit3, label: t('assign_exam','Assign Exam','Assign Exam'), path: "/assign-exam" },
+    { icon: FiClipboard, label: t('result','K·∫øt qu·∫£','Result'), path: "/result" },
+  ];
+
+  const setting = { icon: FiSettings, label: t('setting','C√†i ƒë·∫∑t','Setting'), path: "/setting" };
+
+  const dropdownRef = useRef(null);
+  const resourcesRef = useRef(null);
+
+  const handleMouseEnter = (item) => {
+    if (item.hasDropdown) setOpenDropdown(true);
+  };
+
+  const handleMouseLeave = (e, item) => {
+    if (item.hasDropdown) {
+      const related = e.relatedTarget;
+      if (
+        dropdownRef.current &&
+        !dropdownRef.current.contains(related) &&
+        resourcesRef.current &&
+        !resourcesRef.current.contains(related)
+      ) {
+        setOpenDropdown(false);
+      }
+    }
+  };
+
+  return (
+    <aside className="w-64 h-screen bg-gradient-to-b from-[#E8F5FF] to-[#CAEAFF] rounded-tr-3xl rounded-br-3xl p-5 shadow-md flex flex-col justify-between relative text-slate-800">
+      <div>
+        <div
+          className="flex items-center justify-center mb-8 cursor-pointer"
+          onClick={() => navigate("/")}
+        >
+          <img
+            src="/Logo.png"
+            alt="OEM Logo"
+            className="h-20 w-auto drop-shadow-md"
+          />
+        </div>
+
+        <nav className="flex flex-col gap-2 relative">
+          {menu.map((item, idx) => {
+            const isActive = location.pathname === item.path;
+            const Icon = item.icon;
+
+            return (
+              <div key={idx} className="relative">
+                <button
+                  ref={item.hasDropdown ? resourcesRef : null}
+                  onClick={() => {
+                    if (item.hasDropdown) {
+                      setOpenDropdown((prev) => !prev);
+                    } else {
+                      navigate(item.path);
+                    }
+                  }}
+                  onMouseEnter={() => handleMouseEnter(item)}
+                  onMouseLeave={(e) => handleMouseLeave(e, item)}
+                  className={`group flex items-center justify-between text-lg font-medium px-4 py-3 rounded-xl transition-all duration-200 w-full ${
+                    isActive
+                      ? "bg-[#0080FF]/10 border-l-4 border-[#0080FF] text-[#0080FF] shadow-sm"
+                      : "text-gray-700 hover:bg-[#A0D4FF]/60 hover:text-[#0080FF]"
+                  }`}
+                >
+                  <div className="flex items-center gap-4">
+                    <Icon
+                      className={`w-6 h-6 transition-colors duration-200 ${
+                        isActive
+                          ? "text-[#0080FF]"
+                          : "text-gray-600 group-hover:text-[#0080FF]"
+                      }`}
+                    />
+                    <span>{item.label}</span>
+                  </div>
+
+                  {/* Chevron (kh√¥ng xoay) */}
+                  {item.hasDropdown && (
+                    <FiChevronDown className="w-5 h-5 text-gray-600 group-hover:text-[#0080FF]" />
+                  )}
+                </button>
+
+                {item.hasDropdown && openDropdown && (
+                  <div
+                    ref={dropdownRef}
+                    onMouseLeave={(e) => handleMouseLeave(e, item)}
+                    onMouseEnter={() => setOpenDropdown(true)}
+                    className="absolute left-full top-0 ml-[1px] bg-white shadow-lg rounded-xl border border-gray-200 py-2 w-44 z-20"
+                  >
+                    <button
+                      onClick={() => navigate("/exam-bank")}
+                      className="flex items-center gap-3 px-4 py-2 hover:bg-[#E8F5FF] text-gray-700 hover:text-[#0080FF] w-full text-left"
+                    >
+                      <FiFileText className="w-5 h-5" />
+                      {t('exam_bank','Ng√¢n h√†ng ƒë·ªÅ','Exam Bank')}
+                    </button>
+                    <button
+                      onClick={() => navigate("/open-exam")}
+                      className="flex items-center gap-3 px-4 py-2 hover:bg-[#E8F5FF] text-gray-700 hover:text-[#0080FF] w-full text-left"
+                    >
+                      <FiEdit3 className="w-5 h-5" />
+                      {t('open_room','M·ªü ph√≤ng thi','Open Room')}
+                    </button>
+                  </div>
+                )}
+              </div>
+            );
+          })}
+        </nav>
+      </div>
+
+      <div className="border-t border-blue-100 pt-3 mt-3">
+        <button
+          onClick={() => navigate(setting.path)}
+          className={`group flex items-center gap-3 text-lg font-medium px-4 py-3 rounded-xl transition-all duration-200 w-full ${
+            location.pathname === setting.path
+              ? "bg-[#0080FF]/10 border-l-4 border-[#0080FF] text-[#0080FF] shadow-sm"
+              : "text-gray-700 hover:bg-[#A0D4FF]/60 hover:text-[#0080FF]"
+          }`}
+        >
+          <setting.icon
+            className={`w-6 h-6 transition-colors duration-200 ${
+              location.pathname === setting.path
+                ? "text-[#0080FF]"
+                : "text-gray-600 group-hover:text-[#0080FF]"
+            }`}
+          />
+          <span>{setting.label}</span>
+        </button>
+      </div>
+    </aside>
+  );
+};
+
+export default InstructorSidebar;
diff --git a/frontend/src/components/instructor/InstructorSummary.jsx b/frontend/src/components/instructor/InstructorSummary.jsx
index ac90587..43d93f1 100644
--- a/frontend/src/components/instructor/InstructorSummary.jsx
+++ b/frontend/src/components/instructor/InstructorSummary.jsx
@@ -1,38 +1,38 @@
-import React from "react";
-import SummaryCard from "./SummaryCard.jsx";
-
-const InstructorSummary = () => {
-  const summaryData = [
-    {
-      title: "T·ªïng s·ªë ƒë·ªÅ ƒë√£ t·∫°o",
-      value: "0",
-      color: "bg-green-400",
-      icon: "/icons/UI Image/report.png",
-      linkText: "Xem",
-    },
-    {
-      title: "T·ªïng s·ªë b√†i ki·ªÉm tra",
-      value: "0",
-      color: "bg-red-400",
-      icon: "/icons/UI Image/totalExam.png",
-      linkText: "Xem",
-    },
-    {
-      title: "T·ªïng s·ªë th√≠ sinh ƒë√£ thi",
-      value: "0",
-      color: "bg-purple-400",
-      icon: "/icons/UI Image/studentGroup.png",
-      linkText: "Xem",
-    },
-  ];
-
-  return (
-    <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
-      {summaryData.map((item, index) => (
-        <SummaryCard key={index} {...item} />
-      ))}
-    </div>
-  );
-};
-
-export default InstructorSummary;
+import React from "react";
+import SummaryCard from "./SummaryCard.jsx";
+
+const InstructorSummary = () => {
+  const summaryData = [
+    {
+      title: "T·ªïng s·ªë ƒë·ªÅ ƒë√£ t·∫°o",
+      value: "0",
+      color: "bg-green-400",
+      icon: "/icons/UI Image/report.png",
+      linkText: "Xem",
+    },
+    {
+      title: "T·ªïng s·ªë b√†i ki·ªÉm tra",
+      value: "0",
+      color: "bg-red-400",
+      icon: "/icons/UI Image/totalExam.png",
+      linkText: "Xem",
+    },
+    {
+      title: "T·ªïng s·ªë th√≠ sinh ƒë√£ thi",
+      value: "0",
+      color: "bg-purple-400",
+      icon: "/icons/UI Image/studentGroup.png",
+      linkText: "Xem",
+    },
+  ];
+
+  return (
+    <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
+      {summaryData.map((item, index) => (
+        <SummaryCard key={index} {...item} />
+      ))}
+    </div>
+  );
+};
+
+export default InstructorSummary;
diff --git a/frontend/src/components/instructor/SummaryCard.jsx b/frontend/src/components/instructor/SummaryCard.jsx
index 8406ff2..3d09eff 100644
--- a/frontend/src/components/instructor/SummaryCard.jsx
+++ b/frontend/src/components/instructor/SummaryCard.jsx
@@ -1,32 +1,32 @@
-import React from "react";
-
-const SummaryCard = ({ title, value, color, icon, linkText }) => {
-  return (
-    <div className="bg-white rounded-2xl shadow-sm p-5 flex flex-col justify-between hover:shadow-md transition-all duration-300">
-      <div className="flex items-center my-auto gap-3 mb-2">
-        <div
-          className={`w-10 h-10 flex items-center justify-center rounded-full ${color}`}
-        >
-          <img src={icon} alt={title} className="w-6 h-6 object-contain" />
-        </div>
-        <div className="">
-          <h3 className="text-2xl font-semibold text-gray-400">{value}</h3>
-          <p className="text-gray-400 font-semibold text-base mb-3">{title}</p>
-        </div>
-      </div>
-      {linkText && (
-        <a
-          href="#"
-          className={`text-[16px] hover:text-gray-600 text-gray-400 font-semibold flex items-center gap-1 self-end cursor-pointer transition-all duration-200 group`}
-        >
-          {linkText}
-          <span className="text-[20px] font-bold transform transition-transform duration-200  ">
-            ‚Üí
-          </span>
-        </a>
-      )}
-    </div>
-  );
-};
-
-export default SummaryCard;
+import React from "react";
+
+const SummaryCard = ({ title, value, color, icon, linkText }) => {
+  return (
+    <div className="bg-white rounded-2xl shadow-sm p-5 flex flex-col justify-between hover:shadow-md transition-all duration-300">
+      <div className="flex items-center my-auto gap-3 mb-2">
+        <div
+          className={`w-10 h-10 flex items-center justify-center rounded-full ${color}`}
+        >
+          <img src={icon} alt={title} className="w-6 h-6 object-contain" />
+        </div>
+        <div className="">
+          <h3 className="text-2xl font-semibold text-gray-400">{value}</h3>
+          <p className="text-gray-400 font-semibold text-base mb-3">{title}</p>
+        </div>
+      </div>
+      {linkText && (
+        <a
+          href="#"
+          className={`text-[16px] hover:text-gray-600 text-gray-400 font-semibold flex items-center gap-1 self-end cursor-pointer transition-all duration-200 group`}
+        >
+          {linkText}
+          <span className="text-[20px] font-bold transform transition-transform duration-200  ">
+            ‚Üí
+          </span>
+        </a>
+      )}
+    </div>
+  );
+};
+
+export default SummaryCard;
diff --git a/frontend/src/index.css b/frontend/src/index.css
index 8643e01..945b35f 100644
--- a/frontend/src/index.css
+++ b/frontend/src/index.css
@@ -1,27 +1,27 @@
-@import "tailwindcss";
-
-@layer base {
-  a,
-  button,
-  input,
-  select {
-    @apply cursor-pointer;
-  }
-
-  input,
-  select,
-  textarea,
-  option {
-    @apply outline-none;
-  }
-}
-
-input[type="number"]::-webkit-outer-spin-button,
-input[type="number"]::-webkit-inner-spin-button {
-  -webkit-appearance: none;
-  margin: 0;
-}
-
-input[type="number"] {
-  -moz-appearance: textfield;
-}
+@import "tailwindcss";
+
+@layer base {
+  a,
+  button,
+  input,
+  select {
+    @apply cursor-pointer;
+  }
+
+  input,
+  select,
+  textarea,
+  option {
+    @apply outline-none;
+  }
+}
+
+input[type="number"]::-webkit-outer-spin-button,
+input[type="number"]::-webkit-inner-spin-button {
+  -webkit-appearance: none;
+  margin: 0;
+}
+
+input[type="number"] {
+  -moz-appearance: textfield;
+}
diff --git a/frontend/src/main.jsx b/frontend/src/main.jsx
index 822005b..fbe896f 100644
--- a/frontend/src/main.jsx
+++ b/frontend/src/main.jsx
@@ -1,13 +1,13 @@
-import { StrictMode } from "react";
-import { createRoot } from "react-dom/client";
-import "./index.css";
-import App from "./App.jsx";
-import { GoogleOAuthProvider } from "@react-oauth/google";
-
-createRoot(document.getElementById("root")).render(
-  <StrictMode>
-    <GoogleOAuthProvider clientId="429788829057-1trsehq11bmckgpllduebgslg3u11rs0.apps.googleusercontent.com">
-      <App />
-    </GoogleOAuthProvider>
-  </StrictMode>
-);
+import { StrictMode } from "react";
+import { createRoot } from "react-dom/client";
+import "./index.css";
+import App from "./App.jsx";
+import { GoogleOAuthProvider } from "@react-oauth/google";
+
+createRoot(document.getElementById("root")).render(
+  <StrictMode>
+    <GoogleOAuthProvider clientId="429788829057-1trsehq11bmckgpllduebgslg3u11rs0.apps.googleusercontent.com">
+      <App />
+    </GoogleOAuthProvider>
+  </StrictMode>
+);
diff --git a/frontend/src/pages/AboutUs.jsx b/frontend/src/pages/AboutUs.jsx
index 96c3352..f63344e 100644
--- a/frontend/src/pages/AboutUs.jsx
+++ b/frontend/src/pages/AboutUs.jsx
@@ -1,44 +1,44 @@
-import React from "react";
-
-const aboutPoints = [
-  "T√≠ch h·ª£p AI/NLP h·ªó tr·ª£ ch·∫•m ƒëi·ªÉm t·ª± lu·∫≠n th√¥ng minh, ƒë·∫£m b·∫£o t√≠nh c√¥ng b·∫±ng v√† minh b·∫°ch.",
-  "T·∫°o ƒë·ªÅ thi nhanh ch√≥ng t·ª´ file Excel, h·ªó tr·ª£ t·ª± ƒë·ªông ph√¢n lo·∫°i c√¢u h·ªèi theo m·ª©c ƒë·ªô.",
-  "Ch·∫•m ƒëi·ªÉm t·ª± ƒë·ªông nhanh ch√≥ng, h·ªó tr·ª£ gi√°o vi√™n ti·∫øt ki·ªám th·ªùi gian ƒë√°ng k·ªÉ.",
-  "Qu·∫£n l√Ω kh√≥a h·ªçc, ng√¢n l∆∞·ª£ng v√† k·∫øt qu·∫£ thi tr√™n m·ªôt n·ªÅn t·∫£ng duy nh·∫•t, d·ªÖ s·ª≠ d·ª•ng.",
-  "Th·ªëng k√™, b√°o c√°o k·∫øt qu·∫£ to√†n di·ªán, h·ªó tr·ª£ gi·∫£ng vi√™n ƒë√°nh gi√° ch√≠nh x√°c nƒÉng l·ª±c h·ªçc vi√™n.",
-];
-
-export default function AboutUs() {
-  return (
-    <section className="py-10 px-6 md:px-10 lg:px-20 bg-gradient-to-b ">
-      <div className="flex items-center justify-center">
-        <div className="max-w-4xl w-full">
-          <h2 className="text-3xl md:text-4xl font-bold text-blue-900 text-center mb-8">
-            V·ªÅ ch√∫ng t√¥i
-          </h2>
-
-          <div className="bg-gradient-to-r from-blue-100 to-pink-100 p-8 rounded-3xl shadow-md hover:shadow-lg transition-shadow duration-300">
-            <p className="text-gray-800 text-base md:text-lg mb-6 leading-relaxed">
-              V·ªõi quy tr√¨nh ph√°t tri·ªÉn b√†i b·∫£n, √°p d·ª•ng c√¥ng ngh·ªá ti√™n ti·∫øn v√†o
-              giao di·ªán th√¢n thi·ªán, <b>OEM Mini</b> ƒë√£ gi√∫p nhi·ªÅu gi·∫£ng vi√™n v√†
-              trung t√¢m ƒë√†o t·∫°o t·ªï ch·ª©c c√°c k·ª≥ thi tr·ª±c tuy·∫øn hi·ªáu qu·∫£ v·ªõi c√°c
-              ∆∞u ƒëi·ªÉm sau:
-            </p>
-
-            <ul className="list-disc pl-6 space-y-3 text-gray-800 text-base md:text-lg mb-6 leading-relaxed">
-              {aboutPoints.map((text, index) => (
-                <li key={index}>{text}</li>
-              ))}
-            </ul>
-
-            <p className="text-gray-800 text-base md:text-lg leading-relaxed">
-              B√™n c·∫°nh vi·ªác cung c·∫•p c√°c ph∆∞∆°ng ph√°p h·ªçc t·∫≠p hi·ªáu qu·∫£,{" "}
-              <b>OEM Mini</b> c√≤n mang l·∫°i s·ª± ti·ªán l·ª£i trong vi·ªác t·ªï ch·ª©c c√°c k·ª≥
-              thi tr·ª±c tuy·∫øn.
-            </p>
-          </div>
-        </div>
-      </div>
-    </section>
-  );
-}
+import React from "react";
+
+const aboutPoints = [
+  "T√≠ch h·ª£p AI/NLP h·ªó tr·ª£ ch·∫•m ƒëi·ªÉm t·ª± lu·∫≠n th√¥ng minh, ƒë·∫£m b·∫£o t√≠nh c√¥ng b·∫±ng v√† minh b·∫°ch.",
+  "T·∫°o ƒë·ªÅ thi nhanh ch√≥ng t·ª´ file Excel, h·ªó tr·ª£ t·ª± ƒë·ªông ph√¢n lo·∫°i c√¢u h·ªèi theo m·ª©c ƒë·ªô.",
+  "Ch·∫•m ƒëi·ªÉm t·ª± ƒë·ªông nhanh ch√≥ng, h·ªó tr·ª£ gi√°o vi√™n ti·∫øt ki·ªám th·ªùi gian ƒë√°ng k·ªÉ.",
+  "Qu·∫£n l√Ω kh√≥a h·ªçc, ng√¢n l∆∞·ª£ng v√† k·∫øt qu·∫£ thi tr√™n m·ªôt n·ªÅn t·∫£ng duy nh·∫•t, d·ªÖ s·ª≠ d·ª•ng.",
+  "Th·ªëng k√™, b√°o c√°o k·∫øt qu·∫£ to√†n di·ªán, h·ªó tr·ª£ gi·∫£ng vi√™n ƒë√°nh gi√° ch√≠nh x√°c nƒÉng l·ª±c h·ªçc vi√™n.",
+];
+
+export default function AboutUs() {
+  return (
+    <section className="py-10 px-6 md:px-10 lg:px-20 bg-gradient-to-b ">
+      <div className="flex items-center justify-center">
+        <div className="max-w-4xl w-full">
+          <h2 className="text-3xl md:text-4xl font-bold text-blue-900 text-center mb-8">
+            V·ªÅ ch√∫ng t√¥i
+          </h2>
+
+          <div className="bg-gradient-to-r from-blue-100 to-pink-100 p-8 rounded-3xl shadow-md hover:shadow-lg transition-shadow duration-300">
+            <p className="text-gray-800 text-base md:text-lg mb-6 leading-relaxed">
+              V·ªõi quy tr√¨nh ph√°t tri·ªÉn b√†i b·∫£n, √°p d·ª•ng c√¥ng ngh·ªá ti√™n ti·∫øn v√†o
+              giao di·ªán th√¢n thi·ªán, <b>OEM Mini</b> ƒë√£ gi√∫p nhi·ªÅu gi·∫£ng vi√™n v√†
+              trung t√¢m ƒë√†o t·∫°o t·ªï ch·ª©c c√°c k·ª≥ thi tr·ª±c tuy·∫øn hi·ªáu qu·∫£ v·ªõi c√°c
+              ∆∞u ƒëi·ªÉm sau:
+            </p>
+
+            <ul className="list-disc pl-6 space-y-3 text-gray-800 text-base md:text-lg mb-6 leading-relaxed">
+              {aboutPoints.map((text, index) => (
+                <li key={index}>{text}</li>
+              ))}
+            </ul>
+
+            <p className="text-gray-800 text-base md:text-lg leading-relaxed">
+              B√™n c·∫°nh vi·ªác cung c·∫•p c√°c ph∆∞∆°ng ph√°p h·ªçc t·∫≠p hi·ªáu qu·∫£,{" "}
+              <b>OEM Mini</b> c√≤n mang l·∫°i s·ª± ti·ªán l·ª£i trong vi·ªác t·ªï ch·ª©c c√°c k·ª≥
+              thi tr·ª±c tuy·∫øn.
+            </p>
+          </div>
+        </div>
+      </div>
+    </section>
+  );
+}
diff --git a/frontend/src/pages/Contract.jsx b/frontend/src/pages/Contract.jsx
index 298229a..3369dd6 100644
--- a/frontend/src/pages/Contract.jsx
+++ b/frontend/src/pages/Contract.jsx
@@ -1,42 +1,42 @@
-import React from "react";
-
-const contacts = [
-  {
-    icon: "/icons/UI Image/gps.png",
-    text: "120 Ho√†ng Minh Th·∫£o, qu·∫≠n Li√™n Chi·ªÉu, th√†nh ph·ªë ƒê√† N·∫µng",
-  },
-  {
-    icon: "/icons/UI Image/phone.png",
-    text: "0971893750",
-  },
-  {
-    icon: "/icons/UI Image/mail1.png",
-    text: "OEMini@edu.vn",
-  },
-];
-export default function Contact() {
-  return (
-    <section className="py-10 px-6">
-      <div className=" flex items-center justify-center">
-        <div className="max-w-5xl w-full">
-          <h2 className="text-4xl font-bold text-blue-900 text-center mb-4">
-            Li√™n h·ªá
-          </h2>
-          <div className="bg-gradient-to-r from-blue-100 to-pink-100 p-8 rounded-3xl shadow flex flex-col md:flex-row justify-between items-center">
-            <div className="space-y-6 text-lg text-gray-800">
-              {contacts.map((item, index) => (
-                <div key={index} className="flex items-center space-x-4">
-                  <img src={item.icon} alt="icon" className="w-12 h-12" />
-                  <p>{item.text}</p>
-                </div>
-              ))}
-            </div>
-            <div className="mt-8 md:mt-0 text-center">
-              <img src="/Logo.png" alt="OEM Logo" className="h-24 w-auto" />
-            </div>
-          </div>
-        </div>
-      </div>
-    </section>
-  );
-}
+import React from "react";
+
+const contacts = [
+  {
+    icon: "/icons/UI Image/gps.png",
+    text: "120 Ho√†ng Minh Th·∫£o, qu·∫≠n Li√™n Chi·ªÉu, th√†nh ph·ªë ƒê√† N·∫µng",
+  },
+  {
+    icon: "/icons/UI Image/phone.png",
+    text: "0971893750",
+  },
+  {
+    icon: "/icons/UI Image/mail1.png",
+    text: "OEMini@edu.vn",
+  },
+];
+export default function Contact() {
+  return (
+    <section className="py-10 px-6">
+      <div className=" flex items-center justify-center">
+        <div className="max-w-5xl w-full">
+          <h2 className="text-4xl font-bold text-blue-900 text-center mb-4">
+            Li√™n h·ªá
+          </h2>
+          <div className="bg-gradient-to-r from-blue-100 to-pink-100 p-8 rounded-3xl shadow flex flex-col md:flex-row justify-between items-center">
+            <div className="space-y-6 text-lg text-gray-800">
+              {contacts.map((item, index) => (
+                <div key={index} className="flex items-center space-x-4">
+                  <img src={item.icon} alt="icon" className="w-12 h-12" />
+                  <p>{item.text}</p>
+                </div>
+              ))}
+            </div>
+            <div className="mt-8 md:mt-0 text-center">
+              <img src="/Logo.png" alt="OEM Logo" className="h-24 w-auto" />
+            </div>
+          </div>
+        </div>
+      </div>
+    </section>
+  );
+}
diff --git a/frontend/src/pages/Features.jsx b/frontend/src/pages/Features.jsx
index 1ca691f..934c388 100644
--- a/frontend/src/pages/Features.jsx
+++ b/frontend/src/pages/Features.jsx
@@ -1,80 +1,80 @@
-// src/components/Features.jsx
-import React from "react";
-
-const features = [
-  {
-    icon: "/icons/UI Image/8194264.png",
-    title: "T·∫°o ƒë·ªÅ thi nhanh ch√≥ng",
-    desc: [
-      "Gi·∫£ng vi√™n c√≥ th·ªÉ t·∫£i l√™n file Excel ch·ª©a c√¢u h·ªèi, h·ªá th·ªëng t·ª± ƒë·ªông ph√¢n lo·∫°i MCQ v√† Essay, gi·∫£m th·ªùi gian nh·∫≠p li·ªáu th·ªß c√¥ng.",
-      "H·ªá th·ªëng nh·∫≠n di·ªán v√† s·∫Øp x·∫øp c√¢u h·ªèi theo d·∫°ng tr·∫Øc nghi·ªám v√† t·ª± lu·∫≠n ƒë·ªÉ chu·∫©n b·ªã ƒë·ªÅ thi nhanh ch√≥ng.",
-      "Gi·∫£ng vi√™n c√≥ th·ªÉ ch·ªânh s·ª≠a c√¢u h·ªèi ngay sau khi import, ƒë·∫£m b·∫£o ƒë·ªô ch√≠nh x√°c c·ªßa ƒë·ªÅ thi",
-      "H·ªá th·ªëng ki·ªÉm so√°t s·ªë l∆∞·ª£ng c√¢u h·ªèi t·ªëi ƒëa tr√™n m·ªói ƒë·ªÅ ƒë·ªÉ duy tr√¨ s·ª± h·ª£p l√Ω v√† d·ªÖ qu·∫£n l√Ω.",
-    ],
-  },
-  {
-    icon: "/icons/UI Image/12.png",
-    title: "Ch·∫•m ƒëi·ªÉm t·ª± ƒë·ªông th√¥ng minh",
-    desc: [
-      "Tr·∫Øc nghi·ªám ƒë∆∞·ª£c ch·∫•m ngay l·∫≠p t·ª©c, c√≤n b√†i t·ª± lu·∫≠n ƒë∆∞·ª£c AI/NLP g·ª£i √Ω ƒëi·ªÉm s·ªë.",
-      "Khi h·ªçc sinh n·ªôp b√†i, h·ªá th·ªëng ch·∫•m ƒëi·ªÉm MCQ d·ª±a tr√™n ƒë√°p √°n ƒë√∫ng ƒë√£ ƒë√°nh d·∫•u.",
-      "Gi·∫£ng vi√™n xem l·∫°i v√† ƒëi·ªÅu ch·ªânh ƒëi·ªÉm AI tr∆∞·ªõc khi c√¥ng b·ªë ch√≠nh th·ª©c, ƒë·∫£m b·∫£o c√¥ng b·∫±ng.",
-      "H·ªá th·ªëng ghi nh·∫≠n l·ªãch s·ª≠ ƒëi·ªÉm v√† thao t√°c ch·ªânh s·ª≠a, h·ªó tr·ª£ ki·ªÉm tra v√† edit sau n√†y",
-    ],
-  },
-  {
-    icon: "/icons/UI Image/123.png",
-    title: "K·∫øt qu·∫£ minh b·∫°ch & c√¥ng b·∫±ng",
-    desc: [
-      "H·ªçc sinh xem ƒëi·ªÉm MCQ ngay sau khi n·ªôp b√†i; ƒëi·ªÉm t·ª± lu·∫≠n ƒë∆∞·ª£c x√°c nh·∫≠n b·ªüi gi·∫£ng vi√™n.",
-      "Gi·∫£ng vi√™n v√† qu·∫£n tr·ªã vi√™n c√≥ th·ªÉ xu·∫•t ƒëi·ªÉm v√† th·ªëng k√™ th√†nh file CSV/Excel ƒë·ªÉ l∆∞u tr·ªØ v√† ph√¢n t√≠ch.",
-      "Gi·∫£ng vi√™n xem t·ªïng quan k·∫øt qu·∫£ c·ªßa t·∫•t c·∫£ h·ªçc sinh trong kh√≥a h·ªçc.",
-      "ƒêi·ªÉm t·ª± lu·∫≠n ch·ªâ ƒë∆∞·ª£c c√¥ng b·ªë sau khi gi·∫£ng vi√™n ki·ªÉm tra g·ª£i √Ω t·ª´ AI, gi·∫£m sai l·ªách v√† thi√™n v·ªã.",
-    ],
-  },
-  {
-    icon: "/icons/UI Image/124.png",
-    title: "B·∫£o m·∫≠t v√† an to√†n d·ªØ li·ªáu",
-    desc: [
-      "S·ª≠ d·ª•ng JWT, bcrypt v√† c√°c ti√™u chu·∫©n b·∫£o m·∫≠t ph·ªï bi·∫øn ƒë·ªÉ b·∫£o v·ªá d·ªØ li·ªáu v√† ph√¢n quy·ªÅn role-based ƒë·ªÉ b·∫£o v·ªá d·ªØ li·ªáu v√† quy·ªÅn truy c·∫≠p.",
-      "M·∫≠t kh·∫©u ƒë∆∞·ª£c l∆∞u b·∫±ng bcrypt ƒë·ªÉ b·∫£o v·ªá th√¥ng tin ng∆∞·ªùi d√πng.",
-      "H·ªá th·ªëng validate input ƒë·ªÉ ch·ªëng SQL Injection/XSS v√† l∆∞u nh·∫≠t k√Ω ho·∫°t ƒë·ªông ƒë·ªÉ theo d√µi h√†nh vi ƒë√°ng ng·ªù.",
-      "Data ng∆∞·ªùi d√πng ƒë∆∞·ª£c sao l∆∞u th∆∞·ªùng xuy√™n ƒë·ªÉ tr√°nh m·∫•t m√°t d·ªØ li·ªáu.",
-    ],
-  },
-];
-
-export default function Features() {
-  return (
-    <section className="py-10 px-6">
-      <h2 className="text-4xl font-bold text-blue-900 text-center mb-8">
-        Gi·ªõi thi·ªáu t√≠nh nƒÉng n·ªïi b·∫≠t c·ªßa OEM Mini
-      </h2>
-      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-7xl mx-auto">
-        {features.map((feature, index) => (
-          <div
-            key={index}
-            className="bg-[#f8fbff] rounded-xl p-6 shadow hover:shadow-lg transition"
-          >
-            <div className="flex flex-col items-center text-center mb-4">
-              <img
-                src={feature.icon}
-                alt="icon"
-                className="w-12 h-12 mb-3 object-contain"
-              />
-              <h3 className="font-bold text-md" style={{ color: "#180eff" }}>
-                {feature.title}
-              </h3>
-            </div>
-            <p className="text-sm text-gray-800 mb-3">{feature.desc[0]}</p>
-            <ul className="text-sm text-gray-700 list-disc pl-4 space-y-2">
-              {feature.desc.map((point, i) => (
-                <li key={i}>{point}</li>
-              ))}
-            </ul>
-          </div>
-        ))}
-      </div>
-    </section>
-  );
-}
+// src/components/Features.jsx
+import React from "react";
+
+const features = [
+  {
+    icon: "/icons/UI Image/8194264.png",
+    title: "T·∫°o ƒë·ªÅ thi nhanh ch√≥ng",
+    desc: [
+      "Gi·∫£ng vi√™n c√≥ th·ªÉ t·∫£i l√™n file Excel ch·ª©a c√¢u h·ªèi, h·ªá th·ªëng t·ª± ƒë·ªông ph√¢n lo·∫°i MCQ v√† Essay, gi·∫£m th·ªùi gian nh·∫≠p li·ªáu th·ªß c√¥ng.",
+      "H·ªá th·ªëng nh·∫≠n di·ªán v√† s·∫Øp x·∫øp c√¢u h·ªèi theo d·∫°ng tr·∫Øc nghi·ªám v√† t·ª± lu·∫≠n ƒë·ªÉ chu·∫©n b·ªã ƒë·ªÅ thi nhanh ch√≥ng.",
+      "Gi·∫£ng vi√™n c√≥ th·ªÉ ch·ªânh s·ª≠a c√¢u h·ªèi ngay sau khi import, ƒë·∫£m b·∫£o ƒë·ªô ch√≠nh x√°c c·ªßa ƒë·ªÅ thi",
+      "H·ªá th·ªëng ki·ªÉm so√°t s·ªë l∆∞·ª£ng c√¢u h·ªèi t·ªëi ƒëa tr√™n m·ªói ƒë·ªÅ ƒë·ªÉ duy tr√¨ s·ª± h·ª£p l√Ω v√† d·ªÖ qu·∫£n l√Ω.",
+    ],
+  },
+  {
+    icon: "/icons/UI Image/12.png",
+    title: "Ch·∫•m ƒëi·ªÉm t·ª± ƒë·ªông th√¥ng minh",
+    desc: [
+      "Tr·∫Øc nghi·ªám ƒë∆∞·ª£c ch·∫•m ngay l·∫≠p t·ª©c, c√≤n b√†i t·ª± lu·∫≠n ƒë∆∞·ª£c AI/NLP g·ª£i √Ω ƒëi·ªÉm s·ªë.",
+      "Khi h·ªçc sinh n·ªôp b√†i, h·ªá th·ªëng ch·∫•m ƒëi·ªÉm MCQ d·ª±a tr√™n ƒë√°p √°n ƒë√∫ng ƒë√£ ƒë√°nh d·∫•u.",
+      "Gi·∫£ng vi√™n xem l·∫°i v√† ƒëi·ªÅu ch·ªânh ƒëi·ªÉm AI tr∆∞·ªõc khi c√¥ng b·ªë ch√≠nh th·ª©c, ƒë·∫£m b·∫£o c√¥ng b·∫±ng.",
+      "H·ªá th·ªëng ghi nh·∫≠n l·ªãch s·ª≠ ƒëi·ªÉm v√† thao t√°c ch·ªânh s·ª≠a, h·ªó tr·ª£ ki·ªÉm tra v√† edit sau n√†y",
+    ],
+  },
+  {
+    icon: "/icons/UI Image/123.png",
+    title: "K·∫øt qu·∫£ minh b·∫°ch & c√¥ng b·∫±ng",
+    desc: [
+      "H·ªçc sinh xem ƒëi·ªÉm MCQ ngay sau khi n·ªôp b√†i; ƒëi·ªÉm t·ª± lu·∫≠n ƒë∆∞·ª£c x√°c nh·∫≠n b·ªüi gi·∫£ng vi√™n.",
+      "Gi·∫£ng vi√™n v√† qu·∫£n tr·ªã vi√™n c√≥ th·ªÉ xu·∫•t ƒëi·ªÉm v√† th·ªëng k√™ th√†nh file CSV/Excel ƒë·ªÉ l∆∞u tr·ªØ v√† ph√¢n t√≠ch.",
+      "Gi·∫£ng vi√™n xem t·ªïng quan k·∫øt qu·∫£ c·ªßa t·∫•t c·∫£ h·ªçc sinh trong kh√≥a h·ªçc.",
+      "ƒêi·ªÉm t·ª± lu·∫≠n ch·ªâ ƒë∆∞·ª£c c√¥ng b·ªë sau khi gi·∫£ng vi√™n ki·ªÉm tra g·ª£i √Ω t·ª´ AI, gi·∫£m sai l·ªách v√† thi√™n v·ªã.",
+    ],
+  },
+  {
+    icon: "/icons/UI Image/124.png",
+    title: "B·∫£o m·∫≠t v√† an to√†n d·ªØ li·ªáu",
+    desc: [
+      "S·ª≠ d·ª•ng JWT, bcrypt v√† c√°c ti√™u chu·∫©n b·∫£o m·∫≠t ph·ªï bi·∫øn ƒë·ªÉ b·∫£o v·ªá d·ªØ li·ªáu v√† ph√¢n quy·ªÅn role-based ƒë·ªÉ b·∫£o v·ªá d·ªØ li·ªáu v√† quy·ªÅn truy c·∫≠p.",
+      "M·∫≠t kh·∫©u ƒë∆∞·ª£c l∆∞u b·∫±ng bcrypt ƒë·ªÉ b·∫£o v·ªá th√¥ng tin ng∆∞·ªùi d√πng.",
+      "H·ªá th·ªëng validate input ƒë·ªÉ ch·ªëng SQL Injection/XSS v√† l∆∞u nh·∫≠t k√Ω ho·∫°t ƒë·ªông ƒë·ªÉ theo d√µi h√†nh vi ƒë√°ng ng·ªù.",
+      "Data ng∆∞·ªùi d√πng ƒë∆∞·ª£c sao l∆∞u th∆∞·ªùng xuy√™n ƒë·ªÉ tr√°nh m·∫•t m√°t d·ªØ li·ªáu.",
+    ],
+  },
+];
+
+export default function Features() {
+  return (
+    <section className="py-10 px-6">
+      <h2 className="text-4xl font-bold text-blue-900 text-center mb-8">
+        Gi·ªõi thi·ªáu t√≠nh nƒÉng n·ªïi b·∫≠t c·ªßa OEM Mini
+      </h2>
+      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-7xl mx-auto">
+        {features.map((feature, index) => (
+          <div
+            key={index}
+            className="bg-[#f8fbff] rounded-xl p-6 shadow hover:shadow-lg transition"
+          >
+            <div className="flex flex-col items-center text-center mb-4">
+              <img
+                src={feature.icon}
+                alt="icon"
+                className="w-12 h-12 mb-3 object-contain"
+              />
+              <h3 className="font-bold text-md" style={{ color: "#180eff" }}>
+                {feature.title}
+              </h3>
+            </div>
+            <p className="text-sm text-gray-800 mb-3">{feature.desc[0]}</p>
+            <ul className="text-sm text-gray-700 list-disc pl-4 space-y-2">
+              {feature.desc.map((point, i) => (
+                <li key={i}>{point}</li>
+              ))}
+            </ul>
+          </div>
+        ))}
+      </div>
+    </section>
+  );
+}
diff --git a/frontend/src/pages/LandingPage.jsx b/frontend/src/pages/LandingPage.jsx
index 06bf4ed..94cf16b 100644
--- a/frontend/src/pages/LandingPage.jsx
+++ b/frontend/src/pages/LandingPage.jsx
@@ -1,66 +1,66 @@
-import React, { useEffect, useState } from "react";
-import axios from "axios";
-
-export default function LandingPage() {
-  const [apiInfo, setApiInfo] = useState(null);
-  const [apiError, setApiError] = useState(null);
-
-  // useEffect(() => {
-  //   axios
-  //     // .get("http://localhost:5000/api/info")
-  //     // .then((response) => {
-  //     //   console.log("API Response:", response.data);
-  //     //   setApiInfo(response.data);
-  //     //   setApiError(null);
-  //     // })
-  //     // .catch((error) => {
-  //     //   console.error("Error fetching API:", error);
-  //     //   setApiError("Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server");
-  //     //   setApiInfo(null);
-  //     // });
-  // }, []);
-
-  return (
-    <section className="w-full min-h-[calc(100vh-60px)] p-6 ">
-      <div className="max-w-[1400px] mx-auto px-4 md:px-10 rounded-3xl">
-        <section className="mt-10 min-h-screen h-auto">
-          <div className="grid lg:grid-cols-2 gap-8 items-center">
-            <div className="relative pt-16 lg:pt-0">
-              <div className="inline-block border-[3px] border-[#005fbd] text-[#0097e9] px-6 py-3 rounded-lg -rotate-6 font-black text-lg mb-6 shadow-md">
-                OEM Mini
-              </div>
-              <h1 className="text-3xl md:text-5xl font-extrabold text-[#023e8a] leading-tight mb-4">
-                H·ªá th·ªëng ƒë·∫Øc l·ª±c h·ªó tr·ª£
-                <br />
-                <span className="block text-2xl md:text-4xl font-bold text-[#00c3ffcc] mt-4">
-                  thi tr·ª±c tuy·∫øn hi·ªáu qu·∫£
-                </span>
-              </h1>
-              {apiInfo && (
-                <p className="mt-6 p-4 text-green-700 text-sm md:text-base bg-green-50 rounded">
-                  {apiInfo.name} - v{apiInfo.version}
-                  <br />
-                  {apiInfo.description}
-                </p>
-              )}
-              {apiError && (
-                <p className="mt-6 p-4 text-red-700 text-sm md:text-base bg-red-50 rounded">
-                  ‚ö†Ô∏è {apiError}
-                </p>
-              )}
-            </div>
-            <div className="flex justify-center items-center">
-              <div className="w-full max-w-[500px] relative">
-                <img
-                  src="/process.png"
-                  alt="Process Illustration"
-                  className="w-full h-auto rounded-lg"
-                />
-              </div>
-            </div>
-          </div>
-        </section>
-      </div>
-    </section>
-  );
-}
+import React, { useEffect, useState } from "react";
+import axios from "axios";
+
+export default function LandingPage() {
+  const [apiInfo, setApiInfo] = useState(null);
+  const [apiError, setApiError] = useState(null);
+
+  // useEffect(() => {
+  //   axios
+  //     // .get("http://localhost:5000/api/info")
+  //     // .then((response) => {
+  //     //   console.log("API Response:", response.data);
+  //     //   setApiInfo(response.data);
+  //     //   setApiError(null);
+  //     // })
+  //     // .catch((error) => {
+  //     //   console.error("Error fetching API:", error);
+  //     //   setApiError("Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server");
+  //     //   setApiInfo(null);
+  //     // });
+  // }, []);
+
+  return (
+    <section className="w-full min-h-[calc(100vh-60px)] p-6 ">
+      <div className="max-w-[1400px] mx-auto px-4 md:px-10 rounded-3xl">
+        <section className="mt-10 min-h-screen h-auto">
+          <div className="grid lg:grid-cols-2 gap-8 items-center">
+            <div className="relative pt-16 lg:pt-0">
+              <div className="inline-block border-[3px] border-[#005fbd] text-[#0097e9] px-6 py-3 rounded-lg -rotate-6 font-black text-lg mb-6 shadow-md">
+                OEM Mini
+              </div>
+              <h1 className="text-3xl md:text-5xl font-extrabold text-[#023e8a] leading-tight mb-4">
+                H·ªá th·ªëng ƒë·∫Øc l·ª±c h·ªó tr·ª£
+                <br />
+                <span className="block text-2xl md:text-4xl font-bold text-[#00c3ffcc] mt-4">
+                  thi tr·ª±c tuy·∫øn hi·ªáu qu·∫£
+                </span>
+              </h1>
+              {apiInfo && (
+                <p className="mt-6 p-4 text-green-700 text-sm md:text-base bg-green-50 rounded">
+                  {apiInfo.name} - v{apiInfo.version}
+                  <br />
+                  {apiInfo.description}
+                </p>
+              )}
+              {apiError && (
+                <p className="mt-6 p-4 text-red-700 text-sm md:text-base bg-red-50 rounded">
+                  ‚ö†Ô∏è {apiError}
+                </p>
+              )}
+            </div>
+            <div className="flex justify-center items-center">
+              <div className="w-full max-w-[500px] relative">
+                <img
+                  src="/process.png"
+                  alt="Process Illustration"
+                  className="w-full h-auto rounded-lg"
+                />
+              </div>
+            </div>
+          </div>
+        </section>
+      </div>
+    </section>
+  );
+}
diff --git a/frontend/src/pages/News.jsx b/frontend/src/pages/News.jsx
index 82c5881..643b755 100644
--- a/frontend/src/pages/News.jsx
+++ b/frontend/src/pages/News.jsx
@@ -1,52 +1,52 @@
-import React from "react";
-
-const newsList = [
-  {
-    title: "",
-    date: "",
-    description: "",
-  },
-  {
-    title: "",
-    date: "",
-    description: "",
-  },
-  {
-    title: "",
-    date: "",
-    description: "",
-  },
-];
-
-export default function News() {
-  return (
-    <section className=" py-10 px-6">
-      <div className="">
-        <h2 className="text-4xl font-bold text-blue-900 text-center mb-8">
-          Tin t·ª©c
-        </h2>
-
-        <div className="max-w-5xl mx-auto bg-white rounded-3xl shadow border border-gray-200 overflow-hidden">
-          <div className="bg-blue-500 text-white font-bold text-lg text-center py-3 rounded-t-3xl">
-            TIN T·ª®C N·ªîI B·∫¨T
-          </div>
-
-          <div className="p-6 space-y-6">
-            {newsList.map((news, index) => (
-              <div
-                key={index}
-                className="border-b border-gray-200 py-4 last:border-none"
-              >
-                <h3 className="text-xl font-semibold text-[#180eff]">
-                  {news.title}
-                </h3>
-                <p className="text-sm text-gray-500 mb-2">{news.date}</p>
-                <p className="text-gray-700">{news.description}</p>
-              </div>
-            ))}
-          </div>
-        </div>
-      </div>
-    </section>
-  );
-}
+import React from "react";
+
+const newsList = [
+  {
+    title: "",
+    date: "",
+    description: "",
+  },
+  {
+    title: "",
+    date: "",
+    description: "",
+  },
+  {
+    title: "",
+    date: "",
+    description: "",
+  },
+];
+
+export default function News() {
+  return (
+    <section className=" py-10 px-6">
+      <div className="">
+        <h2 className="text-4xl font-bold text-blue-900 text-center mb-8">
+          Tin t·ª©c
+        </h2>
+
+        <div className="max-w-5xl mx-auto bg-white rounded-3xl shadow border border-gray-200 overflow-hidden">
+          <div className="bg-blue-500 text-white font-bold text-lg text-center py-3 rounded-t-3xl">
+            TIN T·ª®C N·ªîI B·∫¨T
+          </div>
+
+          <div className="p-6 space-y-6">
+            {newsList.map((news, index) => (
+              <div
+                key={index}
+                className="border-b border-gray-200 py-4 last:border-none"
+              >
+                <h3 className="text-xl font-semibold text-[#180eff]">
+                  {news.title}
+                </h3>
+                <p className="text-sm text-gray-500 mb-2">{news.date}</p>
+                <p className="text-gray-700">{news.description}</p>
+              </div>
+            ))}
+          </div>
+        </div>
+      </div>
+    </section>
+  );
+}
diff --git a/frontend/src/pages/adminPage/AdminDashboard.jsx b/frontend/src/pages/adminPage/AdminDashboard.jsx
index 3f7a940..4fb564f 100644
--- a/frontend/src/pages/adminPage/AdminDashboard.jsx
+++ b/frontend/src/pages/adminPage/AdminDashboard.jsx
@@ -1,338 +1,338 @@
-import React, { useState, useEffect } from 'react';
-import { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area } from 'recharts';
-import { 
-  Home, Users, BookOpen, FileText, Award, 
-  Database, Settings, TrendingUp, User 
-} from 'lucide-react';
-import axiosClient from '../../api/axiosClient';
-
-const AdminDashboard = () => {
-  const [stats, setStats] = useState({
-    totalStudents: 0,
-    totalInstructors: 0,
-    totalExamsUploaded: 0,
-    totalExams: 0,
-    publishedRooms: 0,
-    studentGrowth: 0,
-    instructorGrowth: 0,
-    examGrowth: 0
-  });
-  const [loading, setLoading] = useState(true);
-
-  // Fetch dashboard statistics from API
-  useEffect(() => {
-    const fetchDashboardStats = async () => {
-      try {
-        setLoading(true);
-        const response = await axiosClient.get('/admin/dashboard');
-        
-        if (response.data && response.data.stats) {
-          setStats(response.data.stats);
-        }
-        
-        // Fetch user growth data
-        if (response.data && response.data.userGrowth) {
-          setUserGrowthData(response.data.userGrowth);
-        }
-        
-        // Fetch recent users
-        if (response.data && response.data.recentUsers) {
-          setRecentUsers(response.data.recentUsers);
-        }
-        
-        // Fetch performance data
-        if (response.data && response.data.performanceData) {
-          setPerformanceData(response.data.performanceData);
-        }
-      } catch (error) {
-        console.error('Error fetching dashboard stats:', error);
-        // Fallback to default values if API fails
-        setStats({
-          totalStudents: 245,
-          totalInstructors: 35,
-          totalExamsUploaded: 120,
-          totalExams: 0,
-          publishedRooms: 0,
-          studentGrowth: 18,
-          instructorGrowth: 5,
-          examGrowth: 10
-        });
-      } finally {
-        setLoading(false);
-      }
-    };
-
-    fetchDashboardStats();
-  }, []);
-
-  const [userGrowthData, setUserGrowthData] = useState([
-    { month: 'Jan', users: 0, value: 0 },
-    { month: 'Feb', users: 0, value: 0 },
-    { month: 'Mar', users: 0, value: 0 },
-    { month: 'Apr', users: 0, value: 0 },
-    { month: 'May', users: 0, value: 0 },
-    { month: 'Jun', users: 0, value: 0 },
-    { month: 'Jul', users: 0, value: 0 },
-    { month: 'Aug', users: 0, value: 0 },
-    { month: 'Sep', users: 0, value: 0 },
-    { month: 'Oct', users: 0, value: 0 },
-    { month: 'Nov', users: 0, value: 0 },
-    { month: 'Dec', users: 0, value: 0 }
-  ]);
-
-  const [performanceData, setPerformanceData] = useState([
-    { exam: 'Exam 1', score: 65 },
-    { exam: 'Exam 7', score: 75 },
-    { exam: 'Exam 4', score: 82 },
-    { exam: 'Exam 6', score: 88 },
-    { exam: 'Final', score: 92 }
-  ]);
-
-  const [recentUsers, setRecentUsers] = useState([
-    { id: 1, name: "Sms B'ils", initial: 'S', color: 'bg-blue-500' },
-    { id: 2, name: 'Bonelle tame', initial: 'B', color: 'bg-purple-500' }
-  ]);
-
-  const navItems = [
-    { icon: Home, label: 'Dashboard', active: true },
-    { icon: Users, label: 'User Management', active: false },
-    { icon: BookOpen, label: 'Exam Management', active: false },
-    { icon: FileText, label: 'Exam Overview', active: false },
-    { icon: Award, label: 'Results', active: false },
-    { icon: Database, label: 'System Logs', active: false },
-    { icon: Settings, label: 'Settings', active: false }
-  ];
-
-  return (
-    <div className="flex min-h-screen bg-gray-900">
-      {/* Sidebar */}
-      <aside className="w-64 bg-gray-800 border-r border-gray-700">
-        <div className="p-6 pb-8">
-          <h2 className="text-xl font-semibold text-white">OEM Mini</h2>
-        </div>
-        
-        <nav className="flex flex-col">
-          {navItems.map((item, index) => (
-            <a
-              key={index}
-              href="#"
-              className={`flex items-center gap-3 px-6 py-4 text-sm transition-all ${
-                item.active
-                  ? 'bg-blue-600 text-white border-l-4 border-blue-400'
-                  : 'text-gray-300 hover:bg-gray-700 hover:text-white'
-              }`}
-            >
-              <item.icon size={18} />
-              <span>{item.label}</span>
-            </a>
-          ))}
-        </nav>
-      </aside>
-
-      {/* Main Content */}
-      <main className="flex-1 p-8 overflow-y-auto">
-        <div className="mb-8">
-          <h1 className="text-3xl font-semibold text-white">Dashboard</h1>
-        </div>
-
-        <div className="grid grid-cols-1 xl:grid-cols-3 gap-8">
-          {/* Left Column - Spans 2 columns */}
-          <div className="xl:col-span-2 space-y-8">
-            {/* Stats Cards */}
-            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
-              {/* Total Students */}
-              <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-                <h3 className="text-sm text-gray-400 mb-3">Total Students</h3>
-                <div className="text-4xl font-bold text-white mb-2">
-                  {loading ? '...' : stats.totalStudents.toLocaleString()}
-                </div>
-                <div className="flex items-center gap-1 text-green-400 text-xs">
-                  <TrendingUp size={14} />
-                  <span>+{loading ? '...' : stats.studentGrowth}% since last month</span>
-                </div>
-              </div>
-
-              {/* Total Instructors */}
-              <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-                <h3 className="text-sm text-gray-400 mb-3">Total Instructors</h3>
-                <div className="text-4xl font-bold text-white mb-2">
-                  {loading ? '...' : stats.totalInstructors.toLocaleString()}
-                </div>
-                <div className="flex items-center gap-1 text-green-400 text-xs">
-                  <TrendingUp size={14} />
-                  <span>+{loading ? '...' : stats.instructorGrowth}% since last month</span>
-                </div>
-              </div>
-
-              {/* Total Exams */}
-              <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-                <h3 className="text-sm text-gray-400 mb-3">Total Exams Uploaded</h3>
-                <div className="text-4xl font-bold text-white mb-2">
-                  {loading ? '...' : stats.totalExamsUploaded.toLocaleString()}
-                </div>
-                <div className="flex items-center gap-1 text-green-400 text-xs">
-                  <TrendingUp size={14} />
-                  <span>+{loading ? '...' : stats.examGrowth}% since last month</span>
-                </div>
-              </div>
-            </div>
-
-            {/* User Growth Chart */}
-            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-              <h2 className="text-lg font-semibold text-white mb-6">
-                User Growth Statistics (Last 12 Months)
-              </h2>
-              <ResponsiveContainer width="100%" height={300}>
-                <BarChart data={userGrowthData}>
-                  <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
-                  <XAxis 
-                    dataKey="month" 
-                    stroke="#9CA3AF" 
-                    style={{ fontSize: '12px' }}
-                  />
-                  <YAxis 
-                    stroke="#9CA3AF" 
-                    style={{ fontSize: '12px' }}
-                  />
-                  <Tooltip 
-                    contentStyle={{ 
-                      backgroundColor: '#1F2937', 
-                      border: 'none', 
-                      borderRadius: '8px',
-                      color: '#fff'
-                    }}
-                  />
-                  <Line 
-                    type="monotone" 
-                    dataKey="users" 
-                    stroke="#3B82F6" 
-                    strokeWidth={2} 
-                    dot={false}
-                  />
-                  <Bar 
-                    dataKey="value" 
-                    fill="#2563EB" 
-                    radius={[4, 4, 0, 0]} 
-                  />
-                </BarChart>
-              </ResponsiveContainer>
-            </div>
-
-            {/* User Growth List */}
-            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-              <h2 className="text-lg font-semibold text-white mb-6">User Growth</h2>
-              <div className="space-y-4">
-                {recentUsers.map((user) => (
-                  <div key={user.id} className="flex items-center gap-3">
-                    <div className="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center font-semibold text-white">
-                      {user.initial}
-                    </div>
-                    <span className="text-white text-sm">{user.name}</span>
-                  </div>
-                ))}
-              </div>
-            </div>
-          </div>
-
-          {/* Right Column */}
-          <div className="space-y-8">
-            {/* Courses Stats */}
-            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-              <h2 className="text-lg font-semibold text-white mb-6">Dashboard</h2>
-              <div className="grid grid-cols-2 gap-4">
-                <div>
-                  <h3 className="text-sm text-gray-400 mb-3 leading-tight">
-                    Total<br />Rooms
-                  </h3>
-                  <div className="text-5xl font-bold text-white">
-                    {loading ? '...' : stats.totalExams}
-                  </div>
-                </div>
-                <div>
-                  <h3 className="text-sm text-gray-400 mb-3 leading-tight">
-                    Published<br />Rooms
-                  </h3>
-                  <div className="text-5xl font-bold text-white">
-                    {loading ? '...' : stats.publishedRooms}
-                  </div>
-                </div>
-              </div>
-            </div>
-
-            {/* Upcoming Exams */}
-            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-              <h2 className="text-lg font-semibold text-white mb-6">Upcoming Exams</h2>
-              
-              <div className="space-y-4">
-                <div className="flex justify-between items-start">
-                  <div className="text-white font-medium">Python Basics</div>
-                  <div className="text-gray-400 text-sm">MCQ</div>
-                </div>
-                
-                <div className="flex justify-between items-center text-sm">
-                  <span className="text-gray-400">MCQ</span>
-                  <span className="text-gray-400">Not Started</span>
-                </div>
-                
-                <button className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors">
-                  Start Exam
-                </button>
-              </div>
-            </div>
-
-            {/* Performance Chart */}
-            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-              <h2 className="text-lg font-semibold text-white mb-6">Performance</h2>
-              <ResponsiveContainer width="100%" height={200}>
-                <AreaChart data={performanceData}>
-                  <defs>
-                    <linearGradient id="colorScore" x1="0" y1="0" x2="0" y2="1">
-                      <stop offset="5%" stopColor="#3B82F6" stopOpacity={0.3}/>
-                      <stop offset="95%" stopColor="#3B82F6" stopOpacity={0}/>
-                    </linearGradient>
-                  </defs>
-                  <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
-                  <XAxis 
-                    dataKey="exam" 
-                    stroke="#9CA3AF" 
-                    style={{ fontSize: '11px' }}
-                  />
-                  <YAxis 
-                    stroke="#9CA3AF" 
-                    style={{ fontSize: '11px' }}
-                  />
-                  <Tooltip 
-                    contentStyle={{ 
-                      backgroundColor: '#1F2937', 
-                      border: 'none', 
-                      borderRadius: '8px',
-                      color: '#fff'
-                    }}
-                  />
-                  <Area 
-                    type="monotone" 
-                    dataKey="score" 
-                    stroke="#3B82F6" 
-                    strokeWidth={2}
-                    fillOpacity={1} 
-                    fill="url(#colorScore)" 
-                  />
-                </AreaChart>
-              </ResponsiveContainer>
-            </div>
-
-            {/* Additional Performance Card */}
-            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
-              <h2 className="text-lg font-semibold text-white mb-6">Performance</h2>
-              <div className="h-32 flex items-center justify-center text-gray-400">
-                Additional metrics coming soon...
-              </div>
-            </div>
-          </div>
-        </div>
-      </main>
-    </div>
-  );
-};
-
+import React, { useState, useEffect } from 'react';
+import { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area } from 'recharts';
+import { 
+  Home, Users, BookOpen, FileText, Award, 
+  Database, Settings, TrendingUp, User 
+} from 'lucide-react';
+import axiosClient from '../../api/axiosClient';
+
+const AdminDashboard = () => {
+  const [stats, setStats] = useState({
+    totalStudents: 0,
+    totalInstructors: 0,
+    totalExamsUploaded: 0,
+    totalExams: 0,
+    publishedRooms: 0,
+    studentGrowth: 0,
+    instructorGrowth: 0,
+    examGrowth: 0
+  });
+  const [loading, setLoading] = useState(true);
+
+  // Fetch dashboard statistics from API
+  useEffect(() => {
+    const fetchDashboardStats = async () => {
+      try {
+        setLoading(true);
+        const response = await axiosClient.get('/admin/dashboard');
+        
+        if (response.data && response.data.stats) {
+          setStats(response.data.stats);
+        }
+        
+        // Fetch user growth data
+        if (response.data && response.data.userGrowth) {
+          setUserGrowthData(response.data.userGrowth);
+        }
+        
+        // Fetch recent users
+        if (response.data && response.data.recentUsers) {
+          setRecentUsers(response.data.recentUsers);
+        }
+        
+        // Fetch performance data
+        if (response.data && response.data.performanceData) {
+          setPerformanceData(response.data.performanceData);
+        }
+      } catch (error) {
+        console.error('Error fetching dashboard stats:', error);
+        // Fallback to default values if API fails
+        setStats({
+          totalStudents: 245,
+          totalInstructors: 35,
+          totalExamsUploaded: 120,
+          totalExams: 0,
+          publishedRooms: 0,
+          studentGrowth: 18,
+          instructorGrowth: 5,
+          examGrowth: 10
+        });
+      } finally {
+        setLoading(false);
+      }
+    };
+
+    fetchDashboardStats();
+  }, []);
+
+  const [userGrowthData, setUserGrowthData] = useState([
+    { month: 'Jan', users: 0, value: 0 },
+    { month: 'Feb', users: 0, value: 0 },
+    { month: 'Mar', users: 0, value: 0 },
+    { month: 'Apr', users: 0, value: 0 },
+    { month: 'May', users: 0, value: 0 },
+    { month: 'Jun', users: 0, value: 0 },
+    { month: 'Jul', users: 0, value: 0 },
+    { month: 'Aug', users: 0, value: 0 },
+    { month: 'Sep', users: 0, value: 0 },
+    { month: 'Oct', users: 0, value: 0 },
+    { month: 'Nov', users: 0, value: 0 },
+    { month: 'Dec', users: 0, value: 0 }
+  ]);
+
+  const [performanceData, setPerformanceData] = useState([
+    { exam: 'Exam 1', score: 65 },
+    { exam: 'Exam 7', score: 75 },
+    { exam: 'Exam 4', score: 82 },
+    { exam: 'Exam 6', score: 88 },
+    { exam: 'Final', score: 92 }
+  ]);
+
+  const [recentUsers, setRecentUsers] = useState([
+    { id: 1, name: "Sms B'ils", initial: 'S', color: 'bg-blue-500' },
+    { id: 2, name: 'Bonelle tame', initial: 'B', color: 'bg-purple-500' }
+  ]);
+
+  const navItems = [
+    { icon: Home, label: 'Dashboard', active: true },
+    { icon: Users, label: 'User Management', active: false },
+    { icon: BookOpen, label: 'Exam Management', active: false },
+    { icon: FileText, label: 'Exam Overview', active: false },
+    { icon: Award, label: 'Results', active: false },
+    { icon: Database, label: 'System Logs', active: false },
+    { icon: Settings, label: 'Settings', active: false }
+  ];
+
+  return (
+    <div className="flex min-h-screen bg-gray-900">
+      {/* Sidebar */}
+      <aside className="w-64 bg-gray-800 border-r border-gray-700">
+        <div className="p-6 pb-8">
+          <h2 className="text-xl font-semibold text-white">OEM Mini</h2>
+        </div>
+        
+        <nav className="flex flex-col">
+          {navItems.map((item, index) => (
+            <a
+              key={index}
+              href="#"
+              className={`flex items-center gap-3 px-6 py-4 text-sm transition-all ${
+                item.active
+                  ? 'bg-blue-600 text-white border-l-4 border-blue-400'
+                  : 'text-gray-300 hover:bg-gray-700 hover:text-white'
+              }`}
+            >
+              <item.icon size={18} />
+              <span>{item.label}</span>
+            </a>
+          ))}
+        </nav>
+      </aside>
+
+      {/* Main Content */}
+      <main className="flex-1 p-8 overflow-y-auto">
+        <div className="mb-8">
+          <h1 className="text-3xl font-semibold text-white">Dashboard</h1>
+        </div>
+
+        <div className="grid grid-cols-1 xl:grid-cols-3 gap-8">
+          {/* Left Column - Spans 2 columns */}
+          <div className="xl:col-span-2 space-y-8">
+            {/* Stats Cards */}
+            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
+              {/* Total Students */}
+              <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+                <h3 className="text-sm text-gray-400 mb-3">Total Students</h3>
+                <div className="text-4xl font-bold text-white mb-2">
+                  {loading ? '...' : stats.totalStudents.toLocaleString()}
+                </div>
+                <div className="flex items-center gap-1 text-green-400 text-xs">
+                  <TrendingUp size={14} />
+                  <span>+{loading ? '...' : stats.studentGrowth}% since last month</span>
+                </div>
+              </div>
+
+              {/* Total Instructors */}
+              <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+                <h3 className="text-sm text-gray-400 mb-3">Total Instructors</h3>
+                <div className="text-4xl font-bold text-white mb-2">
+                  {loading ? '...' : stats.totalInstructors.toLocaleString()}
+                </div>
+                <div className="flex items-center gap-1 text-green-400 text-xs">
+                  <TrendingUp size={14} />
+                  <span>+{loading ? '...' : stats.instructorGrowth}% since last month</span>
+                </div>
+              </div>
+
+              {/* Total Exams */}
+              <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+                <h3 className="text-sm text-gray-400 mb-3">Total Exams Uploaded</h3>
+                <div className="text-4xl font-bold text-white mb-2">
+                  {loading ? '...' : stats.totalExamsUploaded.toLocaleString()}
+                </div>
+                <div className="flex items-center gap-1 text-green-400 text-xs">
+                  <TrendingUp size={14} />
+                  <span>+{loading ? '...' : stats.examGrowth}% since last month</span>
+                </div>
+              </div>
+            </div>
+
+            {/* User Growth Chart */}
+            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+              <h2 className="text-lg font-semibold text-white mb-6">
+                User Growth Statistics (Last 12 Months)
+              </h2>
+              <ResponsiveContainer width="100%" height={300}>
+                <BarChart data={userGrowthData}>
+                  <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
+                  <XAxis 
+                    dataKey="month" 
+                    stroke="#9CA3AF" 
+                    style={{ fontSize: '12px' }}
+                  />
+                  <YAxis 
+                    stroke="#9CA3AF" 
+                    style={{ fontSize: '12px' }}
+                  />
+                  <Tooltip 
+                    contentStyle={{ 
+                      backgroundColor: '#1F2937', 
+                      border: 'none', 
+                      borderRadius: '8px',
+                      color: '#fff'
+                    }}
+                  />
+                  <Line 
+                    type="monotone" 
+                    dataKey="users" 
+                    stroke="#3B82F6" 
+                    strokeWidth={2} 
+                    dot={false}
+                  />
+                  <Bar 
+                    dataKey="value" 
+                    fill="#2563EB" 
+                    radius={[4, 4, 0, 0]} 
+                  />
+                </BarChart>
+              </ResponsiveContainer>
+            </div>
+
+            {/* User Growth List */}
+            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+              <h2 className="text-lg font-semibold text-white mb-6">User Growth</h2>
+              <div className="space-y-4">
+                {recentUsers.map((user) => (
+                  <div key={user.id} className="flex items-center gap-3">
+                    <div className="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center font-semibold text-white">
+                      {user.initial}
+                    </div>
+                    <span className="text-white text-sm">{user.name}</span>
+                  </div>
+                ))}
+              </div>
+            </div>
+          </div>
+
+          {/* Right Column */}
+          <div className="space-y-8">
+            {/* Courses Stats */}
+            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+              <h2 className="text-lg font-semibold text-white mb-6">Dashboard</h2>
+              <div className="grid grid-cols-2 gap-4">
+                <div>
+                  <h3 className="text-sm text-gray-400 mb-3 leading-tight">
+                    Total<br />Rooms
+                  </h3>
+                  <div className="text-5xl font-bold text-white">
+                    {loading ? '...' : stats.totalExams}
+                  </div>
+                </div>
+                <div>
+                  <h3 className="text-sm text-gray-400 mb-3 leading-tight">
+                    Published<br />Rooms
+                  </h3>
+                  <div className="text-5xl font-bold text-white">
+                    {loading ? '...' : stats.publishedRooms}
+                  </div>
+                </div>
+              </div>
+            </div>
+
+            {/* Upcoming Exams */}
+            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+              <h2 className="text-lg font-semibold text-white mb-6">Upcoming Exams</h2>
+              
+              <div className="space-y-4">
+                <div className="flex justify-between items-start">
+                  <div className="text-white font-medium">Python Basics</div>
+                  <div className="text-gray-400 text-sm">MCQ</div>
+                </div>
+                
+                <div className="flex justify-between items-center text-sm">
+                  <span className="text-gray-400">MCQ</span>
+                  <span className="text-gray-400">Not Started</span>
+                </div>
+                
+                <button className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors">
+                  Start Exam
+                </button>
+              </div>
+            </div>
+
+            {/* Performance Chart */}
+            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+              <h2 className="text-lg font-semibold text-white mb-6">Performance</h2>
+              <ResponsiveContainer width="100%" height={200}>
+                <AreaChart data={performanceData}>
+                  <defs>
+                    <linearGradient id="colorScore" x1="0" y1="0" x2="0" y2="1">
+                      <stop offset="5%" stopColor="#3B82F6" stopOpacity={0.3}/>
+                      <stop offset="95%" stopColor="#3B82F6" stopOpacity={0}/>
+                    </linearGradient>
+                  </defs>
+                  <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
+                  <XAxis 
+                    dataKey="exam" 
+                    stroke="#9CA3AF" 
+                    style={{ fontSize: '11px' }}
+                  />
+                  <YAxis 
+                    stroke="#9CA3AF" 
+                    style={{ fontSize: '11px' }}
+                  />
+                  <Tooltip 
+                    contentStyle={{ 
+                      backgroundColor: '#1F2937', 
+                      border: 'none', 
+                      borderRadius: '8px',
+                      color: '#fff'
+                    }}
+                  />
+                  <Area 
+                    type="monotone" 
+                    dataKey="score" 
+                    stroke="#3B82F6" 
+                    strokeWidth={2}
+                    fillOpacity={1} 
+                    fill="url(#colorScore)" 
+                  />
+                </AreaChart>
+              </ResponsiveContainer>
+            </div>
+
+            {/* Additional Performance Card */}
+            <div className="bg-gray-800 border border-gray-700 rounded-lg p-6">
+              <h2 className="text-lg font-semibold text-white mb-6">Performance</h2>
+              <div className="h-32 flex items-center justify-center text-gray-400">
+                Additional metrics coming soon...
+              </div>
+            </div>
+          </div>
+        </div>
+      </main>
+    </div>
+  );
+};
+
 export default AdminDashboard;
\ No newline at end of file
diff --git a/frontend/src/pages/instructorPage/AssignExam.jsx b/frontend/src/pages/instructorPage/AssignExam.jsx
index a231440..c63663b 100644
--- a/frontend/src/pages/instructorPage/AssignExam.jsx
+++ b/frontend/src/pages/instructorPage/AssignExam.jsx
@@ -1,234 +1,234 @@
-// üìÅ AssignExam.jsx
-import React, { useState, useEffect } from "react";
-import {
-  FiPlus,
-  FiSearch,
-  FiEdit,
-  FiTrash2,
-  FiSettings,
-  FiChevronLeft,
-  FiChevronRight,
-  FiClock,
-  FiHash,
-  FiFileText,
-} from "react-icons/fi";
-import axios from "axios";
-import LoadingSpinner from "../../components/LoadingSpinner";
-import { useNavigate } from "react-router-dom";
-import { timeAgo } from "../../../../backend/src/utils/timeAgo";
-
-const AssignExam = () => {
-  const [exams, setExams] = useState([]);
-  const [loading, setLoading] = useState(true);
-  const [error, setError] = useState("");
-  const [searchTerm, setSearchTerm] = useState("");
-  const [filterStatus, setFilterStatus] = useState("all");
-  const [currentPage, setCurrentPage] = useState(1);
-  const [totalPages, setTotalPages] = useState(1);
-
-  const navigate = useNavigate();
-  const token = localStorage.getItem("token");
-
-  const fetchExams = async () => {
-    try {
-      setLoading(true);
-      setError("");
-
-      const response = await axios.get(
-        `http://localhost:5000/api/assign-bank/exams`,
-        {
-          headers: { Authorization: `Bearer ${token}` },
-          params: {
-            page: currentPage,
-            limit: 10,
-            search: searchTerm || undefined,
-            status: filterStatus === "all" ? undefined : filterStatus,
-          },
-        }
-      );
-
-      const { data, pagination } = response.data;
-      setExams(data);
-      setTotalPages(pagination.totalPages || 1);
-    } catch (err) {
-      const msg =
-        err.response?.data?.message ||
-        "Kh√¥ng th·ªÉ t·∫£i danh s√°ch ƒë·ªÅ thi. Vui l√≤ng th·ª≠ l·∫°i.";
-      setError(msg);
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  useEffect(() => {
-    fetchExams();
-  }, [currentPage, searchTerm, filterStatus]);
-
-  const handleDelete = async (id) => {
-    if (!window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ƒë·ªÅ thi n√†y?")) return;
-    try {
-      await axios.delete(`http://localhost:5000/api/assign-bank/exams/${id}`, {
-        headers: { Authorization: `Bearer ${token}` },
-      });
-      alert("X√≥a ƒë·ªÅ thi th√†nh c√¥ng!");
-      fetchExams();
-    } catch (err) {
-      const msg =
-        err.response?.data?.message || "X√≥a ƒë·ªÅ thi th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i.";
-      alert(msg);
-    }
-  };
-
-  const handlePublish = async (id) => {
-    if (!window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën m·ªü ph√≤ng thi?")) return;
-    try {
-      await axios.post(
-        `http://localhost:5000/api/assign-bank/exams/${id}/publish`,
-        {},
-        { headers: { Authorization: `Bearer ${token}` } }
-      );
-      alert("M·ªü ph√≤ng thi th√†nh c√¥ng!");
-      fetchExams();
-    } catch (err) {
-      const msg =
-        err.response?.data?.message ||
-        "Kh√¥ng th·ªÉ m·ªü ph√≤ng thi. Vui l√≤ng th·ª≠ l·∫°i.";
-      alert(msg);
-    }
-  };
-
-  const filteredExams = exams.filter((exam) => {
-    const matchesSearch = exam.title
-      .toLowerCase()
-      .includes(searchTerm.toLowerCase());
-    const matchesFilter =
-      filterStatus === "all" || exam.status === filterStatus;
-    return matchesSearch && matchesFilter;
-  });
-
-  return (
-    <div className="min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50 p-4 md:p-8">
-      <div className="max-w-7xl mx-auto">
-        {/* Header */}
-        <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
-          <div>
-            <h1 className="text-3xl font-bold text-gray-900">
-              Ng√¢n h√†ng ƒë·ªÅ thi
-            </h1>
-            <p className="text-gray-600 mt-1">
-              Qu·∫£n l√Ω v√† ph√¢n c√¥ng ƒë·ªÅ thi cho h·ªçc vi√™n
-            </p>
-          </div>
-          <button
-            onClick={() => navigate("/instructor/upload-exam")}
-            className="flex items-center gap-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-5 py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all"
-          >
-            <FiPlus className="w-5 h-5" />
-            T·∫°o ƒë·ªÅ thi m·ªõi
-          </button>
-        </div>
-
-        {/* Toolbar */}
-        <div className="bg-white rounded-2xl shadow-sm p-5 mb-6">
-          <div className="flex flex-col md:flex-row gap-4">
-            <div className="flex-1 relative">
-              <FiSearch className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5" />
-              <input
-                type="text"
-                placeholder="T√¨m ki·∫øm ƒë·ªÅ thi..."
-                value={searchTerm}
-                onChange={(e) => setSearchTerm(e.target.value)}
-                className="w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500"
-              />
-            </div>
-            <select
-              value={filterStatus}
-              onChange={(e) => setFilterStatus(e.target.value)}
-              className="px-5 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500"
-            >
-              <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
-              <option value="draft">Nh√°p</option>
-              <option value="published">ƒê√£ m·ªü</option>
-            </select>
-          </div>
-        </div>
-
-        {error && (
-          <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl mb-6">
-            {error}
-          </div>
-        )}
-
-        {loading ? (
-          <div className="flex justify-center py-16">
-            <LoadingSpinner size="lg" />
-          </div>
-        ) : filteredExams.length === 0 ? (
-          <div className="text-center py-16 bg-white rounded-2xl shadow-sm">
-            <p className="text-gray-500 mb-4">Ch∆∞a c√≥ ƒë·ªÅ thi n√†o</p>
-            <button
-              onClick={() => navigate("/instructor/upload-exam")}
-              className="text-purple-600 hover:underline"
-            >
-              T·∫°o ƒë·ªÅ thi ƒë·∫ßu ti√™n
-            </button>
-          </div>
-        ) : (
-          <div className="space-y-4">
-            {filteredExams.map((exam) => (
-              <div
-                key={exam.id}
-                className="bg-white rounded-2xl shadow-sm p-6 hover:shadow-lg transition-all"
-              >
-                <div className="flex items-center justify-between">
-                  <div>
-                    <h3 className="text-lg font-semibold text-gray-900">
-                      {exam.title}
-                    </h3>
-                    <div className="flex items-center  gap-6 mt-3 text-sm text-gray-600">
-                      <div className="flex items-center gap-2">
-                        <FiHash className="w-4 h-4" />
-                        <span>{exam.exam_room_code || "Ch∆∞a m·ªü ph√≤ng"}</span>
-                      </div>
-                      <div className="flex items-center gap-2">
-                        <FiFileText className="w-4 h-4" />
-                        <span>
-                          {exam.status === "draft" ? "Nh√°p" : "ƒê√£ m·ªü"}
-                        </span>
-                      </div>
-                      <div className="flex items-center gap-2 text-gray-400 text-sm">
-                        <span>ƒê√£ ƒë·∫©y ƒë·ªÅ thi t·ª´ {timeAgo(exam.created_at)}</span>
-                      </div>
-                    </div>
-                  </div>
-
-                  <div className="flex items-center gap-2">
-                    <button
-                      onClick={() =>
-                        navigate(`/instructor/exams/${exam.id}/edit`)
-                      }
-                      className="p-3 text-blue-600 hover:bg-blue-50 rounded-xl"
-                      title="Ch·ªânh s·ª≠a ƒë·ªÅ thi"
-                    >
-                      <FiEdit className="w-5 h-5" />
-                    </button>
-
-                    <button
-                      onClick={() => handleDelete(exam.id)}
-                      className="p-3 text-red-600 hover:bg-red-50 rounded-xl"
-                      title="X√≥a"
-                    >
-                      <FiTrash2 className="w-5 h-5" />
-                    </button>
-                  </div>
-                </div>
-              </div>
-            ))}
-          </div>
-        )}
-      </div>
-    </div>
-  );
-};
-
-export default AssignExam;
+// üìÅ AssignExam.jsx
+import React, { useState, useEffect } from "react";
+import {
+  FiPlus,
+  FiSearch,
+  FiEdit,
+  FiTrash2,
+  FiSettings,
+  FiChevronLeft,
+  FiChevronRight,
+  FiClock,
+  FiHash,
+  FiFileText,
+} from "react-icons/fi";
+import axios from "axios";
+import LoadingSpinner from "../../components/LoadingSpinner";
+import { useNavigate } from "react-router-dom";
+import { timeAgo } from "../../../../backend/src/utils/timeAgo";
+
+const AssignExam = () => {
+  const [exams, setExams] = useState([]);
+  const [loading, setLoading] = useState(true);
+  const [error, setError] = useState("");
+  const [searchTerm, setSearchTerm] = useState("");
+  const [filterStatus, setFilterStatus] = useState("all");
+  const [currentPage, setCurrentPage] = useState(1);
+  const [totalPages, setTotalPages] = useState(1);
+
+  const navigate = useNavigate();
+  const token = localStorage.getItem("token");
+
+  const fetchExams = async () => {
+    try {
+      setLoading(true);
+      setError("");
+
+      const response = await axios.get(
+        `http://localhost:5000/api/assign-bank/exams`,
+        {
+          headers: { Authorization: `Bearer ${token}` },
+          params: {
+            page: currentPage,
+            limit: 10,
+            search: searchTerm || undefined,
+            status: filterStatus === "all" ? undefined : filterStatus,
+          },
+        }
+      );
+
+      const { data, pagination } = response.data;
+      setExams(data);
+      setTotalPages(pagination.totalPages || 1);
+    } catch (err) {
+      const msg =
+        err.response?.data?.message ||
+        "Kh√¥ng th·ªÉ t·∫£i danh s√°ch ƒë·ªÅ thi. Vui l√≤ng th·ª≠ l·∫°i.";
+      setError(msg);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  useEffect(() => {
+    fetchExams();
+  }, [currentPage, searchTerm, filterStatus]);
+
+  const handleDelete = async (id) => {
+    if (!window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a ƒë·ªÅ thi n√†y?")) return;
+    try {
+      await axios.delete(`http://localhost:5000/api/assign-bank/exams/${id}`, {
+        headers: { Authorization: `Bearer ${token}` },
+      });
+      alert("X√≥a ƒë·ªÅ thi th√†nh c√¥ng!");
+      fetchExams();
+    } catch (err) {
+      const msg =
+        err.response?.data?.message || "X√≥a ƒë·ªÅ thi th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i.";
+      alert(msg);
+    }
+  };
+
+  const handlePublish = async (id) => {
+    if (!window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën m·ªü ph√≤ng thi?")) return;
+    try {
+      await axios.post(
+        `http://localhost:5000/api/assign-bank/exams/${id}/publish`,
+        {},
+        { headers: { Authorization: `Bearer ${token}` } }
+      );
+      alert("M·ªü ph√≤ng thi th√†nh c√¥ng!");
+      fetchExams();
+    } catch (err) {
+      const msg =
+        err.response?.data?.message ||
+        "Kh√¥ng th·ªÉ m·ªü ph√≤ng thi. Vui l√≤ng th·ª≠ l·∫°i.";
+      alert(msg);
+    }
+  };
+
+  const filteredExams = exams.filter((exam) => {
+    const matchesSearch = exam.title
+      .toLowerCase()
+      .includes(searchTerm.toLowerCase());
+    const matchesFilter =
+      filterStatus === "all" || exam.status === filterStatus;
+    return matchesSearch && matchesFilter;
+  });
+
+  return (
+    <div className="min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50 p-4 md:p-8">
+      <div className="max-w-7xl mx-auto">
+        {/* Header */}
+        <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
+          <div>
+            <h1 className="text-3xl font-bold text-gray-900">
+              Ng√¢n h√†ng ƒë·ªÅ thi
+            </h1>
+            <p className="text-gray-600 mt-1">
+              Qu·∫£n l√Ω v√† ph√¢n c√¥ng ƒë·ªÅ thi cho h·ªçc vi√™n
+            </p>
+          </div>
+          <button
+            onClick={() => navigate("/instructor/upload-exam")}
+            className="flex items-center gap-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-5 py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transform hover:scale-105 transition-all"
+          >
+            <FiPlus className="w-5 h-5" />
+            T·∫°o ƒë·ªÅ thi m·ªõi
+          </button>
+        </div>
+
+        {/* Toolbar */}
+        <div className="bg-white rounded-2xl shadow-sm p-5 mb-6">
+          <div className="flex flex-col md:flex-row gap-4">
+            <div className="flex-1 relative">
+              <FiSearch className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5" />
+              <input
+                type="text"
+                placeholder="T√¨m ki·∫øm ƒë·ªÅ thi..."
+                value={searchTerm}
+                onChange={(e) => setSearchTerm(e.target.value)}
+                className="w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500"
+              />
+            </div>
+            <select
+              value={filterStatus}
+              onChange={(e) => setFilterStatus(e.target.value)}
+              className="px-5 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500"
+            >
+              <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
+              <option value="draft">Nh√°p</option>
+              <option value="published">ƒê√£ m·ªü</option>
+            </select>
+          </div>
+        </div>
+
+        {error && (
+          <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl mb-6">
+            {error}
+          </div>
+        )}
+
+        {loading ? (
+          <div className="flex justify-center py-16">
+            <LoadingSpinner size="lg" />
+          </div>
+        ) : filteredExams.length === 0 ? (
+          <div className="text-center py-16 bg-white rounded-2xl shadow-sm">
+            <p className="text-gray-500 mb-4">Ch∆∞a c√≥ ƒë·ªÅ thi n√†o</p>
+            <button
+              onClick={() => navigate("/instructor/upload-exam")}
+              className="text-purple-600 hover:underline"
+            >
+              T·∫°o ƒë·ªÅ thi ƒë·∫ßu ti√™n
+            </button>
+          </div>
+        ) : (
+          <div className="space-y-4">
+            {filteredExams.map((exam) => (
+              <div
+                key={exam.id}
+                className="bg-white rounded-2xl shadow-sm p-6 hover:shadow-lg transition-all"
+              >
+                <div className="flex items-center justify-between">
+                  <div>
+                    <h3 className="text-lg font-semibold text-gray-900">
+                      {exam.title}
+                    </h3>
+                    <div className="flex items-center  gap-6 mt-3 text-sm text-gray-600">
+                      <div className="flex items-center gap-2">
+                        <FiHash className="w-4 h-4" />
+                        <span>{exam.exam_room_code || "Ch∆∞a m·ªü ph√≤ng"}</span>
+                      </div>
+                      <div className="flex items-center gap-2">
+                        <FiFileText className="w-4 h-4" />
+                        <span>
+                          {exam.status === "draft" ? "Nh√°p" : "ƒê√£ m·ªü"}
+                        </span>
+                      </div>
+                      <div className="flex items-center gap-2 text-gray-400 text-sm">
+                        <span>ƒê√£ ƒë·∫©y ƒë·ªÅ thi t·ª´ {timeAgo(exam.created_at)}</span>
+                      </div>
+                    </div>
+                  </div>
+
+                  <div className="flex items-center gap-2">
+                    <button
+                      onClick={() =>
+                        navigate(`/instructor/exams/${exam.id}/edit`)
+                      }
+                      className="p-3 text-blue-600 hover:bg-blue-50 rounded-xl"
+                      title="Ch·ªânh s·ª≠a ƒë·ªÅ thi"
+                    >
+                      <FiEdit className="w-5 h-5" />
+                    </button>
+
+                    <button
+                      onClick={() => handleDelete(exam.id)}
+                      className="p-3 text-red-600 hover:bg-red-50 rounded-xl"
+                      title="X√≥a"
+                    >
+                      <FiTrash2 className="w-5 h-5" />
+                    </button>
+                  </div>
+                </div>
+              </div>
+            ))}
+          </div>
+        )}
+      </div>
+    </div>
+  );
+};
+
+export default AssignExam;
diff --git a/frontend/src/pages/instructorPage/EditExam.jsx b/frontend/src/pages/instructorPage/EditExam.jsx
index 876e397..6ca2dba 100644
--- a/frontend/src/pages/instructorPage/EditExam.jsx
+++ b/frontend/src/pages/instructorPage/EditExam.jsx
@@ -1,840 +1,840 @@
-// üìÅ src/pages/instructor/EditExam.jsx
-import React, { useEffect, useState } from "react";
-import { useParams, useNavigate } from "react-router-dom";
-import { FiTrash2, FiPlus, FiX } from "react-icons/fi";
-import axios from "axios";
-import LoadingSpinner from "../../components/LoadingSpinner";
-import * as XLSX from "xlsx";
-
-const EditExam = () => {
-  const { id } = useParams();
-  const navigate = useNavigate();
-  const token = localStorage.getItem("token");
-
-  const [editingExam, setEditingExam] = useState(null);
-  const [loading, setLoading] = useState(true);
-  const [errorMessage, setErrorMessage] = useState("");
-
-  // Upload states
-  const [selectedFile, setSelectedFile] = useState(null);
-  const [parsedQuestions, setParsedQuestions] = useState([]);
-  const [newQuestions, setNewQuestions] = useState([]);
-  const [previewOpen, setPreviewOpen] = useState(false);
-
-  useEffect(() => {
-    const fetchExam = async () => {
-      try {
-        const res = await axios.get(
-          `http://localhost:5000/api/edit-exam/exams/${id}/edit`,
-          { headers: { Authorization: `Bearer ${token}` } }
-        );
-        const processedQuestions = res.data.questions.map((q) => {
-          if (q.type?.toLowerCase() === "essay") {
-            const match = q.content?.match(
-              /(.*)\((\d+(?:\.\d+)?)\s*ƒë\)\s*C√¢u tr·∫£ l·ªùi:\s*(.*)/i
-            );
-            if (match) {
-              q.content = match[1].trim();
-              q.points = parseFloat(match[2]);
-              q.modelAnswer = match[3].trim();
-            }
-            if (!q.modelAnswer) q.modelAnswer = "";
-          }
-          if (!q.points) q.points = q.points === 0 ? 0 : q.points || 0.1;
-          if (!q.options) q.options = [];
-          return q;
-        });
-        setEditingExam({ ...res.data, questions: processedQuestions });
-      } catch (err) {
-        alert("Kh√¥ng th·ªÉ t·∫£i chi ti·∫øt ƒë·ªÅ thi!");
-        navigate("/assign-exam");
-      } finally {
-        setLoading(false);
-      }
-    };
-    fetchExam();
-  }, [id, token, navigate]);
-
-  // ---------- Helpers ----------
-  const normalizeType = (t) =>
-    (t || "").toString().toLowerCase() === "essay" ? "essay" : "MCQ";
-
-  const computeTotalPoints = (questions) =>
-    Math.round(
-      (questions.reduce((s, q) => s + (parseFloat(q.points) || 0), 0) +
-        Number.EPSILON) *
-        10
-    ) / 10;
-
-  // ---------- Save exam ----------
-  const handleSaveExam = async () => {
-    const totalPoints = computeTotalPoints(editingExam.questions);
-    if (totalPoints !== 10) {
-      setErrorMessage(
-        `T·ªïng ƒëi·ªÉm hi·ªán t·∫°i l√† ${totalPoints.toFixed(
-          1
-        )}. T·ªïng ƒëi·ªÉm ph·∫£i b·∫±ng 10 ƒë·ªÉ l∆∞u b√†i thi!`
-      );
-      return;
-    }
-
-    if (!editingExam.title?.trim()) {
-      alert("Ti√™u ƒë·ªÅ ƒë·ªÅ thi kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!");
-      return;
-    }
-
-    try {
-      const updatedQuestions = editingExam.questions.map((q) => ({
-        ...q,
-        type: normalizeType(q.type),
-      }));
-
-      await axios.put(
-        `http://localhost:5000/api/edit-exam/exams/${id}`,
-        { ...editingExam, questions: updatedQuestions },
-        { headers: { Authorization: `Bearer ${token}` } }
-      );
-      alert("C·∫≠p nh·∫≠t ƒë·ªÅ thi th√†nh c√¥ng!");
-      navigate("/assign-exam");
-    } catch (err) {
-      alert("C·∫≠p nh·∫≠t ƒë·ªÅ thi th·∫•t b·∫°i!");
-    }
-  };
-
-  // ---------- File select & parse ----------
-  const handleFileSelect = (e) => {
-    setSelectedFile(e.target.files?.[0] || null);
-    setParsedQuestions([]);
-    setNewQuestions([]);
-    setPreviewOpen(false);
-  };
-
-  const parseExcelToQuestions = (workbook) => {
-    const sheetName = workbook.SheetNames[0];
-    const sheet = workbook.Sheets[sheetName];
-    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: "" });
-    const dataRows = rows.slice(1);
-
-    const questionsFromFile = dataRows
-      .map((row, rowIdx) => {
-        const rawType = (row[0] || "").toString().trim();
-        if (!rawType) return null;
-
-        const type = normalizeType(rawType);
-        const content = (row[1] || "").toString().trim();
-        const points = parseFloat(row[2]) || 0;
-        if (!content) return null;
-
-        // --- MCQ ---
-        if (type === "MCQ") {
-          const opts = ["A", "B", "C", "D"]
-            .map((letter, i) => {
-              const txt = (row[3 + i] || "").toString().trim();
-              return txt
-                ? {
-                    tempId: `${rowIdx}-${letter}`,
-                    content: txt,
-                    is_correct: false,
-                  }
-                : null;
-            })
-            .filter(Boolean);
-
-          const correct = ((row[7] || "") + "").toString().trim().toUpperCase();
-          opts.forEach((o) => {
-            if (o.tempId.endsWith(`-${correct}`)) o.is_correct = true;
-          });
-
-          return { type: "MCQ", content, points, options: opts };
-        }
-
-        // --- ESSAY ---
-        const modelAnswer = (row[3] || "").toString().trim();
-        return { type: "essay", content, points, modelAnswer };
-      })
-      .filter(Boolean);
-
-    return questionsFromFile;
-  };
-
-  const areMCQEqual = (a, b) => {
-    if (a.content?.trim() !== b.content?.trim()) return false;
-    if ((a.options?.length || 0) !== (b.options?.length || 0)) return false;
-    for (let i = 0; i < a.options.length; i++) {
-      const oa = (a.options[i].content || "").trim();
-      const ob = (b.options[i]?.content || "").trim();
-      if (oa !== ob) return false;
-      if (!!a.options[i].is_correct !== !!b.options[i].is_correct) return false;
-    }
-    return true;
-  };
-
-  const areEssayEqual = (a, b) => {
-    return (
-      (a.content || "").trim() === (b.content || "").trim() &&
-      (a.modelAnswer || "").trim() === (b.modelAnswer || "").trim()
-    );
-  };
-
-  const isDuplicateAgainstExisting = (qFromFile, existingQs) => {
-    return existingQs.some((exist) => {
-      if (normalizeType(exist.type) !== normalizeType(qFromFile.type))
-        return false;
-      if (qFromFile.type === "MCQ") return areMCQEqual(qFromFile, exist);
-      return areEssayEqual(qFromFile, exist);
-    });
-  };
-
-  const handleAnalyzeFile = () => {
-    if (!selectedFile) {
-      alert("Vui l√≤ng ch·ªçn file Excel tr∆∞·ªõc.");
-      return;
-    }
-    const reader = new FileReader();
-    reader.onload = (evt) => {
-      try {
-        const data = new Uint8Array(evt.target.result);
-        const workbook = XLSX.read(data, { type: "array" });
-        const fileQuestions = parseExcelToQuestions(workbook);
-        setParsedQuestions(fileQuestions);
-
-        const existing = editingExam.questions || [];
-        const uniques = fileQuestions.filter(
-          (fq) => !isDuplicateAgainstExisting(fq, existing)
-        );
-
-        if (uniques.length === 0) {
-          alert(
-            "Kh√¥ng c√≥ c√¢u h·ªèi m·ªõi n√†o trong file, vui l√≤ng th√™m c√¢u h·ªèi m·ªõi ƒë·ªÉ c·∫≠p nh·∫≠t"
-          );
-          setNewQuestions([]);
-          setPreviewOpen(false);
-          return;
-        }
-
-        const withSelected = uniques.map((q, i) => ({
-          ...q,
-          selected: true,
-          tempId: `preview-${Date.now()}-${i}`,
-        }));
-        setNewQuestions(withSelected);
-        setPreviewOpen(true);
-      } catch (err) {
-        console.error(err);
-        alert("ƒê·ªçc file th·∫•t b·∫°i. Vui l√≤ng ki·ªÉm tra file Excel.");
-      }
-    };
-    reader.readAsArrayBuffer(selectedFile);
-  };
-
-  // ------------ Preview / add flow -------------
-  const updatePreviewQuestion = (tempId, patch) => {
-    setNewQuestions((prev) =>
-      prev.map((q) => (q.tempId === tempId ? { ...q, ...patch } : q))
-    );
-  };
-
-  const toggleSelectPreview = (tempId) => {
-    setNewQuestions((prev) =>
-      prev.map((q) =>
-        q.tempId === tempId ? { ...q, selected: !q.selected } : q
-      )
-    );
-  };
-
-  const handleAddSelectedQuestionsToExam = () => {
-    const selected = newQuestions.filter((q) => q.selected);
-    if (selected.length === 0) {
-      alert("Ch∆∞a ch·ªçn c√¢u h·ªèi n√†o ƒë·ªÉ th√™m.");
-      return;
-    }
-
-    const currentTotal = computeTotalPoints(editingExam.questions);
-    const addTotal = computeTotalPoints(selected);
-    const newTotal = Math.round((currentTotal + addTotal) * 10) / 10;
-    if (newTotal !== 10) {
-      alert(
-        `T·ªïng ƒëi·ªÉm sau khi th√™m s·∫Ω l√† ${newTotal.toFixed(
-          1
-        )}. T·ªïng ƒëi·ªÉm c·ªßa ƒë·ªÅ ph·∫£i b·∫±ng 10. Vui l√≤ng ƒëi·ªÅu ch·ªânh ƒëi·ªÉm tr∆∞·ªõc khi th√™m.`
-      );
-      return;
-    }
-
-    const assigned = selected.map((q, i) => {
-      const baseId = Date.now() + i + Math.floor(Math.random() * 1000);
-      if (normalizeType(q.type) === "MCQ") {
-        const options = q.options.map((o, idx) => ({
-          id: baseId + 100 + idx,
-          content: o.content,
-          is_correct: o.is_correct,
-        }));
-        return {
-          id: baseId,
-          type: "MCQ",
-          content: q.content,
-          points: parseFloat(q.points) || 0.1,
-          options,
-        };
-      } else {
-        return {
-          id: baseId,
-          type: "essay",
-          content: q.content,
-          points: parseFloat(q.points) || 0.1,
-          modelAnswer: q.modelAnswer || "",
-        };
-      }
-    });
-
-    setEditingExam((prev) => ({
-      ...prev,
-      questions: [...prev.questions, ...assigned],
-    }));
-
-    setNewQuestions([]);
-    setParsedQuestions([]);
-    setSelectedFile(null);
-    setPreviewOpen(false);
-    alert(
-      "ƒê√£ th√™m c√°c c√¢u ch·ªçn v√†o b√†i thi. Nh·ªõ nh·∫•n L∆∞u thay ƒë·ªïi ƒë·ªÉ c·∫≠p nh·∫≠t l√™n server."
-    );
-  };
-
-  // ---------- render ----------
-  if (loading) return <LoadingSpinner size="lg" />;
-  if (!editingExam)
-    return (
-      <div className="p-6 text-center text-gray-600">Kh√¥ng c√≥ d·ªØ li·ªáu</div>
-    );
-
-  const mcqQuestions = editingExam.questions.filter(
-    (q) => normalizeType(q.type) === "MCQ"
-  );
-  const essayQuestions = editingExam.questions.filter(
-    (q) => normalizeType(q.type) === "essay"
-  );
-
-  return (
-    <div className="min-h-screen p-4 md:p-8">
-      <div className="max-w-full mx-auto bg-white rounded-2xl shadow-2xl p-6">
-        {/* Header */}
-        <div className="flex justify-between items-center mb-6">
-          <h2 className="text-2xl font-bold text-gray-900">Ch·ªânh s·ª≠a ƒë·ªÅ thi</h2>
-          <button
-            onClick={() => navigate("/assign-exam")}
-            className="text-gray-500 hover:text-gray-700"
-          >
-            <FiX className="w-6 h-6" />
-          </button>
-        </div>
-
-        {errorMessage && (
-          <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl mb-6">
-            {errorMessage}
-          </div>
-        )}
-
-        {/* Title */}
-        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
-          <div>
-            <label className="block text-sm font-medium text-gray-700 mb-1">
-              Ti√™u ƒë·ªÅ ƒë·ªÅ thi
-            </label>
-            <input
-              type="text"
-              value={editingExam.title}
-              onChange={(e) =>
-                setEditingExam({ ...editingExam, title: e.target.value })
-              }
-              className="w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
-            />
-          </div>
-
-          {/* UPLOAD PANEL */}
-          <div className="space-y-3">
-            <label className="block text-sm font-semibold text-gray-800">
-              Upload c√¢u h·ªèi t·ª´ file Excel
-            </label>
-
-            <div className="flex items-center gap-3">
-              <label
-                htmlFor="excel-upload"
-                className={`
-                  flex-1 flex items-center justify-center gap-2
-                  px-4 py-3 rounded-xl border-2 border-dashed
-                  ${
-                    selectedFile
-                      ? "border-green-500 bg-green-50"
-                      : "border-gray-300 hover:border-gray-400"
-                  }
-                  cursor-pointer transition-colors duration-200
-                `}
-              >
-                <span className="text-sm font-medium text-gray-700 truncate">
-                  {selectedFile ? selectedFile.name : "Ch·ªçn file .xlsx / .xls"}
-                </span>
-              </label>
-
-              <input
-                id="excel-upload"
-                type="file"
-                accept=".xlsx,.xls"
-                onChange={handleFileSelect}
-                className="hidden"
-              />
-            </div>
-
-            <div className="flex gap-2">
-              <button
-                onClick={handleAnalyzeFile}
-                disabled={!selectedFile}
-                className={`
-                  flex-1 flex items-center justify-center gap-2
-                  px-4 py-2.5 rounded-xl font-medium text-sm transition-all
-                  ${
-                    selectedFile
-                      ? "bg-blue-600 hover:bg-blue-700 text-white shadow-md"
-                      : "bg-gray-200 text-gray-400 cursor-not-allowed"
-                  }
-                `}
-              >
-                <svg
-                  className="w-4 h-4"
-                  fill="none"
-                  stroke="currentColor"
-                  viewBox="0 0 24 24"
-                >
-                  <path
-                    strokeLinecap="round"
-                    strokeLinejoin="round"
-                    strokeWidth={2}
-                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
-                  />
-                </svg>
-                Ph√¢n t√≠ch file
-              </button>
-
-              <button
-                onClick={() => {
-                  setSelectedFile(null);
-                  setParsedQuestions([]);
-                  setNewQuestions([]);
-                  setPreviewOpen(false);
-                }}
-                className={`
-                  px-4 py-2.5 rounded-xl font-medium text-sm border
-                  ${
-                    selectedFile
-                      ? "border-gray-300 text-gray-700 hover:bg-gray-50"
-                      : "border-gray-200 text-gray-400 cursor-not-allowed"
-                  }
-                  transition-colors
-                `}
-              >
-                H·ªßy
-              </button>
-            </div>
-
-            <p className="text-xs text-gray-500 leading-relaxed">
-              <span className="font-medium">Format:</span> type (MCQ/essay),
-              content, points, optionA..D (MCQ), correctOption (A/B/C/D),
-              modelAnswer (essay)
-            </p>
-          </div>
-        </div>
-
-        {/* PREVIEW */}
-        {previewOpen && newQuestions.length > 0 && (
-          <div className="mb-6 border rounded-lg p-5 bg-gray-50">
-            <h4 className="font-semibold mb-2">
-              Preview: C√°c c√¢u h·ªèi m·ªõi t√¨m ƒë∆∞·ª£c trong file
-            </h4>
-            <p className="text-sm text-gray-600 mb-4">
-              Tick ch·ªçn c√¢u mu·ªën th√™m, ch·ªânh ƒëi·ªÉm n·∫øu c·∫ßn. T·ªïng ƒëi·ªÉm sau khi
-              th√™m ph·∫£i b·∫±ng 10.
-            </p>
-
-            <div className="space-y-4 max-h-96 overflow-y-auto">
-              {newQuestions.map((q) => (
-                <div
-                  key={q.tempId}
-                  className="p-4 bg-white border rounded-lg shadow-sm"
-                >
-                  <div className="flex items-center justify-between mb-3">
-                    <div className="flex items-center gap-3">
-                      <input
-                        type="checkbox"
-                        checked={!!q.selected}
-                        onChange={() => toggleSelectPreview(q.tempId)}
-                        className="w-5 h-5 text-blue-600 rounded"
-                      />
-                      <strong className="text-indigo-700">
-                        {normalizeType(q.type) === "MCQ" ? "MCQ" : "Essay"}
-                      </strong>
-                      <span className="text-sm text-gray-700 max-w-xl truncate">
-                        {q.content}
-                      </span>
-                    </div>
-
-                    <div className="flex items-center gap-2">
-                      <label className="text-sm text-gray-600">ƒêi·ªÉm</label>
-                      <input
-                        type="number"
-                        min="0"
-                        step="0.1"
-                        value={q.points}
-                        onChange={(e) =>
-                          updatePreviewQuestion(q.tempId, {
-                            points: parseFloat(e.target.value),
-                          })
-                        }
-                        className="w-20 px-2 py-1 border rounded text-sm"
-                      />
-                    </div>
-                  </div>
-
-                  {normalizeType(q.type) === "MCQ" && (
-                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2">
-                      {q.options.map((opt, i) => (
-                        <div
-                          key={opt.tempId}
-                          className="flex items-center gap-2 text-sm p-2 bg-gray-50 rounded"
-                        >
-                          <span className="font-medium text-gray-800 w-6">
-                            {String.fromCharCode(65 + i)}.
-                          </span>
-                          <span className="flex-1">{opt.content}</span>
-                          {opt.is_correct && (
-                            <span className="text-green-600 font-medium">
-                              (ƒê√°p √°n ƒë√∫ng)
-                            </span>
-                          )}
-                        </div>
-                      ))}
-                    </div>
-                  )}
-
-                  {normalizeType(q.type) === "essay" && (
-                    <div className="mt-3">
-                      <div className="font-medium text-gray-800 mb-1">
-                        ƒê√°p √°n m·∫´u:
-                      </div>
-                      <div className="p-2 bg-gray-50 rounded text-sm whitespace-pre-wrap">
-                        {q.modelAnswer || "(Tr·ªëng)"}
-                      </div>
-                    </div>
-                  )}
-                </div>
-              ))}
-            </div>
-
-            <div className="flex justify-end gap-3 mt-4">
-              <button
-                onClick={() => setPreviewOpen(false)}
-                className="px-4 py-2 border rounded-xl hover:bg-gray-50"
-              >
-                ƒê√≥ng
-              </button>
-              <button
-                onClick={handleAddSelectedQuestionsToExam}
-                className="px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700"
-              >
-                Th√™m c√°c c√¢u ch·ªçn v√†o ƒë·ªÅ thi
-              </button>
-            </div>
-          </div>
-        )}
-
-        {/* MCQ SECTION */}
-        <div className="space-y-6 mb-10">
-          <h3 className="text-lg font-semibold text-green-700 mb-4">
-            Ph·∫ßn tr·∫Øc nghi·ªám ({mcqQuestions.length} c√¢u)
-          </h3>
-
-          {mcqQuestions.map((q, idx) => (
-            <div
-              key={q.id}
-              className="border border-gray-200 rounded-xl p-5 bg-gray-50"
-            >
-              <div className="flex justify-between items-start mb-3">
-                <span className="font-medium text-gray-700">
-                  C√¢u {idx + 1}:
-                </span>
-                <button
-                  onClick={() => {
-                    if (window.confirm("X√≥a c√¢u h·ªèi n√†y?")) {
-                      setEditingExam({
-                        ...editingExam,
-                        questions: editingExam.questions.filter(
-                          (x) => x.id !== q.id
-                        ),
-                      });
-                    }
-                  }}
-                  className="text-red-600 hover:text-red-700"
-                >
-                  <FiTrash2 className="w-5 h-5" />
-                </button>
-              </div>
-
-              <textarea
-                value={q.content}
-                onChange={(e) => {
-                  const updated = [...editingExam.questions];
-                  const originalIdx = updated.findIndex((x) => x.id === q.id);
-                  updated[originalIdx].content = e.target.value;
-                  setEditingExam({ ...editingExam, questions: updated });
-                }}
-                className="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:ring-2 focus:ring-purple-500"
-                rows="2"
-                placeholder="N·ªôi dung c√¢u h·ªèi"
-              />
-
-              <div className="flex items-center gap-2 mb-3">
-                <span className="text-sm text-gray-600">ƒêi·ªÉm:</span>
-                <input
-                  type="number"
-                  value={q.points}
-                  onChange={(e) => {
-                    const updated = [...editingExam.questions];
-                    const originalIdx = updated.findIndex((x) => x.id === q.id);
-                    updated[originalIdx].points =
-                      parseFloat(e.target.value) || 0.1;
-                    setEditingExam({ ...editingExam, questions: updated });
-                  }}
-                  className="w-20 px-2 py-1 border rounded-lg text-sm"
-                  min="0.1"
-                  step="0.1"
-                />
-              </div>
-
-              <div className="space-y-2">
-                {q.options.map((opt, optIndex) => (
-                  <div
-                    key={opt.id}
-                    className="flex items-center gap-3 bg-white p-3 rounded-lg border"
-                  >
-                    <span className="font-medium text-gray-700">
-                      {String.fromCharCode(65 + optIndex)}.
-                    </span>
-                    <input
-                      type="radio"
-                      name={`question-${q.id}`}
-                      checked={opt.is_correct}
-                      onChange={() => {
-                        const updated = [...editingExam.questions];
-                        const originalIdx = updated.findIndex(
-                          (x) => x.id === q.id
-                        );
-                        updated[originalIdx].options.forEach(
-                          (o, i) => (o.is_correct = i === optIndex)
-                        );
-                        setEditingExam({ ...editingExam, questions: updated });
-                      }}
-                    />
-                    <input
-                      type="text"
-                      value={opt.content}
-                      onChange={(e) => {
-                        const updated = [...editingExam.questions];
-                        const originalIdx = updated.findIndex(
-                          (x) => x.id === q.id
-                        );
-                        updated[originalIdx].options[optIndex].content =
-                          e.target.value;
-                        setEditingExam({ ...editingExam, questions: updated });
-                      }}
-                      className="flex-1 px-3 py-1 text-sm"
-                      placeholder="N·ªôi dung ƒë√°p √°n"
-                    />
-                    <button
-                      onClick={() => {
-                        const updated = [...editingExam.questions];
-                        const originalIdx = updated.findIndex(
-                          (x) => x.id === q.id
-                        );
-                        updated[originalIdx].options.splice(optIndex, 1);
-                        setEditingExam({ ...editingExam, questions: updated });
-                      }}
-                      className="text-red-500 hover:text-red-700"
-                    >
-                      <FiTrash2 className="w-4 h-4" />
-                    </button>
-                  </div>
-                ))}
-                <button
-                  onClick={() => {
-                    const updated = [...editingExam.questions];
-                    const originalIdx = updated.findIndex((x) => x.id === q.id);
-                    updated[originalIdx].options.push({
-                      id: Date.now(),
-                      content: `L·ª±a ch·ªçn ${String.fromCharCode(
-                        65 + q.options.length
-                      )}`,
-                      is_correct: false,
-                    });
-                    setEditingExam({ ...editingExam, questions: updated });
-                  }}
-                  className="text-sm text-green-600 hover:underline"
-                >
-                  + Th√™m ƒë√°p √°n
-                </button>
-              </div>
-            </div>
-          ))}
-
-          <button
-            onClick={() => {
-              const newQuestion = {
-                id: Date.now(),
-                type: "MCQ",
-                content: "C√¢u h·ªèi tr·∫Øc nghi·ªám m·ªõi",
-                points: 0.1,
-                modelAnswer: "",
-                options: [
-                  {
-                    id: Date.now() + 1,
-                    content: "L·ª±a ch·ªçn A",
-                    is_correct: true,
-                  },
-                  {
-                    id: Date.now() + 2,
-                    content: "L·ª±a ch·ªçn B",
-                    is_correct: false,
-                  },
-                ],
-              };
-              setEditingExam({
-                ...editingExam,
-                questions: [...editingExam.questions, newQuestion],
-              });
-            }}
-            className="flex items-center gap-2 text-green-600 hover:text-green-700 font-medium"
-          >
-            <FiPlus /> Th√™m c√¢u h·ªèi tr·∫Øc nghi·ªám
-          </button>
-        </div>
-
-        {/* ESSAY SECTION */}
-        <div className="space-y-6 mb-6">
-          <h3 className="text-lg font-semibold text-purple-700 mb-4">
-            Ph·∫ßn t·ª± lu·∫≠n ({essayQuestions.length} c√¢u)
-          </h3>
-
-          {essayQuestions.map((q, idx) => (
-            <div
-              key={q.id}
-              className="border border-gray-200 rounded-xl p-5 bg-gray-50"
-            >
-              <div className="flex justify-between items-start mb-3">
-                <span className="font-medium text-gray-700">
-                  C√¢u {mcqQuestions.length + idx + 1}:
-                </span>
-                <button
-                  onClick={() => {
-                    if (window.confirm("X√≥a c√¢u h·ªèi n√†y?")) {
-                      setEditingExam({
-                        ...editingExam,
-                        questions: editingExam.questions.filter(
-                          (x) => x.id !== q.id
-                        ),
-                      });
-                    }
-                  }}
-                  className="text-red-600 hover:text-red-700"
-                >
-                  <FiTrash2 className="w-5 h-5" />
-                </button>
-              </div>
-
-              <textarea
-                value={q.content}
-                onChange={(e) => {
-                  const updated = [...editingExam.questions];
-                  const originalIdx = updated.findIndex((x) => x.id === q.id);
-                  updated[originalIdx].content = e.target.value;
-                  setEditingExam({ ...editingExam, questions: updated });
-                }}
-                className="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:ring-2 focus:ring-purple-500"
-                rows="4"
-                placeholder="N·ªôi dung c√¢u h·ªèi t·ª± lu·∫≠n"
-              />
-
-              <div className="flex items-center gap-2 mb-3">
-                <span className="text-sm text-gray-600">ƒêi·ªÉm:</span>
-                <input
-                  type="number"
-                  value={q.points}
-                  onChange={(e) => {
-                    const updated = [...editingExam.questions];
-                    const originalIdx = updated.findIndex((x) => x.id === q.id);
-                    updated[originalIdx].points =
-                      parseFloat(e.target.value) || 0.1;
-                    setEditingExam({ ...editingExam, questions: updated });
-                  }}
-                  className="w-20 px-2 py-1 border rounded-lg text-sm"
-                  min="0.1"
-                  step="0.1"
-                />
-              </div>
-
-              <label className="block text-sm font-medium text-gray-700">
-                ƒê√°p √°n m·∫´u
-              </label>
-              <textarea
-                value={q.modelAnswer || ""}
-                onChange={(e) => {
-                  const updated = [...editingExam.questions];
-                  const originalIdx = updated.findIndex((x) => x.id === q.id);
-                  updated[originalIdx].modelAnswer = e.target.value;
-                  setEditingExam({ ...editingExam, questions: updated });
-                }}
-                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
-                rows="4"
-                placeholder="Nh·∫≠p ƒë√°p √°n m·∫´u cho c√¢u t·ª± lu·∫≠n"
-              />
-            </div>
-          ))}
-
-          <button
-            onClick={() => {
-              const newQuestion = {
-                id: Date.now(),
-                type: "essay",
-                content: "C√¢u h·ªèi t·ª± lu·∫≠n m·ªõi",
-                points: 0.1,
-                modelAnswer: "",
-              };
-              setEditingExam({
-                ...editingExam,
-                questions: [...editingExam.questions, newQuestion],
-              });
-            }}
-            className="flex items-center gap-2 text-purple-600 hover:text-purple-700 font-medium"
-          >
-            <FiPlus /> Th√™m c√¢u h·ªèi t·ª± lu·∫≠n
-          </button>
-        </div>
-
-        {/* Action buttons */}
-        <div className="flex justify-end gap-3">
-          <button
-            onClick={() => navigate("/assign-exam")}
-            className="px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50"
-          >
-            H·ªßy
-          </button>
-          <button
-            onClick={handleSaveExam}
-            className="px-6 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl hover:shadow-lg"
-          >
-            L∆∞u thay ƒë·ªïi
-          </button>
-        </div>
-      </div>
-    </div>
-  );
-};
-
-export default EditExam;
+// üìÅ src/pages/instructor/EditExam.jsx
+import React, { useEffect, useState } from "react";
+import { useParams, useNavigate } from "react-router-dom";
+import { FiTrash2, FiPlus, FiX } from "react-icons/fi";
+import axios from "axios";
+import LoadingSpinner from "../../components/LoadingSpinner";
+import * as XLSX from "xlsx";
+
+const EditExam = () => {
+  const { id } = useParams();
+  const navigate = useNavigate();
+  const token = localStorage.getItem("token");
+
+  const [editingExam, setEditingExam] = useState(null);
+  const [loading, setLoading] = useState(true);
+  const [errorMessage, setErrorMessage] = useState("");
+
+  // Upload states
+  const [selectedFile, setSelectedFile] = useState(null);
+  const [parsedQuestions, setParsedQuestions] = useState([]);
+  const [newQuestions, setNewQuestions] = useState([]);
+  const [previewOpen, setPreviewOpen] = useState(false);
+
+  useEffect(() => {
+    const fetchExam = async () => {
+      try {
+        const res = await axios.get(
+          `http://localhost:5000/api/edit-exam/exams/${id}/edit`,
+          { headers: { Authorization: `Bearer ${token}` } }
+        );
+        const processedQuestions = res.data.questions.map((q) => {
+          if (q.type?.toLowerCase() === "essay") {
+            const match = q.content?.match(
+              /(.*)\((\d+(?:\.\d+)?)\s*ƒë\)\s*C√¢u tr·∫£ l·ªùi:\s*(.*)/i
+            );
+            if (match) {
+              q.content = match[1].trim();
+              q.points = parseFloat(match[2]);
+              q.modelAnswer = match[3].trim();
+            }
+            if (!q.modelAnswer) q.modelAnswer = "";
+          }
+          if (!q.points) q.points = q.points === 0 ? 0 : q.points || 0.1;
+          if (!q.options) q.options = [];
+          return q;
+        });
+        setEditingExam({ ...res.data, questions: processedQuestions });
+      } catch (err) {
+        alert("Kh√¥ng th·ªÉ t·∫£i chi ti·∫øt ƒë·ªÅ thi!");
+        navigate("/assign-exam");
+      } finally {
+        setLoading(false);
+      }
+    };
+    fetchExam();
+  }, [id, token, navigate]);
+
+  // ---------- Helpers ----------
+  const normalizeType = (t) =>
+    (t || "").toString().toLowerCase() === "essay" ? "essay" : "MCQ";
+
+  const computeTotalPoints = (questions) =>
+    Math.round(
+      (questions.reduce((s, q) => s + (parseFloat(q.points) || 0), 0) +
+        Number.EPSILON) *
+        10
+    ) / 10;
+
+  // ---------- Save exam ----------
+  const handleSaveExam = async () => {
+    const totalPoints = computeTotalPoints(editingExam.questions);
+    if (totalPoints !== 10) {
+      setErrorMessage(
+        `T·ªïng ƒëi·ªÉm hi·ªán t·∫°i l√† ${totalPoints.toFixed(
+          1
+        )}. T·ªïng ƒëi·ªÉm ph·∫£i b·∫±ng 10 ƒë·ªÉ l∆∞u b√†i thi!`
+      );
+      return;
+    }
+
+    if (!editingExam.title?.trim()) {
+      alert("Ti√™u ƒë·ªÅ ƒë·ªÅ thi kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!");
+      return;
+    }
+
+    try {
+      const updatedQuestions = editingExam.questions.map((q) => ({
+        ...q,
+        type: normalizeType(q.type),
+      }));
+
+      await axios.put(
+        `http://localhost:5000/api/edit-exam/exams/${id}`,
+        { ...editingExam, questions: updatedQuestions },
+        { headers: { Authorization: `Bearer ${token}` } }
+      );
+      alert("C·∫≠p nh·∫≠t ƒë·ªÅ thi th√†nh c√¥ng!");
+      navigate("/assign-exam");
+    } catch (err) {
+      alert("C·∫≠p nh·∫≠t ƒë·ªÅ thi th·∫•t b·∫°i!");
+    }
+  };
+
+  // ---------- File select & parse ----------
+  const handleFileSelect = (e) => {
+    setSelectedFile(e.target.files?.[0] || null);
+    setParsedQuestions([]);
+    setNewQuestions([]);
+    setPreviewOpen(false);
+  };
+
+  const parseExcelToQuestions = (workbook) => {
+    const sheetName = workbook.SheetNames[0];
+    const sheet = workbook.Sheets[sheetName];
+    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: "" });
+    const dataRows = rows.slice(1);
+
+    const questionsFromFile = dataRows
+      .map((row, rowIdx) => {
+        const rawType = (row[0] || "").toString().trim();
+        if (!rawType) return null;
+
+        const type = normalizeType(rawType);
+        const content = (row[1] || "").toString().trim();
+        const points = parseFloat(row[2]) || 0;
+        if (!content) return null;
+
+        // --- MCQ ---
+        if (type === "MCQ") {
+          const opts = ["A", "B", "C", "D"]
+            .map((letter, i) => {
+              const txt = (row[3 + i] || "").toString().trim();
+              return txt
+                ? {
+                    tempId: `${rowIdx}-${letter}`,
+                    content: txt,
+                    is_correct: false,
+                  }
+                : null;
+            })
+            .filter(Boolean);
+
+          const correct = ((row[7] || "") + "").toString().trim().toUpperCase();
+          opts.forEach((o) => {
+            if (o.tempId.endsWith(`-${correct}`)) o.is_correct = true;
+          });
+
+          return { type: "MCQ", content, points, options: opts };
+        }
+
+        // --- ESSAY ---
+        const modelAnswer = (row[3] || "").toString().trim();
+        return { type: "essay", content, points, modelAnswer };
+      })
+      .filter(Boolean);
+
+    return questionsFromFile;
+  };
+
+  const areMCQEqual = (a, b) => {
+    if (a.content?.trim() !== b.content?.trim()) return false;
+    if ((a.options?.length || 0) !== (b.options?.length || 0)) return false;
+    for (let i = 0; i < a.options.length; i++) {
+      const oa = (a.options[i].content || "").trim();
+      const ob = (b.options[i]?.content || "").trim();
+      if (oa !== ob) return false;
+      if (!!a.options[i].is_correct !== !!b.options[i].is_correct) return false;
+    }
+    return true;
+  };
+
+  const areEssayEqual = (a, b) => {
+    return (
+      (a.content || "").trim() === (b.content || "").trim() &&
+      (a.modelAnswer || "").trim() === (b.modelAnswer || "").trim()
+    );
+  };
+
+  const isDuplicateAgainstExisting = (qFromFile, existingQs) => {
+    return existingQs.some((exist) => {
+      if (normalizeType(exist.type) !== normalizeType(qFromFile.type))
+        return false;
+      if (qFromFile.type === "MCQ") return areMCQEqual(qFromFile, exist);
+      return areEssayEqual(qFromFile, exist);
+    });
+  };
+
+  const handleAnalyzeFile = () => {
+    if (!selectedFile) {
+      alert("Vui l√≤ng ch·ªçn file Excel tr∆∞·ªõc.");
+      return;
+    }
+    const reader = new FileReader();
+    reader.onload = (evt) => {
+      try {
+        const data = new Uint8Array(evt.target.result);
+        const workbook = XLSX.read(data, { type: "array" });
+        const fileQuestions = parseExcelToQuestions(workbook);
+        setParsedQuestions(fileQuestions);
+
+        const existing = editingExam.questions || [];
+        const uniques = fileQuestions.filter(
+          (fq) => !isDuplicateAgainstExisting(fq, existing)
+        );
+
+        if (uniques.length === 0) {
+          alert(
+            "Kh√¥ng c√≥ c√¢u h·ªèi m·ªõi n√†o trong file, vui l√≤ng th√™m c√¢u h·ªèi m·ªõi ƒë·ªÉ c·∫≠p nh·∫≠t"
+          );
+          setNewQuestions([]);
+          setPreviewOpen(false);
+          return;
+        }
+
+        const withSelected = uniques.map((q, i) => ({
+          ...q,
+          selected: true,
+          tempId: `preview-${Date.now()}-${i}`,
+        }));
+        setNewQuestions(withSelected);
+        setPreviewOpen(true);
+      } catch (err) {
+        console.error(err);
+        alert("ƒê·ªçc file th·∫•t b·∫°i. Vui l√≤ng ki·ªÉm tra file Excel.");
+      }
+    };
+    reader.readAsArrayBuffer(selectedFile);
+  };
+
+  // ------------ Preview / add flow -------------
+  const updatePreviewQuestion = (tempId, patch) => {
+    setNewQuestions((prev) =>
+      prev.map((q) => (q.tempId === tempId ? { ...q, ...patch } : q))
+    );
+  };
+
+  const toggleSelectPreview = (tempId) => {
+    setNewQuestions((prev) =>
+      prev.map((q) =>
+        q.tempId === tempId ? { ...q, selected: !q.selected } : q
+      )
+    );
+  };
+
+  const handleAddSelectedQuestionsToExam = () => {
+    const selected = newQuestions.filter((q) => q.selected);
+    if (selected.length === 0) {
+      alert("Ch∆∞a ch·ªçn c√¢u h·ªèi n√†o ƒë·ªÉ th√™m.");
+      return;
+    }
+
+    const currentTotal = computeTotalPoints(editingExam.questions);
+    const addTotal = computeTotalPoints(selected);
+    const newTotal = Math.round((currentTotal + addTotal) * 10) / 10;
+    if (newTotal !== 10) {
+      alert(
+        `T·ªïng ƒëi·ªÉm sau khi th√™m s·∫Ω l√† ${newTotal.toFixed(
+          1
+        )}. T·ªïng ƒëi·ªÉm c·ªßa ƒë·ªÅ ph·∫£i b·∫±ng 10. Vui l√≤ng ƒëi·ªÅu ch·ªânh ƒëi·ªÉm tr∆∞·ªõc khi th√™m.`
+      );
+      return;
+    }
+
+    const assigned = selected.map((q, i) => {
+      const baseId = Date.now() + i + Math.floor(Math.random() * 1000);
+      if (normalizeType(q.type) === "MCQ") {
+        const options = q.options.map((o, idx) => ({
+          id: baseId + 100 + idx,
+          content: o.content,
+          is_correct: o.is_correct,
+        }));
+        return {
+          id: baseId,
+          type: "MCQ",
+          content: q.content,
+          points: parseFloat(q.points) || 0.1,
+          options,
+        };
+      } else {
+        return {
+          id: baseId,
+          type: "essay",
+          content: q.content,
+          points: parseFloat(q.points) || 0.1,
+          modelAnswer: q.modelAnswer || "",
+        };
+      }
+    });
+
+    setEditingExam((prev) => ({
+      ...prev,
+      questions: [...prev.questions, ...assigned],
+    }));
+
+    setNewQuestions([]);
+    setParsedQuestions([]);
+    setSelectedFile(null);
+    setPreviewOpen(false);
+    alert(
+      "ƒê√£ th√™m c√°c c√¢u ch·ªçn v√†o b√†i thi. Nh·ªõ nh·∫•n L∆∞u thay ƒë·ªïi ƒë·ªÉ c·∫≠p nh·∫≠t l√™n server."
+    );
+  };
+
+  // ---------- render ----------
+  if (loading) return <LoadingSpinner size="lg" />;
+  if (!editingExam)
+    return (
+      <div className="p-6 text-center text-gray-600">Kh√¥ng c√≥ d·ªØ li·ªáu</div>
+    );
+
+  const mcqQuestions = editingExam.questions.filter(
+    (q) => normalizeType(q.type) === "MCQ"
+  );
+  const essayQuestions = editingExam.questions.filter(
+    (q) => normalizeType(q.type) === "essay"
+  );
+
+  return (
+    <div className="min-h-screen p-4 md:p-8">
+      <div className="max-w-full mx-auto bg-white rounded-2xl shadow-2xl p-6">
+        {/* Header */}
+        <div className="flex justify-between items-center mb-6">
+          <h2 className="text-2xl font-bold text-gray-900">Ch·ªânh s·ª≠a ƒë·ªÅ thi</h2>
+          <button
+            onClick={() => navigate("/assign-exam")}
+            className="text-gray-500 hover:text-gray-700"
+          >
+            <FiX className="w-6 h-6" />
+          </button>
+        </div>
+
+        {errorMessage && (
+          <div className="bg-red-50 border border-red-200 text-red-700 p-4 rounded-xl mb-6">
+            {errorMessage}
+          </div>
+        )}
+
+        {/* Title */}
+        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
+          <div>
+            <label className="block text-sm font-medium text-gray-700 mb-1">
+              Ti√™u ƒë·ªÅ ƒë·ªÅ thi
+            </label>
+            <input
+              type="text"
+              value={editingExam.title}
+              onChange={(e) =>
+                setEditingExam({ ...editingExam, title: e.target.value })
+              }
+              className="w-full px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
+            />
+          </div>
+
+          {/* UPLOAD PANEL */}
+          <div className="space-y-3">
+            <label className="block text-sm font-semibold text-gray-800">
+              Upload c√¢u h·ªèi t·ª´ file Excel
+            </label>
+
+            <div className="flex items-center gap-3">
+              <label
+                htmlFor="excel-upload"
+                className={`
+                  flex-1 flex items-center justify-center gap-2
+                  px-4 py-3 rounded-xl border-2 border-dashed
+                  ${
+                    selectedFile
+                      ? "border-green-500 bg-green-50"
+                      : "border-gray-300 hover:border-gray-400"
+                  }
+                  cursor-pointer transition-colors duration-200
+                `}
+              >
+                <span className="text-sm font-medium text-gray-700 truncate">
+                  {selectedFile ? selectedFile.name : "Ch·ªçn file .xlsx / .xls"}
+                </span>
+              </label>
+
+              <input
+                id="excel-upload"
+                type="file"
+                accept=".xlsx,.xls"
+                onChange={handleFileSelect}
+                className="hidden"
+              />
+            </div>
+
+            <div className="flex gap-2">
+              <button
+                onClick={handleAnalyzeFile}
+                disabled={!selectedFile}
+                className={`
+                  flex-1 flex items-center justify-center gap-2
+                  px-4 py-2.5 rounded-xl font-medium text-sm transition-all
+                  ${
+                    selectedFile
+                      ? "bg-blue-600 hover:bg-blue-700 text-white shadow-md"
+                      : "bg-gray-200 text-gray-400 cursor-not-allowed"
+                  }
+                `}
+              >
+                <svg
+                  className="w-4 h-4"
+                  fill="none"
+                  stroke="currentColor"
+                  viewBox="0 0 24 24"
+                >
+                  <path
+                    strokeLinecap="round"
+                    strokeLinejoin="round"
+                    strokeWidth={2}
+                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
+                  />
+                </svg>
+                Ph√¢n t√≠ch file
+              </button>
+
+              <button
+                onClick={() => {
+                  setSelectedFile(null);
+                  setParsedQuestions([]);
+                  setNewQuestions([]);
+                  setPreviewOpen(false);
+                }}
+                className={`
+                  px-4 py-2.5 rounded-xl font-medium text-sm border
+                  ${
+                    selectedFile
+                      ? "border-gray-300 text-gray-700 hover:bg-gray-50"
+                      : "border-gray-200 text-gray-400 cursor-not-allowed"
+                  }
+                  transition-colors
+                `}
+              >
+                H·ªßy
+              </button>
+            </div>
+
+            <p className="text-xs text-gray-500 leading-relaxed">
+              <span className="font-medium">Format:</span> type (MCQ/essay),
+              content, points, optionA..D (MCQ), correctOption (A/B/C/D),
+              modelAnswer (essay)
+            </p>
+          </div>
+        </div>
+
+        {/* PREVIEW */}
+        {previewOpen && newQuestions.length > 0 && (
+          <div className="mb-6 border rounded-lg p-5 bg-gray-50">
+            <h4 className="font-semibold mb-2">
+              Preview: C√°c c√¢u h·ªèi m·ªõi t√¨m ƒë∆∞·ª£c trong file
+            </h4>
+            <p className="text-sm text-gray-600 mb-4">
+              Tick ch·ªçn c√¢u mu·ªën th√™m, ch·ªânh ƒëi·ªÉm n·∫øu c·∫ßn. T·ªïng ƒëi·ªÉm sau khi
+              th√™m ph·∫£i b·∫±ng 10.
+            </p>
+
+            <div className="space-y-4 max-h-96 overflow-y-auto">
+              {newQuestions.map((q) => (
+                <div
+                  key={q.tempId}
+                  className="p-4 bg-white border rounded-lg shadow-sm"
+                >
+                  <div className="flex items-center justify-between mb-3">
+                    <div className="flex items-center gap-3">
+                      <input
+                        type="checkbox"
+                        checked={!!q.selected}
+                        onChange={() => toggleSelectPreview(q.tempId)}
+                        className="w-5 h-5 text-blue-600 rounded"
+                      />
+                      <strong className="text-indigo-700">
+                        {normalizeType(q.type) === "MCQ" ? "MCQ" : "Essay"}
+                      </strong>
+                      <span className="text-sm text-gray-700 max-w-xl truncate">
+                        {q.content}
+                      </span>
+                    </div>
+
+                    <div className="flex items-center gap-2">
+                      <label className="text-sm text-gray-600">ƒêi·ªÉm</label>
+                      <input
+                        type="number"
+                        min="0"
+                        step="0.1"
+                        value={q.points}
+                        onChange={(e) =>
+                          updatePreviewQuestion(q.tempId, {
+                            points: parseFloat(e.target.value),
+                          })
+                        }
+                        className="w-20 px-2 py-1 border rounded text-sm"
+                      />
+                    </div>
+                  </div>
+
+                  {normalizeType(q.type) === "MCQ" && (
+                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-2 mt-2">
+                      {q.options.map((opt, i) => (
+                        <div
+                          key={opt.tempId}
+                          className="flex items-center gap-2 text-sm p-2 bg-gray-50 rounded"
+                        >
+                          <span className="font-medium text-gray-800 w-6">
+                            {String.fromCharCode(65 + i)}.
+                          </span>
+                          <span className="flex-1">{opt.content}</span>
+                          {opt.is_correct && (
+                            <span className="text-green-600 font-medium">
+                              (ƒê√°p √°n ƒë√∫ng)
+                            </span>
+                          )}
+                        </div>
+                      ))}
+                    </div>
+                  )}
+
+                  {normalizeType(q.type) === "essay" && (
+                    <div className="mt-3">
+                      <div className="font-medium text-gray-800 mb-1">
+                        ƒê√°p √°n m·∫´u:
+                      </div>
+                      <div className="p-2 bg-gray-50 rounded text-sm whitespace-pre-wrap">
+                        {q.modelAnswer || "(Tr·ªëng)"}
+                      </div>
+                    </div>
+                  )}
+                </div>
+              ))}
+            </div>
+
+            <div className="flex justify-end gap-3 mt-4">
+              <button
+                onClick={() => setPreviewOpen(false)}
+                className="px-4 py-2 border rounded-xl hover:bg-gray-50"
+              >
+                ƒê√≥ng
+              </button>
+              <button
+                onClick={handleAddSelectedQuestionsToExam}
+                className="px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700"
+              >
+                Th√™m c√°c c√¢u ch·ªçn v√†o ƒë·ªÅ thi
+              </button>
+            </div>
+          </div>
+        )}
+
+        {/* MCQ SECTION */}
+        <div className="space-y-6 mb-10">
+          <h3 className="text-lg font-semibold text-green-700 mb-4">
+            Ph·∫ßn tr·∫Øc nghi·ªám ({mcqQuestions.length} c√¢u)
+          </h3>
+
+          {mcqQuestions.map((q, idx) => (
+            <div
+              key={q.id}
+              className="border border-gray-200 rounded-xl p-5 bg-gray-50"
+            >
+              <div className="flex justify-between items-start mb-3">
+                <span className="font-medium text-gray-700">
+                  C√¢u {idx + 1}:
+                </span>
+                <button
+                  onClick={() => {
+                    if (window.confirm("X√≥a c√¢u h·ªèi n√†y?")) {
+                      setEditingExam({
+                        ...editingExam,
+                        questions: editingExam.questions.filter(
+                          (x) => x.id !== q.id
+                        ),
+                      });
+                    }
+                  }}
+                  className="text-red-600 hover:text-red-700"
+                >
+                  <FiTrash2 className="w-5 h-5" />
+                </button>
+              </div>
+
+              <textarea
+                value={q.content}
+                onChange={(e) => {
+                  const updated = [...editingExam.questions];
+                  const originalIdx = updated.findIndex((x) => x.id === q.id);
+                  updated[originalIdx].content = e.target.value;
+                  setEditingExam({ ...editingExam, questions: updated });
+                }}
+                className="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:ring-2 focus:ring-purple-500"
+                rows="2"
+                placeholder="N·ªôi dung c√¢u h·ªèi"
+              />
+
+              <div className="flex items-center gap-2 mb-3">
+                <span className="text-sm text-gray-600">ƒêi·ªÉm:</span>
+                <input
+                  type="number"
+                  value={q.points}
+                  onChange={(e) => {
+                    const updated = [...editingExam.questions];
+                    const originalIdx = updated.findIndex((x) => x.id === q.id);
+                    updated[originalIdx].points =
+                      parseFloat(e.target.value) || 0.1;
+                    setEditingExam({ ...editingExam, questions: updated });
+                  }}
+                  className="w-20 px-2 py-1 border rounded-lg text-sm"
+                  min="0.1"
+                  step="0.1"
+                />
+              </div>
+
+              <div className="space-y-2">
+                {q.options.map((opt, optIndex) => (
+                  <div
+                    key={opt.id}
+                    className="flex items-center gap-3 bg-white p-3 rounded-lg border"
+                  >
+                    <span className="font-medium text-gray-700">
+                      {String.fromCharCode(65 + optIndex)}.
+                    </span>
+                    <input
+                      type="radio"
+                      name={`question-${q.id}`}
+                      checked={opt.is_correct}
+                      onChange={() => {
+                        const updated = [...editingExam.questions];
+                        const originalIdx = updated.findIndex(
+                          (x) => x.id === q.id
+                        );
+                        updated[originalIdx].options.forEach(
+                          (o, i) => (o.is_correct = i === optIndex)
+                        );
+                        setEditingExam({ ...editingExam, questions: updated });
+                      }}
+                    />
+                    <input
+                      type="text"
+                      value={opt.content}
+                      onChange={(e) => {
+                        const updated = [...editingExam.questions];
+                        const originalIdx = updated.findIndex(
+                          (x) => x.id === q.id
+                        );
+                        updated[originalIdx].options[optIndex].content =
+                          e.target.value;
+                        setEditingExam({ ...editingExam, questions: updated });
+                      }}
+                      className="flex-1 px-3 py-1 text-sm"
+                      placeholder="N·ªôi dung ƒë√°p √°n"
+                    />
+                    <button
+                      onClick={() => {
+                        const updated = [...editingExam.questions];
+                        const originalIdx = updated.findIndex(
+                          (x) => x.id === q.id
+                        );
+                        updated[originalIdx].options.splice(optIndex, 1);
+                        setEditingExam({ ...editingExam, questions: updated });
+                      }}
+                      className="text-red-500 hover:text-red-700"
+                    >
+                      <FiTrash2 className="w-4 h-4" />
+                    </button>
+                  </div>
+                ))}
+                <button
+                  onClick={() => {
+                    const updated = [...editingExam.questions];
+                    const originalIdx = updated.findIndex((x) => x.id === q.id);
+                    updated[originalIdx].options.push({
+                      id: Date.now(),
+                      content: `L·ª±a ch·ªçn ${String.fromCharCode(
+                        65 + q.options.length
+                      )}`,
+                      is_correct: false,
+                    });
+                    setEditingExam({ ...editingExam, questions: updated });
+                  }}
+                  className="text-sm text-green-600 hover:underline"
+                >
+                  + Th√™m ƒë√°p √°n
+                </button>
+              </div>
+            </div>
+          ))}
+
+          <button
+            onClick={() => {
+              const newQuestion = {
+                id: Date.now(),
+                type: "MCQ",
+                content: "C√¢u h·ªèi tr·∫Øc nghi·ªám m·ªõi",
+                points: 0.1,
+                modelAnswer: "",
+                options: [
+                  {
+                    id: Date.now() + 1,
+                    content: "L·ª±a ch·ªçn A",
+                    is_correct: true,
+                  },
+                  {
+                    id: Date.now() + 2,
+                    content: "L·ª±a ch·ªçn B",
+                    is_correct: false,
+                  },
+                ],
+              };
+              setEditingExam({
+                ...editingExam,
+                questions: [...editingExam.questions, newQuestion],
+              });
+            }}
+            className="flex items-center gap-2 text-green-600 hover:text-green-700 font-medium"
+          >
+            <FiPlus /> Th√™m c√¢u h·ªèi tr·∫Øc nghi·ªám
+          </button>
+        </div>
+
+        {/* ESSAY SECTION */}
+        <div className="space-y-6 mb-6">
+          <h3 className="text-lg font-semibold text-purple-700 mb-4">
+            Ph·∫ßn t·ª± lu·∫≠n ({essayQuestions.length} c√¢u)
+          </h3>
+
+          {essayQuestions.map((q, idx) => (
+            <div
+              key={q.id}
+              className="border border-gray-200 rounded-xl p-5 bg-gray-50"
+            >
+              <div className="flex justify-between items-start mb-3">
+                <span className="font-medium text-gray-700">
+                  C√¢u {mcqQuestions.length + idx + 1}:
+                </span>
+                <button
+                  onClick={() => {
+                    if (window.confirm("X√≥a c√¢u h·ªèi n√†y?")) {
+                      setEditingExam({
+                        ...editingExam,
+                        questions: editingExam.questions.filter(
+                          (x) => x.id !== q.id
+                        ),
+                      });
+                    }
+                  }}
+                  className="text-red-600 hover:text-red-700"
+                >
+                  <FiTrash2 className="w-5 h-5" />
+                </button>
+              </div>
+
+              <textarea
+                value={q.content}
+                onChange={(e) => {
+                  const updated = [...editingExam.questions];
+                  const originalIdx = updated.findIndex((x) => x.id === q.id);
+                  updated[originalIdx].content = e.target.value;
+                  setEditingExam({ ...editingExam, questions: updated });
+                }}
+                className="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3 focus:ring-2 focus:ring-purple-500"
+                rows="4"
+                placeholder="N·ªôi dung c√¢u h·ªèi t·ª± lu·∫≠n"
+              />
+
+              <div className="flex items-center gap-2 mb-3">
+                <span className="text-sm text-gray-600">ƒêi·ªÉm:</span>
+                <input
+                  type="number"
+                  value={q.points}
+                  onChange={(e) => {
+                    const updated = [...editingExam.questions];
+                    const originalIdx = updated.findIndex((x) => x.id === q.id);
+                    updated[originalIdx].points =
+                      parseFloat(e.target.value) || 0.1;
+                    setEditingExam({ ...editingExam, questions: updated });
+                  }}
+                  className="w-20 px-2 py-1 border rounded-lg text-sm"
+                  min="0.1"
+                  step="0.1"
+                />
+              </div>
+
+              <label className="block text-sm font-medium text-gray-700">
+                ƒê√°p √°n m·∫´u
+              </label>
+              <textarea
+                value={q.modelAnswer || ""}
+                onChange={(e) => {
+                  const updated = [...editingExam.questions];
+                  const originalIdx = updated.findIndex((x) => x.id === q.id);
+                  updated[originalIdx].modelAnswer = e.target.value;
+                  setEditingExam({ ...editingExam, questions: updated });
+                }}
+                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
+                rows="4"
+                placeholder="Nh·∫≠p ƒë√°p √°n m·∫´u cho c√¢u t·ª± lu·∫≠n"
+              />
+            </div>
+          ))}
+
+          <button
+            onClick={() => {
+              const newQuestion = {
+                id: Date.now(),
+                type: "essay",
+                content: "C√¢u h·ªèi t·ª± lu·∫≠n m·ªõi",
+                points: 0.1,
+                modelAnswer: "",
+              };
+              setEditingExam({
+                ...editingExam,
+                questions: [...editingExam.questions, newQuestion],
+              });
+            }}
+            className="flex items-center gap-2 text-purple-600 hover:text-purple-700 font-medium"
+          >
+            <FiPlus /> Th√™m c√¢u h·ªèi t·ª± lu·∫≠n
+          </button>
+        </div>
+
+        {/* Action buttons */}
+        <div className="flex justify-end gap-3">
+          <button
+            onClick={() => navigate("/assign-exam")}
+            className="px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50"
+          >
+            H·ªßy
+          </button>
+          <button
+            onClick={handleSaveExam}
+            className="px-6 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl hover:shadow-lg"
+          >
+            L∆∞u thay ƒë·ªïi
+          </button>
+        </div>
+      </div>
+    </div>
+  );
+};
+
+export default EditExam;
diff --git a/frontend/src/pages/instructorPage/ExamBank.jsx b/frontend/src/pages/instructorPage/ExamBank.jsx
index fd79668..792b96a 100644
--- a/frontend/src/pages/instructorPage/ExamBank.jsx
+++ b/frontend/src/pages/instructorPage/ExamBank.jsx
@@ -1,592 +1,592 @@
-import React, { useState } from "react";
-import {
-  FiUpload,
-  FiFile,
-  FiCheck,
-  FiX,
-  FiType,
-  FiAlignLeft,
-} from "react-icons/fi";
-import axios from "axios";
-import * as XLSX from "xlsx";
-import LoadingSpinner from "../../components/LoadingSpinner";
-
-const ExamBank = () => {
-  const [uploadedFile, setUploadedFile] = useState(null);
-  const [previewData, setPreviewData] = useState(null);
-  const [examTitle, setExamTitle] = useState("");
-  const [loading, setLoading] = useState(false);
-  const [error, setError] = useState(null);
-  const [jobId, setJobId] = useState(null);
-  const [duration, setDuration] = useState("");
-  const [message, setMessage] = useState("");
-
-  // Handle file selection
-  const handleFileChange = (e) => {
-    const file = e.target.files?.[0];
-    if (!file) return;
-
-    if (!file.name.endsWith(".xlsx") && !file.name.endsWith(".xls")) {
-      setError("‚ö†Ô∏è Vui l√≤ng ch·ªçn file Excel (.xlsx ho·∫∑c .xls)");
-      return;
-    }
-
-    setUploadedFile(file);
-    setError(null);
-    setPreviewData(null);
-    setJobId(null);
-  };
-
-  // Parse Excel and classify questions
-  const parseExcelFile = async (file) => {
-    try {
-      const data = await file.arrayBuffer();
-      const workbook = XLSX.read(data, { type: "array" });
-
-      if (!workbook.SheetNames || workbook.SheetNames.length === 0) {
-        throw new Error("File Excel kh√¥ng c√≥ sheet n√†o");
-      }
-
-      const sheetName = workbook.SheetNames[0];
-      const worksheet = workbook.Sheets[sheetName];
-      const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
-
-      if (jsonData.length < 2) {
-        throw new Error("File Excel ph·∫£i c√≥ √≠t nh·∫•t 1 d√≤ng d·ªØ li·ªáu");
-      }
-
-      // Parse data by sections
-      const questions = [];
-      let currentSection = null;
-      let rowIndex = 0;
-
-      for (let i = 0; i < jsonData.length; i++) {
-        const row = jsonData[i];
-        if (!row || row.length === 0) {
-          rowIndex++;
-          continue;
-        }
-
-        // Convert row to text
-        const rowText = row
-          .map((cell) => cell?.toString().trim() || "")
-          .join(" ");
-
-        // Check for section markers
-        if (rowText.includes("Tr·∫Øc nghi·ªám") && rowText.includes("MCQ")) {
-          currentSection = "MCQ";
-          rowIndex++;
-          continue;
-        } else if (rowText.includes("T·ª± lu·∫≠n") && rowText.includes("Essay")) {
-          currentSection = "Essay";
-          rowIndex++;
-          continue;
-        }
-
-        // Skip empty rows or section headers
-        if (!currentSection || rowText.length === 0) {
-          rowIndex++;
-          continue;
-        }
-
-        // Parse based on section
-        if (currentSection === "MCQ") {
-          // MCQ: Each row has question + 4 options
-          const questionText = row[0]?.toString().trim() || "";
-          if (!questionText) {
-            rowIndex++;
-            continue;
-          }
-
-          const options = [];
-          for (let j = 1; j <= 4; j++) {
-            const opt = row[j]?.toString().trim() || "";
-            if (opt) {
-              options.push(opt);
-            }
-          }
-
-          const questionData = {
-            row: rowIndex + 1,
-            question_text: questionText,
-            type: "MCQ",
-            errors: [],
-          };
-
-          // Find correct answer (marked with *)
-          let correctOption = null;
-          const cleanOptions = options.map((opt, idx) => {
-            const trimmed = opt.trim();
-            if (trimmed.endsWith("*")) {
-              correctOption = idx;
-              return trimmed.replace(/\*+$/, "").trim();
-            }
-            return trimmed;
-          });
-
-          // Validation
-          if (options.length < 2) {
-            questionData.errors.push(
-              "C√¢u h·ªèi tr·∫Øc nghi·ªám ph·∫£i c√≥ √≠t nh·∫•t 2 ƒë√°p √°n"
-            );
-          }
-          if (correctOption === null && options.length > 0) {
-            questionData.errors.push(
-              "Kh√¥ng t√¨m th·∫•y ƒë√°p √°n ƒë√∫ng (c·∫ßn ƒë√°nh d·∫•u * ·ªü cu·ªëi ƒë√°p √°n)"
-            );
-          }
-
-          questionData.options = cleanOptions;
-          questionData.correct_option =
-            correctOption !== null ? correctOption : null;
-
-          questions.push(questionData);
-        } else if (currentSection === "Essay") {
-          // Essay: Look for "C√¢u h·ªèi:" and "C√¢u tr·∫£ l·ªùi:" in the text
-          const fullText = row
-            .map((cell) => cell?.toString().trim() || "")
-            .join(" ");
-
-          // Try to find question and answer pattern
-          const questionMatch = fullText.match(/C√¢u h·ªèi:\s*([^\n]+)/i);
-          const answerMatch = fullText.match(/C√¢u tr·∫£ l·ªùi:\s*([^\n]+)/i);
-
-          if (questionMatch || answerMatch) {
-            const questionData = {
-              row: rowIndex + 1,
-              question_text: questionMatch ? questionMatch[1].trim() : "",
-              type: "Essay",
-              model_answer: answerMatch ? answerMatch[1].trim() : "",
-              errors: [],
-            };
-
-            if (!questionData.question_text) {
-              questionData.errors.push(
-                'Kh√¥ng t√¨m th·∫•y "C√¢u h·ªèi:" trong vƒÉn b·∫£n'
-              );
-            }
-            if (!questionData.model_answer) {
-              questionData.errors.push(
-                'Kh√¥ng t√¨m th·∫•y "C√¢u tr·∫£ l·ªùi:" trong vƒÉn b·∫£n'
-              );
-            }
-
-            questions.push(questionData);
-          }
-        }
-
-        rowIndex++;
-      }
-
-      const summary = {
-        total: questions.length,
-        mcq: questions.filter((q) => q.type === "MCQ").length,
-        essay: questions.filter((q) => q.type === "Essay").length,
-        errors: questions.filter((q) => q.errors.length > 0).length,
-      };
-
-      return { preview: questions, summary };
-    } catch (err) {
-      throw new Error(`L·ªói parse file Excel: ${err.message}`);
-    }
-  };
-
-  // Handle file upload
-  const handleUpload = async () => {
-    if (!uploadedFile) {
-      setError("‚ö†Ô∏è Vui l√≤ng ch·ªçn file tr∆∞·ªõc khi upload");
-      return;
-    }
-
-    setLoading(true);
-    setError(null);
-
-    try {
-      const result = await parseExcelFile(uploadedFile);
-      setPreviewData(result);
-    } catch (err) {
-      setError(err.message);
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  // Handle commit to database
-  const handleCommit = async () => {
-    if (!previewData) {
-      setError("‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ commit");
-      return;
-    }
-
-    if (!examTitle || examTitle.trim() === "") {
-      setError("‚ö†Ô∏è Vui l√≤ng nh·∫≠p t√™n ƒë·ªÅ thi tr∆∞·ªõc khi l∆∞u");
-      return;
-    }
-
-    const hasErrors = previewData.preview.some((q) => q.errors.length > 0);
-    if (hasErrors) {
-      setError("‚ö†Ô∏è C√≥ c√¢u h·ªèi b·ªã l·ªói. Vui l√≤ng ki·ªÉm tra l·∫°i tr∆∞·ªõc khi commit");
-      return;
-    }
-
-    setLoading(true);
-    setError(null);
-
-    try {
-      const token = localStorage.getItem("token");
-      const response = await axios.post(
-        "http://localhost:5000/api/exam-bank/import-commit",
-        {
-          preview: previewData.preview,
-          summary: previewData.summary,
-          exam_title: examTitle,
-          duration: parseInt(duration, 10) || 60,
-        },
-        {
-          headers: { Authorization: `Bearer ${token}` },
-        }
-      );
-
-      if (response.data.status === "success") {
-        setMessage(
-          `‚úÖ Import th√†nh c√¥ng! ƒê√£ th√™m ${previewData.summary.total} c√¢u h·ªèi v√†o ng√¢n h√†ng.\nExam ID: ${response.data.exam_id}`
-        );
-        setTimeout(() => setMessage(""), 10000);
-        setPreviewData(null);
-        setUploadedFile(null);
-        setExamTitle("");
-        const fileInput = document.getElementById("fileInput");
-        if (fileInput) fileInput.value = "";
-      } else {
-        setError(
-          "‚ùå Import th·∫•t b·∫°i! Backend kh√¥ng tr·∫£ v·ªÅ tr·∫°ng th√°i success."
-        );
-      }
-    } catch (err) {
-      setError(
-        "‚ùå L·ªói khi commit d·ªØ li·ªáu: " +
-          (err.response?.data?.message || err.message)
-      );
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  // Handle reset
-  const handleReset = () => {
-    setPreviewData(null);
-    setUploadedFile(null);
-    setError(null);
-    const fileInput = document.getElementById("fileInput");
-    if (fileInput) fileInput.value = "";
-  };
-
-  const renderQuestionText = (q) => {
-    const scorePattern = /\((\d+(?:[.,]\d+)?)ƒë\)/i;
-    const match = q.question_text.match(scorePattern);
-    const point = match ? match[1].replace(",", ".") : q.points || "?";
-    const textWithoutPoint = q.question_text.replace(scorePattern, "").trim();
-    return `${textWithoutPoint} (${point}ƒë)`;
-  };
-
-  return (
-    <div className="p-6 bg-gray-50 min-h-screen">
-      {/* Header */}
-      <div className="mb-8">
-        <h1 className="text-3xl font-bold text-gray-800 mb-2">
-          Ng√¢n h√†ng ƒë·ªÅ thi
-        </h1>
-        <p className="text-gray-600">
-          Upload file Excel ƒë·ªÉ import c√¢u h·ªèi v√†o h·ªá th·ªëng
-        </p>
-      </div>
-
-      {/* Upload Section */}
-      <div className="bg-white rounded-xl shadow-sm p-6 mb-6">
-        <h2 className="text-xl font-semibold text-gray-700 mb-4 flex items-center gap-2">
-          <FiUpload className="w-6 h-6" />
-          Upload file Excel
-        </h2>
-
-        <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-blue-400 transition">
-          <div className="flex flex-col items-center gap-4">
-            <input
-              id="fileInput"
-              type="file"
-              accept=".xlsx,.xls"
-              onChange={handleFileChange}
-              className="hidden"
-            />
-
-            {uploadedFile ? (
-              <div className="flex items-center gap-3 text-blue-600">
-                <FiFile className="w-6 h-6" />
-                <span className="font-medium">{uploadedFile.name}</span>
-                <span className="text-sm text-gray-500">
-                  ({(uploadedFile.size / 1024).toFixed(2)} KB)
-                </span>
-              </div>
-            ) : (
-              <label htmlFor="fileInput" className="cursor-pointer">
-                <div className="flex flex-col items-center gap-2 text-gray-400 hover:text-blue-500 transition">
-                  <FiUpload className="w-12 h-12" />
-                  <span className="text-sm font-medium">
-                    Click ƒë·ªÉ ch·ªçn file
-                  </span>
-                  <span className="text-xs">.xlsx ho·∫∑c .xls</span>
-                </div>
-              </label>
-            )}
-          </div>
-        </div>
-
-        {/* Instructions */}
-        <div className="mt-4 p-4 bg-blue-50 rounded-lg">
-          <p className="text-sm font-semibold text-blue-800 mb-2">
-            üìã H∆∞·ªõng d·∫´n format file Excel:
-          </p>
-          <div className="text-sm text-blue-700 space-y-2">
-            <div>
-              <p className="font-semibold">üìù Ph·∫ßn Tr·∫Øc nghi·ªám (MCQ):</p>
-              <p>
-                ‚Ä¢ Th√™m ti√™u ƒë·ªÅ: <strong>"Tr·∫Øc nghi·ªám (MCQ)"</strong>
-              </p>
-              <p>‚Ä¢ M·ªói d√≤ng: C√¢u h·ªèi (c·ªôt 1) + 4 ƒë√°p √°n (c·ªôt 2-5)</p>
-              <p>‚Ä¢ ƒê√°nh d·∫•u * ·ªü cu·ªëi ƒë√°p √°n ƒë√∫ng</p>
-              <p>
-                ‚Ä¢ V√≠ d·ª•: "What is AI?" | "Option A" | "Option B*" | "Option C" |
-                "Option D"
-              </p>
-            </div>
-            <div className="mt-2 border-t pt-2">
-              <p className="font-semibold">‚úçÔ∏è Ph·∫ßn T·ª± lu·∫≠n (Essay):</p>
-              <p>
-                ‚Ä¢ Th√™m ti√™u ƒë·ªÅ: <strong>"T·ª± lu·∫≠n (Essay):"</strong>
-              </p>
-              <p>
-                ‚Ä¢ Format trong Excel: <strong>"C√¢u h·ªèi: ..."</strong> v√†{" "}
-                <strong>"C√¢u tr·∫£ l·ªùi: ..."</strong>
-              </p>
-              <p>
-                ‚Ä¢ V√≠ d·ª•: "C√¢u 1: C√¢u h·ªèi: trong l·ªãch s·ª≠ vi·ªát nam c√≥ bao nhi√™u v·ªã
-                vua? C√¢u tr·∫£ l·ªùi: C√≥ 8 v·ªã vua."
-              </p>
-            </div>
-          </div>
-        </div>
-
-        {/* Action buttons */}
-        <div className="flex gap-3 mt-4">
-          <button
-            onClick={handleUpload}
-            disabled={!uploadedFile || loading}
-            className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition flex items-center gap-2"
-          >
-            {loading ? (
-              <LoadingSpinner size="sm" text="" />
-            ) : (
-              <>
-                <FiUpload className="w-5 h-5" />
-                Ph√¢n t√≠ch file
-              </>
-            )}
-          </button>
-
-          {previewData && (
-            <button
-              onClick={handleReset}
-              className="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition flex items-center gap-2"
-            >
-              <FiX className="w-5 h-5" />
-              Reset
-            </button>
-          )}
-          {/* Th√¥ng b√°o th√†nh c√¥ng */}
-          {message && (
-            <span className="text-green-400 font-semibold ml-2">{message}</span>
-          )}
-        </div>
-
-        {/* Error message */}
-        {error && (
-          <div className="mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
-            <p className="text-sm text-red-700">{error}</p>
-          </div>
-        )}
-      </div>
-
-      {/* Preview Section */}
-      {previewData && (
-        <div className="bg-white rounded-xl shadow-sm p-6">
-          <div className="flex items-center justify-between mb-6">
-            <h2 className="text-xl font-semibold text-gray-700 flex items-center gap-2">
-              <FiFile className="w-6 h-6" />
-              Preview - Xem tr∆∞·ªõc
-            </h2>
-
-            {/* Summary */}
-            <div className="flex gap-4">
-              <div className="text-center px-4 py-2 bg-blue-50 rounded-lg">
-                <p className="text-2xl font-bold text-blue-600">
-                  {previewData.summary.total}
-                </p>
-                <p className="text-xs text-blue-600">T·ªïng c·ªông</p>
-              </div>
-              <div className="text-center px-4 py-2 bg-green-50 rounded-lg">
-                <p className="text-2xl font-bold text-green-600">
-                  {previewData.summary.mcq}
-                </p>
-                <p className="text-xs text-green-600">Tr·∫Øc nghi·ªám</p>
-              </div>
-              <div className="text-center px-4 py-2 bg-purple-50 rounded-lg">
-                <p className="text-2xl font-bold text-purple-600">
-                  {previewData.summary.essay}
-                </p>
-                <p className="text-xs text-purple-600">T·ª± lu·∫≠n</p>
-              </div>
-              {previewData.summary.errors > 0 && (
-                <div className="text-center px-4 py-2 bg-red-50 rounded-lg">
-                  <p className="text-2xl font-bold text-red-600">
-                    {previewData.summary.errors}
-                  </p>
-                  <p className="text-xs text-red-600">L·ªói</p>
-                </div>
-              )}
-            </div>
-          </div>
-
-          {/* Questions list */}
-          <div className="space-y-4 max-h-96 overflow-y-auto">
-            {previewData.preview.map((q, idx) => (
-              <div
-                key={idx}
-                className={`p-4 rounded-lg border-2 ${
-                  q.errors.length > 0
-                    ? "border-red-300 bg-red-50"
-                    : "border-gray-200 bg-gray-50"
-                }`}
-              >
-                <div className="flex items-start gap-3">
-                  <div
-                    className={`p-2 rounded-full ${
-                      q.type === "MCQ" ? "bg-green-100" : "bg-purple-100"
-                    }`}
-                  >
-                    {q.type === "MCQ" ? (
-                      <FiType className="w-5 h-5 text-green-600" />
-                    ) : (
-                      <FiAlignLeft className="w-5 h-5 text-purple-600" />
-                    )}
-                  </div>
-
-                  <div className="flex-1">
-                    <div className="flex items-center gap-2 mb-2">
-                      <span className="text-sm font-semibold text-gray-500">
-                        Row {q.row}
-                      </span>
-                      <span
-                        className={`px-2 py-1 rounded text-xs font-semibold ${
-                          q.type === "MCQ"
-                            ? "bg-green-100 text-green-700"
-                            : "bg-purple-100 text-purple-700"
-                        }`}
-                      >
-                        {q.type}
-                      </span>
-                    </div>
-
-                    <p className="font-medium text-gray-800 mb-2">
-                      {renderQuestionText(q)}
-                    </p>
-
-                    {/* MCQ Options */}
-                    {q.type === "MCQ" && q.options && (
-                      <div className="ml-4 space-y-1">
-                        {q.options.map((opt, optIdx) => (
-                          <div
-                            key={optIdx}
-                            className={`text-sm flex items-center gap-2 ${
-                              optIdx === q.correct_option
-                                ? "text-green-600 font-semibold"
-                                : "text-gray-600"
-                            }`}
-                          >
-                            <span className="w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center text-xs">
-                              {String.fromCharCode(65 + optIdx)}
-                            </span>
-                            {opt}
-                            {optIdx === q.correct_option && (
-                              <span className="text-green-600">‚úì</span>
-                            )}
-                          </div>
-                        ))}
-                      </div>
-                    )}
-
-                    {/* Essay Model Answer */}
-                    {q.type === "Essay" && q.model_answer && (
-                      <div className="ml-4 p-2 bg-gray-100 rounded text-sm text-gray-700">
-                        <strong>ƒê√°p √°n m·∫´u:</strong> {q.model_answer}
-                      </div>
-                    )}
-
-                    {/* Errors */}
-                    {q.errors.length > 0 && (
-                      <div className="mt-2 p-2 bg-red-100 rounded text-sm text-red-700">
-                        {q.errors.map((err, errIdx) => (
-                          <p key={errIdx}>‚ö†Ô∏è {err}</p>
-                        ))}
-                      </div>
-                    )}
-                  </div>
-                </div>
-              </div>
-            ))}
-          </div>
-
-          {/* Commit button */}
-          {previewData.summary.errors === 0 && (
-            <div className="mt-6 flex flex-col md:flex-row items-center justify-between gap-4">
-              <div className="flex-1 max-w-xl">
-                <input
-                  id="examTitle"
-                  type="text"
-                  value={examTitle}
-                  onChange={(e) => {
-                    setExamTitle(e.target.value);
-                    if (error) setError("");
-                  }}
-                  placeholder="Nh·∫≠p t√™n ƒë·ªÅ thi c·ªßa b·∫°n"
-                  className="w-full border border-gray-300 rounded-lg px-5 py-4 text-lg text-gray-800
-                   focus:outline-none focus:ring-1 focus:ring-emerald-400 focus:border-emerald-400
-                   placeholder-gray-400 transition"
-                />
-              </div>
-
-              {/* N√∫t l∆∞u */}
-              <div className="shrink-0">
-                <button
-                  onClick={handleCommit}
-                  disabled={loading}
-                  className="px-8 py-4 bg-green-600 text-white text-lg rounded-lg hover:bg-green-700 
-                   disabled:bg-gray-400 disabled:cursor-not-allowed transition flex items-center gap-2"
-                >
-                  {loading ? (
-                    <LoadingSpinner size="sm" text="ƒêang x·ª≠ l√Ω..." />
-                  ) : (
-                    <>
-                      <FiCheck className="w-5 h-5" />
-                      X√°c nh·∫≠n & l∆∞u
-                    </>
-                  )}
-                </button>
-              </div>
-            </div>
-          )}
-        </div>
-      )}
-    </div>
-  );
-};
-
-export default ExamBank;
+import React, { useState } from "react";
+import {
+  FiUpload,
+  FiFile,
+  FiCheck,
+  FiX,
+  FiType,
+  FiAlignLeft,
+} from "react-icons/fi";
+import axios from "axios";
+import * as XLSX from "xlsx";
+import LoadingSpinner from "../../components/LoadingSpinner";
+
+const ExamBank = () => {
+  const [uploadedFile, setUploadedFile] = useState(null);
+  const [previewData, setPreviewData] = useState(null);
+  const [examTitle, setExamTitle] = useState("");
+  const [loading, setLoading] = useState(false);
+  const [error, setError] = useState(null);
+  const [jobId, setJobId] = useState(null);
+  const [duration, setDuration] = useState("");
+  const [message, setMessage] = useState("");
+
+  // Handle file selection
+  const handleFileChange = (e) => {
+    const file = e.target.files?.[0];
+    if (!file) return;
+
+    if (!file.name.endsWith(".xlsx") && !file.name.endsWith(".xls")) {
+      setError("‚ö†Ô∏è Vui l√≤ng ch·ªçn file Excel (.xlsx ho·∫∑c .xls)");
+      return;
+    }
+
+    setUploadedFile(file);
+    setError(null);
+    setPreviewData(null);
+    setJobId(null);
+  };
+
+  // Parse Excel and classify questions
+  const parseExcelFile = async (file) => {
+    try {
+      const data = await file.arrayBuffer();
+      const workbook = XLSX.read(data, { type: "array" });
+
+      if (!workbook.SheetNames || workbook.SheetNames.length === 0) {
+        throw new Error("File Excel kh√¥ng c√≥ sheet n√†o");
+      }
+
+      const sheetName = workbook.SheetNames[0];
+      const worksheet = workbook.Sheets[sheetName];
+      const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
+
+      if (jsonData.length < 2) {
+        throw new Error("File Excel ph·∫£i c√≥ √≠t nh·∫•t 1 d√≤ng d·ªØ li·ªáu");
+      }
+
+      // Parse data by sections
+      const questions = [];
+      let currentSection = null;
+      let rowIndex = 0;
+
+      for (let i = 0; i < jsonData.length; i++) {
+        const row = jsonData[i];
+        if (!row || row.length === 0) {
+          rowIndex++;
+          continue;
+        }
+
+        // Convert row to text
+        const rowText = row
+          .map((cell) => cell?.toString().trim() || "")
+          .join(" ");
+
+        // Check for section markers
+        if (rowText.includes("Tr·∫Øc nghi·ªám") && rowText.includes("MCQ")) {
+          currentSection = "MCQ";
+          rowIndex++;
+          continue;
+        } else if (rowText.includes("T·ª± lu·∫≠n") && rowText.includes("Essay")) {
+          currentSection = "Essay";
+          rowIndex++;
+          continue;
+        }
+
+        // Skip empty rows or section headers
+        if (!currentSection || rowText.length === 0) {
+          rowIndex++;
+          continue;
+        }
+
+        // Parse based on section
+        if (currentSection === "MCQ") {
+          // MCQ: Each row has question + 4 options
+          const questionText = row[0]?.toString().trim() || "";
+          if (!questionText) {
+            rowIndex++;
+            continue;
+          }
+
+          const options = [];
+          for (let j = 1; j <= 4; j++) {
+            const opt = row[j]?.toString().trim() || "";
+            if (opt) {
+              options.push(opt);
+            }
+          }
+
+          const questionData = {
+            row: rowIndex + 1,
+            question_text: questionText,
+            type: "MCQ",
+            errors: [],
+          };
+
+          // Find correct answer (marked with *)
+          let correctOption = null;
+          const cleanOptions = options.map((opt, idx) => {
+            const trimmed = opt.trim();
+            if (trimmed.endsWith("*")) {
+              correctOption = idx;
+              return trimmed.replace(/\*+$/, "").trim();
+            }
+            return trimmed;
+          });
+
+          // Validation
+          if (options.length < 2) {
+            questionData.errors.push(
+              "C√¢u h·ªèi tr·∫Øc nghi·ªám ph·∫£i c√≥ √≠t nh·∫•t 2 ƒë√°p √°n"
+            );
+          }
+          if (correctOption === null && options.length > 0) {
+            questionData.errors.push(
+              "Kh√¥ng t√¨m th·∫•y ƒë√°p √°n ƒë√∫ng (c·∫ßn ƒë√°nh d·∫•u * ·ªü cu·ªëi ƒë√°p √°n)"
+            );
+          }
+
+          questionData.options = cleanOptions;
+          questionData.correct_option =
+            correctOption !== null ? correctOption : null;
+
+          questions.push(questionData);
+        } else if (currentSection === "Essay") {
+          // Essay: Look for "C√¢u h·ªèi:" and "C√¢u tr·∫£ l·ªùi:" in the text
+          const fullText = row
+            .map((cell) => cell?.toString().trim() || "")
+            .join(" ");
+
+          // Try to find question and answer pattern
+          const questionMatch = fullText.match(/C√¢u h·ªèi:\s*([^\n]+)/i);
+          const answerMatch = fullText.match(/C√¢u tr·∫£ l·ªùi:\s*([^\n]+)/i);
+
+          if (questionMatch || answerMatch) {
+            const questionData = {
+              row: rowIndex + 1,
+              question_text: questionMatch ? questionMatch[1].trim() : "",
+              type: "Essay",
+              model_answer: answerMatch ? answerMatch[1].trim() : "",
+              errors: [],
+            };
+
+            if (!questionData.question_text) {
+              questionData.errors.push(
+                'Kh√¥ng t√¨m th·∫•y "C√¢u h·ªèi:" trong vƒÉn b·∫£n'
+              );
+            }
+            if (!questionData.model_answer) {
+              questionData.errors.push(
+                'Kh√¥ng t√¨m th·∫•y "C√¢u tr·∫£ l·ªùi:" trong vƒÉn b·∫£n'
+              );
+            }
+
+            questions.push(questionData);
+          }
+        }
+
+        rowIndex++;
+      }
+
+      const summary = {
+        total: questions.length,
+        mcq: questions.filter((q) => q.type === "MCQ").length,
+        essay: questions.filter((q) => q.type === "Essay").length,
+        errors: questions.filter((q) => q.errors.length > 0).length,
+      };
+
+      return { preview: questions, summary };
+    } catch (err) {
+      throw new Error(`L·ªói parse file Excel: ${err.message}`);
+    }
+  };
+
+  // Handle file upload
+  const handleUpload = async () => {
+    if (!uploadedFile) {
+      setError("‚ö†Ô∏è Vui l√≤ng ch·ªçn file tr∆∞·ªõc khi upload");
+      return;
+    }
+
+    setLoading(true);
+    setError(null);
+
+    try {
+      const result = await parseExcelFile(uploadedFile);
+      setPreviewData(result);
+    } catch (err) {
+      setError(err.message);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  // Handle commit to database
+  const handleCommit = async () => {
+    if (!previewData) {
+      setError("‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ commit");
+      return;
+    }
+
+    if (!examTitle || examTitle.trim() === "") {
+      setError("‚ö†Ô∏è Vui l√≤ng nh·∫≠p t√™n ƒë·ªÅ thi tr∆∞·ªõc khi l∆∞u");
+      return;
+    }
+
+    const hasErrors = previewData.preview.some((q) => q.errors.length > 0);
+    if (hasErrors) {
+      setError("‚ö†Ô∏è C√≥ c√¢u h·ªèi b·ªã l·ªói. Vui l√≤ng ki·ªÉm tra l·∫°i tr∆∞·ªõc khi commit");
+      return;
+    }
+
+    setLoading(true);
+    setError(null);
+
+    try {
+      const token = localStorage.getItem("token");
+      const response = await axios.post(
+        "http://localhost:5000/api/exam-bank/import-commit",
+        {
+          preview: previewData.preview,
+          summary: previewData.summary,
+          exam_title: examTitle,
+          duration: parseInt(duration, 10) || 60,
+        },
+        {
+          headers: { Authorization: `Bearer ${token}` },
+        }
+      );
+
+      if (response.data.status === "success") {
+        setMessage(
+          `‚úÖ Import th√†nh c√¥ng! ƒê√£ th√™m ${previewData.summary.total} c√¢u h·ªèi v√†o ng√¢n h√†ng.\nExam ID: ${response.data.exam_id}`
+        );
+        setTimeout(() => setMessage(""), 10000);
+        setPreviewData(null);
+        setUploadedFile(null);
+        setExamTitle("");
+        const fileInput = document.getElementById("fileInput");
+        if (fileInput) fileInput.value = "";
+      } else {
+        setError(
+          "‚ùå Import th·∫•t b·∫°i! Backend kh√¥ng tr·∫£ v·ªÅ tr·∫°ng th√°i success."
+        );
+      }
+    } catch (err) {
+      setError(
+        "‚ùå L·ªói khi commit d·ªØ li·ªáu: " +
+          (err.response?.data?.message || err.message)
+      );
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  // Handle reset
+  const handleReset = () => {
+    setPreviewData(null);
+    setUploadedFile(null);
+    setError(null);
+    const fileInput = document.getElementById("fileInput");
+    if (fileInput) fileInput.value = "";
+  };
+
+  const renderQuestionText = (q) => {
+    const scorePattern = /\((\d+(?:[.,]\d+)?)ƒë\)/i;
+    const match = q.question_text.match(scorePattern);
+    const point = match ? match[1].replace(",", ".") : q.points || "?";
+    const textWithoutPoint = q.question_text.replace(scorePattern, "").trim();
+    return `${textWithoutPoint} (${point}ƒë)`;
+  };
+
+  return (
+    <div className="p-6 bg-gray-50 min-h-screen">
+      {/* Header */}
+      <div className="mb-8">
+        <h1 className="text-3xl font-bold text-gray-800 mb-2">
+          Ng√¢n h√†ng ƒë·ªÅ thi
+        </h1>
+        <p className="text-gray-600">
+          Upload file Excel ƒë·ªÉ import c√¢u h·ªèi v√†o h·ªá th·ªëng
+        </p>
+      </div>
+
+      {/* Upload Section */}
+      <div className="bg-white rounded-xl shadow-sm p-6 mb-6">
+        <h2 className="text-xl font-semibold text-gray-700 mb-4 flex items-center gap-2">
+          <FiUpload className="w-6 h-6" />
+          Upload file Excel
+        </h2>
+
+        <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-blue-400 transition">
+          <div className="flex flex-col items-center gap-4">
+            <input
+              id="fileInput"
+              type="file"
+              accept=".xlsx,.xls"
+              onChange={handleFileChange}
+              className="hidden"
+            />
+
+            {uploadedFile ? (
+              <div className="flex items-center gap-3 text-blue-600">
+                <FiFile className="w-6 h-6" />
+                <span className="font-medium">{uploadedFile.name}</span>
+                <span className="text-sm text-gray-500">
+                  ({(uploadedFile.size / 1024).toFixed(2)} KB)
+                </span>
+              </div>
+            ) : (
+              <label htmlFor="fileInput" className="cursor-pointer">
+                <div className="flex flex-col items-center gap-2 text-gray-400 hover:text-blue-500 transition">
+                  <FiUpload className="w-12 h-12" />
+                  <span className="text-sm font-medium">
+                    Click ƒë·ªÉ ch·ªçn file
+                  </span>
+                  <span className="text-xs">.xlsx ho·∫∑c .xls</span>
+                </div>
+              </label>
+            )}
+          </div>
+        </div>
+
+        {/* Instructions */}
+        <div className="mt-4 p-4 bg-blue-50 rounded-lg">
+          <p className="text-sm font-semibold text-blue-800 mb-2">
+            üìã H∆∞·ªõng d·∫´n format file Excel:
+          </p>
+          <div className="text-sm text-blue-700 space-y-2">
+            <div>
+              <p className="font-semibold">üìù Ph·∫ßn Tr·∫Øc nghi·ªám (MCQ):</p>
+              <p>
+                ‚Ä¢ Th√™m ti√™u ƒë·ªÅ: <strong>"Tr·∫Øc nghi·ªám (MCQ)"</strong>
+              </p>
+              <p>‚Ä¢ M·ªói d√≤ng: C√¢u h·ªèi (c·ªôt 1) + 4 ƒë√°p √°n (c·ªôt 2-5)</p>
+              <p>‚Ä¢ ƒê√°nh d·∫•u * ·ªü cu·ªëi ƒë√°p √°n ƒë√∫ng</p>
+              <p>
+                ‚Ä¢ V√≠ d·ª•: "What is AI?" | "Option A" | "Option B*" | "Option C" |
+                "Option D"
+              </p>
+            </div>
+            <div className="mt-2 border-t pt-2">
+              <p className="font-semibold">‚úçÔ∏è Ph·∫ßn T·ª± lu·∫≠n (Essay):</p>
+              <p>
+                ‚Ä¢ Th√™m ti√™u ƒë·ªÅ: <strong>"T·ª± lu·∫≠n (Essay):"</strong>
+              </p>
+              <p>
+                ‚Ä¢ Format trong Excel: <strong>"C√¢u h·ªèi: ..."</strong> v√†{" "}
+                <strong>"C√¢u tr·∫£ l·ªùi: ..."</strong>
+              </p>
+              <p>
+                ‚Ä¢ V√≠ d·ª•: "C√¢u 1: C√¢u h·ªèi: trong l·ªãch s·ª≠ vi·ªát nam c√≥ bao nhi√™u v·ªã
+                vua? C√¢u tr·∫£ l·ªùi: C√≥ 8 v·ªã vua."
+              </p>
+            </div>
+          </div>
+        </div>
+
+        {/* Action buttons */}
+        <div className="flex gap-3 mt-4">
+          <button
+            onClick={handleUpload}
+            disabled={!uploadedFile || loading}
+            className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition flex items-center gap-2"
+          >
+            {loading ? (
+              <LoadingSpinner size="sm" text="" />
+            ) : (
+              <>
+                <FiUpload className="w-5 h-5" />
+                Ph√¢n t√≠ch file
+              </>
+            )}
+          </button>
+
+          {previewData && (
+            <button
+              onClick={handleReset}
+              className="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition flex items-center gap-2"
+            >
+              <FiX className="w-5 h-5" />
+              Reset
+            </button>
+          )}
+          {/* Th√¥ng b√°o th√†nh c√¥ng */}
+          {message && (
+            <span className="text-green-400 font-semibold ml-2">{message}</span>
+          )}
+        </div>
+
+        {/* Error message */}
+        {error && (
+          <div className="mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
+            <p className="text-sm text-red-700">{error}</p>
+          </div>
+        )}
+      </div>
+
+      {/* Preview Section */}
+      {previewData && (
+        <div className="bg-white rounded-xl shadow-sm p-6">
+          <div className="flex items-center justify-between mb-6">
+            <h2 className="text-xl font-semibold text-gray-700 flex items-center gap-2">
+              <FiFile className="w-6 h-6" />
+              Preview - Xem tr∆∞·ªõc
+            </h2>
+
+            {/* Summary */}
+            <div className="flex gap-4">
+              <div className="text-center px-4 py-2 bg-blue-50 rounded-lg">
+                <p className="text-2xl font-bold text-blue-600">
+                  {previewData.summary.total}
+                </p>
+                <p className="text-xs text-blue-600">T·ªïng c·ªông</p>
+              </div>
+              <div className="text-center px-4 py-2 bg-green-50 rounded-lg">
+                <p className="text-2xl font-bold text-green-600">
+                  {previewData.summary.mcq}
+                </p>
+                <p className="text-xs text-green-600">Tr·∫Øc nghi·ªám</p>
+              </div>
+              <div className="text-center px-4 py-2 bg-purple-50 rounded-lg">
+                <p className="text-2xl font-bold text-purple-600">
+                  {previewData.summary.essay}
+                </p>
+                <p className="text-xs text-purple-600">T·ª± lu·∫≠n</p>
+              </div>
+              {previewData.summary.errors > 0 && (
+                <div className="text-center px-4 py-2 bg-red-50 rounded-lg">
+                  <p className="text-2xl font-bold text-red-600">
+                    {previewData.summary.errors}
+                  </p>
+                  <p className="text-xs text-red-600">L·ªói</p>
+                </div>
+              )}
+            </div>
+          </div>
+
+          {/* Questions list */}
+          <div className="space-y-4 max-h-96 overflow-y-auto">
+            {previewData.preview.map((q, idx) => (
+              <div
+                key={idx}
+                className={`p-4 rounded-lg border-2 ${
+                  q.errors.length > 0
+                    ? "border-red-300 bg-red-50"
+                    : "border-gray-200 bg-gray-50"
+                }`}
+              >
+                <div className="flex items-start gap-3">
+                  <div
+                    className={`p-2 rounded-full ${
+                      q.type === "MCQ" ? "bg-green-100" : "bg-purple-100"
+                    }`}
+                  >
+                    {q.type === "MCQ" ? (
+                      <FiType className="w-5 h-5 text-green-600" />
+                    ) : (
+                      <FiAlignLeft className="w-5 h-5 text-purple-600" />
+                    )}
+                  </div>
+
+                  <div className="flex-1">
+                    <div className="flex items-center gap-2 mb-2">
+                      <span className="text-sm font-semibold text-gray-500">
+                        Row {q.row}
+                      </span>
+                      <span
+                        className={`px-2 py-1 rounded text-xs font-semibold ${
+                          q.type === "MCQ"
+                            ? "bg-green-100 text-green-700"
+                            : "bg-purple-100 text-purple-700"
+                        }`}
+                      >
+                        {q.type}
+                      </span>
+                    </div>
+
+                    <p className="font-medium text-gray-800 mb-2">
+                      {renderQuestionText(q)}
+                    </p>
+
+                    {/* MCQ Options */}
+                    {q.type === "MCQ" && q.options && (
+                      <div className="ml-4 space-y-1">
+                        {q.options.map((opt, optIdx) => (
+                          <div
+                            key={optIdx}
+                            className={`text-sm flex items-center gap-2 ${
+                              optIdx === q.correct_option
+                                ? "text-green-600 font-semibold"
+                                : "text-gray-600"
+                            }`}
+                          >
+                            <span className="w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center text-xs">
+                              {String.fromCharCode(65 + optIdx)}
+                            </span>
+                            {opt}
+                            {optIdx === q.correct_option && (
+                              <span className="text-green-600">‚úì</span>
+                            )}
+                          </div>
+                        ))}
+                      </div>
+                    )}
+
+                    {/* Essay Model Answer */}
+                    {q.type === "Essay" && q.model_answer && (
+                      <div className="ml-4 p-2 bg-gray-100 rounded text-sm text-gray-700">
+                        <strong>ƒê√°p √°n m·∫´u:</strong> {q.model_answer}
+                      </div>
+                    )}
+
+                    {/* Errors */}
+                    {q.errors.length > 0 && (
+                      <div className="mt-2 p-2 bg-red-100 rounded text-sm text-red-700">
+                        {q.errors.map((err, errIdx) => (
+                          <p key={errIdx}>‚ö†Ô∏è {err}</p>
+                        ))}
+                      </div>
+                    )}
+                  </div>
+                </div>
+              </div>
+            ))}
+          </div>
+
+          {/* Commit button */}
+          {previewData.summary.errors === 0 && (
+            <div className="mt-6 flex flex-col md:flex-row items-center justify-between gap-4">
+              <div className="flex-1 max-w-xl">
+                <input
+                  id="examTitle"
+                  type="text"
+                  value={examTitle}
+                  onChange={(e) => {
+                    setExamTitle(e.target.value);
+                    if (error) setError("");
+                  }}
+                  placeholder="Nh·∫≠p t√™n ƒë·ªÅ thi c·ªßa b·∫°n"
+                  className="w-full border border-gray-300 rounded-lg px-5 py-4 text-lg text-gray-800
+                   focus:outline-none focus:ring-1 focus:ring-emerald-400 focus:border-emerald-400
+                   placeholder-gray-400 transition"
+                />
+              </div>
+
+              {/* N√∫t l∆∞u */}
+              <div className="shrink-0">
+                <button
+                  onClick={handleCommit}
+                  disabled={loading}
+                  className="px-8 py-4 bg-green-600 text-white text-lg rounded-lg hover:bg-green-700 
+                   disabled:bg-gray-400 disabled:cursor-not-allowed transition flex items-center gap-2"
+                >
+                  {loading ? (
+                    <LoadingSpinner size="sm" text="ƒêang x·ª≠ l√Ω..." />
+                  ) : (
+                    <>
+                      <FiCheck className="w-5 h-5" />
+                      X√°c nh·∫≠n & l∆∞u
+                    </>
+                  )}
+                </button>
+              </div>
+            </div>
+          )}
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default ExamBank;
diff --git a/frontend/src/pages/instructorPage/InstructorDashboard.jsx b/frontend/src/pages/instructorPage/InstructorDashboard.jsx
index 3b1be54..9935105 100644
--- a/frontend/src/pages/instructorPage/InstructorDashboard.jsx
+++ b/frontend/src/pages/instructorPage/InstructorDashboard.jsx
@@ -1,278 +1,278 @@
-import React, { useState, useEffect } from "react";
-import { BarChart, Bar, XAxis, Tooltip, ResponsiveContainer } from "recharts";
-import { FiLogOut } from "react-icons/fi";
-import { useNavigate } from "react-router-dom";
-import axios from "axios";
-import axiosClient from "../../api/axiosClient";
-
-const InstructorDashboard = () => {
-  const navigate = useNavigate();
-
-  // üß† State
-  const [stats, setStats] = useState({
-    total_exams_created: 0,
-    total_tests_submitted: 0,
-    total_students_participated: 0,
-  });
-  const [monthlyData, setMonthlyData] = useState([]);
-  const [userInfo, setUserInfo] = useState({
-    fullname: "Gi·∫£ng vi√™n",
-    avatar: "/icons/UI Image/default-avatar.png",
-  });
-
-  // üß≠ Fetch dashboard summary
-  useEffect(() => {
-    const fetchStats = async () => {
-      try {
-        const token = localStorage.getItem("token");
-        const res = await axios.get(
-          "http://localhost:5000/api/instructor/dashboard",
-          {
-            headers: { Authorization: `Bearer ${token}` },
-          }
-        );
-        setStats({
-          total_exams_created: res.data.total_exams_created || 0,
-          total_tests_submitted: res.data.total_tests_submitted || 0,
-          total_students_participated:
-            res.data.total_students_participated || 0,
-        });
-      } catch (err) {
-        console.error("‚ùå L·ªói l·∫•y d·ªØ li·ªáu th·ªëng k√™:", err);
-      }
-    };
-    fetchStats();
-  }, []);
-
-  // üß≠ Fetch user info
-  useEffect(() => {
-    // Prefer avatar stored in localStorage (updated by Profile page upload)
-    const localAvatar = localStorage.getItem("avatar");
-    const localFullname = localStorage.getItem("fullname");
-    if (localAvatar || localFullname) {
-      setUserInfo((prev) => ({
-        ...prev,
-        fullname: localFullname || prev.fullname,
-        avatar: localAvatar || prev.avatar,
-      }));
-    }
-
-    // Try to load the canonical profile endpoint which returns the avatar/fullname
-    const fetchUser = async () => {
-      try {
-        const res = await axiosClient.get('/profile');
-        const user = res.data && res.data.data;
-        if (user) {
-          const avatarUrl = user.avatar || localAvatar || "/icons/UI Image/default-avatar.png";
-          const fullname = user.full_name || localFullname || "Gi·∫£ng vi√™n";
-          try {
-            if (avatarUrl) localStorage.setItem('avatar', avatarUrl);
-            if (fullname) localStorage.setItem('fullname', fullname);
-          } catch (e) {}
-          setUserInfo({ fullname, avatar: avatarUrl });
-          return;
-        }
-      } catch (err) {
-        // If profile endpoint fails, silently fallback to localStorage ‚Äî keep console for debug
-        console.warn('Failed to load /api/profile for header avatar:', err?.response || err?.message || err);
-      }
-    };
-    fetchUser();
-
-    // Listen for storage changes (avatar updated in Profile page)
-    const onStorage = (e) => {
-      if (e.key === 'avatar' || e.key === 'fullname') {
-        setUserInfo((prev) => ({
-          ...prev,
-          avatar: localStorage.getItem('avatar') || prev.avatar,
-          fullname: localStorage.getItem('fullname') || prev.fullname,
-        }));
-      }
-    };
-
-    // Also listen for an in-tab custom event dispatched by the Profile page
-    const onProfileUpdated = () => {
-      setUserInfo((prev) => ({
-        ...prev,
-        avatar: localStorage.getItem('avatar') || prev.avatar,
-        fullname: localStorage.getItem('fullname') || prev.fullname,
-      }));
-    };
-
-    window.addEventListener('storage', onStorage);
-    window.addEventListener('profileUpdated', onProfileUpdated);
-    return () => {
-      window.removeEventListener('storage', onStorage);
-      window.removeEventListener('profileUpdated', onProfileUpdated);
-    };
-  }, []);
-
-  // üß≠ Fetch monthly chart data
-  useEffect(() => {
-    const fetchMonthly = async () => {
-      try {
-        const token = localStorage.getItem("token");
-        const res = await axios.get(
-          "http://localhost:5000/api/instructor/dashboard/monthly",
-          {
-            headers: { Authorization: `Bearer ${token}` },
-          }
-        );
-        const formatted = res.data.map((item) => ({
-          name: `T${item.month}`,
-          exams: item.exams_created,
-          students: item.students_participated,
-        }));
-        setMonthlyData(formatted);
-      } catch (err) {
-        console.error("‚ùå Failed to fetch monthly stats:", err);
-      }
-    };
-    fetchMonthly();
-  }, []);
-
-  // üß≠ Logout
-  const handleLogout = () => {
-    localStorage.clear();
-    navigate("/login");
-  };
-
-  return (
-    <div className="flex bg-gray-50 min-h-screen">
-      <main className="flex-1 p-6">
-        {/* Header */}
-        <div className="flex justify-end items-center mb-6">
-          <div
-            onClick={() => navigate("/profile")}
-            className="flex items-center gap-3 px-4 py-2 cursor-pointer hover:bg-gray-100 rounded-lg transition"
-          >
-            <img
-              src={userInfo.avatar}
-              alt="User Avatar"
-              title="Xem h·ªì s∆° c√° nh√¢n"
-              className="w-10 h-10 rounded-full border border-gray-200 object-cover"
-            />
-            <div className="flex items-center gap-2">
-              <p className="text-gray-500 text-sm leading-tight">Xin ch√†o,</p>
-              <p className="font-semibold text-[#606060]">
-                {userInfo.fullname}
-              </p>
-            </div>
-          </div>
-          <button
-            onClick={handleLogout}
-            className="flex items-center justify-center w-9 h-9 rounded-full hover:bg-gray-100 transition"
-            title="ƒêƒÉng xu·∫•t"
-          >
-            <FiLogOut className="w-5 h-5 text-gray-600" />
-          </button>
-        </div>
-
-        {/* Summary Cards */}
-        <div className="grid grid-cols-1 sm:grid-cols-3 gap-6">
-          {/* T·ªïng s·ªë ƒë·ªÅ ƒë√£ t·∫°o */}
-          <div className="bg-white rounded-xl shadow-sm p-6 flex flex-col justify-between border border-slate-200">
-            <div className="flex items-center gap-4">
-              <div className="bg-green-500 p-3 rounded-full flex items-center justify-center">
-                <img
-                  src="./icons/UI Image/student.png"
-                  alt="icon"
-                  className="w-6 h-6"
-                />
-              </div>
-              <div>
-                <p className="text-2xl font-bold text-gray-700">
-                  {stats.total_exams_created}
-                </p>
-                <p className="text-gray-500">T·ªïng s·ªë ƒë·ªÅ ƒë√£ t·∫°o</p>
-              </div>
-            </div>
-            <a
-              href="#"
-              className="text-gray-400 hover:text-gray-600 text-sm mt-4 self-end"
-            >
-              Xem ‚Üí
-            </a>
-          </div>
-
-          {/* T·ªïng s·ªë b√†i ki·ªÉm tra */}
-          <div className="bg-white rounded-xl shadow-sm p-6 flex flex-col justify-between border border-slate-200">
-            <div className="flex items-center gap-4">
-              <div className="bg-red-500 p-3 rounded-full flex items-center justify-center">
-                <img
-                  src="./icons/UI Image/student1.png"
-                  alt="icon"
-                  className="w-6 h-6"
-                />
-              </div>
-              <div>
-                <p className="text-2xl font-bold text-gray-700">
-                  {stats.total_tests_submitted}
-                </p>
-                <p className="text-gray-500">T·ªïng s·ªë b√†i ki·ªÉm tra</p>
-              </div>
-            </div>
-            <a
-              href="#"
-              className="text-gray-400 hover:text-gray-600 text-sm mt-4 self-end"
-            >
-              Xem ‚Üí
-            </a>
-          </div>
-
-          {/* T·ªïng s·ªë th√≠ sinh ƒë√£ thi */}
-          <div className="bg-white rounded-xl shadow-sm p-6 flex flex-col justify-between border border-slate-200">
-            <div className="flex items-center gap-4">
-              <div className="bg-purple-500 p-3 rounded-full flex items-center justify-center">
-                <img
-                  src="./icons/UI Image/student2.png"
-                  alt="icon"
-                  className="w-6 h-6"
-                />
-              </div>
-              <div>
-                <p className="text-2xl font-bold text-gray-700">
-                  {stats.total_students_participated}
-                </p>
-                <p className="text-gray-500">T·ªïng s·ªë th√≠ sinh ƒë√£ thi</p>
-              </div>
-            </div>
-            <a
-              href="#"
-              className="text-gray-400 hover:text-gray-600 text-sm mt-4 self-end"
-            >
-              Xem ‚Üí
-            </a>
-          </div>
-        </div>
-
-        {/* Charts */}
-        <div className="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-8">
-          <div className="bg-white rounded-xl shadow-sm p-4 border border-slate-200">
-            <h2 className="text-gray-700 font-semibold mb-2">Total Exams</h2>
-            <ResponsiveContainer width="100%" height={250}>
-              <BarChart data={monthlyData}>
-                <XAxis dataKey="name" />
-                <Tooltip />
-                <Bar dataKey="exams" fill="#7AB8FF" radius={[6, 6, 0, 0]} />
-              </BarChart>
-            </ResponsiveContainer>
-          </div>
-
-          <div className="bg-white rounded-xl shadow-sm p-4 border border-slate-200">
-            <h2 className="text-gray-700 font-semibold mb-2">Total Students</h2>
-            <ResponsiveContainer width="100%" height={250}>
-              <BarChart data={monthlyData}>
-                <XAxis dataKey="name" />
-                <Tooltip />
-                <Bar dataKey="students" fill="#F88FA1" radius={[6, 6, 0, 0]} />
-              </BarChart>
-            </ResponsiveContainer>
-          </div>
-        </div>
-      </main>
-    </div>
-  );
-};
-
-export default InstructorDashboard;
+import React, { useState, useEffect } from "react";
+import { BarChart, Bar, XAxis, Tooltip, ResponsiveContainer } from "recharts";
+import { FiLogOut } from "react-icons/fi";
+import { useNavigate } from "react-router-dom";
+import axios from "axios";
+import axiosClient from "../../api/axiosClient";
+
+const InstructorDashboard = () => {
+  const navigate = useNavigate();
+
+  // üß† State
+  const [stats, setStats] = useState({
+    total_exams_created: 0,
+    total_tests_submitted: 0,
+    total_students_participated: 0,
+  });
+  const [monthlyData, setMonthlyData] = useState([]);
+  const [userInfo, setUserInfo] = useState({
+    fullname: "Gi·∫£ng vi√™n",
+    avatar: "/icons/UI Image/default-avatar.png",
+  });
+
+  // üß≠ Fetch dashboard summary
+  useEffect(() => {
+    const fetchStats = async () => {
+      try {
+        const token = localStorage.getItem("token");
+        const res = await axios.get(
+          "http://localhost:5000/api/instructor/dashboard",
+          {
+            headers: { Authorization: `Bearer ${token}` },
+          }
+        );
+        setStats({
+          total_exams_created: res.data.total_exams_created || 0,
+          total_tests_submitted: res.data.total_tests_submitted || 0,
+          total_students_participated:
+            res.data.total_students_participated || 0,
+        });
+      } catch (err) {
+        console.error("‚ùå L·ªói l·∫•y d·ªØ li·ªáu th·ªëng k√™:", err);
+      }
+    };
+    fetchStats();
+  }, []);
+
+  // üß≠ Fetch user info
+  useEffect(() => {
+    // Prefer avatar stored in localStorage (updated by Profile page upload)
+    const localAvatar = localStorage.getItem("avatar");
+    const localFullname = localStorage.getItem("fullname");
+    if (localAvatar || localFullname) {
+      setUserInfo((prev) => ({
+        ...prev,
+        fullname: localFullname || prev.fullname,
+        avatar: localAvatar || prev.avatar,
+      }));
+    }
+
+    // Try to load the canonical profile endpoint which returns the avatar/fullname
+    const fetchUser = async () => {
+      try {
+        const res = await axiosClient.get('/profile');
+        const user = res.data && res.data.data;
+        if (user) {
+          const avatarUrl = user.avatar || localAvatar || "/icons/UI Image/default-avatar.png";
+          const fullname = user.full_name || localFullname || "Gi·∫£ng vi√™n";
+          try {
+            if (avatarUrl) localStorage.setItem('avatar', avatarUrl);
+            if (fullname) localStorage.setItem('fullname', fullname);
+          } catch (e) {}
+          setUserInfo({ fullname, avatar: avatarUrl });
+          return;
+        }
+      } catch (err) {
+        // If profile endpoint fails, silently fallback to localStorage ‚Äî keep console for debug
+        console.warn('Failed to load /api/profile for header avatar:', err?.response || err?.message || err);
+      }
+    };
+    fetchUser();
+
+    // Listen for storage changes (avatar updated in Profile page)
+    const onStorage = (e) => {
+      if (e.key === 'avatar' || e.key === 'fullname') {
+        setUserInfo((prev) => ({
+          ...prev,
+          avatar: localStorage.getItem('avatar') || prev.avatar,
+          fullname: localStorage.getItem('fullname') || prev.fullname,
+        }));
+      }
+    };
+
+    // Also listen for an in-tab custom event dispatched by the Profile page
+    const onProfileUpdated = () => {
+      setUserInfo((prev) => ({
+        ...prev,
+        avatar: localStorage.getItem('avatar') || prev.avatar,
+        fullname: localStorage.getItem('fullname') || prev.fullname,
+      }));
+    };
+
+    window.addEventListener('storage', onStorage);
+    window.addEventListener('profileUpdated', onProfileUpdated);
+    return () => {
+      window.removeEventListener('storage', onStorage);
+      window.removeEventListener('profileUpdated', onProfileUpdated);
+    };
+  }, []);
+
+  // üß≠ Fetch monthly chart data
+  useEffect(() => {
+    const fetchMonthly = async () => {
+      try {
+        const token = localStorage.getItem("token");
+        const res = await axios.get(
+          "http://localhost:5000/api/instructor/dashboard/monthly",
+          {
+            headers: { Authorization: `Bearer ${token}` },
+          }
+        );
+        const formatted = res.data.map((item) => ({
+          name: `T${item.month}`,
+          exams: item.exams_created,
+          students: item.students_participated,
+        }));
+        setMonthlyData(formatted);
+      } catch (err) {
+        console.error("‚ùå Failed to fetch monthly stats:", err);
+      }
+    };
+    fetchMonthly();
+  }, []);
+
+  // üß≠ Logout
+  const handleLogout = () => {
+    localStorage.clear();
+    navigate("/login");
+  };
+
+  return (
+    <div className="flex bg-gray-50 min-h-screen">
+      <main className="flex-1 p-6">
+        {/* Header */}
+        <div className="flex justify-end items-center mb-6">
+          <div
+            onClick={() => navigate("/profile")}
+            className="flex items-center gap-3 px-4 py-2 cursor-pointer hover:bg-gray-100 rounded-lg transition"
+          >
+            <img
+              src={userInfo.avatar}
+              alt="User Avatar"
+              title="Xem h·ªì s∆° c√° nh√¢n"
+              className="w-10 h-10 rounded-full border border-gray-200 object-cover"
+            />
+            <div className="flex items-center gap-2">
+              <p className="text-gray-500 text-sm leading-tight">Xin ch√†o,</p>
+              <p className="font-semibold text-[#606060]">
+                {userInfo.fullname}
+              </p>
+            </div>
+          </div>
+          <button
+            onClick={handleLogout}
+            className="flex items-center justify-center w-9 h-9 rounded-full hover:bg-gray-100 transition"
+            title="ƒêƒÉng xu·∫•t"
+          >
+            <FiLogOut className="w-5 h-5 text-gray-600" />
+          </button>
+        </div>
+
+        {/* Summary Cards */}
+        <div className="grid grid-cols-1 sm:grid-cols-3 gap-6">
+          {/* T·ªïng s·ªë ƒë·ªÅ ƒë√£ t·∫°o */}
+          <div className="bg-white rounded-xl shadow-sm p-6 flex flex-col justify-between border border-slate-200">
+            <div className="flex items-center gap-4">
+              <div className="bg-green-500 p-3 rounded-full flex items-center justify-center">
+                <img
+                  src="./icons/UI Image/student.png"
+                  alt="icon"
+                  className="w-6 h-6"
+                />
+              </div>
+              <div>
+                <p className="text-2xl font-bold text-gray-700">
+                  {stats.total_exams_created}
+                </p>
+                <p className="text-gray-500">T·ªïng s·ªë ƒë·ªÅ ƒë√£ t·∫°o</p>
+              </div>
+            </div>
+            <a
+              href="#"
+              className="text-gray-400 hover:text-gray-600 text-sm mt-4 self-end"
+            >
+              Xem ‚Üí
+            </a>
+          </div>
+
+          {/* T·ªïng s·ªë b√†i ki·ªÉm tra */}
+          <div className="bg-white rounded-xl shadow-sm p-6 flex flex-col justify-between border border-slate-200">
+            <div className="flex items-center gap-4">
+              <div className="bg-red-500 p-3 rounded-full flex items-center justify-center">
+                <img
+                  src="./icons/UI Image/student1.png"
+                  alt="icon"
+                  className="w-6 h-6"
+                />
+              </div>
+              <div>
+                <p className="text-2xl font-bold text-gray-700">
+                  {stats.total_tests_submitted}
+                </p>
+                <p className="text-gray-500">T·ªïng s·ªë b√†i ki·ªÉm tra</p>
+              </div>
+            </div>
+            <a
+              href="#"
+              className="text-gray-400 hover:text-gray-600 text-sm mt-4 self-end"
+            >
+              Xem ‚Üí
+            </a>
+          </div>
+
+          {/* T·ªïng s·ªë th√≠ sinh ƒë√£ thi */}
+          <div className="bg-white rounded-xl shadow-sm p-6 flex flex-col justify-between border border-slate-200">
+            <div className="flex items-center gap-4">
+              <div className="bg-purple-500 p-3 rounded-full flex items-center justify-center">
+                <img
+                  src="./icons/UI Image/student2.png"
+                  alt="icon"
+                  className="w-6 h-6"
+                />
+              </div>
+              <div>
+                <p className="text-2xl font-bold text-gray-700">
+                  {stats.total_students_participated}
+                </p>
+                <p className="text-gray-500">T·ªïng s·ªë th√≠ sinh ƒë√£ thi</p>
+              </div>
+            </div>
+            <a
+              href="#"
+              className="text-gray-400 hover:text-gray-600 text-sm mt-4 self-end"
+            >
+              Xem ‚Üí
+            </a>
+          </div>
+        </div>
+
+        {/* Charts */}
+        <div className="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-8">
+          <div className="bg-white rounded-xl shadow-sm p-4 border border-slate-200">
+            <h2 className="text-gray-700 font-semibold mb-2">Total Exams</h2>
+            <ResponsiveContainer width="100%" height={250}>
+              <BarChart data={monthlyData}>
+                <XAxis dataKey="name" />
+                <Tooltip />
+                <Bar dataKey="exams" fill="#7AB8FF" radius={[6, 6, 0, 0]} />
+              </BarChart>
+            </ResponsiveContainer>
+          </div>
+
+          <div className="bg-white rounded-xl shadow-sm p-4 border border-slate-200">
+            <h2 className="text-gray-700 font-semibold mb-2">Total Students</h2>
+            <ResponsiveContainer width="100%" height={250}>
+              <BarChart data={monthlyData}>
+                <XAxis dataKey="name" />
+                <Tooltip />
+                <Bar dataKey="students" fill="#F88FA1" radius={[6, 6, 0, 0]} />
+              </BarChart>
+            </ResponsiveContainer>
+          </div>
+        </div>
+      </main>
+    </div>
+  );
+};
+
+export default InstructorDashboard;
diff --git a/frontend/src/pages/instructorPage/Profile.jsx b/frontend/src/pages/instructorPage/Profile.jsx
index a18aaaa..4d9fc16 100644
--- a/frontend/src/pages/instructorPage/Profile.jsx
+++ b/frontend/src/pages/instructorPage/Profile.jsx
@@ -1,501 +1,501 @@
-import React, { useState, useEffect } from "react";
-import axiosClient from "../../api/axiosClient";
-import { FiCamera, FiSave } from "react-icons/fi";
-import { useNavigate } from "react-router-dom";
-
-const Profile = () => {
-  const navigate = useNavigate();
-
-  const [userInfo, setUserInfo] = useState({
-    fullname: "Gi·∫£ng vi√™n",
-    avatar: "/icons/UI Image/default-avatar.png",
-  });
-
-  const [formData, setFormData] = useState({
-    firstName: "",
-    lastName: "",
-    gender: "",
-    email: "",
-    phone: "",
-    address: "",
-    avatar: "/icons/UI Image/default-avatar.png",
-  });
-  // Keep a copy of the initially loaded values to detect real changes
-  const [initialForm, setInitialForm] = useState(null);
-  // Inline message shown above the Save button
-  const [message, setMessage] = useState({ text: "", type: "" }); // type: 'success'|'error'|'info'
-  const messageTimerRef = React.useRef(null);
-
-  // clear timer on unmount
-  useEffect(() => {
-    return () => {
-      if (messageTimerRef.current) clearTimeout(messageTimerRef.current);
-    };
-  }, []);
-
-  useEffect(() => {
-    // Load from backend profile if token exists, otherwise fallback to localStorage
-    const loadProfile = async () => {
-      try {
-        const res = await axiosClient.get("/profile");
-        const user = res.data && res.data.data;
-        if (user) {
-          // Map backend user -> frontend form fields
-          const nameParts = (user.full_name || "").split(" ");
-          const lastName = nameParts.slice(0, -1).join(" ") || "";
-          const firstName = nameParts.slice(-1).join(" ") || "";
-          const genderMapBack = { male: "Nam", female: "N·ªØ", other: "Kh√°c" };
-
-          setFormData((prev) => ({
-            ...prev,
-            firstName,
-            lastName,
-            gender: genderMapBack[user.gender] || "",
-            email: user.email || prev.email,
-            phone: user.phone || "",
-            address: user.address || "",
-            avatar: user.avatar || prev.avatar,
-          }));
-
-          // store a normalized snapshot for change detection
-          setInitialForm({
-            firstName,
-            lastName,
-            gender: genderMapBack[user.gender] || "",
-            email: user.email || "",
-            phone: user.phone || "",
-            address: user.address || "",
-            avatar: user.avatar || prev.avatar,
-          });
-
-          setUserInfo({ fullname: user.full_name || prev.fullname, avatar: user.avatar || prev.avatar });
-
-          // also persist a couple of values locally for other UI
-          if (user.full_name) localStorage.setItem("fullname", user.full_name);
-          if (user.avatar) localStorage.setItem("avatar", user.avatar);
-          if (user.email) localStorage.setItem("email", user.email);
-          return;
-        }
-      } catch (err) {
-        // ignore fetch error and fall back to localStorage
-        console.warn("Could not fetch profile from API:", err?.response || err?.message || err);
-      }
-
-      // Fallback: use localStorage if backend not available
-      const fullname = localStorage.getItem("fullname") || "Gi·∫£ng vi√™n";
-      const avatar = localStorage.getItem("avatar") || "/icons/UI Image/default-avatar.png";
-      const email = localStorage.getItem("email") || "";
-
-      setUserInfo({ fullname, avatar });
-      setFormData((prev) => ({
-        ...prev,
-        avatar,
-        email,
-      }));
-    };
-
-    loadProfile();
-  }, []);
-
-  // logout is handled by the global header; keep navigation available via profile links
-
-  const handleChange = (e) => {
-    const { name, value } = e.target;
-    // Prevent typing letters into phone field by stripping non-digits
-    if (name === "phone") {
-      const digits = value.replace(/\D/g, "");
-      setFormData({ ...formData, [name]: digits });
-      return;
-    }
-    setFormData({ ...formData, [name]: value });
-  };
-
-  const handleSubmit = async (e) => {
-    e.preventDefault();
-    console.log("[Profile] saving profile, data:", formData);
-
-    // Validate phone: must be 10 digits when provided
-    if (formData.phone && !/^\d{10}$/.test(formData.phone)) {
-      alert("Nh·∫≠p sai ƒë·ªãnh d·∫°ng s·ªë ƒëi·ªán tho·∫°i");
-      return;
-    }
-
-    // Helper: normalize avatar URL (remove cache-bust query param)
-    const normalizeAvatar = (a) => {
-      if (!a) return '';
-      try {
-        // treat blob/data URLs as unique (they indicate a new file)
-        if (a.startsWith('blob:') || a.startsWith('data:')) return a;
-        const url = new URL(a, window.location.origin);
-        url.searchParams.delete('t');
-        return url.toString();
-      } catch (err) {
-        // fallback string compare
-        return a.replace(/\?t=\d+$/, '');
-      }
-    };
-
-    // If we have an initial snapshot, check if anything changed; if not, notify and skip
-    if (initialForm) {
-      const fullnameNow = `${formData.lastName || ''} ${formData.firstName || ''}`.trim();
-      const fullnameThen = `${initialForm.lastName || ''} ${initialForm.firstName || ''}`.trim();
-      const changed = (
-        fullnameNow !== fullnameThen ||
-        (formData.phone || '') !== (initialForm.phone || '') ||
-        (formData.address || '') !== (initialForm.address || '') ||
-        (formData.gender || '') !== (initialForm.gender || '') ||
-        normalizeAvatar(formData.avatar) !== normalizeAvatar(initialForm.avatar)
-      );
-      if (!changed) {
-        // show inline info message instead of alert
-        setMessage({ text: 'Kh√¥ng c√≥ thay ƒë·ªïi n√†o m·ªõi', type: 'info' });
-        if (messageTimerRef.current) clearTimeout(messageTimerRef.current);
-        messageTimerRef.current = setTimeout(() => setMessage({ text: '', type: '' }), 4000);
-        return;
-      }
-    }
-
-    // Map frontend fields to backend expected payload
-    const genderMap = { Nam: "male", "N·ªØ": "female", Kh√°c: "other" };
-    const payload = {
-      full_name: `${formData.lastName || ""} ${formData.firstName || ""}`.trim(),
-      phone: formData.phone || null,
-      address: formData.address || null,
-      avatar: formData.avatar || null,
-      gender: genderMap[formData.gender] || null,
-    };
-
-    try {
-      const res = await axiosClient.put("/profile", payload);
-      console.log("[Profile] save response:", res.data);
-
-      if (res.data && res.data.success) {
-        const saved = res.data.data || {};
-        const fullname = saved.full_name || payload.full_name || "";
-        let avatar = saved.avatar || payload.avatar || formData.avatar;
-        // cache-bust
-        if (typeof avatar === 'string' && !avatar.startsWith('data:')) {
-          const sep = avatar.includes('?') ? '&' : '?';
-          avatar = `${avatar}${sep}t=${Date.now()}`;
-        }
-
-        const email = saved.email || formData.email;
-        localStorage.setItem('fullname', fullname);
-        if (avatar) localStorage.setItem('avatar', avatar);
-        if (email) localStorage.setItem('email', email);
-
-        // update local UI
-        const nameParts = (fullname || "").split(" ");
-        const lastName = nameParts.slice(0, -1).join(" ") || "";
-        const firstName = nameParts.slice(-1).join(" ") || "";
-
-        const genderMapBack = { male: "Nam", female: "N·ªØ", other: "Kh√°c" };
-
-        setFormData((prev) => ({
-          ...prev,
-          firstName,
-          lastName,
-          gender: genderMapBack[saved.gender] || prev.gender,
-          email,
-          phone: saved.phone || prev.phone,
-          address: saved.address || prev.address,
-          avatar,
-        }));
-
-        setUserInfo({ fullname, avatar });
-
-        // update initial snapshot so further saves compare against the newly saved state
-        const normalizedAvatarForSnapshot = (typeof avatar === 'string') ? String(avatar).replace(/\?t=\d+$/, '') : avatar;
-        setInitialForm({
-          firstName,
-          lastName,
-          gender: genderMapBack[saved.gender] || '' ,
-          email,
-          phone: saved.phone || formData.phone || '',
-          address: saved.address || formData.address || '',
-          avatar: normalizedAvatarForSnapshot,
-        });
-
-        try { window.dispatchEvent(new Event('profileUpdated')); } catch (e) { /* ignore */ }
-
-        // show inline success message instead of alert
-        setMessage({ text: 'L∆∞u h·ªì s∆° th√†nh c√¥ng', type: 'success' });
-        if (messageTimerRef.current) clearTimeout(messageTimerRef.current);
-        messageTimerRef.current = setTimeout(() => setMessage({ text: '', type: '' }), 4000);
-        return;
-      }
-
-      alert(res.data?.message || 'L∆∞u h·ªì s∆° th·∫•t b·∫°i');
-    } catch (err) {
-      console.error('[Profile] save error', err);
-      const msg = err?.response?.data?.message || err.message || 'L∆∞u h·ªì s∆° th·∫•t b·∫°i';
-      alert(msg);
-    }
-  };
-
-  return (
-    <div className="flex bg-gray-50 min-h-screen">
-      <main className="flex-1 p-6">
-        <div className="flex justify-center">
-          <div className="w-full max-w-full">
-            <div className="flex items-center bg-[#1BA4FF] rounded-[17px] px-3 py-3 mb-6 gap-3">
-              <button
-                onClick={() => navigate("/instructor-dashboard")}
-                className="flex items-center text-white hover:opacity-80 transition"
-              >
-                <img
-                  src="/icons/UI Image/return.png"
-                  alt="Return"
-                  className="w-4 h-4 mr-2"
-                />
-                <h2 className="text-xl underline underline-offset-4 font-semibold">
-                  H·ªì s∆°
-                </h2>
-              </button>
-            </div>
-
-            <div className="bg-white shadow-lg rounded-3xl w-full p-8 border border-gray-100">
-              <div className="flex justify-center mb-6">
-                <div className="relative w-28 h-28">
-                  <img
-                    src={formData.avatar}
-                    alt="Avatar"
-                    className="w-full h-full rounded-full object-cover border border-gray-200 shadow-sm"
-                  />
-                  <label
-                    htmlFor="avatar"
-                    className="absolute bottom-1 right-1 bg-gray-100 border border-gray-300 text-gray-600 w-8 h-8 flex items-center justify-center rounded-full cursor-pointer hover:bg-gray-200 transition"
-                  >
-                    <FiCamera className="w-4 h-4" />
-                    {/* Accessible label text for screen-readers */}
-                    <span className="sr-only">Ch·ªçn ·∫£nh ƒë·∫°i di·ªán</span>
-                    <input
-                      type="file"
-                      id="avatar"
-                      accept="image/*"
-                      className="hidden"
-                      aria-label="Upload avatar"
-                      onChange={async (e) => {
-                        const file = e.target.files && e.target.files[0];
-                        if (!file) return;
-
-                        try {
-                          // show a temporary preview while uploading
-                          const tmpUrl = URL.createObjectURL(file);
-                          setFormData((prev) => ({ ...prev, avatar: tmpUrl }));
-
-                          const form = new FormData();
-
-                          // Ensure we append a real File object. In some cases the UI stores a
-                          // preview URL (blob: or data:) instead of the original File; that
-                          // won't be accepted by multer. If `file` isn't a File, try to
-                          // fetch the blob from the preview URL and convert it to a File.
-                          let fileToUpload = file;
-                          if (!(fileToUpload instanceof File)) {
-                            console.warn('[Profile] selected item is not a File object, attempting to resolve from preview URL');
-                            const preview = formData.avatar;
-                            if (typeof preview === 'string' && (preview.startsWith('blob:') || preview.startsWith('data:'))) {
-                              try {
-                                const fetched = await fetch(preview);
-                                const blob = await fetched.blob();
-                                // Preserve mimetype if available
-                                const ext = (blob.type && blob.type.split('/')[1]) || 'jpg';
-                                fileToUpload = new File([blob], `avatar.${ext}`, { type: blob.type || 'image/jpeg' });
-                                console.log('[Profile] converted preview URL to File for upload', fileToUpload);
-                              } catch (fetchErr) {
-                                console.error('[Profile] failed to fetch blob from preview URL', fetchErr);
-                                alert('Kh√¥ng th·ªÉ ƒë·ªçc file ·∫£nh t·ª´ b·∫£n xem tr∆∞·ªõc. Vui l√≤ng ch·ªçn l·∫°i ·∫£nh t·ª´ thi·∫øt b·ªã.');
-                                return;
-                              }
-                            } else {
-                              alert('Kh√¥ng t√¨m th·∫•y file ·∫£nh h·ª£p l·ªá. Vui l√≤ng ch·ªçn file t·ª´ m√°y t√≠nh.');
-                              return;
-                            }
-                          }
-
-                          form.append('avatar', fileToUpload);
-
-                          // Log token presence to help debug 401 issues
-                          const token = localStorage.getItem('token');
-                          console.log('[Profile] uploading avatar ‚Äî token present:', !!token, token);
-
-                          // If there's no token, use the no-auth debug endpoint to verify server upload
-                          if (!token) {
-                            console.warn('[Profile] No token found ‚Äî attempting no-auth debug upload to /profile/avatar-test');
-                            const res = await axiosClient.post('/profile/avatar-test', form);
-                            if (res?.data?.data?.avatar) {
-                              let savedUrl = res.data.data.avatar;
-                              if (typeof savedUrl === 'string' && !savedUrl.startsWith('data:')) {
-                                const sep = savedUrl.includes('?') ? '&' : '?';
-                                savedUrl = `${savedUrl}${sep}t=${Date.now()}`;
-                              }
-                              setFormData((prev) => ({ ...prev, avatar: savedUrl }));
-                              localStorage.setItem('avatar', savedUrl);
-                              try { window.dispatchEvent(new Event('profileUpdated')); } catch (e) { /* ignore */ }
-                            }
-                            return;
-                          }
-
-                          // When token exists, include it explicitly to ensure Authorization header is present
-                          const config = { headers: { Authorization: `Bearer ${token}` } };
-
-                          // IMPORTANT: do NOT set Content-Type manually; let the browser/axios set the multipart boundary
-                          const res = await axiosClient.post('/profile/avatar', form, config);
-
-                          if (res.data && res.data.data && res.data.data.avatar) {
-                            let savedUrl = res.data.data.avatar;
-                            if (typeof savedUrl === 'string' && !savedUrl.startsWith('data:')) {
-                              const sep = savedUrl.includes('?') ? '&' : '?';
-                              savedUrl = `${savedUrl}${sep}t=${Date.now()}`;
-                            }
-                            setFormData((prev) => ({ ...prev, avatar: savedUrl }));
-                            // update UI global storage
-                            localStorage.setItem('avatar', savedUrl);
-                            // notify other components in the same tab to refresh (storage event won't fire in same tab)
-                            try { window.dispatchEvent(new Event('profileUpdated')); } catch (e) { /* ignore */ }
-                          }
-                        } catch (err) {
-                          console.error('Avatar upload failed', err);
-
-                          // If auth fails, give a clear message and hint to re-login
-                          if (err?.response?.status === 401) {
-                            console.warn('[Profile] Upload blocked by 401 ‚Äî token invalid or expired');
-                            alert('Phi√™n ƒëƒÉng nh·∫≠p kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n. Vui l√≤ng ƒëƒÉng nh·∫≠p l·∫°i v√† th·ª≠ l·∫°i.');
-                            return;
-                          }
-
-                          const msg = err?.response?.data?.message || err.message || 'Kh√¥ng th·ªÉ t·∫£i ·∫£nh l√™n. Vui l√≤ng th·ª≠ l·∫°i.';
-                          alert(msg);
-                        }
-                      }}
-                    />
-                    <span id="avatar-desc" className="sr-only">Ch·ªçn file ·∫£nh ƒë·ªÉ c·∫≠p nh·∫≠t ·∫£nh ƒë·∫°i di·ªán</span>
-                  </label>
-                </div>
-              </div>
-
-              <form onSubmit={handleSubmit} className="space-y-6">
-                <div className="flex justify-between flex-col sm:flex-row gap-6">
-                  <div className="flex flex-1 items-center gap-3">
-                    <label htmlFor="lastName" className="w-24 text-xl text-[#606060] font-normal">
-                      H·ªç:
-                    </label>
-                    <input
-                      id="lastName"
-                      type="text"
-                      name="lastName"
-                      value={formData.lastName}
-                      onChange={handleChange}
-                      placeholder="H·ªç"
-                      title="H·ªç"
-                      autoComplete="family-name"
-                      className="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm focus:ring-2 focus:ring-blue-400 outline-none"
-                    />
-                  </div>
-
-                  <div className="flex flex-1 items-center gap-3">
-                    <label htmlFor="firstName" className="w-24 text-xl text-[#606060] font-normal">
-                      T√™n:
-                    </label>
-                    <input
-                      id="firstName"
-                      type="text"
-                      name="firstName"
-                      value={formData.firstName}
-                      onChange={handleChange}
-                      placeholder="T√™n"
-                      title="T√™n"
-                      autoComplete="given-name"
-                      className="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm focus:ring-2 focus:ring-blue-400 outline-none"
-                    />
-                  </div>
-                </div>
-                <div className="flex items-center gap-3">
-                  <label className="w-24 text-xl text-[#606060] font-normal">
-                    Gi·ªõi t√≠nh:
-                  </label>
-                  <div className="flex gap-6 text-xl">
-                    {["Nam", "N·ªØ", "Kh√°c"].map((g) => (
-                      <label key={g} className="flex items-center gap-2">
-                        <input
-                          type="radio"
-                          name="gender"
-                          value={g}
-                          checked={formData.gender === g}
-                          onChange={handleChange}
-                          className="accent-blue-500"
-                        />
-                        {g}
-                      </label>
-                    ))}
-                  </div>
-                </div>
-                {[
-                  {
-                    label: "Email:",
-                    name: "email",
-                    type: "email",
-                    placeholder: "Email",
-                  },
-                  { label: "SƒêT:", name: "phone", type: "text", placeholder: "S·ªë ƒëi·ªán tho·∫°i" },
-                  { label: "ƒê·ªãa ch·ªâ:", name: "address", type: "text", placeholder: "ƒê·ªãa ch·ªâ" },
-                ].map((field) => (
-                  <div key={field.name} className="flex items-center gap-3">
-                    <label htmlFor={`field-${field.name}`} className="w-24 text-xl text-[#606060] font-normal">
-                      {field.label}
-                    </label>
-                    <input
-                      id={`field-${field.name}`}
-                      type={field.type}
-                      name={field.name}
-                      value={formData[field.name]}
-                      onChange={handleChange}
-                      placeholder={field.placeholder}
-                      title={field.label.replace(':', '')}
-                        autoComplete={field.name === 'email' ? 'email' : field.name === 'phone' ? 'tel' : 'street-address'}
-                      className="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm focus:ring-2 focus:ring-blue-400 outline-none"
-                      // make email read-only (cannot be changed from profile page)
-                      readOnly={field.name === 'email'}
-                      disabled={field.name === 'email'}
-                    />
-                  </div>
-                ))}
-
-                {/* Inline message shown above the Save button */}
-                <div className="flex justify-center pt-2">
-                  {message.text && (
-                    <div
-                      className={`mb-3 px-4 py-2 rounded-md text-sm ${
-                        message.type === 'success'
-                          ? 'bg-green-50 text-green-800 border border-green-200'
-                          : message.type === 'error'
-                          ? 'bg-red-50 text-red-800 border border-red-200'
-                          : 'bg-blue-50 text-blue-800 border border-blue-200'
-                      }`}
-                      role="status"
-                      aria-live="polite"
-                    >
-                      {message.text}
-                    </div>
-                  )}
-                </div>
-
-                <div className="flex justify-center pt-4">
-                  <button
-                    type="submit"
-                    className="flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white font-normal px-6 py-2 rounded-lg transition group"
-                  >
-                    <FiSave className="text-xl group-hover:text-blue-100 transition" />
-                    <span className="text-xl">L∆∞u h·ªì s∆°</span>
-                  </button>
-                </div>
-              </form>
-            </div>
-          </div>
-        </div>
-      </main>
-    </div>
-  );
-};
-
-export default Profile;
+import React, { useState, useEffect } from "react";
+import axiosClient from "../../api/axiosClient";
+import { FiCamera, FiSave } from "react-icons/fi";
+import { useNavigate } from "react-router-dom";
+
+const Profile = () => {
+  const navigate = useNavigate();
+
+  const [userInfo, setUserInfo] = useState({
+    fullname: "Gi·∫£ng vi√™n",
+    avatar: "/icons/UI Image/default-avatar.png",
+  });
+
+  const [formData, setFormData] = useState({
+    firstName: "",
+    lastName: "",
+    gender: "",
+    email: "",
+    phone: "",
+    address: "",
+    avatar: "/icons/UI Image/default-avatar.png",
+  });
+  // Keep a copy of the initially loaded values to detect real changes
+  const [initialForm, setInitialForm] = useState(null);
+  // Inline message shown above the Save button
+  const [message, setMessage] = useState({ text: "", type: "" }); // type: 'success'|'error'|'info'
+  const messageTimerRef = React.useRef(null);
+
+  // clear timer on unmount
+  useEffect(() => {
+    return () => {
+      if (messageTimerRef.current) clearTimeout(messageTimerRef.current);
+    };
+  }, []);
+
+  useEffect(() => {
+    // Load from backend profile if token exists, otherwise fallback to localStorage
+    const loadProfile = async () => {
+      try {
+        const res = await axiosClient.get("/profile");
+        const user = res.data && res.data.data;
+        if (user) {
+          // Map backend user -> frontend form fields
+          const nameParts = (user.full_name || "").split(" ");
+          const lastName = nameParts.slice(0, -1).join(" ") || "";
+          const firstName = nameParts.slice(-1).join(" ") || "";
+          const genderMapBack = { male: "Nam", female: "N·ªØ", other: "Kh√°c" };
+
+          setFormData((prev) => ({
+            ...prev,
+            firstName,
+            lastName,
+            gender: genderMapBack[user.gender] || "",
+            email: user.email || prev.email,
+            phone: user.phone || "",
+            address: user.address || "",
+            avatar: user.avatar || prev.avatar,
+          }));
+
+          // store a normalized snapshot for change detection
+          setInitialForm({
+            firstName,
+            lastName,
+            gender: genderMapBack[user.gender] || "",
+            email: user.email || "",
+            phone: user.phone || "",
+            address: user.address || "",
+            avatar: user.avatar || prev.avatar,
+          });
+
+          setUserInfo({ fullname: user.full_name || prev.fullname, avatar: user.avatar || prev.avatar });
+
+          // also persist a couple of values locally for other UI
+          if (user.full_name) localStorage.setItem("fullname", user.full_name);
+          if (user.avatar) localStorage.setItem("avatar", user.avatar);
+          if (user.email) localStorage.setItem("email", user.email);
+          return;
+        }
+      } catch (err) {
+        // ignore fetch error and fall back to localStorage
+        console.warn("Could not fetch profile from API:", err?.response || err?.message || err);
+      }
+
+      // Fallback: use localStorage if backend not available
+      const fullname = localStorage.getItem("fullname") || "Gi·∫£ng vi√™n";
+      const avatar = localStorage.getItem("avatar") || "/icons/UI Image/default-avatar.png";
+      const email = localStorage.getItem("email") || "";
+
+      setUserInfo({ fullname, avatar });
+      setFormData((prev) => ({
+        ...prev,
+        avatar,
+        email,
+      }));
+    };
+
+    loadProfile();
+  }, []);
+
+  // logout is handled by the global header; keep navigation available via profile links
+
+  const handleChange = (e) => {
+    const { name, value } = e.target;
+    // Prevent typing letters into phone field by stripping non-digits
+    if (name === "phone") {
+      const digits = value.replace(/\D/g, "");
+      setFormData({ ...formData, [name]: digits });
+      return;
+    }
+    setFormData({ ...formData, [name]: value });
+  };
+
+  const handleSubmit = async (e) => {
+    e.preventDefault();
+    console.log("[Profile] saving profile, data:", formData);
+
+    // Validate phone: must be 10 digits when provided
+    if (formData.phone && !/^\d{10}$/.test(formData.phone)) {
+      alert("Nh·∫≠p sai ƒë·ªãnh d·∫°ng s·ªë ƒëi·ªán tho·∫°i");
+      return;
+    }
+
+    // Helper: normalize avatar URL (remove cache-bust query param)
+    const normalizeAvatar = (a) => {
+      if (!a) return '';
+      try {
+        // treat blob/data URLs as unique (they indicate a new file)
+        if (a.startsWith('blob:') || a.startsWith('data:')) return a;
+        const url = new URL(a, window.location.origin);
+        url.searchParams.delete('t');
+        return url.toString();
+      } catch (err) {
+        // fallback string compare
+        return a.replace(/\?t=\d+$/, '');
+      }
+    };
+
+    // If we have an initial snapshot, check if anything changed; if not, notify and skip
+    if (initialForm) {
+      const fullnameNow = `${formData.lastName || ''} ${formData.firstName || ''}`.trim();
+      const fullnameThen = `${initialForm.lastName || ''} ${initialForm.firstName || ''}`.trim();
+      const changed = (
+        fullnameNow !== fullnameThen ||
+        (formData.phone || '') !== (initialForm.phone || '') ||
+        (formData.address || '') !== (initialForm.address || '') ||
+        (formData.gender || '') !== (initialForm.gender || '') ||
+        normalizeAvatar(formData.avatar) !== normalizeAvatar(initialForm.avatar)
+      );
+      if (!changed) {
+        // show inline info message instead of alert
+        setMessage({ text: 'Kh√¥ng c√≥ thay ƒë·ªïi n√†o m·ªõi', type: 'info' });
+        if (messageTimerRef.current) clearTimeout(messageTimerRef.current);
+        messageTimerRef.current = setTimeout(() => setMessage({ text: '', type: '' }), 4000);
+        return;
+      }
+    }
+
+    // Map frontend fields to backend expected payload
+    const genderMap = { Nam: "male", "N·ªØ": "female", Kh√°c: "other" };
+    const payload = {
+      full_name: `${formData.lastName || ""} ${formData.firstName || ""}`.trim(),
+      phone: formData.phone || null,
+      address: formData.address || null,
+      avatar: formData.avatar || null,
+      gender: genderMap[formData.gender] || null,
+    };
+
+    try {
+      const res = await axiosClient.put("/profile", payload);
+      console.log("[Profile] save response:", res.data);
+
+      if (res.data && res.data.success) {
+        const saved = res.data.data || {};
+        const fullname = saved.full_name || payload.full_name || "";
+        let avatar = saved.avatar || payload.avatar || formData.avatar;
+        // cache-bust
+        if (typeof avatar === 'string' && !avatar.startsWith('data:')) {
+          const sep = avatar.includes('?') ? '&' : '?';
+          avatar = `${avatar}${sep}t=${Date.now()}`;
+        }
+
+        const email = saved.email || formData.email;
+        localStorage.setItem('fullname', fullname);
+        if (avatar) localStorage.setItem('avatar', avatar);
+        if (email) localStorage.setItem('email', email);
+
+        // update local UI
+        const nameParts = (fullname || "").split(" ");
+        const lastName = nameParts.slice(0, -1).join(" ") || "";
+        const firstName = nameParts.slice(-1).join(" ") || "";
+
+        const genderMapBack = { male: "Nam", female: "N·ªØ", other: "Kh√°c" };
+
+        setFormData((prev) => ({
+          ...prev,
+          firstName,
+          lastName,
+          gender: genderMapBack[saved.gender] || prev.gender,
+          email,
+          phone: saved.phone || prev.phone,
+          address: saved.address || prev.address,
+          avatar,
+        }));
+
+        setUserInfo({ fullname, avatar });
+
+        // update initial snapshot so further saves compare against the newly saved state
+        const normalizedAvatarForSnapshot = (typeof avatar === 'string') ? String(avatar).replace(/\?t=\d+$/, '') : avatar;
+        setInitialForm({
+          firstName,
+          lastName,
+          gender: genderMapBack[saved.gender] || '' ,
+          email,
+          phone: saved.phone || formData.phone || '',
+          address: saved.address || formData.address || '',
+          avatar: normalizedAvatarForSnapshot,
+        });
+
+        try { window.dispatchEvent(new Event('profileUpdated')); } catch (e) { /* ignore */ }
+
+        // show inline success message instead of alert
+        setMessage({ text: 'L∆∞u h·ªì s∆° th√†nh c√¥ng', type: 'success' });
+        if (messageTimerRef.current) clearTimeout(messageTimerRef.current);
+        messageTimerRef.current = setTimeout(() => setMessage({ text: '', type: '' }), 4000);
+        return;
+      }
+
+      alert(res.data?.message || 'L∆∞u h·ªì s∆° th·∫•t b·∫°i');
+    } catch (err) {
+      console.error('[Profile] save error', err);
+      const msg = err?.response?.data?.message || err.message || 'L∆∞u h·ªì s∆° th·∫•t b·∫°i';
+      alert(msg);
+    }
+  };
+
+  return (
+    <div className="flex bg-gray-50 min-h-screen">
+      <main className="flex-1 p-6">
+        <div className="flex justify-center">
+          <div className="w-full max-w-full">
+            <div className="flex items-center bg-[#1BA4FF] rounded-[17px] px-3 py-3 mb-6 gap-3">
+              <button
+                onClick={() => navigate("/instructor-dashboard")}
+                className="flex items-center text-white hover:opacity-80 transition"
+              >
+                <img
+                  src="/icons/UI Image/return.png"
+                  alt="Return"
+                  className="w-4 h-4 mr-2"
+                />
+                <h2 className="text-xl underline underline-offset-4 font-semibold">
+                  H·ªì s∆°
+                </h2>
+              </button>
+            </div>
+
+            <div className="bg-white shadow-lg rounded-3xl w-full p-8 border border-gray-100">
+              <div className="flex justify-center mb-6">
+                <div className="relative w-28 h-28">
+                  <img
+                    src={formData.avatar}
+                    alt="Avatar"
+                    className="w-full h-full rounded-full object-cover border border-gray-200 shadow-sm"
+                  />
+                  <label
+                    htmlFor="avatar"
+                    className="absolute bottom-1 right-1 bg-gray-100 border border-gray-300 text-gray-600 w-8 h-8 flex items-center justify-center rounded-full cursor-pointer hover:bg-gray-200 transition"
+                  >
+                    <FiCamera className="w-4 h-4" />
+                    {/* Accessible label text for screen-readers */}
+                    <span className="sr-only">Ch·ªçn ·∫£nh ƒë·∫°i di·ªán</span>
+                    <input
+                      type="file"
+                      id="avatar"
+                      accept="image/*"
+                      className="hidden"
+                      aria-label="Upload avatar"
+                      onChange={async (e) => {
+                        const file = e.target.files && e.target.files[0];
+                        if (!file) return;
+
+                        try {
+                          // show a temporary preview while uploading
+                          const tmpUrl = URL.createObjectURL(file);
+                          setFormData((prev) => ({ ...prev, avatar: tmpUrl }));
+
+                          const form = new FormData();
+
+                          // Ensure we append a real File object. In some cases the UI stores a
+                          // preview URL (blob: or data:) instead of the original File; that
+                          // won't be accepted by multer. If `file` isn't a File, try to
+                          // fetch the blob from the preview URL and convert it to a File.
+                          let fileToUpload = file;
+                          if (!(fileToUpload instanceof File)) {
+                            console.warn('[Profile] selected item is not a File object, attempting to resolve from preview URL');
+                            const preview = formData.avatar;
+                            if (typeof preview === 'string' && (preview.startsWith('blob:') || preview.startsWith('data:'))) {
+                              try {
+                                const fetched = await fetch(preview);
+                                const blob = await fetched.blob();
+                                // Preserve mimetype if available
+                                const ext = (blob.type && blob.type.split('/')[1]) || 'jpg';
+                                fileToUpload = new File([blob], `avatar.${ext}`, { type: blob.type || 'image/jpeg' });
+                                console.log('[Profile] converted preview URL to File for upload', fileToUpload);
+                              } catch (fetchErr) {
+                                console.error('[Profile] failed to fetch blob from preview URL', fetchErr);
+                                alert('Kh√¥ng th·ªÉ ƒë·ªçc file ·∫£nh t·ª´ b·∫£n xem tr∆∞·ªõc. Vui l√≤ng ch·ªçn l·∫°i ·∫£nh t·ª´ thi·∫øt b·ªã.');
+                                return;
+                              }
+                            } else {
+                              alert('Kh√¥ng t√¨m th·∫•y file ·∫£nh h·ª£p l·ªá. Vui l√≤ng ch·ªçn file t·ª´ m√°y t√≠nh.');
+                              return;
+                            }
+                          }
+
+                          form.append('avatar', fileToUpload);
+
+                          // Log token presence to help debug 401 issues
+                          const token = localStorage.getItem('token');
+                          console.log('[Profile] uploading avatar ‚Äî token present:', !!token, token);
+
+                          // If there's no token, use the no-auth debug endpoint to verify server upload
+                          if (!token) {
+                            console.warn('[Profile] No token found ‚Äî attempting no-auth debug upload to /profile/avatar-test');
+                            const res = await axiosClient.post('/profile/avatar-test', form);
+                            if (res?.data?.data?.avatar) {
+                              let savedUrl = res.data.data.avatar;
+                              if (typeof savedUrl === 'string' && !savedUrl.startsWith('data:')) {
+                                const sep = savedUrl.includes('?') ? '&' : '?';
+                                savedUrl = `${savedUrl}${sep}t=${Date.now()}`;
+                              }
+                              setFormData((prev) => ({ ...prev, avatar: savedUrl }));
+                              localStorage.setItem('avatar', savedUrl);
+                              try { window.dispatchEvent(new Event('profileUpdated')); } catch (e) { /* ignore */ }
+                            }
+                            return;
+                          }
+
+                          // When token exists, include it explicitly to ensure Authorization header is present
+                          const config = { headers: { Authorization: `Bearer ${token}` } };
+
+                          // IMPORTANT: do NOT set Content-Type manually; let the browser/axios set the multipart boundary
+                          const res = await axiosClient.post('/profile/avatar', form, config);
+
+                          if (res.data && res.data.data && res.data.data.avatar) {
+                            let savedUrl = res.data.data.avatar;
+                            if (typeof savedUrl === 'string' && !savedUrl.startsWith('data:')) {
+                              const sep = savedUrl.includes('?') ? '&' : '?';
+                              savedUrl = `${savedUrl}${sep}t=${Date.now()}`;
+                            }
+                            setFormData((prev) => ({ ...prev, avatar: savedUrl }));
+                            // update UI global storage
+                            localStorage.setItem('avatar', savedUrl);
+                            // notify other components in the same tab to refresh (storage event won't fire in same tab)
+                            try { window.dispatchEvent(new Event('profileUpdated')); } catch (e) { /* ignore */ }
+                          }
+                        } catch (err) {
+                          console.error('Avatar upload failed', err);
+
+                          // If auth fails, give a clear message and hint to re-login
+                          if (err?.response?.status === 401) {
+                            console.warn('[Profile] Upload blocked by 401 ‚Äî token invalid or expired');
+                            alert('Phi√™n ƒëƒÉng nh·∫≠p kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n. Vui l√≤ng ƒëƒÉng nh·∫≠p l·∫°i v√† th·ª≠ l·∫°i.');
+                            return;
+                          }
+
+                          const msg = err?.response?.data?.message || err.message || 'Kh√¥ng th·ªÉ t·∫£i ·∫£nh l√™n. Vui l√≤ng th·ª≠ l·∫°i.';
+                          alert(msg);
+                        }
+                      }}
+                    />
+                    <span id="avatar-desc" className="sr-only">Ch·ªçn file ·∫£nh ƒë·ªÉ c·∫≠p nh·∫≠t ·∫£nh ƒë·∫°i di·ªán</span>
+                  </label>
+                </div>
+              </div>
+
+              <form onSubmit={handleSubmit} className="space-y-6">
+                <div className="flex justify-between flex-col sm:flex-row gap-6">
+                  <div className="flex flex-1 items-center gap-3">
+                    <label htmlFor="lastName" className="w-24 text-xl text-[#606060] font-normal">
+                      H·ªç:
+                    </label>
+                    <input
+                      id="lastName"
+                      type="text"
+                      name="lastName"
+                      value={formData.lastName}
+                      onChange={handleChange}
+                      placeholder="H·ªç"
+                      title="H·ªç"
+                      autoComplete="family-name"
+                      className="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm focus:ring-2 focus:ring-blue-400 outline-none"
+                    />
+                  </div>
+
+                  <div className="flex flex-1 items-center gap-3">
+                    <label htmlFor="firstName" className="w-24 text-xl text-[#606060] font-normal">
+                      T√™n:
+                    </label>
+                    <input
+                      id="firstName"
+                      type="text"
+                      name="firstName"
+                      value={formData.firstName}
+                      onChange={handleChange}
+                      placeholder="T√™n"
+                      title="T√™n"
+                      autoComplete="given-name"
+                      className="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm focus:ring-2 focus:ring-blue-400 outline-none"
+                    />
+                  </div>
+                </div>
+                <div className="flex items-center gap-3">
+                  <label className="w-24 text-xl text-[#606060] font-normal">
+                    Gi·ªõi t√≠nh:
+                  </label>
+                  <div className="flex gap-6 text-xl">
+                    {["Nam", "N·ªØ", "Kh√°c"].map((g) => (
+                      <label key={g} className="flex items-center gap-2">
+                        <input
+                          type="radio"
+                          name="gender"
+                          value={g}
+                          checked={formData.gender === g}
+                          onChange={handleChange}
+                          className="accent-blue-500"
+                        />
+                        {g}
+                      </label>
+                    ))}
+                  </div>
+                </div>
+                {[
+                  {
+                    label: "Email:",
+                    name: "email",
+                    type: "email",
+                    placeholder: "Email",
+                  },
+                  { label: "SƒêT:", name: "phone", type: "text", placeholder: "S·ªë ƒëi·ªán tho·∫°i" },
+                  { label: "ƒê·ªãa ch·ªâ:", name: "address", type: "text", placeholder: "ƒê·ªãa ch·ªâ" },
+                ].map((field) => (
+                  <div key={field.name} className="flex items-center gap-3">
+                    <label htmlFor={`field-${field.name}`} className="w-24 text-xl text-[#606060] font-normal">
+                      {field.label}
+                    </label>
+                    <input
+                      id={`field-${field.name}`}
+                      type={field.type}
+                      name={field.name}
+                      value={formData[field.name]}
+                      onChange={handleChange}
+                      placeholder={field.placeholder}
+                      title={field.label.replace(':', '')}
+                        autoComplete={field.name === 'email' ? 'email' : field.name === 'phone' ? 'tel' : 'street-address'}
+                      className="w-full border border-gray-300 rounded-lg px-4 py-3 text-sm focus:ring-2 focus:ring-blue-400 outline-none"
+                      // make email read-only (cannot be changed from profile page)
+                      readOnly={field.name === 'email'}
+                      disabled={field.name === 'email'}
+                    />
+                  </div>
+                ))}
+
+                {/* Inline message shown above the Save button */}
+                <div className="flex justify-center pt-2">
+                  {message.text && (
+                    <div
+                      className={`mb-3 px-4 py-2 rounded-md text-sm ${
+                        message.type === 'success'
+                          ? 'bg-green-50 text-green-800 border border-green-200'
+                          : message.type === 'error'
+                          ? 'bg-red-50 text-red-800 border border-red-200'
+                          : 'bg-blue-50 text-blue-800 border border-blue-200'
+                      }`}
+                      role="status"
+                      aria-live="polite"
+                    >
+                      {message.text}
+                    </div>
+                  )}
+                </div>
+
+                <div className="flex justify-center pt-4">
+                  <button
+                    type="submit"
+                    className="flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white font-normal px-6 py-2 rounded-lg transition group"
+                  >
+                    <FiSave className="text-xl group-hover:text-blue-100 transition" />
+                    <span className="text-xl">L∆∞u h·ªì s∆°</span>
+                  </button>
+                </div>
+              </form>
+            </div>
+          </div>
+        </div>
+      </main>
+    </div>
+  );
+};
+
+export default Profile;
diff --git a/frontend/src/pages/instructorPage/Result.jsx b/frontend/src/pages/instructorPage/Result.jsx
index 6b40d6f..937020f 100644
--- a/frontend/src/pages/instructorPage/Result.jsx
+++ b/frontend/src/pages/instructorPage/Result.jsx
@@ -1,702 +1,702 @@
-import React from "react";
-import { useNavigate } from "react-router-dom";
-import axiosClient from "../../api/axiosClient";
-
-const cls = (...a) => a.filter(Boolean).join(" ");
-
-const Badge = ({ color = "slate", children }) => (
-  <span
-    className={cls(
-      "inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium border",
-      color === "emerald" && "bg-emerald-50 text-emerald-700 border-emerald-200",
-      color === "amber" && "bg-amber-50 text-amber-700 border-amber-200",
-      color === "rose" && "bg-rose-50 text-rose-700 border-rose-200",
-      color === "slate" && "bg-slate-50 text-slate-700 border-slate-200"
-    )}
-  >
-    {children}
-  </span>
-);
-
-const StatCard = ({ label, value, subtle }) => (
-  <div className="group rounded-2xl border bg-white p-4 shadow-sm hover:shadow-md transition-all">
-    <div className="text-slate-500 text-sm">{label}</div>
-    <div className="mt-1 text-2xl font-semibold tracking-tight">{value}</div>
-    {subtle ? <div className="text-xs text-slate-400 mt-1">{subtle}</div> : null}
-  </div>
-);
-
-const Section = ({ title, right, children }) => (
-  <section className="rounded-2xl border bg-white p-4 shadow-sm">
-    <div className="mb-3 flex items-center justify-between">
-      <h3 className="text-base font-semibold text-slate-800">{title}</h3>
-      {right}
-    </div>
-    {children}
-  </section>
-);
-
-const StatusPill = (v) => {
-  const s = String(v || "").toLowerCase();
-  if (s === "confirmed") return <Badge color="emerald">Confirmed</Badge>;
-  if (s === "graded") return <Badge color="amber">Awaiting Approval</Badge>;
-  if (s === "pending") return <Badge color="slate">Pending</Badge>;
-  return <Badge>‚Äî</Badge>;
-};
-
-const fmtDate = (s) => (s ? new Date(s).toLocaleString() : "-");
-const toFinal = (r) =>
-  r.total_score ?? r.suggested_total_score ?? 0;
-
-export default function Result() {
-  const nav = useNavigate();
-
-  const [examId, setExamId] = React.useState("");
-  const [examList, setExamList] = React.useState([]);
-  const [summary, setSummary] = React.useState(null);
-  const [rows, setRows] = React.useState([]);
-  const [loading, setLoading] = React.useState(false);
-
-  const [q, setQ] = React.useState("");
-  const [status, setStatus] = React.useState("all");
-  const [sort, setSort] = React.useState("score_desc");
-  const [minScore, setMinScore] = React.useState("");
-  const [maxScore, setMaxScore] = React.useState("");
-  const [passThreshold, setPassThreshold] = React.useState(50);
-
-  const [drawer, setDrawer] = React.useState({ open: false, row: null });
-
-
-  const load = async (id) => {
-    if (!id) return;
-    setLoading(true);
-    try {
-      const [s, r] = await Promise.all([
-        axiosClient.get(`/instructor/exams/${id}/summary`),
-        axiosClient.get(`/instructor/exams/${id}/results`),
-      ]);
-      setSummary(s?.data || null);
-      setRows(Array.isArray(r?.data) ? r.data : []);
-    } catch {
-      setRows([]);
-      setSummary(null);
-    } finally {
-      setLoading(false);
-    }
-  };
-
-  React.useEffect(() => {
-    (async () => {
-      try {
-        const res = await axiosClient.get("/instructor/exams/my");
-        const list = Array.isArray(res.data) ? res.data : [];
-        setExamList(list);
-
-        const url = new URL(window.location.href);
-        const idQ = url.searchParams.get("exam_id");
-        if (idQ) {
-          setExamId(idQ);
-          load(idQ);
-        } else {
-          const first =
-            list.find((e) => String(e.status) === "published") || list[0];
-          if (first) {
-            setExamId(String(first.id));
-            load(String(first.id));
-          }
-        }
-      } catch {
-        /* ignore */
-      }
-    })();
-  }, []);
-
-  const onPick = (e) => {
-    const id = e.target.value.trim();
-    setExamId(id);
-    load(id);
-  };
-
-  const filtered = React.useMemo(() => {
-    const norm = (s) => String(s || "").toLowerCase();
-    let arr = (rows || []).filter((r) =>
-      norm(r.student_name).includes(norm(q))
-    );
-
-    if (status !== "all")
-      arr = arr.filter((r) =>
-        String(r.status || "").toLowerCase().includes(status)
-      );
-
-    const min = minScore !== "" ? Number(minScore) : null;
-    const max = maxScore !== "" ? Number(maxScore) : null;
-    if (min != null) arr = arr.filter((r) => toFinal(r) >= min);
-    if (max != null) arr = arr.filter((r) => toFinal(r) <= max);
-
-    // always sort on a clone to avoid mutating state
-    const sorted = [...arr];
-    if (sort === "score_desc") sorted.sort((a, b) => toFinal(b) - toFinal(a));
-    if (sort === "score_asc") sorted.sort((a, b) => toFinal(a) - toFinal(b));
-
-    return sorted;
-  }, [rows, q, status, sort, minScore, maxScore]);
-
-
-  const exportCsv = () => {
-    const header = [
-      "Student",
-      "MCQ",
-      "AI",
-      "Suggested",
-      "Final",
-      "Status",
-      "Start",
-      "Submitted",
-      "Duration(min)",
-      "Cheating",
-      "FaceURL",
-      "CardURL",
-    ];
-    const lines = [header.join(",")];
-    filtered.forEach((r) => {
-      const line = [
-        r.student_name ?? "",
-        r.mcq_score ?? "",
-        r.ai_score ?? "",
-        r.suggested_total_score ?? "",
-        r.total_score ?? "",
-        r.status ?? "",
-        r.started_at ? new Date(r.started_at).toLocaleString() : "",
-        r.submitted_at ? new Date(r.submitted_at).toLocaleString() : "",
-        r.duration_minutes ?? "",
-        r.cheating_flag ? "Yes" : "No",
-        r.face_image_url ?? "",
-        r.student_card_url ?? "",
-      ]
-        .map((v) => `"${String(v).replaceAll('"', '""')}"`)
-        .join(",");
-      lines.push(line);
-    });
-    const blob = new Blob([lines.join("\n")], {
-      type: "text/csv;charset=utf-8;",
-    });
-    const url = URL.createObjectURL(blob);
-    const a = document.createElement("a");
-    a.href = url;
-    a.download = `results_exam_${examId || "unknown"}.csv`;
-    a.click();
-    URL.revokeObjectURL(url);
-  };
-
-  const exportXlsx = async () => {
-    try {
-      const data = filtered.map((r) => ({
-        Student: r.student_name,
-        MCQ: r.mcq_score,
-        AI: r.ai_score,
-        Suggested: r.suggested_total_score,
-        Final: r.total_score ?? r.suggested_total_score,
-        Status: r.status,
-        Start: r.started_at ? new Date(r.started_at).toLocaleString() : "",
-        Submitted: r.submitted_at
-          ? new Date(r.submitted_at).toLocaleString()
-          : "",
-        "Duration (min)": r.duration_minutes ?? "",
-        Cheating: r.cheating_flag ? "Yes" : "No",
-        FaceURL: r.face_image_url ?? "",
-        CardURL: r.student_card_url ?? "",
-      }));
-      const mod = await import(/* @vite-ignore */ "xlsx");
-      const ws = mod.utils.json_to_sheet(data);
-      const wb = mod.utils.book_new();
-      mod.utils.book_append_sheet(wb, ws, "Results");
-      mod.writeFile(wb, `results_exam_${examId || "unknown"}.xlsx`);
-    } catch {
-      exportCsv();
-    }
-  };
-
-  const openDrawer = (row) => setDrawer({ open: true, row });
-  const closeDrawer = () => setDrawer({ open: false, row: null });
-
-  const saveScore = async () => {
-    const r = drawer.row;
-    if (!r) return;
-    try {
-      const payload = {
-        mcq_score: Number(r.mcq_score ?? 0),
-        ai_score: Number(r.ai_score ?? 0),
-        student_name: r.student_name,
-      };
-      await axiosClient.put(
-        `/instructor/exams/${examId}/students/${r.student_id}/score`,
-        payload
-      );
-      await load(examId);
-      closeDrawer();
-    } catch {
-      /* ignore */
-    }
-  };
-
- 
-  return (
-    <div className="p-6 max-w-7xl mx-auto space-y-6">
-
-      {/* Header + actions */}
-      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
-        <div>
-          <h1 className="text-2xl font-bold tracking-tight">Exam Results</h1>
-          <p className="text-slate-500 text-sm">
-            Xem, l·ªçc, ch·ªânh & c√¥ng b·ªë ƒëi·ªÉm cho t·ª´ng b√†i thi ƒë√£ publish.
-          </p>
-        </div>
-        <div className="flex items-center gap-2">
-          <button
-            onClick={() => nav("/results-exams")}
-            className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
-          >
-            Ch·ªçn b√†i thi kh√°c
-          </button>
-
-          <select
-            value={examId}
-            onChange={onPick}
-            className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:border-slate-300"
-          >
-            <option value="">Ch·ªçn b√†i thi‚Ä¶</option>
-            {examList.map((e) => (
-              <option key={e.id} value={e.id}>
-                {e.title || `Exam #${e.id}`} {e.status ? `(${e.status})` : ""}
-              </option>
-            ))}
-          </select>
-
-          <div className="hidden sm:flex items-center gap-2">
-            <button
-              onClick={exportCsv}
-              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
-            >
-              Export CSV
-            </button>
-            <button
-              onClick={exportXlsx}
-              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
-            >
-              Export Excel
-            </button>
-          </div>
-        </div>
-      </div>
-
-      {/* Summary */}
-      <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
-        <StatCard
-          label="Total Submissions"
-          value={(summary?.total_submissions ?? summary?.total ?? 0)}
-        />
-        <StatCard
-          label="Total Students"
-          value={summary?.total_students ?? 0}
-        />
-        <StatCard
-          label="Avg Score"
-          value={
-            summary?.avg_score != null
-              ? Number(summary.avg_score).toFixed(2)
-              : "-"
-          }
-        />
-        <StatCard
-          label="Last Submission"
-          value={fmtDate(summary?.last_submission_time)}
-        />
-      </div>
-
-      {/* Filters */}
-      <Section
-        title="B·ªô l·ªçc"
-        right={
-          <div className="text-xs text-slate-400">
-            {filtered.length} b·∫£n ghi hi·ªÉn th·ªã
-          </div>
-        }
-      >
-        <div className="flex flex-wrap items-center gap-2">
-          <input
-            value={q}
-            onChange={(e) => setQ(e.target.value)}
-            placeholder="T√¨m t√™n sinh vi√™n‚Ä¶"
-            className="w-56 rounded-xl border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
-          />
-          <div className="inline-flex rounded-xl border overflow-hidden bg-white shadow-sm">
-            {["all", "pending", "graded", "confirmed"].map((s) => (
-              <button
-                key={s}
-                onClick={() => setStatus(s)}
-                className={cls(
-                  "px-3 py-2 text-sm",
-                  status === s ? "bg-indigo-600 text-white" : "hover:bg-slate-50"
-                )}
-              >
-                {s}
-              </button>
-            ))}
-          </div>
-          <input
-            type="number"
-            placeholder="Min"
-            className="w-24 rounded-xl border px-3 py-2 shadow-sm"
-            value={minScore}
-            onChange={(e) => setMinScore(e.target.value)}
-          />
-          <input
-            type="number"
-            placeholder="Max"
-            className="w-24 rounded-xl border px-3 py-2 shadow-sm"
-            value={maxScore}
-            onChange={(e) => setMaxScore(e.target.value)}
-          />
-          <div className="inline-flex rounded-xl border overflow-hidden bg-white shadow-sm">
-            <button
-              onClick={() => setSort("score_desc")}
-              className={cls(
-                "px-3 py-2 text-sm",
-                sort === "score_desc" ? "bg-indigo-600 text-white" : "hover:bg-slate-50"
-              )}
-            >
-              ƒêi·ªÉm ‚Üì
-            </button>
-            <button
-              onClick={() => setSort("score_asc")}
-              className={cls(
-                "px-3 py-2 text-sm",
-                sort === "score_asc" ? "bg-indigo-600 text-white" : "hover:bg-slate-50"
-              )}
-            >
-              ƒêi·ªÉm ‚Üë
-            </button>
-          </div>
-        </div>
-      </Section>
-
-      {/* Charts + Export row */}
-      <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
-        <Section title="Ph√¢n b·ªë ƒëi·ªÉm (Histogram)">
-          <Histogram rows={filtered} />
-        </Section>
-        <Section
-          title="T·ªâ l·ªá ƒë·∫°t (Pass/Fail)"
-          right={
-            <div className="flex items-center gap-2 text-sm">
-              <span>Ng∆∞·ª°ng:</span>
-              <input
-                type="number"
-                className="w-20 rounded-lg border px-2 py-1 shadow-sm"
-                value={passThreshold}
-                onChange={(e) => setPassThreshold(e.target.value)}
-              />
-            </div>
-          }
-        >
-          <PassFail rows={filtered} passThreshold={Number(passThreshold || 0)} />
-        </Section>
-        <Section
-          title="Xu·∫•t b√°o c√°o"
-          right={<div className="text-xs text-slate-400">CSV/Excel</div>}
-        >
-          <div className="flex flex-wrap gap-2">
-            <button
-              onClick={exportCsv}
-              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
-            >
-              Export CSV
-            </button>
-            <button
-              onClick={exportXlsx}
-              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
-            >
-              Export Excel
-            </button>
-          </div>
-        </Section>
-      </div>
-
-      {/* Table */}
-      <Section title="Danh s√°ch b√†i n·ªôp">
-        <div className="overflow-auto rounded-xl border">
-          <table className="min-w-full text-sm">
-            <thead className="bg-slate-50 sticky top-0">
-              <tr className="text-left text-slate-700">
-                <th className="p-3">Student</th>
-                <th className="p-3">MCQ</th>
-                <th className="p-3">Essay (AI)</th>
-                <th className="p-3">Suggested</th>
-                <th className="p-3">Final</th>
-                <th className="p-3">Start</th>
-                <th className="p-3">Submitted</th>
-                <th className="p-3">Duration (min)</th>
-                <th className="p-3">Cheating</th>
-                <th className="p-3">Face</th>
-                <th className="p-3">Card</th>
-                <th className="p-3">Status</th>
-                <th className="p-3">Actions</th>
-              </tr>
-            </thead>
-            <tbody>
-              {loading ? (
-                <tr>
-                  <td colSpan={13} className="p-6 text-center text-slate-500">
-                    ƒêang t·∫£i...
-                  </td>
-                </tr>
-              ) : filtered.length === 0 ? (
-                <tr>
-                  <td colSpan={13} className="p-6 text-center text-slate-500">
-                    Kh√¥ng c√≥ d·ªØ li·ªáu
-                  </td>
-                </tr>
-              ) : (
-                filtered.map((r) => (
-                  <tr
-                    key={`${r.student_id}-${r.student_name}`}
-                    className="border-t hover:bg-indigo-50/40 transition"
-                  >
-                    <td className="p-3 font-medium text-slate-800">
-                      {r.student_name}
-                    </td>
-                    <td className="p-3">{r.mcq_score ?? "-"}</td>
-                    <td className="p-3">{r.ai_score ?? "-"}</td>
-                    <td className="p-3">{r.suggested_total_score ?? "-"}</td>
-                    <td className="p-3 font-semibold">
-                      {(r.total_score ?? r.suggested_total_score ?? 0).toFixed
-                        ? (r.total_score ?? r.suggested_total_score ?? 0).toFixed(2)
-                        : r.total_score ?? r.suggested_total_score ?? 0}
-                    </td>
-                    <td className="p-3">{fmtDate(r.started_at)}</td>
-                    <td className="p-3">{fmtDate(r.submitted_at)}</td>
-                    <td className="p-3">{r.duration_minutes ?? "-"}</td>
-                    <td className="p-3">
-                      {r.cheating_flag ? (
-                        <Badge color="rose">Yes</Badge>
-                      ) : (
-                        <Badge>No</Badge>
-                      )}
-                    </td>
-                    <td className="p-3">
-                      {r.face_image_url ? (
-                        <a
-                          className="text-indigo-600 underline hover:text-indigo-800"
-                          href={r.face_image_url}
-                          target="_blank"
-                        >
-                          View
-                        </a>
-                      ) : (
-                        "‚Äî"
-                      )}
-                    </td>
-                    <td className="p-3">
-                      {r.student_card_url ? (
-                        <a
-                          className="text-indigo-600 underline hover:text-indigo-800"
-                          href={r.student_card_url}
-                          target="_blank"
-                        >
-                          View
-                        </a>
-                      ) : (
-                        "‚Äî"
-                      )}
-                    </td>
-                    <td className="p-3">{StatusPill(r.status)}</td>
-                    <td className="p-3">
-                      <button
-                        onClick={() => openDrawer(r)}
-                        className="rounded-lg border bg-white px-3 py-1.5 shadow-sm hover:bg-slate-50 transition"
-                      >
-                        Edit
-                      </button>
-                    </td>
-                  </tr>
-                ))
-              )}
-            </tbody>
-          </table>
-        </div>
-      </Section>
-
-      {/* Drawer */}
-      {drawer.open && (
-        <div className="fixed inset-0 z-50 flex bg-black/30">
-          <div className="ml-auto h-full w-full max-w-md bg-white shadow-xl">
-            <div className="flex items-center justify-between border-b p-4">
-              <div>
-                <h4 className="text-lg font-semibold">C·∫≠p nh·∫≠t ƒëi·ªÉm</h4>
-                <div className="text-xs text-slate-500">
-                  Save & Confirm s·∫Ω c√¥ng b·ªë ƒëi·ªÉm cu·ªëi c√πng cho sinh vi√™n
-                </div>
-              </div>
-              <button
-                onClick={closeDrawer}
-                className="rounded-lg border bg-white px-3 py-1.5 hover:bg-slate-50"
-              >
-                ƒê√≥ng
-              </button>
-            </div>
-
-            <div className="p-4 space-y-3">
-              <div>
-                <label className="text-sm text-slate-600">T√™n sinh vi√™n</label>
-                <input
-                  className="mt-1 w-full rounded-lg border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
-                  value={drawer.row.student_name || ""}
-                  onChange={(e) =>
-                    setDrawer((d) => ({
-                      ...d,
-                      row: { ...d.row, student_name: e.target.value },
-                    }))
-                  }
-                />
-              </div>
-              <div className="grid grid-cols-2 gap-3">
-                <div>
-                  <label className="text-sm text-slate-600">ƒêi·ªÉm MCQ</label>
-                  <input
-                    type="number"
-                    className="mt-1 w-full rounded-lg border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
-                    value={drawer.row.mcq_score ?? 0}
-                    onChange={(e) =>
-                      setDrawer((d) => ({
-                        ...d,
-                        row: { ...d.row, mcq_score: e.target.value },
-                      }))
-                    }
-                  />
-                </div>
-                <div>
-                  <label className="text-sm text-slate-600">ƒêi·ªÉm AI</label>
-                  <input
-                    type="number"
-                    className="mt-1 w-full rounded-lg border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
-                    value={drawer.row.ai_score ?? 0}
-                    onChange={(e) =>
-                      setDrawer((d) => ({
-                        ...d,
-                        row: { ...d.row, ai_score: e.target.value },
-                      }))
-                    }
-                  />
-                </div>
-              </div>
-
-              <div className="rounded-xl border bg-slate-50 p-3">
-                <div className="text-sm text-slate-600">Final Preview</div>
-                <div className="mt-1 text-xl font-semibold">
-                  {(
-                    Number(drawer.row.mcq_score ?? 0) +
-                    Number(drawer.row.ai_score ?? 0)
-                  ).toFixed(2)}
-                </div>
-              </div>
-
-              <button
-                onClick={saveScore}
-                className="w-full rounded-xl bg-indigo-600 px-4 py-2 font-medium text-white shadow-sm hover:bg-indigo-700 transition"
-              >
-                L∆∞u & X√°c nh·∫≠n
-              </button>
-            </div>
-          </div>
-        </div>
-      )}
-    </div>
-  );
-}
-
-function Histogram({ rows }) {
-  const finals = rows
-    .map(toFinal)
-    .filter((v) => !isNaN(Number(v)));
-
-  const bins = new Array(10).fill(0);
-  finals.forEach((v) => {
-    const i = Math.max(0, Math.min(9, Math.floor(Number(v) / 10)));
-    bins[i]++;
-  });
-  const data = bins.map((c, i) => ({ name: `${i * 10}-${i * 10 + 9}`, cnt: c }));
-
-  const [lib, setLib] = React.useState(null);
-  React.useEffect(() => {
-    (async () => {
-      try {
-        const m = await import("recharts");
-        setLib(m);
-      } catch {}
-    })();
-  }, []);
-  if (!lib)
-    return <div className="text-sm text-slate-500">ƒêang t·∫£i bi·ªÉu ƒë·ªì‚Ä¶</div>;
-
-  const { ResponsiveContainer, BarChart, Bar, XAxis, Tooltip, CartesianGrid } =
-    lib;
-
-  return (
-    <div style={{ width: "100%", height: 240 }}>
-      <ResponsiveContainer width="100%" height={240}>
-        <BarChart data={data}>
-          <CartesianGrid strokeDasharray="3 3" />
-          <XAxis dataKey="name" />
-          <Tooltip />
-          <Bar dataKey="cnt" radius={[8, 8, 0, 0]} fill="#6366f1" />
-        </BarChart>
-      </ResponsiveContainer>
-    </div>
-  );
-}
-
-function PassFail({ rows, passThreshold }) {
-  const finals = rows
-    .map(toFinal)
-    .filter((v) => !isNaN(Number(v)));
-  const pass = finals.filter((v) => Number(v) >= passThreshold).length;
-  const fail = finals.length - pass;
-
-  const [lib, setLib] = React.useState(null);
-  React.useEffect(() => {
-    (async () => {
-      try {
-        const m = await import("recharts");
-        setLib(m);
-      } catch {}
-    })();
-  }, []);
-  if (!lib)
-    return <div className="text-sm text-slate-500">ƒêang t·∫£i bi·ªÉu ƒë·ªì‚Ä¶</div>;
-
-  const { ResponsiveContainer, PieChart, Pie, Cell, Tooltip } = lib;
-  const data = [
-    { name: "Pass", value: pass },
-    { name: "Fail", value: fail },
-  ];
-
-  return (
-    <div style={{ width: "100%", height: 240 }}>
-      <ResponsiveContainer width="100%" height={240}>
-        <PieChart>
-          <Pie
-            data={data}
-            dataKey="value"
-            nameKey="name"
-            innerRadius={50}
-            outerRadius={80}
-          >
-            <Cell fill="#10b981" />
-            <Cell fill="#f43f5e" />
-          </Pie>
-          <Tooltip />
-        </PieChart>
-      </ResponsiveContainer>
-    </div>
-  );
-}
+import React from "react";
+import { useNavigate } from "react-router-dom";
+import axiosClient from "../../api/axiosClient";
+
+const cls = (...a) => a.filter(Boolean).join(" ");
+
+const Badge = ({ color = "slate", children }) => (
+  <span
+    className={cls(
+      "inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium border",
+      color === "emerald" && "bg-emerald-50 text-emerald-700 border-emerald-200",
+      color === "amber" && "bg-amber-50 text-amber-700 border-amber-200",
+      color === "rose" && "bg-rose-50 text-rose-700 border-rose-200",
+      color === "slate" && "bg-slate-50 text-slate-700 border-slate-200"
+    )}
+  >
+    {children}
+  </span>
+);
+
+const StatCard = ({ label, value, subtle }) => (
+  <div className="group rounded-2xl border bg-white p-4 shadow-sm hover:shadow-md transition-all">
+    <div className="text-slate-500 text-sm">{label}</div>
+    <div className="mt-1 text-2xl font-semibold tracking-tight">{value}</div>
+    {subtle ? <div className="text-xs text-slate-400 mt-1">{subtle}</div> : null}
+  </div>
+);
+
+const Section = ({ title, right, children }) => (
+  <section className="rounded-2xl border bg-white p-4 shadow-sm">
+    <div className="mb-3 flex items-center justify-between">
+      <h3 className="text-base font-semibold text-slate-800">{title}</h3>
+      {right}
+    </div>
+    {children}
+  </section>
+);
+
+const StatusPill = (v) => {
+  const s = String(v || "").toLowerCase();
+  if (s === "confirmed") return <Badge color="emerald">Confirmed</Badge>;
+  if (s === "graded") return <Badge color="amber">Awaiting Approval</Badge>;
+  if (s === "pending") return <Badge color="slate">Pending</Badge>;
+  return <Badge>‚Äî</Badge>;
+};
+
+const fmtDate = (s) => (s ? new Date(s).toLocaleString() : "-");
+const toFinal = (r) =>
+  r.total_score ?? r.suggested_total_score ?? 0;
+
+export default function Result() {
+  const nav = useNavigate();
+
+  const [examId, setExamId] = React.useState("");
+  const [examList, setExamList] = React.useState([]);
+  const [summary, setSummary] = React.useState(null);
+  const [rows, setRows] = React.useState([]);
+  const [loading, setLoading] = React.useState(false);
+
+  const [q, setQ] = React.useState("");
+  const [status, setStatus] = React.useState("all");
+  const [sort, setSort] = React.useState("score_desc");
+  const [minScore, setMinScore] = React.useState("");
+  const [maxScore, setMaxScore] = React.useState("");
+  const [passThreshold, setPassThreshold] = React.useState(50);
+
+  const [drawer, setDrawer] = React.useState({ open: false, row: null });
+
+
+  const load = async (id) => {
+    if (!id) return;
+    setLoading(true);
+    try {
+      const [s, r] = await Promise.all([
+        axiosClient.get(`/instructor/exams/${id}/summary`),
+        axiosClient.get(`/instructor/exams/${id}/results`),
+      ]);
+      setSummary(s?.data || null);
+      setRows(Array.isArray(r?.data) ? r.data : []);
+    } catch {
+      setRows([]);
+      setSummary(null);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  React.useEffect(() => {
+    (async () => {
+      try {
+        const res = await axiosClient.get("/instructor/exams/my");
+        const list = Array.isArray(res.data) ? res.data : [];
+        setExamList(list);
+
+        const url = new URL(window.location.href);
+        const idQ = url.searchParams.get("exam_id");
+        if (idQ) {
+          setExamId(idQ);
+          load(idQ);
+        } else {
+          const first =
+            list.find((e) => String(e.status) === "published") || list[0];
+          if (first) {
+            setExamId(String(first.id));
+            load(String(first.id));
+          }
+        }
+      } catch {
+        /* ignore */
+      }
+    })();
+  }, []);
+
+  const onPick = (e) => {
+    const id = e.target.value.trim();
+    setExamId(id);
+    load(id);
+  };
+
+  const filtered = React.useMemo(() => {
+    const norm = (s) => String(s || "").toLowerCase();
+    let arr = (rows || []).filter((r) =>
+      norm(r.student_name).includes(norm(q))
+    );
+
+    if (status !== "all")
+      arr = arr.filter((r) =>
+        String(r.status || "").toLowerCase().includes(status)
+      );
+
+    const min = minScore !== "" ? Number(minScore) : null;
+    const max = maxScore !== "" ? Number(maxScore) : null;
+    if (min != null) arr = arr.filter((r) => toFinal(r) >= min);
+    if (max != null) arr = arr.filter((r) => toFinal(r) <= max);
+
+    // always sort on a clone to avoid mutating state
+    const sorted = [...arr];
+    if (sort === "score_desc") sorted.sort((a, b) => toFinal(b) - toFinal(a));
+    if (sort === "score_asc") sorted.sort((a, b) => toFinal(a) - toFinal(b));
+
+    return sorted;
+  }, [rows, q, status, sort, minScore, maxScore]);
+
+
+  const exportCsv = () => {
+    const header = [
+      "Student",
+      "MCQ",
+      "AI",
+      "Suggested",
+      "Final",
+      "Status",
+      "Start",
+      "Submitted",
+      "Duration(min)",
+      "Cheating",
+      "FaceURL",
+      "CardURL",
+    ];
+    const lines = [header.join(",")];
+    filtered.forEach((r) => {
+      const line = [
+        r.student_name ?? "",
+        r.mcq_score ?? "",
+        r.ai_score ?? "",
+        r.suggested_total_score ?? "",
+        r.total_score ?? "",
+        r.status ?? "",
+        r.started_at ? new Date(r.started_at).toLocaleString() : "",
+        r.submitted_at ? new Date(r.submitted_at).toLocaleString() : "",
+        r.duration_minutes ?? "",
+        r.cheating_flag ? "Yes" : "No",
+        r.face_image_url ?? "",
+        r.student_card_url ?? "",
+      ]
+        .map((v) => `"${String(v).replaceAll('"', '""')}"`)
+        .join(",");
+      lines.push(line);
+    });
+    const blob = new Blob([lines.join("\n")], {
+      type: "text/csv;charset=utf-8;",
+    });
+    const url = URL.createObjectURL(blob);
+    const a = document.createElement("a");
+    a.href = url;
+    a.download = `results_exam_${examId || "unknown"}.csv`;
+    a.click();
+    URL.revokeObjectURL(url);
+  };
+
+  const exportXlsx = async () => {
+    try {
+      const data = filtered.map((r) => ({
+        Student: r.student_name,
+        MCQ: r.mcq_score,
+        AI: r.ai_score,
+        Suggested: r.suggested_total_score,
+        Final: r.total_score ?? r.suggested_total_score,
+        Status: r.status,
+        Start: r.started_at ? new Date(r.started_at).toLocaleString() : "",
+        Submitted: r.submitted_at
+          ? new Date(r.submitted_at).toLocaleString()
+          : "",
+        "Duration (min)": r.duration_minutes ?? "",
+        Cheating: r.cheating_flag ? "Yes" : "No",
+        FaceURL: r.face_image_url ?? "",
+        CardURL: r.student_card_url ?? "",
+      }));
+      const mod = await import(/* @vite-ignore */ "xlsx");
+      const ws = mod.utils.json_to_sheet(data);
+      const wb = mod.utils.book_new();
+      mod.utils.book_append_sheet(wb, ws, "Results");
+      mod.writeFile(wb, `results_exam_${examId || "unknown"}.xlsx`);
+    } catch {
+      exportCsv();
+    }
+  };
+
+  const openDrawer = (row) => setDrawer({ open: true, row });
+  const closeDrawer = () => setDrawer({ open: false, row: null });
+
+  const saveScore = async () => {
+    const r = drawer.row;
+    if (!r) return;
+    try {
+      const payload = {
+        mcq_score: Number(r.mcq_score ?? 0),
+        ai_score: Number(r.ai_score ?? 0),
+        student_name: r.student_name,
+      };
+      await axiosClient.put(
+        `/instructor/exams/${examId}/students/${r.student_id}/score`,
+        payload
+      );
+      await load(examId);
+      closeDrawer();
+    } catch {
+      /* ignore */
+    }
+  };
+
+ 
+  return (
+    <div className="p-6 max-w-7xl mx-auto space-y-6">
+
+      {/* Header + actions */}
+      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
+        <div>
+          <h1 className="text-2xl font-bold tracking-tight">Exam Results</h1>
+          <p className="text-slate-500 text-sm">
+            Xem, l·ªçc, ch·ªânh & c√¥ng b·ªë ƒëi·ªÉm cho t·ª´ng b√†i thi ƒë√£ publish.
+          </p>
+        </div>
+        <div className="flex items-center gap-2">
+          <button
+            onClick={() => nav("/results-exams")}
+            className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
+          >
+            Ch·ªçn b√†i thi kh√°c
+          </button>
+
+          <select
+            value={examId}
+            onChange={onPick}
+            className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:border-slate-300"
+          >
+            <option value="">Ch·ªçn b√†i thi‚Ä¶</option>
+            {examList.map((e) => (
+              <option key={e.id} value={e.id}>
+                {e.title || `Exam #${e.id}`} {e.status ? `(${e.status})` : ""}
+              </option>
+            ))}
+          </select>
+
+          <div className="hidden sm:flex items-center gap-2">
+            <button
+              onClick={exportCsv}
+              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
+            >
+              Export CSV
+            </button>
+            <button
+              onClick={exportXlsx}
+              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
+            >
+              Export Excel
+            </button>
+          </div>
+        </div>
+      </div>
+
+      {/* Summary */}
+      <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
+        <StatCard
+          label="Total Submissions"
+          value={(summary?.total_submissions ?? summary?.total ?? 0)}
+        />
+        <StatCard
+          label="Total Students"
+          value={summary?.total_students ?? 0}
+        />
+        <StatCard
+          label="Avg Score"
+          value={
+            summary?.avg_score != null
+              ? Number(summary.avg_score).toFixed(2)
+              : "-"
+          }
+        />
+        <StatCard
+          label="Last Submission"
+          value={fmtDate(summary?.last_submission_time)}
+        />
+      </div>
+
+      {/* Filters */}
+      <Section
+        title="B·ªô l·ªçc"
+        right={
+          <div className="text-xs text-slate-400">
+            {filtered.length} b·∫£n ghi hi·ªÉn th·ªã
+          </div>
+        }
+      >
+        <div className="flex flex-wrap items-center gap-2">
+          <input
+            value={q}
+            onChange={(e) => setQ(e.target.value)}
+            placeholder="T√¨m t√™n sinh vi√™n‚Ä¶"
+            className="w-56 rounded-xl border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
+          />
+          <div className="inline-flex rounded-xl border overflow-hidden bg-white shadow-sm">
+            {["all", "pending", "graded", "confirmed"].map((s) => (
+              <button
+                key={s}
+                onClick={() => setStatus(s)}
+                className={cls(
+                  "px-3 py-2 text-sm",
+                  status === s ? "bg-indigo-600 text-white" : "hover:bg-slate-50"
+                )}
+              >
+                {s}
+              </button>
+            ))}
+          </div>
+          <input
+            type="number"
+            placeholder="Min"
+            className="w-24 rounded-xl border px-3 py-2 shadow-sm"
+            value={minScore}
+            onChange={(e) => setMinScore(e.target.value)}
+          />
+          <input
+            type="number"
+            placeholder="Max"
+            className="w-24 rounded-xl border px-3 py-2 shadow-sm"
+            value={maxScore}
+            onChange={(e) => setMaxScore(e.target.value)}
+          />
+          <div className="inline-flex rounded-xl border overflow-hidden bg-white shadow-sm">
+            <button
+              onClick={() => setSort("score_desc")}
+              className={cls(
+                "px-3 py-2 text-sm",
+                sort === "score_desc" ? "bg-indigo-600 text-white" : "hover:bg-slate-50"
+              )}
+            >
+              ƒêi·ªÉm ‚Üì
+            </button>
+            <button
+              onClick={() => setSort("score_asc")}
+              className={cls(
+                "px-3 py-2 text-sm",
+                sort === "score_asc" ? "bg-indigo-600 text-white" : "hover:bg-slate-50"
+              )}
+            >
+              ƒêi·ªÉm ‚Üë
+            </button>
+          </div>
+        </div>
+      </Section>
+
+      {/* Charts + Export row */}
+      <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
+        <Section title="Ph√¢n b·ªë ƒëi·ªÉm (Histogram)">
+          <Histogram rows={filtered} />
+        </Section>
+        <Section
+          title="T·ªâ l·ªá ƒë·∫°t (Pass/Fail)"
+          right={
+            <div className="flex items-center gap-2 text-sm">
+              <span>Ng∆∞·ª°ng:</span>
+              <input
+                type="number"
+                className="w-20 rounded-lg border px-2 py-1 shadow-sm"
+                value={passThreshold}
+                onChange={(e) => setPassThreshold(e.target.value)}
+              />
+            </div>
+          }
+        >
+          <PassFail rows={filtered} passThreshold={Number(passThreshold || 0)} />
+        </Section>
+        <Section
+          title="Xu·∫•t b√°o c√°o"
+          right={<div className="text-xs text-slate-400">CSV/Excel</div>}
+        >
+          <div className="flex flex-wrap gap-2">
+            <button
+              onClick={exportCsv}
+              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
+            >
+              Export CSV
+            </button>
+            <button
+              onClick={exportXlsx}
+              className="rounded-xl border bg-white px-3 py-2 shadow-sm hover:bg-slate-50 transition"
+            >
+              Export Excel
+            </button>
+          </div>
+        </Section>
+      </div>
+
+      {/* Table */}
+      <Section title="Danh s√°ch b√†i n·ªôp">
+        <div className="overflow-auto rounded-xl border">
+          <table className="min-w-full text-sm">
+            <thead className="bg-slate-50 sticky top-0">
+              <tr className="text-left text-slate-700">
+                <th className="p-3">Student</th>
+                <th className="p-3">MCQ</th>
+                <th className="p-3">Essay (AI)</th>
+                <th className="p-3">Suggested</th>
+                <th className="p-3">Final</th>
+                <th className="p-3">Start</th>
+                <th className="p-3">Submitted</th>
+                <th className="p-3">Duration (min)</th>
+                <th className="p-3">Cheating</th>
+                <th className="p-3">Face</th>
+                <th className="p-3">Card</th>
+                <th className="p-3">Status</th>
+                <th className="p-3">Actions</th>
+              </tr>
+            </thead>
+            <tbody>
+              {loading ? (
+                <tr>
+                  <td colSpan={13} className="p-6 text-center text-slate-500">
+                    ƒêang t·∫£i...
+                  </td>
+                </tr>
+              ) : filtered.length === 0 ? (
+                <tr>
+                  <td colSpan={13} className="p-6 text-center text-slate-500">
+                    Kh√¥ng c√≥ d·ªØ li·ªáu
+                  </td>
+                </tr>
+              ) : (
+                filtered.map((r) => (
+                  <tr
+                    key={`${r.student_id}-${r.student_name}`}
+                    className="border-t hover:bg-indigo-50/40 transition"
+                  >
+                    <td className="p-3 font-medium text-slate-800">
+                      {r.student_name}
+                    </td>
+                    <td className="p-3">{r.mcq_score ?? "-"}</td>
+                    <td className="p-3">{r.ai_score ?? "-"}</td>
+                    <td className="p-3">{r.suggested_total_score ?? "-"}</td>
+                    <td className="p-3 font-semibold">
+                      {(r.total_score ?? r.suggested_total_score ?? 0).toFixed
+                        ? (r.total_score ?? r.suggested_total_score ?? 0).toFixed(2)
+                        : r.total_score ?? r.suggested_total_score ?? 0}
+                    </td>
+                    <td className="p-3">{fmtDate(r.started_at)}</td>
+                    <td className="p-3">{fmtDate(r.submitted_at)}</td>
+                    <td className="p-3">{r.duration_minutes ?? "-"}</td>
+                    <td className="p-3">
+                      {r.cheating_flag ? (
+                        <Badge color="rose">Yes</Badge>
+                      ) : (
+                        <Badge>No</Badge>
+                      )}
+                    </td>
+                    <td className="p-3">
+                      {r.face_image_url ? (
+                        <a
+                          className="text-indigo-600 underline hover:text-indigo-800"
+                          href={r.face_image_url}
+                          target="_blank"
+                        >
+                          View
+                        </a>
+                      ) : (
+                        "‚Äî"
+                      )}
+                    </td>
+                    <td className="p-3">
+                      {r.student_card_url ? (
+                        <a
+                          className="text-indigo-600 underline hover:text-indigo-800"
+                          href={r.student_card_url}
+                          target="_blank"
+                        >
+                          View
+                        </a>
+                      ) : (
+                        "‚Äî"
+                      )}
+                    </td>
+                    <td className="p-3">{StatusPill(r.status)}</td>
+                    <td className="p-3">
+                      <button
+                        onClick={() => openDrawer(r)}
+                        className="rounded-lg border bg-white px-3 py-1.5 shadow-sm hover:bg-slate-50 transition"
+                      >
+                        Edit
+                      </button>
+                    </td>
+                  </tr>
+                ))
+              )}
+            </tbody>
+          </table>
+        </div>
+      </Section>
+
+      {/* Drawer */}
+      {drawer.open && (
+        <div className="fixed inset-0 z-50 flex bg-black/30">
+          <div className="ml-auto h-full w-full max-w-md bg-white shadow-xl">
+            <div className="flex items-center justify-between border-b p-4">
+              <div>
+                <h4 className="text-lg font-semibold">C·∫≠p nh·∫≠t ƒëi·ªÉm</h4>
+                <div className="text-xs text-slate-500">
+                  Save & Confirm s·∫Ω c√¥ng b·ªë ƒëi·ªÉm cu·ªëi c√πng cho sinh vi√™n
+                </div>
+              </div>
+              <button
+                onClick={closeDrawer}
+                className="rounded-lg border bg-white px-3 py-1.5 hover:bg-slate-50"
+              >
+                ƒê√≥ng
+              </button>
+            </div>
+
+            <div className="p-4 space-y-3">
+              <div>
+                <label className="text-sm text-slate-600">T√™n sinh vi√™n</label>
+                <input
+                  className="mt-1 w-full rounded-lg border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
+                  value={drawer.row.student_name || ""}
+                  onChange={(e) =>
+                    setDrawer((d) => ({
+                      ...d,
+                      row: { ...d.row, student_name: e.target.value },
+                    }))
+                  }
+                />
+              </div>
+              <div className="grid grid-cols-2 gap-3">
+                <div>
+                  <label className="text-sm text-slate-600">ƒêi·ªÉm MCQ</label>
+                  <input
+                    type="number"
+                    className="mt-1 w-full rounded-lg border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
+                    value={drawer.row.mcq_score ?? 0}
+                    onChange={(e) =>
+                      setDrawer((d) => ({
+                        ...d,
+                        row: { ...d.row, mcq_score: e.target.value },
+                      }))
+                    }
+                  />
+                </div>
+                <div>
+                  <label className="text-sm text-slate-600">ƒêi·ªÉm AI</label>
+                  <input
+                    type="number"
+                    className="mt-1 w-full rounded-lg border px-3 py-2 shadow-sm focus:outline-none focus:ring focus:ring-indigo-100"
+                    value={drawer.row.ai_score ?? 0}
+                    onChange={(e) =>
+                      setDrawer((d) => ({
+                        ...d,
+                        row: { ...d.row, ai_score: e.target.value },
+                      }))
+                    }
+                  />
+                </div>
+              </div>
+
+              <div className="rounded-xl border bg-slate-50 p-3">
+                <div className="text-sm text-slate-600">Final Preview</div>
+                <div className="mt-1 text-xl font-semibold">
+                  {(
+                    Number(drawer.row.mcq_score ?? 0) +
+                    Number(drawer.row.ai_score ?? 0)
+                  ).toFixed(2)}
+                </div>
+              </div>
+
+              <button
+                onClick={saveScore}
+                className="w-full rounded-xl bg-indigo-600 px-4 py-2 font-medium text-white shadow-sm hover:bg-indigo-700 transition"
+              >
+                L∆∞u & X√°c nh·∫≠n
+              </button>
+            </div>
+          </div>
+        </div>
+      )}
+    </div>
+  );
+}
+
+function Histogram({ rows }) {
+  const finals = rows
+    .map(toFinal)
+    .filter((v) => !isNaN(Number(v)));
+
+  const bins = new Array(10).fill(0);
+  finals.forEach((v) => {
+    const i = Math.max(0, Math.min(9, Math.floor(Number(v) / 10)));
+    bins[i]++;
+  });
+  const data = bins.map((c, i) => ({ name: `${i * 10}-${i * 10 + 9}`, cnt: c }));
+
+  const [lib, setLib] = React.useState(null);
+  React.useEffect(() => {
+    (async () => {
+      try {
+        const m = await import("recharts");
+        setLib(m);
+      } catch {}
+    })();
+  }, []);
+  if (!lib)
+    return <div className="text-sm text-slate-500">ƒêang t·∫£i bi·ªÉu ƒë·ªì‚Ä¶</div>;
+
+  const { ResponsiveContainer, BarChart, Bar, XAxis, Tooltip, CartesianGrid } =
+    lib;
+
+  return (
+    <div style={{ width: "100%", height: 240 }}>
+      <ResponsiveContainer width="100%" height={240}>
+        <BarChart data={data}>
+          <CartesianGrid strokeDasharray="3 3" />
+          <XAxis dataKey="name" />
+          <Tooltip />
+          <Bar dataKey="cnt" radius={[8, 8, 0, 0]} fill="#6366f1" />
+        </BarChart>
+      </ResponsiveContainer>
+    </div>
+  );
+}
+
+function PassFail({ rows, passThreshold }) {
+  const finals = rows
+    .map(toFinal)
+    .filter((v) => !isNaN(Number(v)));
+  const pass = finals.filter((v) => Number(v) >= passThreshold).length;
+  const fail = finals.length - pass;
+
+  const [lib, setLib] = React.useState(null);
+  React.useEffect(() => {
+    (async () => {
+      try {
+        const m = await import("recharts");
+        setLib(m);
+      } catch {}
+    })();
+  }, []);
+  if (!lib)
+    return <div className="text-sm text-slate-500">ƒêang t·∫£i bi·ªÉu ƒë·ªì‚Ä¶</div>;
+
+  const { ResponsiveContainer, PieChart, Pie, Cell, Tooltip } = lib;
+  const data = [
+    { name: "Pass", value: pass },
+    { name: "Fail", value: fail },
+  ];
+
+  return (
+    <div style={{ width: "100%", height: 240 }}>
+      <ResponsiveContainer width="100%" height={240}>
+        <PieChart>
+          <Pie
+            data={data}
+            dataKey="value"
+            nameKey="name"
+            innerRadius={50}
+            outerRadius={80}
+          >
+            <Cell fill="#10b981" />
+            <Cell fill="#f43f5e" />
+          </Pie>
+          <Tooltip />
+        </PieChart>
+      </ResponsiveContainer>
+    </div>
+  );
+}
diff --git a/frontend/src/pages/instructorPage/Setting.jsx b/frontend/src/pages/instructorPage/Setting.jsx
index e2e9778..b9fc7c2 100644
--- a/frontend/src/pages/instructorPage/Setting.jsx
+++ b/frontend/src/pages/instructorPage/Setting.jsx
@@ -1,44 +1,44 @@
-import React from "react";
-import { useUi } from "../../context/UiContext.jsx";
-
-export default function Setting() {
-  const { lang, setLang } = useUi();
-
-  const Toggle = ({checked, onChange}) => (
-    <button
-      type="button"
-      role="switch"
-      aria-checked={checked}
-      onClick={()=> onChange(!checked)}
-      className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${checked? 'bg-emerald-500': 'bg-slate-300'}`}
-    >
-      <span className={`inline-block h-5 w-5 transform rounded-full bg-white transition ${checked? 'translate-x-5' : 'translate-x-1'}`} />
-    </button>
-  );
-
-  return (
-    <div className="max-w-3xl mx-auto">
-      <header className="mb-4">
-        <h1 className="text-xl font-semibold text-slate-800">C√†i ƒë·∫∑t giao di·ªán</h1>
-        <p className="text-slate-600">Thi·∫øt l·∫≠p theme v√† ng√¥n ng·ªØ cho giao di·ªán gi·∫£ng vi√™n</p>
-      </header>
-
-      {/* Theme section removed per user request; interface always uses light theme */}
-
-      <section className="bg-white border border-slate-200 rounded-2xl p-4 shadow-sm">
-        <div className="flex items-center justify-between">
-          <div>
-            <div className="font-medium text-slate-800">Ng√¥n ng·ªØ</div>
-            <div className="text-sm text-slate-500">Ch·ªçn ng√¥n ng·ªØ hi·ªÉn th·ªã cho giao di·ªán gi·∫£ng vi√™n</div>
-          </div>
-          <div className="inline-flex rounded-xl border border-slate-200 overflow-hidden">
-            <button onClick={()=> setLang('vi')} className={`px-3 py-2 text-sm ${lang==='vi'?'bg-blue-600 text-white':'bg-white hover:bg-slate-50'}`}>Ti·∫øng Vi·ªát</button>
-            <button onClick={()=> setLang('en')} className={`px-3 py-2 text-sm ${lang==='en'?'bg-blue-600 text-white':'bg-white hover:bg-slate-50'}`}>English</button>
-          </div>
-        </div>
-      </section>
-
-      <p className="text-xs text-slate-500 mt-3">G·ª£i √Ω: M·ªôt s·ªë trang s·∫Ω ph·∫£n ·ª©ng ngay; ph·∫ßn c√≤n l·∫°i s·∫Ω ƒë∆∞·ª£c √°p d·ª•ng d·∫ßn.</p>
-    </div>
-  );
-}
+import React from "react";
+import { useUi } from "../../context/UiContext.jsx";
+
+export default function Setting() {
+  const { lang, setLang } = useUi();
+
+  const Toggle = ({checked, onChange}) => (
+    <button
+      type="button"
+      role="switch"
+      aria-checked={checked}
+      onClick={()=> onChange(!checked)}
+      className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${checked? 'bg-emerald-500': 'bg-slate-300'}`}
+    >
+      <span className={`inline-block h-5 w-5 transform rounded-full bg-white transition ${checked? 'translate-x-5' : 'translate-x-1'}`} />
+    </button>
+  );
+
+  return (
+    <div className="max-w-3xl mx-auto">
+      <header className="mb-4">
+        <h1 className="text-xl font-semibold text-slate-800">C√†i ƒë·∫∑t giao di·ªán</h1>
+        <p className="text-slate-600">Thi·∫øt l·∫≠p theme v√† ng√¥n ng·ªØ cho giao di·ªán gi·∫£ng vi√™n</p>
+      </header>
+
+      {/* Theme section removed per user request; interface always uses light theme */}
+
+      <section className="bg-white border border-slate-200 rounded-2xl p-4 shadow-sm">
+        <div className="flex items-center justify-between">
+          <div>
+            <div className="font-medium text-slate-800">Ng√¥n ng·ªØ</div>
+            <div className="text-sm text-slate-500">Ch·ªçn ng√¥n ng·ªØ hi·ªÉn th·ªã cho giao di·ªán gi·∫£ng vi√™n</div>
+          </div>
+          <div className="inline-flex rounded-xl border border-slate-200 overflow-hidden">
+            <button onClick={()=> setLang('vi')} className={`px-3 py-2 text-sm ${lang==='vi'?'bg-blue-600 text-white':'bg-white hover:bg-slate-50'}`}>Ti·∫øng Vi·ªát</button>
+            <button onClick={()=> setLang('en')} className={`px-3 py-2 text-sm ${lang==='en'?'bg-blue-600 text-white':'bg-white hover:bg-slate-50'}`}>English</button>
+          </div>
+        </div>
+      </section>
+
+      <p className="text-xs text-slate-500 mt-3">G·ª£i √Ω: M·ªôt s·ªë trang s·∫Ω ph·∫£n ·ª©ng ngay; ph·∫ßn c√≤n l·∫°i s·∫Ω ƒë∆∞·ª£c √°p d·ª•ng d·∫ßn.</p>
+    </div>
+  );
+}
diff --git a/frontend/src/pages/studentPage/StudentDashboard.jsx b/frontend/src/pages/studentPage/StudentDashboard.jsx
index 95a251d..4fb6de6 100644
--- a/frontend/src/pages/studentPage/StudentDashboard.jsx
+++ b/frontend/src/pages/studentPage/StudentDashboard.jsx
@@ -1,149 +1,149 @@
-import React from 'react';
-import { useNavigate } from 'react-router-dom';
-import axiosClient from '../../api/axiosClient';
-
-export default function StudentDashboard() {
-  const navigate = useNavigate();
-  const [results, setResults] = React.useState([]);
-  const [loading, setLoading] = React.useState(true);
-  const [user, setUser] = React.useState({ fullname: '', avatar: '' });
-
-  React.useEffect(() => {
-    (async () => {
-      try {
-        const res = await axiosClient.get('/results/my');
-        setResults((res.data || []).slice(0, 6));
-      } catch (e) {
-        setResults([]);
-      } finally { setLoading(false); }
-    })();
-  }, []);
-
-  // Load profile for greeting (∆∞u ti√™n API, fallback localStorage)
-  React.useEffect(() => {
-    (async () => {
-      try {
-        const res = await axiosClient.get('/profile');
-        const u = res?.data?.data;
-        if (u) {
-          setUser({ fullname: u.full_name || 'Ng∆∞·ªùi d√πng', avatar: u.avatar || '/icons/UI Image/default-avatar.png' });
-          try {
-            localStorage.setItem('fullname', u.full_name || '');
-            if (u.avatar) localStorage.setItem('avatar', u.avatar);
-          } catch {}
-          return;
-        }
-      } catch {}
-      // fallback
-      const fullname = localStorage.getItem('fullname') || 'Ng∆∞·ªùi d√πng';
-      const avatar = localStorage.getItem('avatar') || '/icons/UI Image/default-avatar.png';
-      setUser({ fullname, avatar });
-    })();
-  }, []);
-
-  const logout = () => {
-    try { localStorage.clear(); sessionStorage.clear(); } catch {}
-    navigate('/login');
-  };
-
-  const Card = ({ title, desc, action, onClick, icon }) => (
-    <button onClick={onClick} className="group text-left rounded-2xl p-4 bg-white border border-slate-200 hover:border-blue-300 hover:shadow transition">
-      <div className="flex items-center gap-3">
-        <div className="w-10 h-10 rounded-xl grid place-items-center bg-gradient-to-br from-blue-100 to-indigo-100 text-blue-600 group-hover:from-blue-200 group-hover:to-indigo-200">
-          {icon || 'üìò'}
-        </div>
-        <div>
-          <h3 className="font-semibold text-slate-800">{title}</h3>
-          <p className="text-sm text-slate-500">{desc}</p>
-        </div>
-      </div>
-      <div className="mt-3 text-sm font-medium text-blue-600">{action} ‚Üí</div>
-    </button>
-  );
-
-  return (
-    <div className="min-h-screen bg-gradient-to-b from-slate-50 to-white">
-      {/* Header */}
-      <header className="sticky top-0 z-10 bg-white/80 backdrop-blur border-b border-slate-200">
-        <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
-          <div className="flex items-center gap-3">
-            <button onClick={() => navigate('/')} className="flex items-center gap-3">
-              <img src="/Logo.png" alt="Logo" className="h-9 w-auto" />
-              <h1 className="text-base font-semibold text-slate-700">Student Dashboard</h1>
-            </button>
-          </div>
-          <div className="flex items-center gap-3">
-            <div className="flex items-center gap-2">
-              <img src={user.avatar || '/icons/UI Image/default-avatar.png'} alt="avatar" className="w-8 h-8 rounded-full object-cover border border-slate-200" />
-              <span className="text-sm text-slate-600">Xin ch√†o, <span className="font-semibold text-slate-800">{user.fullname || 'Ng∆∞·ªùi d√πng'}</span></span>
-            </div>
-            <button onClick={logout} className="px-3 py-2 rounded-lg border border-slate-300 text-slate-700 hover:border-slate-400">ƒêƒÉng xu·∫•t</button>
-          </div>
-        </div>
-      </header>
-
-      <main className="max-w-6xl mx-auto p-4">
-        {/* Hero */}
-        <section className="rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 p-6 mb-6">
-          <h2 className="text-xl font-bold text-slate-800">Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i üëã</h2>
-          <p className="text-slate-600">B·∫Øt ƒë·∫ßu b·∫±ng c√°ch x√°c minh m√£ ph√≤ng thi ho·∫∑c xem k·∫øt qu·∫£ g·∫ßn ƒë√¢y.</p>
-          <div className="mt-4 flex flex-wrap gap-3">
-            <button onClick={() => navigate('/student-dashboard/results')} className="px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:border-slate-400">K·∫øt qu·∫£ c·ªßa t√¥i</button>
-          </div>
-        </section>
-
-        {/* Quick actions mapped to user stories */}
-        <section className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
-          <Card title="V√†o thi" desc="Nh·∫≠p m√£ ph√≤ng ƒë∆∞·ª£c gi·∫£ng vi√™n cung c·∫•p." action="X√°c minh ngay" onClick={() => navigate('/verify-room')} icon="üîê" />
-          <Card title="K·∫øt qu·∫£ & l·ªãch s·ª≠" desc="Xem ƒëi·ªÉm c√°c b√†i ƒë√£ thi." action="Xem b·∫£ng ƒëi·ªÉm" onClick={() => navigate('/student-dashboard/results')} icon="üìä" />
-          <Card title="Kho√° h·ªçc" desc="Duy·ªát c√°c kho√° h·ªçc m·ªü." action="Xem kho√° h·ªçc" onClick={() => alert('T√≠nh nƒÉng duy·ªát kho√° h·ªçc (US12) ‚Äî s·∫Ω t√≠ch h·ª£p sau.')} icon="üìö" />
-          <Card title="H·ªì s∆°" desc="C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n, avatar." action="C·∫≠p nh·∫≠t" onClick={() => navigate('/profile')} icon="üë§" />
-          <Card title="H∆∞·ªõng d·∫´n l√†m b√†i" desc="Quy t·∫Øc & ch·ªëng gian l·∫≠n." action="Xem h∆∞·ªõng d·∫´n" onClick={() => alert('Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n/FAQ ch·ªëng gian l·∫≠n.')} icon="üõ°Ô∏è" />
-          <Card title="Tr·ª£ gi√∫p" desc="Li√™n h·ªá h·ªó tr·ª£ khi g·∫∑p l·ªói." action="G·ª≠i y√™u c·∫ßu" onClick={() => alert('Li√™n h·ªá h·ªó tr·ª£ qua email/Zalo theo h∆∞·ªõng d·∫´n.')} icon="‚ùì" />
-        </section>
-
-        {/* Recent results */}
-        <section className="rounded-2xl bg-white border border-slate-200 p-4">
-          <div className="flex items-center justify-between mb-3">
-            <h3 className="font-semibold text-slate-800">K·∫øt qu·∫£ g·∫ßn ƒë√¢y</h3>
-            <button onClick={() => navigate('/student-dashboard/results')} className="text-sm text-blue-600 hover:underline">Xem t·∫•t c·∫£</button>
-          </div>
-          {loading ? (
-            <div className="space-y-2">
-              <div className="h-4 w-40 bg-slate-200 rounded animate-pulse" />
-              <div className="h-12 w-full bg-slate-200 rounded animate-pulse" />
-              <div className="h-12 w-full bg-slate-200 rounded animate-pulse" />
-            </div>
-          ) : results.length === 0 ? (
-            <p className="text-slate-500 text-sm">Ch∆∞a c√≥ k·∫øt qu·∫£ n√†o.</p>
-          ) : (
-            <div className="overflow-x-auto">
-              <table className="min-w-full text-sm">
-                <thead>
-                  <tr className="text-left text-slate-500">
-                    <th className="py-2 pr-4">B√†i thi</th>
-                    <th className="py-2 pr-4">MCQ</th>
-                    <th className="py-2 pr-4">T·ª± lu·∫≠n</th>
-                    <th className="py-2 pr-4">T·ªïng t·∫°m</th>
-                    <th className="py-2 pr-4">Ng√†y n·ªôp</th>
-                  </tr>
-                </thead>
-                <tbody>
-                  {results.map((r) => (
-                    <tr key={r.submission_id} className="border-t border-slate-100">
-                      <td className="py-2 pr-4 font-medium text-slate-700">{r.exam_title || r.exam_id}</td>
-                      <td className="py-2 pr-4">{(r.total_score ?? r.mcq_score) ?? '-'}</td>
-                      <td className="py-2 pr-4">{r.essay_score ?? '-'}</td>
-                      <td className="py-2 pr-4">{r.suggested_total_score ?? '-'}</td>
-                      <td className="py-2 pr-4">{r.submitted_at ? new Date(r.submitted_at).toLocaleString() : '-'}</td>
-                    </tr>
-                  ))}
-                </tbody>
-              </table>
-            </div>
-          )}
-        </section>
-      </main>
-    </div>
-  );
-}
+import React from 'react';
+import { useNavigate } from 'react-router-dom';
+import axiosClient from '../../api/axiosClient';
+
+export default function StudentDashboard() {
+  const navigate = useNavigate();
+  const [results, setResults] = React.useState([]);
+  const [loading, setLoading] = React.useState(true);
+  const [user, setUser] = React.useState({ fullname: '', avatar: '' });
+
+  React.useEffect(() => {
+    (async () => {
+      try {
+        const res = await axiosClient.get('/results/my');
+        setResults((res.data || []).slice(0, 6));
+      } catch (e) {
+        setResults([]);
+      } finally { setLoading(false); }
+    })();
+  }, []);
+
+  // Load profile for greeting (∆∞u ti√™n API, fallback localStorage)
+  React.useEffect(() => {
+    (async () => {
+      try {
+        const res = await axiosClient.get('/profile');
+        const u = res?.data?.data;
+        if (u) {
+          setUser({ fullname: u.full_name || 'Ng∆∞·ªùi d√πng', avatar: u.avatar || '/icons/UI Image/default-avatar.png' });
+          try {
+            localStorage.setItem('fullname', u.full_name || '');
+            if (u.avatar) localStorage.setItem('avatar', u.avatar);
+          } catch {}
+          return;
+        }
+      } catch {}
+      // fallback
+      const fullname = localStorage.getItem('fullname') || 'Ng∆∞·ªùi d√πng';
+      const avatar = localStorage.getItem('avatar') || '/icons/UI Image/default-avatar.png';
+      setUser({ fullname, avatar });
+    })();
+  }, []);
+
+  const logout = () => {
+    try { localStorage.clear(); sessionStorage.clear(); } catch {}
+    navigate('/login');
+  };
+
+  const Card = ({ title, desc, action, onClick, icon }) => (
+    <button onClick={onClick} className="group text-left rounded-2xl p-4 bg-white border border-slate-200 hover:border-blue-300 hover:shadow transition">
+      <div className="flex items-center gap-3">
+        <div className="w-10 h-10 rounded-xl grid place-items-center bg-gradient-to-br from-blue-100 to-indigo-100 text-blue-600 group-hover:from-blue-200 group-hover:to-indigo-200">
+          {icon || 'üìò'}
+        </div>
+        <div>
+          <h3 className="font-semibold text-slate-800">{title}</h3>
+          <p className="text-sm text-slate-500">{desc}</p>
+        </div>
+      </div>
+      <div className="mt-3 text-sm font-medium text-blue-600">{action} ‚Üí</div>
+    </button>
+  );
+
+  return (
+    <div className="min-h-screen bg-gradient-to-b from-slate-50 to-white">
+      {/* Header */}
+      <header className="sticky top-0 z-10 bg-white/80 backdrop-blur border-b border-slate-200">
+        <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
+          <div className="flex items-center gap-3">
+            <button onClick={() => navigate('/')} className="flex items-center gap-3">
+              <img src="/Logo.png" alt="Logo" className="h-9 w-auto" />
+              <h1 className="text-base font-semibold text-slate-700">Student Dashboard</h1>
+            </button>
+          </div>
+          <div className="flex items-center gap-3">
+            <div className="flex items-center gap-2">
+              <img src={user.avatar || '/icons/UI Image/default-avatar.png'} alt="avatar" className="w-8 h-8 rounded-full object-cover border border-slate-200" />
+              <span className="text-sm text-slate-600">Xin ch√†o, <span className="font-semibold text-slate-800">{user.fullname || 'Ng∆∞·ªùi d√πng'}</span></span>
+            </div>
+            <button onClick={logout} className="px-3 py-2 rounded-lg border border-slate-300 text-slate-700 hover:border-slate-400">ƒêƒÉng xu·∫•t</button>
+          </div>
+        </div>
+      </header>
+
+      <main className="max-w-6xl mx-auto p-4">
+        {/* Hero */}
+        <section className="rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 p-6 mb-6">
+          <h2 className="text-xl font-bold text-slate-800">Ch√†o m·ª´ng b·∫°n tr·ªü l·∫°i üëã</h2>
+          <p className="text-slate-600">B·∫Øt ƒë·∫ßu b·∫±ng c√°ch x√°c minh m√£ ph√≤ng thi ho·∫∑c xem k·∫øt qu·∫£ g·∫ßn ƒë√¢y.</p>
+          <div className="mt-4 flex flex-wrap gap-3">
+            <button onClick={() => navigate('/student-dashboard/results')} className="px-4 py-2 rounded-lg border border-slate-300 text-slate-700 hover:border-slate-400">K·∫øt qu·∫£ c·ªßa t√¥i</button>
+          </div>
+        </section>
+
+        {/* Quick actions mapped to user stories */}
+        <section className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
+          <Card title="V√†o thi" desc="Nh·∫≠p m√£ ph√≤ng ƒë∆∞·ª£c gi·∫£ng vi√™n cung c·∫•p." action="X√°c minh ngay" onClick={() => navigate('/verify-room')} icon="üîê" />
+          <Card title="K·∫øt qu·∫£ & l·ªãch s·ª≠" desc="Xem ƒëi·ªÉm c√°c b√†i ƒë√£ thi." action="Xem b·∫£ng ƒëi·ªÉm" onClick={() => navigate('/student-dashboard/results')} icon="üìä" />
+          <Card title="Kho√° h·ªçc" desc="Duy·ªát c√°c kho√° h·ªçc m·ªü." action="Xem kho√° h·ªçc" onClick={() => alert('T√≠nh nƒÉng duy·ªát kho√° h·ªçc (US12) ‚Äî s·∫Ω t√≠ch h·ª£p sau.')} icon="üìö" />
+          <Card title="H·ªì s∆°" desc="C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n, avatar." action="C·∫≠p nh·∫≠t" onClick={() => navigate('/profile')} icon="üë§" />
+          <Card title="H∆∞·ªõng d·∫´n l√†m b√†i" desc="Quy t·∫Øc & ch·ªëng gian l·∫≠n." action="Xem h∆∞·ªõng d·∫´n" onClick={() => alert('Hi·ªÉn th·ªã h∆∞·ªõng d·∫´n/FAQ ch·ªëng gian l·∫≠n.')} icon="üõ°Ô∏è" />
+          <Card title="Tr·ª£ gi√∫p" desc="Li√™n h·ªá h·ªó tr·ª£ khi g·∫∑p l·ªói." action="G·ª≠i y√™u c·∫ßu" onClick={() => alert('Li√™n h·ªá h·ªó tr·ª£ qua email/Zalo theo h∆∞·ªõng d·∫´n.')} icon="‚ùì" />
+        </section>
+
+        {/* Recent results */}
+        <section className="rounded-2xl bg-white border border-slate-200 p-4">
+          <div className="flex items-center justify-between mb-3">
+            <h3 className="font-semibold text-slate-800">K·∫øt qu·∫£ g·∫ßn ƒë√¢y</h3>
+            <button onClick={() => navigate('/student-dashboard/results')} className="text-sm text-blue-600 hover:underline">Xem t·∫•t c·∫£</button>
+          </div>
+          {loading ? (
+            <div className="space-y-2">
+              <div className="h-4 w-40 bg-slate-200 rounded animate-pulse" />
+              <div className="h-12 w-full bg-slate-200 rounded animate-pulse" />
+              <div className="h-12 w-full bg-slate-200 rounded animate-pulse" />
+            </div>
+          ) : results.length === 0 ? (
+            <p className="text-slate-500 text-sm">Ch∆∞a c√≥ k·∫øt qu·∫£ n√†o.</p>
+          ) : (
+            <div className="overflow-x-auto">
+              <table className="min-w-full text-sm">
+                <thead>
+                  <tr className="text-left text-slate-500">
+                    <th className="py-2 pr-4">B√†i thi</th>
+                    <th className="py-2 pr-4">MCQ</th>
+                    <th className="py-2 pr-4">T·ª± lu·∫≠n</th>
+                    <th className="py-2 pr-4">T·ªïng t·∫°m</th>
+                    <th className="py-2 pr-4">Ng√†y n·ªôp</th>
+                  </tr>
+                </thead>
+                <tbody>
+                  {results.map((r) => (
+                    <tr key={r.submission_id} className="border-t border-slate-100">
+                      <td className="py-2 pr-4 font-medium text-slate-700">{r.exam_title || r.exam_id}</td>
+                      <td className="py-2 pr-4">{(r.total_score ?? r.mcq_score) ?? '-'}</td>
+                      <td className="py-2 pr-4">{r.essay_score ?? '-'}</td>
+                      <td className="py-2 pr-4">{r.suggested_total_score ?? '-'}</td>
+                      <td className="py-2 pr-4">{r.submitted_at ? new Date(r.submitted_at).toLocaleString() : '-'}</td>
+                    </tr>
+                  ))}
+                </tbody>
+              </table>
+            </div>
+          )}
+        </section>
+      </main>
+    </div>
+  );
+}
diff --git a/frontend/vite.config.js b/frontend/vite.config.js
index fafb063..012ea92 100644
--- a/frontend/vite.config.js
+++ b/frontend/vite.config.js
@@ -1,35 +1,35 @@
-import { defineConfig } from "vite";
-import react from "@vitejs/plugin-react";
-import tailwindcss from "@tailwindcss/vite";
-
-export default defineConfig({
-  plugins: [react(), tailwindcss()],
-  server: {
-    host: "0.0.0.0",
-    port: 4000,
-    strictPort: true,
-    cors: true,
-    allowedHosts: [
-      "localhost",
-      "127.0.0.1",
-      "",
-    ],
-    proxy: {
-      "/auth": {
-        target: "http://localhost:5000 ",
-        changeOrigin: true,
-        secure: false,
-      },
-      "/exam_rooms": {
-        target: "http://localhost:5000 ",
-        changeOrigin: true,
-        secure: false,
-      },
-      "/api": {
-        target: "http://localhost:5000",
-        changeOrigin: true,
-        secure: false,
-      },
-    },
-  },
-});
+import { defineConfig } from "vite";
+import react from "@vitejs/plugin-react";
+import tailwindcss from "@tailwindcss/vite";
+
+export default defineConfig({
+  plugins: [react(), tailwindcss()],
+  server: {
+    host: "0.0.0.0",
+    port: 4000,
+    strictPort: true,
+    cors: true,
+    allowedHosts: [
+      "localhost",
+      "127.0.0.1",
+      "",
+    ],
+    proxy: {
+      "/auth": {
+        target: "http://localhost:5000 ",
+        changeOrigin: true,
+        secure: false,
+      },
+      "/exam_rooms": {
+        target: "http://localhost:5000 ",
+        changeOrigin: true,
+        secure: false,
+      },
+      "/api": {
+        target: "http://localhost:5000",
+        changeOrigin: true,
+        secure: false,
+      },
+    },
+  },
+});
diff --git a/frontend/vite.config.js.timestamp-1762507189558-9358ce7eccb93.mjs b/frontend/vite.config.js.timestamp-1762507189558-9358ce7eccb93.mjs
index 817bd9d..33e3c00 100644
--- a/frontend/vite.config.js.timestamp-1762507189558-9358ce7eccb93.mjs
+++ b/frontend/vite.config.js.timestamp-1762507189558-9358ce7eccb93.mjs
@@ -1,39 +1,39 @@
-// vite.config.js
-import { defineConfig } from "file:///D:/OEM/OEM_Project-/frontend/node_modules/vite/dist/node/index.js";
-import react from "file:///D:/OEM/OEM_Project-/frontend/node_modules/@vitejs/plugin-react/dist/index.js";
-import tailwindcss from "file:///D:/OEM/OEM_Project-/frontend/node_modules/@tailwindcss/vite/dist/index.mjs";
-var vite_config_default = defineConfig({
-  plugins: [react(), tailwindcss()],
-  server: {
-    host: "0.0.0.0",
-    port: 4e3,
-    strictPort: true,
-    cors: true,
-    allowedHosts: [
-      "localhost",
-      "127.0.0.1",
-      ""
-    ],
-    proxy: {
-      "/auth": {
-        target: "http://localhost:5000 ",
-        changeOrigin: true,
-        secure: false
-      },
-      "/exam_rooms": {
-        target: "http://localhost:5000 ",
-        changeOrigin: true,
-        secure: false
-      },
-      "/api": {
-        target: "http://localhost:5000",
-        changeOrigin: true,
-        secure: false
-      }
-    }
-  }
-});
-export {
-  vite_config_default as default
-};
-//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsidml0ZS5jb25maWcuanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImNvbnN0IF9fdml0ZV9pbmplY3RlZF9vcmlnaW5hbF9kaXJuYW1lID0gXCJEOlxcXFxPRU1cXFxcT0VNX1Byb2plY3QtXFxcXGZyb250ZW5kXCI7Y29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2ZpbGVuYW1lID0gXCJEOlxcXFxPRU1cXFxcT0VNX1Byb2plY3QtXFxcXGZyb250ZW5kXFxcXHZpdGUuY29uZmlnLmpzXCI7Y29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2ltcG9ydF9tZXRhX3VybCA9IFwiZmlsZTovLy9EOi9PRU0vT0VNX1Byb2plY3QtL2Zyb250ZW5kL3ZpdGUuY29uZmlnLmpzXCI7aW1wb3J0IHsgZGVmaW5lQ29uZmlnIH0gZnJvbSBcInZpdGVcIjtcclxuaW1wb3J0IHJlYWN0IGZyb20gXCJAdml0ZWpzL3BsdWdpbi1yZWFjdFwiO1xyXG5pbXBvcnQgdGFpbHdpbmRjc3MgZnJvbSBcIkB0YWlsd2luZGNzcy92aXRlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb25maWcoe1xyXG4gIHBsdWdpbnM6IFtyZWFjdCgpLCB0YWlsd2luZGNzcygpXSxcclxuICBzZXJ2ZXI6IHtcclxuICAgIGhvc3Q6IFwiMC4wLjAuMFwiLFxyXG4gICAgcG9ydDogNDAwMCxcclxuICAgIHN0cmljdFBvcnQ6IHRydWUsXHJcbiAgICBjb3JzOiB0cnVlLFxyXG4gICAgYWxsb3dlZEhvc3RzOiBbXHJcbiAgICAgIFwibG9jYWxob3N0XCIsXHJcbiAgICAgIFwiMTI3LjAuMC4xXCIsXHJcbiAgICAgIFwiXCIsXHJcbiAgICBdLFxyXG4gICAgcHJveHk6IHtcclxuICAgICAgXCIvYXV0aFwiOiB7XHJcbiAgICAgICAgdGFyZ2V0OiBcImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMCBcIixcclxuICAgICAgICBjaGFuZ2VPcmlnaW46IHRydWUsXHJcbiAgICAgICAgc2VjdXJlOiBmYWxzZSxcclxuICAgICAgfSxcclxuICAgICAgXCIvZXhhbV9yb29tc1wiOiB7XHJcbiAgICAgICAgdGFyZ2V0OiBcImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMCBcIixcclxuICAgICAgICBjaGFuZ2VPcmlnaW46IHRydWUsXHJcbiAgICAgICAgc2VjdXJlOiBmYWxzZSxcclxuICAgICAgfSxcclxuICAgICAgXCIvYXBpXCI6IHtcclxuICAgICAgICB0YXJnZXQ6IFwiaHR0cDovL2xvY2FsaG9zdDo1MDAwXCIsXHJcbiAgICAgICAgY2hhbmdlT3JpZ2luOiB0cnVlLFxyXG4gICAgICAgIHNlY3VyZTogZmFsc2UsXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gIH0sXHJcbn0pO1xyXG4iXSwKICAibWFwcGluZ3MiOiAiO0FBQThRLFNBQVMsb0JBQW9CO0FBQzNTLE9BQU8sV0FBVztBQUNsQixPQUFPLGlCQUFpQjtBQUV4QixJQUFPLHNCQUFRLGFBQWE7QUFBQSxFQUMxQixTQUFTLENBQUMsTUFBTSxHQUFHLFlBQVksQ0FBQztBQUFBLEVBQ2hDLFFBQVE7QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLFlBQVk7QUFBQSxJQUNaLE1BQU07QUFBQSxJQUNOLGNBQWM7QUFBQSxNQUNaO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNGO0FBQUEsSUFDQSxPQUFPO0FBQUEsTUFDTCxTQUFTO0FBQUEsUUFDUCxRQUFRO0FBQUEsUUFDUixjQUFjO0FBQUEsUUFDZCxRQUFRO0FBQUEsTUFDVjtBQUFBLE1BQ0EsZUFBZTtBQUFBLFFBQ2IsUUFBUTtBQUFBLFFBQ1IsY0FBYztBQUFBLFFBQ2QsUUFBUTtBQUFBLE1BQ1Y7QUFBQSxNQUNBLFFBQVE7QUFBQSxRQUNOLFFBQVE7QUFBQSxRQUNSLGNBQWM7QUFBQSxRQUNkLFFBQVE7QUFBQSxNQUNWO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFDRixDQUFDOyIsCiAgIm5hbWVzIjogW10KfQo=
+// vite.config.js
+import { defineConfig } from "file:///D:/OEM/OEM_Project-/frontend/node_modules/vite/dist/node/index.js";
+import react from "file:///D:/OEM/OEM_Project-/frontend/node_modules/@vitejs/plugin-react/dist/index.js";
+import tailwindcss from "file:///D:/OEM/OEM_Project-/frontend/node_modules/@tailwindcss/vite/dist/index.mjs";
+var vite_config_default = defineConfig({
+  plugins: [react(), tailwindcss()],
+  server: {
+    host: "0.0.0.0",
+    port: 4e3,
+    strictPort: true,
+    cors: true,
+    allowedHosts: [
+      "localhost",
+      "127.0.0.1",
+      ""
+    ],
+    proxy: {
+      "/auth": {
+        target: "http://localhost:5000 ",
+        changeOrigin: true,
+        secure: false
+      },
+      "/exam_rooms": {
+        target: "http://localhost:5000 ",
+        changeOrigin: true,
+        secure: false
+      },
+      "/api": {
+        target: "http://localhost:5000",
+        changeOrigin: true,
+        secure: false
+      }
+    }
+  }
+});
+export {
+  vite_config_default as default
+};
+//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsidml0ZS5jb25maWcuanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImNvbnN0IF9fdml0ZV9pbmplY3RlZF9vcmlnaW5hbF9kaXJuYW1lID0gXCJEOlxcXFxPRU1cXFxcT0VNX1Byb2plY3QtXFxcXGZyb250ZW5kXCI7Y29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2ZpbGVuYW1lID0gXCJEOlxcXFxPRU1cXFxcT0VNX1Byb2plY3QtXFxcXGZyb250ZW5kXFxcXHZpdGUuY29uZmlnLmpzXCI7Y29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2ltcG9ydF9tZXRhX3VybCA9IFwiZmlsZTovLy9EOi9PRU0vT0VNX1Byb2plY3QtL2Zyb250ZW5kL3ZpdGUuY29uZmlnLmpzXCI7aW1wb3J0IHsgZGVmaW5lQ29uZmlnIH0gZnJvbSBcInZpdGVcIjtcclxuaW1wb3J0IHJlYWN0IGZyb20gXCJAdml0ZWpzL3BsdWdpbi1yZWFjdFwiO1xyXG5pbXBvcnQgdGFpbHdpbmRjc3MgZnJvbSBcIkB0YWlsd2luZGNzcy92aXRlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb25maWcoe1xyXG4gIHBsdWdpbnM6IFtyZWFjdCgpLCB0YWlsd2luZGNzcygpXSxcclxuICBzZXJ2ZXI6IHtcclxuICAgIGhvc3Q6IFwiMC4wLjAuMFwiLFxyXG4gICAgcG9ydDogNDAwMCxcclxuICAgIHN0cmljdFBvcnQ6IHRydWUsXHJcbiAgICBjb3JzOiB0cnVlLFxyXG4gICAgYWxsb3dlZEhvc3RzOiBbXHJcbiAgICAgIFwibG9jYWxob3N0XCIsXHJcbiAgICAgIFwiMTI3LjAuMC4xXCIsXHJcbiAgICAgIFwiXCIsXHJcbiAgICBdLFxyXG4gICAgcHJveHk6IHtcclxuICAgICAgXCIvYXV0aFwiOiB7XHJcbiAgICAgICAgdGFyZ2V0OiBcImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMCBcIixcclxuICAgICAgICBjaGFuZ2VPcmlnaW46IHRydWUsXHJcbiAgICAgICAgc2VjdXJlOiBmYWxzZSxcclxuICAgICAgfSxcclxuICAgICAgXCIvZXhhbV9yb29tc1wiOiB7XHJcbiAgICAgICAgdGFyZ2V0OiBcImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMCBcIixcclxuICAgICAgICBjaGFuZ2VPcmlnaW46IHRydWUsXHJcbiAgICAgICAgc2VjdXJlOiBmYWxzZSxcclxuICAgICAgfSxcclxuICAgICAgXCIvYXBpXCI6IHtcclxuICAgICAgICB0YXJnZXQ6IFwiaHR0cDovL2xvY2FsaG9zdDo1MDAwXCIsXHJcbiAgICAgICAgY2hhbmdlT3JpZ2luOiB0cnVlLFxyXG4gICAgICAgIHNlY3VyZTogZmFsc2UsXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gIH0sXHJcbn0pO1xyXG4iXSwKICAibWFwcGluZ3MiOiAiO0FBQThRLFNBQVMsb0JBQW9CO0FBQzNTLE9BQU8sV0FBVztBQUNsQixPQUFPLGlCQUFpQjtBQUV4QixJQUFPLHNCQUFRLGFBQWE7QUFBQSxFQUMxQixTQUFTLENBQUMsTUFBTSxHQUFHLFlBQVksQ0FBQztBQUFBLEVBQ2hDLFFBQVE7QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLE1BQU07QUFBQSxJQUNOLFlBQVk7QUFBQSxJQUNaLE1BQU07QUFBQSxJQUNOLGNBQWM7QUFBQSxNQUNaO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNGO0FBQUEsSUFDQSxPQUFPO0FBQUEsTUFDTCxTQUFTO0FBQUEsUUFDUCxRQUFRO0FBQUEsUUFDUixjQUFjO0FBQUEsUUFDZCxRQUFRO0FBQUEsTUFDVjtBQUFBLE1BQ0EsZUFBZTtBQUFBLFFBQ2IsUUFBUTtBQUFBLFFBQ1IsY0FBYztBQUFBLFFBQ2QsUUFBUTtBQUFBLE1BQ1Y7QUFBQSxNQUNBLFFBQVE7QUFBQSxRQUNOLFFBQVE7QUFBQSxRQUNSLGNBQWM7QUFBQSxRQUNkLFFBQVE7QUFBQSxNQUNWO0FBQUEsSUFDRjtBQUFBLEVBQ0Y7QUFDRixDQUFDOyIsCiAgIm5hbWVzIjogW10KfQo=
diff --git a/scripts/create_sample_excel.js b/scripts/create_sample_excel.js
index d4dbe0c..2b86a91 100644
--- a/scripts/create_sample_excel.js
+++ b/scripts/create_sample_excel.js
@@ -1,32 +1,32 @@
-// Script to convert CSV sample to Excel format
-// Run: node scripts/create_sample_excel.js
-
-const XLSX = require('xlsx');
-const fs = require('fs');
-
-console.log('üìù Creating sample Excel file...');
-
-// Read the CSV file
-const csvContent = fs.readFileSync('docs/sample_exam_bank.csv', 'utf-8');
-
-// Convert CSV to worksheet
-const workbook = XLSX.utils.book_new();
-const worksheet = XLSX.utils.aoa_to_sheet(
-  csvContent.split('\n').map(line => {
-    // Parse CSV line (simple approach)
-    const parts = line.split(',');
-    return parts;
-  })
-);
-
-// Add worksheet to workbook
-XLSX.utils.book_append_sheet(workbook, worksheet, 'Question Bank');
-
-// Write to file
-const outputPath = 'docs/sample_exam_bank.xlsx';
-XLSX.writeFile(workbook, outputPath);
-
-console.log('‚úÖ Sample Excel file created at:', outputPath);
-console.log('üìÑ You can now upload this file to the Exam Bank system!');
-
-
+// Script to convert CSV sample to Excel format
+// Run: node scripts/create_sample_excel.js
+
+const XLSX = require('xlsx');
+const fs = require('fs');
+
+console.log('üìù Creating sample Excel file...');
+
+// Read the CSV file
+const csvContent = fs.readFileSync('docs/sample_exam_bank.csv', 'utf-8');
+
+// Convert CSV to worksheet
+const workbook = XLSX.utils.book_new();
+const worksheet = XLSX.utils.aoa_to_sheet(
+  csvContent.split('\n').map(line => {
+    // Parse CSV line (simple approach)
+    const parts = line.split(',');
+    return parts;
+  })
+);
+
+// Add worksheet to workbook
+XLSX.utils.book_append_sheet(workbook, worksheet, 'Question Bank');
+
+// Write to file
+const outputPath = 'docs/sample_exam_bank.xlsx';
+XLSX.writeFile(workbook, outputPath);
+
+console.log('‚úÖ Sample Excel file created at:', outputPath);
+console.log('üìÑ You can now upload this file to the Exam Bank system!');
+
+
